<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0002_0054_02_grid_RF">
    <![CDATA[
-- FO_0002_0054_02_grid_RF
with        
    set [Список МО]        
    as ' Filter        
        (
            Descendants        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF        
            ),
            not        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"        
            )        
        ) '        
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ]          
    as 'IIF          
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа]          
        ) '           
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]          
    as '[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта] '  
    member [Measures].[Расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213)]       
    as 'Sum     
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Заработная плата],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Начисления на выплаты по оплате труда]     
            },
            [Measures].[<%selected_measure%>]     
        ) / 1000'    
    member [Measures].[Расходы на коммунальные услуги (КОСГУ 223)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Коммунальные услуги]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
    member [Measures].[Расходы на социальное обеспечение (КОСГУ 260)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение]   
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'           
    member [Measures].[Расходы на обслуживание государственного (муниципального) долга (КОСГУ 230)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Обслуживание государственного (муниципального) долга]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
    member [Measures].[Расходы на первоочередные нужды (КОСГУ 212, КОСГУ 221, КОСГУ 222, КОСГУ 224, КОСГУ 340)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Прочие выплаты],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Услуги связи],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Транспортные услуги],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Арендная плата за пользование имуществом],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости материальных запасов]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
    member [Measures].[Расходы на прочие нужды (КОСГУ 225, КОСГУ 226, КОСГУ 241, КОСГУ 290)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Работы, услуги по содержанию имущества],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Прочие работы, услуги],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления организациям].[Безвозмездные перечисления государственным и муниципальным организациям],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Прочие расходы]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
        
    member [Measures].[Итого социально-значимые расходы]    
    as '(
            [Measures].[Расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213)] 
        ) +  
        (
            [Measures].[Расходы на коммунальные услуги (КОСГУ 223)] 
        ) + 
        (                
           [Measures].[Расходы на социальное обеспечение (КОСГУ 260)] 
        )'  

    member [Measures].[Итого первоочередных расходов]    
    as '(
            [Measures].[Расходы на обслуживание государственного (муниципального) долга (КОСГУ 230)] 
        ) +  
        (
            [Measures].[Расходы на первоочередные нужды (КОСГУ 212, КОСГУ 221, КОСГУ 222, КОСГУ 224, КОСГУ 340)] 
        ) +  
        (
            [Measures].[Расходы на прочие нужды (КОСГУ 225, КОСГУ 226, КОСГУ 241, КОСГУ 290)] 
        )'  

    member [Measures].[Расходы]    
    as '  
        (
            [Measures].[Расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213)] 
        ) +  
        (
            [Measures].[Расходы на коммунальные услуги (КОСГУ 223)] 
        ) + 
        (                
           [Measures].[Расходы на социальное обеспечение (КОСГУ 260)] 
        ) +
        (
            [Measures].[Расходы на обслуживание государственного (муниципального) долга (КОСГУ 230)] 
        ) +  
        (
            [Measures].[Расходы на первоочередные нужды (КОСГУ 212, КОСГУ 221, КОСГУ 222, КОСГУ 224, КОСГУ 340)] 
        ) +  
        (
            [Measures].[Расходы на прочие нужды (КОСГУ 225, КОСГУ 226, КОСГУ 241, КОСГУ 290)] 
        ) '    
    member [Measures].[Расходы всего]    
    as 'IIF    
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember is [РзПр__Сопоставимый].[РзПр__Сопоставимый].DefaultMember,
            (
                [Measures].[<%selected_measure%>],
                [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]    
            ) / 1000,
            (
                [Measures].[<%selected_measure%>],
                <%selected_rzpr%>  
            ) / 1000    
        )    '    
    member [Measures].[Доля расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
            [Measures].[Расходы]  / [Measures].[Расходы всего]  
        )'    
    member [Measures].[Доля расходов прошлый год]    
    as '    
        (
            [Measures].[Доля расходов] ,
            ParallelPeriod    
            (
                [Период__Период].[Период__Период].[Год],
                1,
                [Период__Период].[Период__Период].CurrentMember    
            )    
        )'    
    member [Measures].[Ранг МО по доле расходов]    
    as 'IIF    
        (
            IsEmpty    
            (
                [[Measures].[Доля расходов]  
            ),
            null,
            Rank    
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                Order    
                (
                    [Список МО],
                    [Measures].[Доля расходов] ,
                    BDESC    
                ),
                [Measures].[Доля расходов]  
            )    
        )'    
    member [Measures].[Худший ранг МО по доле расходов]    
    as 'IIF    
        (
            IsEmpty    
            (
                [Measures].[Ранг МО по доле расходов]    
            ),
            null,
            max    
            (
                [Список МО],
                [Measures].[Ранг МО по доле расходов]    
            )    
        )'    
    member [Measures].[Максимальная доля]    
    as 'max    
        (
            [Список МО],
            [Measures].[Доля расходов]  
        )'    
    member [Measures].[Минимальная доля]    
    as 'min    
        (
            [Список МО],
            [Measures].[Доля расходов]  
        )'    
    member [Measures].[Оценка доли расходов]    
    as 'IIF    
        (
            (
                IsEmpty ([Measures].[Максимальная доля]) and IsEmpty ([Measures].[Минимальная доля])    
            ) or    
            (
                [Measures].[Максимальная доля] - [Measures].[Минимальная доля]    
            ) = 0,
            null,
            (
                [Measures].[Доля расходов] - [Measures].[Минимальная доля]  
            ) /    
            (
                [Measures].[Максимальная доля] - [Measures].[Минимальная доля]    
            )    
        )'    
    member [Measures].[Темп роста доли расходов]    
    as 'IIF    
        (
            IsEmpty   
            (
                [Measures].[Доля расходов прошлый год]    
            ) or    
            (
                [Measures].[Доля расходов прошлый год]    
            ) = 0,
            null,
            [Measures].[Доля расходов]  / [Measures].[Доля расходов прошлый год]  
        )'    
select
    {
        [Measures].[Расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213)],
        [Measures].[Расходы на коммунальные услуги (КОСГУ 223)],
        [Measures].[Расходы на социальное обеспечение (КОСГУ 260)],
        [Measures].[Итого социально-значимые расходы],
        [Measures].[Расходы на обслуживание государственного (муниципального) долга (КОСГУ 230)],
        [Measures].[Расходы на первоочередные нужды (КОСГУ 212, КОСГУ 221, КОСГУ 222, КОСГУ 224, КОСГУ 340)],
        [Measures].[Расходы на прочие нужды (КОСГУ 225, КОСГУ 226, КОСГУ 241, КОСГУ 290)],
        [Measures].[Итого первоочередных расходов],
        [Measures].[Расходы всего],
        [Measures].[Доля расходов],
        [Measures].[Ранг МО по доле расходов],
        [Measures].[Оценка доли расходов],
        [Measures].[Темп роста доли расходов],
        [Measures].[Худший ранг МО по доле расходов]
    } on columns,
    { [Список МО] } on rows        
from [ФО_МесОтч_Расходы]        
where        
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ],
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%selected_rzpr%>       
    )         
  ]]>
  </query>

  <query id="FO_0002_0054_02_grid_HMAO">
    <![CDATA[
-- FO_0002_0054_02_HMAO
with        
    set [Список МО]        
    as ' Filter        
        (
            Descendants        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF        
            ),
            not        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"        
            )        
        ) '        
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ]          
    as 'IIF          
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа]          
        ) '           
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]          
    as '[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта]'  
    member [Период__Период].[Период__Период].[Аггрегированный период прошлый год]
    as 'Aggregate
        (
            {
                Filter
                (
                    Descendants
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_last_year%>],
                        [Период__Период].[Период__Период].[Месяц],
                        SELF
                    ),
                    (
                        [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                    ) and
                    (
                        [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                    ) and
                    (
                        [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                    ) and
                    (
                        [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                    ) and
                    (
                        [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                    ) and
                    (
                        [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                    ) and
                    IIF
                    (
                        [Measures].[<%selected_measure%>] is [Measures].[Уточненные годовые назначения],
                        [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Данные всех периодов].[<%period_last_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
                        [Период__Период].[Период__Период].CurrentMember.Properties("PKID") <= [Период__Период].[Период__Период].[Данные всех периодов].[<%period_last_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>].Properties("PKID")
                    )
                )
            }
        ) '

    set [Периоды]  
    as ' Filter  
        (
            Descendants  
            (
                [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>],
                [Период__Период].[Период__Период].[Месяц],
                SELF  
            ),
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"  
            ) and
            IIF
            (
                [Measures].[<%selected_measure%>] is [Measures].[Уточненные годовые назначения],
                [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
                [Период__Период].[Период__Период].CurrentMember.Properties("PKID") <= [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>].Properties("PKID")
            )
        ) '  
    member [Measures].[Нараст.итог на отчетную дату]  
    as 'Sum  
        (
            [Периоды],
            [Measures].[<%selected_measure%>]  
        ) '  

    member [Measures].[Оплата труда и начисления на выплаты по оплате труда за исключением аппарата (КОСГУ 211, 213)]      
    as '
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[1. Оплата труда и начисления на выплаты по оплате труда (за исключением аппарата) (КОСГУ 211+КОСГУ 213)],
            [Measures].[Нараст.итог на отчетную дату]      
        ) / 1000'       
    member [Measures].[Содержание органов местного самоуправления (расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213))]      
    as '      
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[в том числе оплата труда с начислениями (КОСГУ 211+ КОСГУ 213)],
            [Measures].[Нараст.итог на отчетную дату]       
        ) / 1000'       
    member [Measures].[Оплата коммунальных услуг (КОСГУ 223)]      
    as '      
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[3. Оплата коммунальных услуг (КОСГУ 223)],
            [Measures].[Нараст.итог на отчетную дату]      
        ) / 1000'       

        
   member [Measures].[Мера для лукапа]
    as 'IIF
        (
            "<%selected_measure%>" = "Исполнено за период",
            "Факт",
            "Годовые назначения"
        )'

    member [Measures].[Социальное обеспечение (КОСГУ 260)] 
    as 'IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            LookupCube 
            (
                "[ФО_МесОтч_Расходы]",
                "  
                (
                    [Measures].[" + [Measures].[Мера для лукапа] + "],
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
                    " + MemberToStr
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                    ) + ",
                    " + MemberToStr 
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                    ) + " 
                )"
            ) / 1000,
            LookupCube
            (
                "[ФО_МесОтч_Расходы]",
                "
                (
                    [Measures].[" + [Measures].[Мера для лукапа] + "],
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                    " + MemberToStr
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                    ) + "
                )"
            ) / 1000
        )' 
        
    member [Measures].[Стипендии (КОСГУ 290)]      
    as '      
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[5. Стипендии (КОСГУ 290)],
            [Measures].[Нараст.итог на отчетную дату]       
        ) / 1000'       
    member [Measures].[Продукты питания, медикаменты]      
    as 'Sum      
        (
            {
                [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[6. Увеличение стоимости нематериальных запасов (КОСГУ 340), в том числе:].[продукты питания (КОСГУ 340)],
                [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[6. Увеличение стоимости нематериальных запасов (КОСГУ 340), в том числе:].[медикаменты (КОСГУ 340)]       
            },
            [Measures].[Нараст.итог на отчетную дату]      
        ) / 1000'         
    member [Measures].[Итого социально-значимых расходов]    
    as '    
        (
            [Measures].[Оплата труда и начисления на выплаты по оплате труда за исключением аппарата (КОСГУ 211, 213)]     
        ) +     
        (
            [Measures].[Содержание органов местного самоуправления (расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213))]     
        ) +     
        (
            [Measures].[Оплата коммунальных услуг (КОСГУ 223)]     
        )+     
        (
            [Measures].[Социальное обеспечение (КОСГУ 260)]    
        ) +     
        (
            [Measures].[Стипендии (КОСГУ 290)]    
        )+     
        (
            [Measures].[Продукты питания, медикаменты]    
        )'         
    member [Measures].[Прочие выплаты (КОСГУ 212)]    
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[1.Прочие выплаты (КОСГУ 212)],
            [Measures].[Нараст.итог на отчетную дату]    
        ) / 1000'    
    member [Measures].[Расходы на обслуживание долга (КОСГУ 230)]    
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[2. Расходы на обслуживание долга (КОСГУ 230)],
            [Measures].[Нараст.итог на отчетную дату]    
        ) / 1000'    
    member [Measures].[Материальные затраты (КОСГУ 221, КОСГУ 222, КОСГУ 224)]    
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[3. Материальные затраты, в том числе:],
            [Measures].[Нараст.итог на отчетную дату]    
        ) / 1000'    
    member [Measures].[Итого первоочередных расходов]    
    as '    
        (
            [Measures].[Прочие выплаты (КОСГУ 212)]    
        ) +    
        (
            [Measures].[Расходы на обслуживание долга (КОСГУ 230)]    
        ) +    
        (
            [Measures].[Материальные затраты (КОСГУ 221, КОСГУ 222, КОСГУ 224)]    
        )'     
    member [Measures].[Расходы]       
    as '       
        (
            [Measures].[Итого социально-значимых расходов]    
        ) +       
        (
            [Measures].[Итого первоочередных расходов]    
        ) '       
    member [Measures].[Расходы всего]       
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ],
            [Measures].[Нараст.итог на отчетную дату]  
        ) / 1000' 
    member [Measures].[Доля расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
            [Measures].[Расходы]  / [Measures].[Расходы всего]  
        )'    

    member [Measures].[Ранг МО по доле расходов]    
    as 'IIF    
        (
            IsEmpty    
            (
                (
                   [Measures].[Доля расходов]   
                )   
            ),
            null,
            Rank    
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                Order    
                (
                    [Список МО],
                    (
                       [Measures].[Доля расходов]
                    ),
                    BDESC    
                ),
                (
                   [Measures].[Доля расходов]  
                )  
            )    
        )'    
    member [Measures].[Худший ранг МО по доле расходов]    
    as 'IIF    
        (
            IsEmpty    
            (
                (
                    [Measures].[Ранг МО по доле расходов]  
                )
            ),
            null,
            max    
            (
                [Список МО],
                (
                    [Measures].[Ранг МО по доле расходов]
                )  
            )    
        )'    
    member [Measures].[Максимальная доля]    
    as 'max    
        (
            [Список МО],
            [Measures].[Доля расходов]  
        )'    
    member [Measures].[Минимальная доля]    
    as 'min    
        (
            [Список МО],
            [Measures].[Доля расходов]  
        )'    
    member [Measures].[Оценка доли расходов]    
    as 'IIF    
        (
            (
                IsEmpty ([Measures].[Максимальная доля]) and IsEmpty ([Measures].[Минимальная доля])    
            ) or    
            (
                [Measures].[Максимальная доля] - [Measures].[Минимальная доля]    
            ) = 0,
            null,
            (
                [Measures].[Доля расходов] - [Measures].[Минимальная доля]  
            ) /    
            (
                [Measures].[Максимальная доля] - [Measures].[Минимальная доля]    
            )    
        )'    
        
        
    member [Measures].[Расходы прошлый год] 
    as ' Sum
            (
                {
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[1. Оплата труда и начисления на выплаты по оплате труда (за исключением аппарата) (КОСГУ 211+КОСГУ 213)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[в том числе оплата труда с начислениями (КОСГУ 211+ КОСГУ 213)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[3. Оплата коммунальных услуг (КОСГУ 223)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[4. Социальное обеспечение (КОСГУ 260), в том числе:],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[5. Стипендии (КОСГУ 290)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[6. Увеличение стоимости нематериальных запасов (КОСГУ 340), в том числе:].[продукты питания (КОСГУ 340)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[6. Увеличение стоимости нематериальных запасов (КОСГУ 340), в том числе:].[медикаменты (КОСГУ 340)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[1.Прочие выплаты (КОСГУ 212)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[2. Расходы на обслуживание долга (КОСГУ 230)],
                    [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[3. Материальные затраты, в том числе:]
                },
                (
                    [Measures].[<%selected_measure%>],
                    [Период__Период].[Период__Период].[Аггрегированный период прошлый год]
                )
            ) / 1000
         '  
    member [Measures].[Расходы всего прошлый год] 
    as ' 
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ],
            [Measures].[<%selected_measure%>],
            [Период__Период].[Период__Период].[Аггрегированный период прошлый год] 
        ) / 1000'  
    member [Measures].[Доля расходов прошлый год] 
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Расходы всего прошлый год]
            ) or 
            (
                [Measures].[Расходы всего прошлый год]
            ) = 0,
            null,
            [Measures].[Расходы прошлый год] / [Measures].[Расходы всего прошлый год]
        )' 
        
    member [Measures].[Темп роста доли расходов]    
    as 'IIF    
        (
            IsEmpty   
            (
                [Measures].[Доля расходов прошлый год]    
            ) or    
            (
                [Measures].[Доля расходов прошлый год]    
            ) = 0,
            null,
            [Measures].[Доля расходов]   / [Measures].[Доля расходов прошлый год]  
        )'  
        
    member [Measures].[Число пустых МО]
    as 'Count
        (
            Filter 
            (
                [Список МО],
                IsEmpty 
                (
                     [Measures].[Оплата труда и начисления на выплаты по оплате труда за исключением аппарата (КОСГУ 211, 213)] 
                ) 
            )
        )'         
select
    {
        [Measures].[Оплата труда и начисления на выплаты по оплате труда за исключением аппарата (КОСГУ 211, 213)],
        [Measures].[Содержание органов местного самоуправления (расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213))],
        [Measures].[Оплата коммунальных услуг (КОСГУ 223)],
        [Measures].[Социальное обеспечение (КОСГУ 260)],
        [Measures].[Стипендии (КОСГУ 290)],
        [Measures].[Продукты питания, медикаменты],
        [Measures].[Итого социально-значимых расходов],
        [Measures].[Прочие выплаты (КОСГУ 212)],
        [Measures].[Расходы на обслуживание долга (КОСГУ 230)],
        [Measures].[Материальные затраты (КОСГУ 221, КОСГУ 222, КОСГУ 224)],
        [Measures].[Итого первоочередных расходов],
        [Measures].[Расходы всего],
        [Measures].[Доля расходов],
        [Measures].[Ранг МО по доле расходов],
        [Measures].[Оценка доли расходов],
        [Measures].[Темп роста доли расходов],
        [Measures].[Худший ранг МО по доле расходов] 
    } on columns,
    {
        Filter 
        (
            [Список МО],
            [Measures].[Число пустых МО] = 0
        ) 
    } on rows   
from [ФО_Финпаспорт МО]      
where        
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]  ,
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ],
        [Состояние__Формы сбора по паспорту МО].[Состояние__Формы сбора по паспорту МО].[Все состояния].[Утвержден] 
    )         
  ]]>
  </query>

  <query id="FO_0002_0054_02_chart_RF">
    <![CDATA[
-- FO_0002_0054_02_chart_RF
with        
    set [Список МО]        
    as ' Filter        
        (
            Descendants        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF        
            ),
            not        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"        
            )        
        ) '        
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ]    
    as 'IIF   
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее],
            Aggregate   
            (
                {
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа]   
                }
            ),
            IIF   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа]   
            )   
        )  '          

    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]  
    as 'IIF  
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее],
            Aggregate
            (
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта]
                }
            ),
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта]
        ) '

    member [Measures].[Расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213)]       
    as 'Sum     
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Заработная плата],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Начисления на выплаты по оплате труда]     
            },
            [Measures].[<%selected_measure%>]     
        ) / 1000'    
    member [Measures].[Расходы на коммунальные услуги (КОСГУ 223)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Коммунальные услуги]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
    member [Measures].[Расходы на социальное обеспечение (КОСГУ 260)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение]   
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'           
    member [Measures].[Расходы на обслуживание государственного (муниципального) долга (КОСГУ 230)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Обслуживание государственного (муниципального) долга]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
    member [Measures].[Расходы на первоочередные нужды (КОСГУ 212, КОСГУ 221, КОСГУ 222, КОСГУ 224, КОСГУ 340)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Прочие выплаты],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Услуги связи],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Транспортные услуги],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Арендная плата за пользование имуществом],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости материальных запасов]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
    member [Measures].[Расходы на прочие нужды (КОСГУ 225, КОСГУ 226, КОСГУ 241, КОСГУ 290)]    
    as 'Sum    
        (
            {
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Работы, услуги по содержанию имущества],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг].[Прочие работы, услуги],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления организациям].[Безвозмездные перечисления государственным и муниципальным организациям],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Прочие расходы]    
            },
            [Measures].[<%selected_measure%>]    
        ) / 1000'    
    member [Measures].[Социально-значимые расходы]    
    as '  
        (
            [Measures].[Расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213)] 
        ) +  
        (
            [Measures].[Расходы на коммунальные услуги (КОСГУ 223)] 
        ) + 
        (
           [Measures].[Расходы на социальное обеспечение (КОСГУ 260)]
        ) '    
    member [Measures].[Первоочередные расходы]    
    as '
        (
            [Measures].[Расходы на обслуживание государственного (муниципального) долга (КОСГУ 230)] 
        ) +  
        (
            [Measures].[Расходы на первоочередные нужды (КОСГУ 212, КОСГУ 221, КОСГУ 222, КОСГУ 224, КОСГУ 340)] 
        ) +  
        (
            [Measures].[Расходы на прочие нужды (КОСГУ 225, КОСГУ 226, КОСГУ 241, КОСГУ 290)] 
        ) '         
    member [Measures].[Расходы всего]    
    as 'IIF    
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember is [РзПр__Сопоставимый].[РзПр__Сопоставимый].DefaultMember,
            (
                [Measures].[<%selected_measure%>],
                [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]    
            ) / 1000,
            (
                [Measures].[<%selected_measure%>],
                <%selected_rzpr%>  
            ) / 1000    
        )    '    
    member [Measures].[Доля социально-значимых расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
           [Measures].[Социально-значимые расходы] / [Measures].[Расходы всего]  
        )'    

    member [Measures].[Доля первоочередных расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
           [Measures].[Первоочередные расходы]  / [Measures].[Расходы всего]  
        )'     
    
    member [Measures].[Доля расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
           ([Measures].[Социально-значимые расходы] + [Measures].[Первоочередные расходы]) / [Measures].[Расходы всего]  
        )' 

    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее]
    as 'AVG
        (
            [Список МО],
            [Measures].CurrentMember
        )'
select
    {
        [Measures].[Доля расходов],
        [Measures].[Доля социально-значимых расходов],
        [Measures].[Доля первоочередных расходов]
    } on columns,
    non Empty
    {
        Order
        (
            [Список МО],
            [Measures].[Доля расходов],
            BDESC
        )
    } on rows
from [ФО_МесОтч_Расходы]        
where        
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ],
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%selected_rzpr%>        
    )         
  ]]>
  </query>

  <query id="FO_0002_0054_02_chart_HMAO">
    <![CDATA[
-- FO_0002_0054_02_chart_HMAO
with        
    set [Список МО]        
    as ' Filter        
        (
            Descendants        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF        
            ),
            not        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"        
            )        
        ) '        
        
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ]    
    as 'IIF   
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее],
            Aggregate   
            (
                {
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа]   
                }
            ),
            IIF   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа]   
            )   
        )  '          
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]  
    as 'IIF  
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее],
            Aggregate
            (
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта]
                }
            ),
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта]
        ) '
   set [Периоды]  
    as ' Filter  
        (
            Descendants  
            (
                [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>],
                [Период__Период].[Период__Период].[Месяц],
                SELF  
            ),
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"  
            ) and
            IIF
            (
                [Measures].[<%selected_measure%>] is [Measures].[Уточненные годовые назначения],
                [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
                [Период__Период].[Период__Период].CurrentMember.Properties("PKID") <= [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>].Properties("PKID")
            ) 
        ) '  
    member [Measures].[Нараст.итог на отчетную дату]  
    as 'IIF
        (
            [Measures].[<%selected_measure%>] is [Measures].[Уточненные годовые назначения],
            [Measures].[<%selected_measure%>],
            Sum  
            (
                [Периоды],
                [Measures].[<%selected_measure%>]  
            )
        )'          
        
    member [Measures].[Оплата труда и начисления на выплаты по оплате труда за исключением аппарата (КОСГУ 211, 213)]      
    as '
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[1. Оплата труда и начисления на выплаты по оплате труда (за исключением аппарата) (КОСГУ 211+КОСГУ 213)],
            [Measures].[Нараст.итог на отчетную дату]     
        ) / 1000'       
    member [Measures].[Содержание органов местного самоуправления (расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213))]      
    as '      
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[в том числе оплата труда с начислениями (КОСГУ 211+ КОСГУ 213)],
            [Measures].[Нараст.итог на отчетную дату]
        ) / 1000'       
    member [Measures].[Оплата коммунальных услуг (КОСГУ 223)]      
    as '      
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[3. Оплата коммунальных услуг (КОСГУ 223)],
            [Measures].[Нараст.итог на отчетную дату]  
        ) / 1000'       

    member [Measures].[Мера для лукапа]
    as 'IIF
        (
            "<%selected_measure%>" = "Исполнено за период",
            "Факт",
            "Годовые назначения"
        )'

    member [Measures].[Социальное обеспечение (КОСГУ 260)] 
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее],
            AVG
            (
                [Список МО],
                [Measures].[Социальное обеспечение (КОСГУ 260)]
            ),
            IIF 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
                LookupCube 
                (
                    "[ФО_МесОтч_Расходы]",
                    "  
                    (
                        [Measures].[" + [Measures].[Мера для лукапа] + "],
                        [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение],
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта],
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
                        " + MemberToStr
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                        ) + ",
                        " + MemberToStr 
                        (
                            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                        ) + " 
                    )"
                ) / 1000,
                LookupCube
                (
                    "[ФО_МесОтч_Расходы]",
                    "
                    (
                        [Measures].[" + [Measures].[Мера для лукапа] + "],
                        [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение],
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта],
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                        " + MemberToStr
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                        ) + "
                    )"
                ) / 1000
            )   
        )'  

    member [Measures].[Стипендии (КОСГУ 290)]      
    as '      
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[5. Стипендии (КОСГУ 290)],
            [Measures].[Нараст.итог на отчетную дату]   
        ) / 1000'       
    member [Measures].[Продукты питания, медикаменты]      
    as 'Sum      
        (
            {
                [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[6. Увеличение стоимости нематериальных запасов (КОСГУ 340), в том числе:].[продукты питания (КОСГУ 340)],
                [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел I. Социально-значимые расходы].[6. Увеличение стоимости нематериальных запасов (КОСГУ 340), в том числе:].[медикаменты (КОСГУ 340)]       
            },
            [Measures].[Нараст.итог на отчетную дату]  
        ) / 1000'         
    member [Measures].[Социально-значимые расходы]    
    as '    
        (
            [Measures].[Оплата труда и начисления на выплаты по оплате труда за исключением аппарата (КОСГУ 211, 213)]     
        ) +     
        (
            [Measures].[Содержание органов местного самоуправления (расходы на оплату труда и начисления на выплаты по оплате труда (КОСГУ 211, 213))]     
        ) +     
        (
            [Measures].[Оплата коммунальных услуг (КОСГУ 223)]     
        )+     
        (
            [Measures].[Социальное обеспечение (КОСГУ 260)]    
        ) +     
        (
            [Measures].[Стипендии (КОСГУ 290)]    
        )+     
        (
            [Measures].[Продукты питания, медикаменты]    
        )'         
    member [Measures].[Прочие выплаты (КОСГУ 212)]    
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[1.Прочие выплаты (КОСГУ 212)],
            [Measures].[Нараст.итог на отчетную дату]  
        ) / 1000'    
    member [Measures].[Расходы на обслуживание долга (КОСГУ 230)]    
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[2. Расходы на обслуживание долга (КОСГУ 230)],
            [Measures].[Нараст.итог на отчетную дату]    
        ) / 1000'    
    member [Measures].[Материальные затраты (КОСГУ 221, КОСГУ 222, КОСГУ 224)]    
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ].[Раздел II. Первоочередные расходы].[3. Материальные затраты, в том числе:],
            [Measures].[Нараст.итог на отчетную дату] 
        ) / 1000'    
    member [Measures].[Первоочередные расходы]    
    as '    
        (
            [Measures].[Прочие выплаты (КОСГУ 212)]    
        ) +    
        (
            [Measures].[Расходы на обслуживание долга (КОСГУ 230)]    
        ) +    
        (
            [Measures].[Материальные затраты (КОСГУ 221, КОСГУ 222, КОСГУ 224)]    
        )'     
    member [Measures].[Расходы]       
    as '       
        (
            [Measures].[Итого социально-значимых расходов]    
        ) +       
        (
            [Measures].[Итого первоочередных расходов]    
        ) '       
    member [Measures].[Расходы всего]       
    as '    
        (
            [Показатели__ФинпаспортМОСопост].[Показатели__ФинпаспортМОСопост].[Все].[Расходы].[ИТОГО РАСХОДОВ],
            [Measures].[Нараст.итог на отчетную дату] 
        ) / 1000' 
        
 
    member [Measures].[Доля социально-значимых расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
           [Measures].[Социально-значимые расходы] / [Measures].[Расходы всего]  
        )'    

    member [Measures].[Доля первоочередных расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
           [Measures].[Первоочередные расходы]  / [Measures].[Расходы всего]  
        )'     
    
    member [Measures].[Доля расходов]    
    as 'IIF    
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
           ([Measures].[Социально-значимые расходы] + [Measures].[Первоочередные расходы]) / [Measures].[Расходы всего]  
        )' 

    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее]
    as 'AVG
        (
            [Список МО],
            (
               [Measures].CurrentMember,
               [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ],
               [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ]
            )   
        )'
        
    member [Measures].[Число пустых МО]
    as 'Count
        (
            Filter 
            (
                [Список МО],
                IsEmpty 
                (
                    [Measures].[Оплата труда и начисления на выплаты по оплате труда за исключением аппарата (КОСГУ 211, 213)] 
                ) 
            )
        )'         
select
    {
        [Measures].[Доля расходов],
        [Measures].[Доля социально-значимых расходов],
        [Measures].[Доля первоочередных расходов]
    } on columns,
    Filter
    (
        Order
        (
            [Список МО],
            [Measures].[Доля расходов],
            BDESC
        ),
        not
        ( 
            IsEmpty([Measures].[Доля расходов]) and IsEmpty([Measures].[Доля социально-значимых расходов]) and IsEmpty([Measures].[Доля первоочередных расходов]) 
        ) and
        (
           [Measures].[Число пустых МО] = 0
        )  
    ) on rows
from [ФО_Финпаспорт МО]       
where        
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ],
        [Состояние__Формы сбора по паспорту МО].[Состояние__Формы сбора по паспорту МО].[Все состояния].[Утвержден] 
    )         
  ]]>
  </query>

  <query id="FO_0002_0054_02_rzprDigest">
    <![CDATA[
-- FO_0002_0054_02_rzprDigest
with   
    member [Measures].[Имя]  
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name'  
    member [Measures].[Уникальное имя]  
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.UniqueName'   
    member [Measures].[Уровень]  
    as 'IIF 
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Level is [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Раздел],
            0,
            1 
        )'  
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]  
    } on columns,
    Filter   
    (
        [РзПр__Сопоставимый].[РзПр__Сопоставимый].AllMembers -  
        {
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР]  
        },
        not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember is [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Parent.DataMember   
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name = "Несопоставленные данные"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name = "Всего"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name = "Всего расходов"  
        ) and not  
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9600"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9700"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9701"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9702"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9703"  
        ) and not
        IsEmpty([Measures].[Факт])
    ) on rows   
from  [ФО_МесОтч_Расходы]   
where 
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>]
    ) 
]]>
  </query>
</root>