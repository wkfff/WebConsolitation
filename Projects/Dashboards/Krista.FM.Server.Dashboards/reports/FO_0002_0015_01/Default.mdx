<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0002_0015_01_date">
    <![CDATA[
-- FO_0002_0015_01_date
-- <#[ФО_АС Бюджет_КазнИсп_Факт расхода]#>
with
    member Measures.[ДанныеНа]
    as '<%period_dimension%>.CurrentMember.UniqueName'
select
    {Measures.[ДанныеНа]} on columns,
    Tail
    (
        NonEmptyCrossjoin
        (
            OpeningPeriod
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2008]
            ) : ClosingPeriod
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2012]
            )
        )
    ) on rows
from [ФО_АС Бюджет_КазнИсп_Факт расхода]
  ]]>
</query>

  <query id="FO_0002_0015_01_grid_fact">
    <![CDATA[
-- FO_0002_0015_01_grid_fact
-- <#[ФО_АС Бюджет_КазнИсп_Факт расхода]#>
with              
    set [Мероприятия]            
    as 'Filter            
        (
            Descendants            
            (
                [Мероприятия].[Сопоставимый].[Все мероприятия],
                [Мероприятия].[Сопоставимый].[Мероприятия уровень 3],
                SELF           
            ),
            not     
            (
                [Мероприятия].[Сопоставимый].CurrentMember is [Мероприятия].[Сопоставимый].CurrentMember.Parent.DataMember    
            ) and [Мероприятия].[Сопоставимый].CurrentMember.Properties("Мероприятия__Сопоставимый") = "Бюджеты муниципальных образований Оренбургской области"     
        )'     
    set [Расходы]     
    as 'Filter     
        (
            Descendants     
            (
                <%selected_mbt%>,
                [Расходы].[Сопоставимый].[Расходы уровень 6],
                SELF     
            ) ,
            not     
            (
                [Расходы].[Сопоставимый].CurrentMember is [Расходы].[Сопоставимый].CurrentMember.Parent.DataMember    
            )     
        )'     
    Member <%fkr_dimension%>.[Фильтр по ФКР]         
    as 'Aggregate         
        (
            {
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Иные межбюджетные трансферты]         
            }         
        )'         
    Member <%ekr_dimension%>.[Фильтр по ЭКР]         
    as 'Aggregate          
        (
            {
                <%ekr_dimension%>.[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам].[Перечисления другим бюджетам бюджетной системы Российской Федерации]                     
            }          
        )'      
    Member [Measures].[Администратор]      
    as '[Расходы].[Сопоставимый].CurrentMember.Properties("Администратор")'      
    Member [Measures].[РзПр]      
    as '[Расходы].[Сопоставимый].CurrentMember.Properties("ФКР")'      
    Member [Measures].[Целевая статья]      
    as '[Расходы].[Сопоставимый].CurrentMember.Properties("КЦСР")'      
    Member [Measures].[Вид расхода]      
    as '[Расходы].[Сопоставимый].CurrentMember.Properties("КВР")'      
    Member [Measures].[КОСГУ]      
    as '<%ekr_dimension%>.CurrentMember.Properties("Код")'   
    Member [Measures].[КБК]    
    as '[Расходы].[Сопоставимый].CurrentMember.Properties("Код") + ";"'    
    
    Member [Measures].[Кассовый расход, тыс.руб.] 
    as '[Measures].[Расход с возвратом нараст итог] / 1000' 
    
    Member [Measures].[Ассигнования, тыс.руб.] 
    as '0' 
    
    Member [Measures].[Остаток ассигнований, тыс.руб.] 
    as '[Measures].[Ассигнования, тыс.руб.] - [Measures].[Кассовый расход, тыс.руб.]' 
    
    member [Мероприятия].[Сопоставимый].[Итого по администратору]
    as 'Sum([Мероприятия],[Measures].[Кассовый расход, тыс.руб.]) * 1000'    
SELECT
    {
        [Measures].[КБК],
        [Measures].[Ассигнования, тыс.руб.],
        [Measures].[Кассовый расход, тыс.руб.],
        [Measures].[Остаток ассигнований, тыс.руб.] 
    } on columns,
    Filter
    (
       {
        {
            {
                <%selected_mbt%>.Parent.Parent 
            }  
            *  
            {
                [Мероприятия].[Сопоставимый].[Итого по администратору]
            }  
        } + 
        {
            [Расходы]                    
            * VisualTotals      
            (
                {
                    [Мероприятия].[Сопоставимый].[Все мероприятия].[БЮДЖЕТ СУБЪЕКТА РФ].[Бюджеты муниципальных образований Оренбургской области]       
                } + [Мероприятия],
                "* Итого"     
            )    
        }
       },
        not 
        (
           IsEmpty([Measures].[Кассовый расход, тыс.руб.])
        )
    ) on rows   
FROM [ФО_АС Бюджет_КазнИсп_Факт расхода] 
WHERE             
    (
        <%fkr_dimension%>.[Фильтр по ФКР],
        <%ekr_dimension%>.[Фильтр по ЭКР],
        <%period_dimension%>.[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
    ) 
  ]]>
  </query>

  <query id="FO_0002_0015_01_grid_plan">
    <![CDATA[
-- FO_0002_0015_01_grid_plan
-- <#[ФО_АС Бюджет_План расходов]#>
with              
    set [Мероприятия]            
    as 'Filter            
        (
            Descendants            
            (
                [Мероприятия].[Сопоставимый].[Все мероприятия],
                [Мероприятия].[Сопоставимый].[Мероприятия уровень 3],
                SELF           
            ),
            not     
            (
                [Мероприятия].[Сопоставимый].CurrentMember is [Мероприятия].[Сопоставимый].CurrentMember.Parent.DataMember    
            ) and [Мероприятия].[Сопоставимый].CurrentMember.Properties("Мероприятия__Сопоставимый") = "Бюджеты муниципальных образований Оренбургской области"     
        )'     
    set [Расходы]     
    as 'Filter     
        (
            Descendants     
            (
                <%selected_mbt%>,
                [Расходы].[Сопоставимый].[Расходы уровень 6],
                SELF     
            ) ,
            not     
            (
                [Расходы].[Сопоставимый].CurrentMember is [Расходы].[Сопоставимый].CurrentMember.Parent.DataMember    
            )     
        )'     
    Member <%fkr_dimension%>.[Фильтр по ФКР]         
    as 'Aggregate         
        (
            {
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                <%fkr_dimension%>.[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ].[Иные межбюджетные трансферты]         
            }         
        )'         
    Member <%ekr_dimension%>.[Фильтр по ЭКР]         
    as 'Aggregate          
        (
            {
                <%ekr_dimension%>.[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам].[Перечисления другим бюджетам бюджетной системы Российской Федерации]                     
            }          
        )'      

    Member [Measures].[Ассигнования, тыс.руб.] 
    as '[Measures].[Ассигнования] / 1000' 

    member [Мероприятия].[Сопоставимый].[Итого по администратору]
    as 'Sum([Мероприятия],[Measures].[Ассигнования, тыс.руб.]) * 1000'    
SELECT
    {
        [Measures].[Ассигнования, тыс.руб.]
    } on columns,
    
        {
        {
            {
                <%selected_mbt%>.Parent.Parent 
            }  
            *  
            {
                [Мероприятия].[Сопоставимый].[Итого по администратору]
            }  
        } + 
        {
            [Расходы]                    
            * VisualTotals      
            (
                {
                    [Мероприятия].[Сопоставимый].[Все мероприятия].[БЮДЖЕТ СУБЪЕКТА РФ].[Бюджеты муниципальных образований Оренбургской области]       
                } + [Мероприятия],
                "* Итого"     
            )    
        }
        } on rows   
FROM [ФО_АС Бюджет_План расходов]
WHERE             
    (
        <%fkr_dimension%>.[Фильтр по ФКР],
        <%ekr_dimension%>.[Фильтр по ЭКР],
        <%period_dimension%>.[Данные всех периодов].[<%period_year%>].[Данные года],
        [Период].[Дата принятия].[Данные всех периодов].[<%period_year%>]
    ) 
  ]]>
  </query>


</root>