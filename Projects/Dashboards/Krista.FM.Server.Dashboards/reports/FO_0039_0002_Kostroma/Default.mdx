<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0039_0002_Kostroma_date">
    <![CDATA[
-- FO_0039_0002_Kostroma_date
with    
    member [Measures].[ДанныеНа]    
    as '[Период].[Период].CurrentMember.UniqueName'    
    set [NonEmptySet]    
    as 'Tail    
        (
            Filter    
            (
                Descendants   
                (
                    [Период].[Период].[Данные всех периодов],
                    [Период].[Период].[Квартал],
                    SELF   
                ),
                not IsEmpty    
                (
                    (
                        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р2]    
                    )    
                ) and   
                (
                    [Период].[Период].CurrentMember.Name <> "Остатки на начало года"  
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные квартала" 
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные полугодия" 
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Данные месяца"
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
                ) 
            ),
            1    
        )'    
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows    
from [ФО_Оценка качества ОиОБП_Показатели]  
]]>
  </query>

  <query id="FO_0039_0002_Kostroma_grid">
    <![CDATA[
-- FO_0039_0002_Kostroma_grid
with             
    set [Список показателей]      
    as '       
        {
            Filter
            (
                Descendants   
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Показатели],
                    SELF   
                ) -  
                {
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Несопоставленные данные],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Ранг],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Средняя оценка по МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Степень качества]  
                },
                IIF
                (
                   [Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Квартал],
                   [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Периодичность расчета показателя") <> "Ежегодно",
                   true
                )
            )
        }'         
    set [Список МО]             
    as 'Filter             
        (
            Descendants             
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF             
            ),
            not             
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember             
            ) and             
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"             
            )             
        )'             
      
 
    member [Период].[Период].[Отклонение]    
    as 'IIF  
        (
           IsEmpty([Период].[Период].[Данные всех периодов].<%selected_period%>) or
           IsEmpty([Период].[Период].[Данные всех периодов].<%selected_prev_period%>),
           null,
           [Период].[Период].[Данные всех периодов].<%selected_period%> - [Период].[Период].[Данные всех периодов].<%selected_prev_period%> 
        )'  
    set [Периоды]    
    as '{ [Период].[Период].[Данные всех периодов].<%selected_prev_period%>, [Период].[Период].[Данные всех периодов].<%selected_period%> }'  
  
select
    {
        Filter             
        (
            {
                {
                    [Список показателей] +
                    Filter             
                    (
                        {
                            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка],
                            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Ранг],
                            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Степень качества]            
                        },
                        [Measures].[<%selected_maasure%>] is [Measures].[Оценка показателя]             
                    )
                }             
                *             
                {
                    [Периоды] +    
                    {
                        [Период].[Период].[Отклонение]    
                    }    
                }             
            },
            true          
        )             
    } on columns,
    {
        Order             
        (
            [Список МО],
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка],
                [Период].[Период].[Данные всех периодов].<%selected_period%>     
            ),
            BDESC             
        )             
    } on rows             
from  [ФО_Оценка качества ОиОБП_Показатели]             
where             
    (
        [Measures].[<%selected_maasure%>] 
    )              
  ]]>
</query>

<query id="FO_0039_0002_Kostroma_indicatorDescription">
<![CDATA[
-- FO_0039_0002_Kostroma_indicatorDescription
With
    set [Список показателей]      
    as '       
        {
            Filter
            (
                Descendants   
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Показатели],
                    SELF   
                ) -  
                {
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Несопоставленные данные],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Ранг],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Средняя оценка по МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Степень качества]  
                },
                IIF
                (
                   [Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Квартал],
                   [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Периодичность расчета показателя") <> "Ежегодно",
                   true
                )
            )
        }'   

    member [Measures].[Наименование]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Наименование")'
    member [Measures].[Единицы измерения]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Единицы измерения")'
    member [Measures].[Направление]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Направление оценки качества ОиОБП")'
Select
    {
       [Measures].[Наименование],
       [Measures].[Направление],
       [Measures].[Единицы измерения]
    } on columns,
    { [Список показателей] }  on rows
From [ФО_Оценка качества ОиОБП_Показатели]
  ]]>
</query>

</root>