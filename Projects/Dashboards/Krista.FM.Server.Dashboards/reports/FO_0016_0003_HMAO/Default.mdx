<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0016_0003_HMAO_date">
    <![CDATA[
-- FO_0016_0003_HMAO_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF
                ),
                not IsEmpty
                (
                    (
                           [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
                    )
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_БККУ_Показатели]
]]>
  </query>

  <query id="FO_0016_0003_HMAO_chart">
    <![CDATA[
-- FO_0016_0003_HMAO_chart
with
    set [Список районов]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            ) or
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
        ) '
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[UniqName]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [Периоды]
    as 'Filter
        (
            Generate
            (
                {
                   <%period_set%>
                },
                {
                  [Период__Период].[Период__Период].CurrentMember
                } + Descendants
                (
                    [Период__Период].[Период__Период].CurrentMember,
                    [Период__Период].[Период__Период].[Квартал],
                    SELF
                )
            ),
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
            )  and not IsEmpty
            (
               [Measures].[Значение]
            )  and
            (
               [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Квартал]
            )
        )'
select
    { {[Районы__Сопоставимый].[Районы__Сопоставимый].[UniqName]} + [Список районов] } on columns,
    { [Периоды] } on rows
from  [ФО_БККУ_Показатели]
where
    (
        <%selected_indicator%>,
        [Measures].[Значение]
    )
  ]]>
</query>

  <query id="FO_0016_0003_HMAO_indicatorList">
    <![CDATA[
-- FO_0016_0003_HMAO_indicatorList
with
    set [Список показателей]
    as '
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]
        }'
    member [Measures].[Имя] 
    as 'IIF 
        (
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 5",
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name + " (периодичность расчета показателя - по итогам 9 месяцев и за год)",
            IIF 
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6",
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name + " (периодичность расчета показателя - по итогам 1 квартала)",
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name + " (периодичность расчета показателя - ежеквартально)" 
            ) 
        ) ' 
    member [Measures].[Уникальное имя]
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.UniqueName'
    member [Measures].[Уровень]
    as '0'
    member [Measures].[Краткое имя] 
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name' 
    member [Measures].[Тип]
    as 'IIF
        (
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 5",
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Наименование") + " (периодичность расчета показателя - по итогам 9 месяцев и за год)",
            IIF
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6",
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Наименование") + " (периодичность расчета показателя - по итогам 1 квартала)",
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Наименование") + " (периодичность расчета показателя - ежеквартально)"
            )
        )'
    set [Список районов]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            ) or
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
        ) '
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Аггрегироавнные районы]
    as 'Aggregate({[Список районов]})'
    member [Период__Период].[Период__Период].[Аггрегированные периоды]
    as 'Aggregate
        (
            {
              <%period_set%>
            }
        )'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень],
        [Measures].[Краткое имя],
        [Measures].[Тип]
    } on columns,
    {
       [Список показателей]
    } on rows
from [ФО_БККУ_Показатели]
  ]]>
  </query>

  <query id="FO_0016_0003_HMAO_nonEmptyPeriodList">
    <![CDATA[
-- FO_0016_0003_HMAO_nonEmptyPeriodList
with 
    set [Непустые периоды] 
    as 'Generate 
        (
            Filter 
            (
                Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF 
                ),
                not IsEmpty 
                (
                    (
                        [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников] 
                    ) 
                ) and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" 
                ) and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" 
                ) and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" 
                ) and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца" 
                ) and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" 
                ) and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты" 
                ) and
                (
                     StrToValue([Период__Период].[Период__Период].CurrentMember.Parent.Parent.Name) >= 2011
                )
            ),
            {
                [Период__Период].[Период__Период].CurrentMember.Parent.Parent 
            } + 
            {
                [Период__Период].[Период__Период].CurrentMember 
            } 
        ) ' 
    member [Measures].[Имя] 
    as ' IIF 
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Квартал],
            [Период__Период].[Период__Период].CurrentMember.Name,
            [Период__Период].[Период__Период].CurrentMember.Name + " год" 
        ) ' 
    member [Measures].[Уникальное имя] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName' 
    member [Measures].[Уровень] 
    as 'IIF 
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Квартал],
            1,
            0 
        )' 
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень] 
    } on columns,
    { [Непустые периоды] } on rows 
from [ФО_БККУ_Показатели] 
  ]]>
  </query>
  
</root>