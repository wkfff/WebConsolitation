<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="ORG_0003_0010_list_of_dates">
    <![CDATA[ -- name: ORG_0003_0010_list_of_dates
with
    set [Товары и услуги]
    as 'Except
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].Children
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].[Прочие жилищные услуги]
            }
        )+ Except
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].Children
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Фактический уровень платежей граждан],
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Прочие коммунальные услуги]
            }
        )'
select
    {[Товары и услуги]} on columns,
    non empty {
        filter
        (
            [Период].[День].[День].members,
            [Measures].[Средняя цена] > 0
        )
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена],
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область]
    )
    ]]>
  </query>

  <query id ="ORG_0003_0010_list_of_regions">
    <![CDATA[ -- name:ORG_0003_0010_list_of_regions
with
    set [Товары и услуги]
    as 'Except
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].Children
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].[Прочие жилищные услуги]
            }
        )+ Except
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].Children
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Прочие коммунальные услуги]
            }
        )+ 
        {
            [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Фактический уровень платежей граждан] 
        }'
select
    {[Товары и услуги]} on columns,
    non empty {
        filter
        (
            [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область].Children,
            [Measures].[Средняя цена] > 0 or [Measures].[Значение] > 0
        )
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано]
    )
    ]]>
  </query>

  <query id = "ORG_0003_0010_grid_dates">
    <![CDATA[ -- ORG_0003_0010_grid_dates
with   
    set [Жилищные услуги]   
    as 'Except   
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].Children   
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].[Прочие жилищные услуги]   
            }   
        )+ Except
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].Children
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Фактический уровень платежей граждан],
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Прочие коммунальные услуги]
            }
        )'
    set [Даты для грида]
    as 'Tail
        (
            Filter
                  (
                        {
                            <%first_date%> : <%selected_date%>
                        },
                        (
                          [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги],
                          [Measures].[Средняя цена]) > 0 or
                        (
                          [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги],
                          [Measures].[Средняя цена]) > 0
                   ), 12
            )
    '
    member [Measures].[День]
    as '[Период].[День].CurrentMember.UniqueName'
select
    {
        {[Measures].[День]}  
        *  { [Даты для грида] }  
    } on columns,
    non empty     
    {
        Filter     
        (
            { [Жилищные услуги] },
            [Measures].[Средняя цена] > 0     
        )     
    } on rows     
  
from [ОРГАНИЗАЦИИ_Цены и тарифы]   
where   
    (
        <%selected_region%>,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] 
    )    ]]>
</query>
  
  <query id = "ORG_0003_0010_grid">
    <![CDATA[ -- ORG_0003_0010_grid
with   
    set [Жилищные услуги]   
    as 'Except   
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].Children   
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги].[Прочие жилищные услуги]   
            }   
        )+ Except
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].Children
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].DataMember,
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Фактический уровень платежей граждан],
                [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Прочие коммунальные услуги]
            }
        )'
    member [Measures].[Единица измерения]
    as '[Организации].[Товары и услуги].CurrentMember.Properties("Единица измерения")'
    member [Measures].[Имя]
    as '[Организации].[Товары и услуги].CurrentMember.UniqueName'
    set [Даты для грида]
    as 'Tail
        (
            Filter
                  (
                        {
                            <%first_date%> : <%selected_date%>
                        },
                        (
                          [Организации].[Товары и услуги].[Все товары и услуги].[Жилищные услуги],
                          [Measures].[Средняя цена]) > 0 or
                        (
                          [Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги],
                          [Measures].[Средняя цена]) > 0
                   ), 12
            )
    '
select
    {
        {
            {[Measures].[Средняя цена]}
            * 
            { [Даты для грида] }
        } +
        {
            {[Measures].[Имя]} 
            * 
            {
                [Период].[День].[Данные всех периодов]
            }
        } + 
        {
            {[Measures].[Единица измерения]}
            *
            {
                [Период].[День].[Данные всех периодов]
            }
        }
    } on columns,
    non empty   
    {
        Filter   
        (
            { [Жилищные услуги] },
            [Measures].[Средняя цена] > 0   
        )   
    } on rows   
from [ОРГАНИЗАЦИИ_Цены и тарифы]   
where   
    (
        <%selected_region%>,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] 
    )
    ]]>
  </query>

  <query id = "ORG_0003_0010_chart_by_time">
    <![CDATA[ -- ORG_0003_0010_chart_by_time
select
    Tail 
    (
        Filter 
        (
            {
                <%first_date%>: <%selected_date%>
            },
            [Measures].[Средняя цена] > 0 
        ),
        12 
    ) on columns,
    {[Measures].[Средняя цена]} on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы] 
where 
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена],
        <%selected_region%>,
        <%selected_parameter%>
    ) 
    ]]>
  </query>

  <query id = "ORG_0003_0010_chart_by_time_names">
    <![CDATA[ -- ORG_0003_0010_chart_by_time_names
with
member [Measures].[День]
as '[Период].[День].CurrentMember.UniqueName'
select
    Tail 
    (
        Filter 
        (
            {
                <%first_date%>: <%selected_date%>
            },
            [Measures].[Средняя цена] > 0 
        ),
        12 
    ) on columns,
    {[Measures].[День]} on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы] 
where 
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена],
        <%selected_region%>,
        <%selected_parameter%>
    ) 
    ]]>
  </query>

  <query id = "ORG_0003_0010_chart2">
    <![CDATA[ -- ORG_0003_0010_chart2
with
member [Measures].[Процент оплаты]
as '[Measures].[Значение]'
member [Measures].[Процент задолженности]
as '100 - [Measures].[Процент оплаты]'
select
    {[Measures].[Процент оплаты], [Measures].[Процент задолженности]} on columns,
    {
        filter
        (
            {except
            (
                {[Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Фактический уровень платежей граждан].Children},
                {[Организации].[Товары и услуги].[Все товары и услуги].[Коммунальные услуги].[Фактический уровень платежей граждан].DataMember}
            )}, [Measures].[Значение] > 0
        )
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Значение не указано],
        <%selected_date%>,
        <%selected_region%>
    )
    ]]>
  </query>

</root>