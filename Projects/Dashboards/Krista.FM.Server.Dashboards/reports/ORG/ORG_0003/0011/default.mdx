<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="ORG_0003_0011_list_of_dates">
    <![CDATA[ -- name: ORG_0003_0011_list_of_dates
select
    {[Measures].[Средняя цена]} on columns,
    {
        filter 
        (
            [Период].[День].[День].members,
            not IsEmpty 
            (
                [Организации].[Товары и услуги].[Все товары и услуги].[Медицинские услуги и медикаменты].[Медикаменты]  
            ) and [Measures].[Средняя цена] > 0 
        ) 
    } on rows 
from [ОРГАНИЗАЦИИ_Цены и тарифы] 
where 
    (
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].DataMember,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] 
    ) 
    ]]>
  </query>

  <query id = "ORG_0003_0011_grid">
    <![CDATA[ -- ORG_0003_0011_grid
with 
    set [Дни текущего месяца] 
    as '<%selected_month%>.Children' 
    set [Дни предыдущего месяца] 
    as '<%selected_month%>.Lag(1).Children' 
    set [Дни предпредыдущего месяца] 
    as '<%selected_month%>.Lag(2).Children' 
    set [Дни предпредпредыдущего месяца] 
    as '<%selected_month%>.Lag(3).Children' 
    member [Период].[День].[Последний день текущего месяца с данными] 
    as 'Tail 
        (
            Filter 
            (
                { [Дни текущего месяца] },
                [Measures].[Средняя цена] > 0 
            ),
            1 
        ).Item(0)'   
    member [Период].[День].[Последний день предыдущего месяца с данными]  
    as 'Tail  
        (
            Filter  
            (
                { [Дни предыдущего месяца] },
                [Measures].[Средняя цена] > 0  
            ),
            1  
        ).Item(0)'  
    member [Период].[День].[Последний день предпредыдущего месяца с данными]  
    as 'Tail  
        (
            Filter  
            (
                { [Дни предпредыдущего месяца] },
                [Measures].[Средняя цена] > 0  
            ),
            1  
        ).Item(0)'  
    member [Период].[День].[Последний день предпредпредыдущего месяца с данными]  
    as 'Tail  
        (
            Filter 
            (
                {
                    [Дни предпредпредыдущего месяца] 
                },
                [Measures].[Средняя цена] > 0 
            ),
            1 
        ).Item(0)' 
    member [Measures].[Цена в последний день текущего месяца] 
    as ' 
        (
            [Measures].[Средняя цена],
            [Период].[День].[Последний день текущего месяца с данными] 
        )' 
    member [Measures].[Цена в последний день предыдущего месяца] 
    as ' 
        (
            [Measures].[Средняя цена],
            [Период].[День].[Последний день предыдущего месяца с данными] 
        )' 
    member [Measures].[Цена в последний день предпредыдущего месяца] 
    as ' 
        (
            [Measures].[Средняя цена],
            [Период].[День].[Последний день предпредыдущего месяца с данными] 
        )' 
    member [Measures].[Цена в последний день предпредпредыдущего месяца] 
    as ' 
        (
            [Measures].[Средняя цена],
            [Период].[День].[Последний день предпредпредыдущего месяца с данными] 
        )' 
    member [Measures].[Абсолютное отклонение, предпредыдущий месяц] 
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена в последний день предпредпредыдущего месяца]
            ) or IsEmpty
            (
                [Measures].[Цена в последний день предпредыдущего месяца]
            ),
            null,
            [Measures].[Цена в последний день предпредыдущего месяца] - [Measures].[Цена в последний день предпредпредыдущего месяца] 
        )' 
    member [Measures].[Темп прироста %, предпредыдущий месяц]
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена в последний день предпредпредыдущего месяца]
            ) or IsEmpty
            (
                [Measures].[Цена в последний день предпредыдущего месяца]
            ),
            null,
            ([Measures].[Цена в последний день предпредыдущего месяца]/[Measures].[Цена в последний день предпредпредыдущего месяца] - 1)
        )'
    member [Measures].[Абсолютное отклонение, предыдущий месяц]
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена в последний день предпредыдущего месяца]
            ) or IsEmpty
            (
                [Measures].[Цена в последний день предыдущего месяца]
            ),
            null,
            [Measures].[Цена в последний день предыдущего месяца] - [Measures].[Цена в последний день предпредыдущего месяца]
        )'
    member [Measures].[Темп прироста %, предыдущий месяц]
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена в последний день предпредыдущего месяца]
            ) or IsEmpty
            (
                [Measures].[Цена в последний день предыдущего месяца]
            ),
            null,
            ([Measures].[Цена в последний день предыдущего месяца]/[Measures].[Цена в последний день предпредыдущего месяца] - 1)
        )'
    member [Measures].[Абсолютное отклонение, текущий месяц]
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена в последний день предыдущего месяца]
            ) or IsEmpty
            (
                [Measures].[Цена в последний день текущего месяца]
            ),
            null,
            [Measures].[Цена в последний день текущего месяца] - [Measures].[Цена в последний день предыдущего месяца]
        )'
    member [Measures].[Темп прироста %, текущий месяц]
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена в последний день предыдущего месяца]
            ) or IsEmpty
            (
                [Measures].[Цена в последний день текущего месяца]
            ),
            null,
            ([Measures].[Цена в последний день текущего месяца]/[Measures].[Цена в последний день предыдущего месяца] - 1)
        )'
    set [Медикаменты]
    as 'except 
        (
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Медицинские услуги и медикаменты].[Медикаменты].Children 
            },
            {
                [Организации].[Товары и услуги].[Все товары и услуги].[Медицинские услуги и медикаменты].[Медикаменты].DataMember 
            } 
        )' 
select
    {
        [Measures].[Цена в последний день предпредыдущего месяца],
        [Measures].[Абсолютное отклонение, предпредыдущий месяц],
        [Measures].[Темп прироста %, предпредыдущий месяц],
        [Measures].[Цена в последний день предыдущего месяца],
        [Measures].[Абсолютное отклонение, предыдущий месяц],
        [Measures].[Темп прироста %, предыдущий месяц],
        [Measures].[Цена в последний день текущего месяца],
        [Measures].[Абсолютное отклонение, текущий месяц],
        [Measures].[Темп прироста %, текущий месяц]
    } on columns,
    {[Медикаменты] } on rows 
from [ОРГАНИЗАЦИИ_Цены и тарифы] 
where 
    (
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].DataMember,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] 
    )
    ]]>
  </query>

  <query id = "ORG_0003_0011_grid_dates">
    <![CDATA[ -- ORG_0003_0011_grid_dates
with 
    set [Дни текущего месяца] 
    as '<%selected_month%>.Children' 
    set [Дни предыдущего месяца] 
    as '<%selected_month%>.Lag(1).Children' 
    set [Дни предпредыдущего месяца] 
    as '<%selected_month%>.Lag(2).Children' 
    set [Дни предпредпредыдущего месяца] 
    as '<%selected_month%>.Lag(3).Children' 
    member [Период].[День].[Последний день текущего месяца с данными] 
    as 'Tail 
        (
            Filter 
            (
                { [Дни текущего месяца] },
                [Measures].[Средняя цена] > 0 
            ),
            1 
        ).Item(0).UniqueName'
    member [Период].[День].[Последний день предыдущего месяца с данными]  
    as 'Tail  
        (
            Filter  
            (
                { [Дни предыдущего месяца] },
                [Measures].[Средняя цена] > 0  
            ),
            1  
        ).Item(0).UniqueName'
    member [Период].[День].[Последний день предпредыдущего месяца с данными]  
    as 'Tail  
        (
            Filter  
            (
                { [Дни предпредыдущего месяца] },
                [Measures].[Средняя цена] > 0  
            ),
            1  
        ).Item(0).UniqueName'
    member [Период].[День].[Последний день предпредпредыдущего месяца с данными]  
    as 'Tail  
        (
            Filter  
            (
                { [Дни предпредпредыдущего месяца] },
                [Measures].[Средняя цена] > 0  
            ),
            1  
        ).Item(0).UniqueName'
select
    {
        [Период].[День].[Последний день предпредпредыдущего месяца с данными],
        [Период].[День].[Последний день предпредыдущего месяца с данными],
        [Период].[День].[Последний день предыдущего месяца с данными],
        [Период].[День].[Последний день текущего месяца с данными]
    } on columns,
    {[Организации].[Товары и услуги].[Все товары и услуги].[Медицинские услуги и медикаменты].[Медикаменты] } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы] 
where 
    (
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].DataMember,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] 
    )
  ]]>
  </query>

  <query id = "ORG_0003_0011_chart_by_time">
    <![CDATA[ -- ORG_0003_0011_chart_by_time
select
    Tail 
    (
        Filter 
        (
            {
                <%first_date%>: <%selected_date%>
            },
            [Measures].[Средняя цена] > 0 
        ),
        12 
    ) on columns,
    {[Measures].[Средняя цена]} on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы] 
where     
    (
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].DataMember,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        <%selected_parameter%>,
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] 
    )
    ]]>
  </query>

  <query id = "ORG_0003_0011_chart_by_time_names">
    <![CDATA[ -- ORG_0003_0011_chart_by_time_names
with
member [Measures].[День]
as '[Период].[День].CurrentMember.UniqueName'
select
    Tail 
    (
        Filter 
        (
            {
                <%first_date%>: <%selected_date%>
            },
            [Measures].[Средняя цена] > 0 
        ),
        12 
    ) on columns,
    {[Measures].[День]} on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы] 
where     
    (
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].DataMember,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        <%selected_parameter%>,
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] 
    )
    ]]>
  </query>

  <query id = "ORG_0003_0011_chart_by_district">
    <![CDATA[ -- ORG_003_0011_chart_by_district
select
    {[Measures].[Значение]} on columns,
    non empty order(
    {
        filter
        (
            [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область].Children,
            [Measures].[Значение] > 0
        )
    }, [Measures].[Значение], asc) on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - МО Вологодской области],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Товары и услуги].[Все товары и услуги].[Медицинские услуги и медикаменты].[Медикаменты].DataMember,
        [Организации].[Тип цены].[Все типы цен].[Торговая надбавка (%)],
        <%selected_month%>.[15]
    )
    ]]>
  </query>

</root>