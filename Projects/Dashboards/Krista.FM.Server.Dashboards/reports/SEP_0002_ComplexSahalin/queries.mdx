<?xml version="1.0" encoding="Windows-1251"?>
<root>


  <query id="years">
    <![CDATA[
    --SEP_0002_ComplexSahalin years
with 
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Год] 
    as '[Период__Период].[Период__Период].currentmember.parent.parent.name' 
select
    non empty 
    {
        filter 
        (
            [Период__Период].[Период__Период].[Квартал].members,
            not isempty
            (
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Социальная сфера]
            ) and [Период__Период].[Период__Период].currentmember.name<>"Квартал 4" and [Период__Период].[Период__Период].currentmember.parent.parent.name<>"2008"
        ) 
    }on rows, 
    NON EMPTY   
    {
        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Социальная сфера],
        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Год] 
    } on columns 
from     [ЭО_СЭР_Комплексная оценка] 
where  
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.],
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР],
        [Measures].[Значение] 
    )  

]]>
  </query>

  <query id="pok">
    <![CDATA[
    --SEP_0002_ComplexSahalin pok
with
    member [Measures].[Код]
    as '[Показатели__Комплексная оценка].currentmember.properties("Код")'
    member [Measures].[Уровень]
    as '[Показатели__Комплексная оценка].currentmember.parent.name'
select
    non empty
    {
        filter
        (
            Descendants
            (
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели],
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Показатель 05],
                SELF
            ),
            [Measures].[Код]<>"1019900" and Right
            (
                [Показатели__Комплексная оценка].currentmember.uniquename,
                10
            )<>"DATAMEMBER"
        )
    }on rows,
    NON EMPTY
    {
        [Measures].[Код],
        [Measures].[Уровень]
    } on columns
from     [ЭО_СЭР_Комплексная оценка]
where
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.],
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]
    ) 
]]>
  </query>

  <query id="grid1">
    <![CDATA[
    --SEP_0002_ComplexSahalin grid1
with      
    member [Measures].[Ед]      
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Единица измерения")'      
    member [Measures].[Обратный]   
    as '<%selectedPok%>.properties("Показатель обратный")'   
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор уровня]  
    as ' IIF 
        (
            (
                Max 
                (
                    filter 
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right 
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10 
                        )<>"DATAMEMBER" 
                    ) ,
                    <%selectedPok%>
                )-Min 
                (
                    filter 
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right 
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10 
                        )<>"DATAMEMBER"  
                    ) ,
                    <%selectedPok%>
                ) 
            )<>0 and not isempty(<%selectedPok%>),
            IIF  
            (
                [Measures].[Обратный]="0",
                (
                    (
                        (
                            <%selectedPok%>,
                            [Measures].[Значение]  
                        )-Min  
                        (
                            filter  
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right  
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10  
                                )<>"DATAMEMBER"  
                            ) ,
                           <%selectedPok%>
                        )  
                    )/  
                    (
                        Max  
                        (
                            filter  
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right  
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10  
                                )<>"DATAMEMBER"  
                            ) ,
                            <%selectedPok%>
                        )-Min  
                        (
                            filter  
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right  
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10  
                                )<>"DATAMEMBER"  
                            ) ,
                            <%selectedPok%> 
                        )  
                    )  
                ) ,
                (
                    (
                        Max  
                        (
                            filter  
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right  
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10  
                                )<>"DATAMEMBER"  
                            ) ,
                            <%selectedPok%>  
                        ) -  
                        (
                            <%selectedPok%>,
                            [Measures].[Значение]  
                        )  
                    )/  
                    (
                        Max  
                        (
                            filter  
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right  
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10  
                                )<>"DATAMEMBER"  
                            ) ,
                            <%selectedPok%>
                        )-Min  
                        (
                            filter  
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right  
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10  
                                )<>"DATAMEMBER"  
                            ) ,
                            <%selectedPok%>
                        )  
                    )  
                )  
            ) ,
            null
        )' 
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика]     
    as 'IIF     
        (
          not isempty((
                ParallelPeriod
                (
                    [Период__Период].[Период__Период].[Год],
                    1,
                    [Период__Период].[Период__Период].currentmember
                ),
                <%selectedPok%>
            )) and   (
                ParallelPeriod     
                (
                    [Период__Период].[Период__Период].[Год],
                    1,
                    [Период__Период].[Период__Период].currentmember     
                ),
                <%selectedPok%>     
            )<>0 and not isempty    
            (
                <%selectedPok%>
            ) and    
            (
               <%selectedPok%>
            )<>0,
            (
               <%selectedPok%>
            )/     
            (
                ParallelPeriod     
                (
                    [Период__Период].[Период__Период].[Год],
                    1,
                    [Период__Период].[Период__Период].currentmember     
                ),
                <%selectedPok%>
            ) ,
             IIF   
            (
                (
                    ParallelPeriod  
                    (
                        [Период__Период].[Период__Период].[Год],
                        1,
                        [Период__Период].[Период__Период].currentmember  
                    ),
                    <%selectedPok%>
                )=0 and 
                (
                    <%selectedPok%>
                )=0 and not isempty
                    (
                        <%selectedPok%>
                    ) and not isempty
                    (
                        (
                            ParallelPeriod
                            (
                                [Период__Период].[Период__Период].[Год],
                                1,
                                [Период__Период].[Период__Период].currentmember
                            ),
                           <%selectedPok%>
                        )
                    ),
                [Measures].[Обратный]  
                *(-1),
            IIF  
            (
                    (
                        ParallelPeriod 
                        (
                            [Период__Период].[Период__Период].[Год],
                            1,
                            [Период__Период].[Период__Период].currentmember 
                        ),
                       <%selectedPok%>
                    )>0 and 
                    (
                        <%selectedPok%>
                    )=0 and not isempty(<%selectedPok%>)
                    and not isempty((
                        ParallelPeriod 
                        (
                            [Период__Период].[Период__Период].[Год],
                            1,
                            [Период__Период].[Период__Период].currentmember 
                        ),
                       <%selectedPok%>
                    )),
                    0,
                    IIF 
                    (
                        (
                            ParallelPeriod 
                            (
                                [Период__Период].[Период__Период].[Год],
                                1,
                                [Период__Период].[Период__Период].currentmember 
                            ),
                             <%selectedPok%>
                        )=0 and 
                        (
                            <%selectedPok%>
                        )>0
                        and not isempty(<%selectedPok%>)
                    and not isempty((
                        ParallelPeriod 
                        (
                            [Период__Период].[Период__Период].[Год],
                            1,
                            [Период__Период].[Период__Период].currentmember 
                        ),
                       <%selectedPok%>
                    )),
                        1,
                        null  
                    ) 
                )  
                )
        ) '        
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор динамики]      
    as 'IIF
    (
    (
                Max   
                (
                    filter   
                    ( 
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right   
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10   
                        )<>"DATAMEMBER"   
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика]   
                )-Min   
                (
                    filter   
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right   
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10   
                        )<>"DATAMEMBER"   
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика]   
                )   
            )<>0 and not isempty((
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика] ,
                        [Measures].[Значение]
                    )),
    IIF 
        (
            [Measures].[Обратный]="0",
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика] ,
                    [Measures].[Значение]   
                )-Min   
                (
                    filter   
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right   
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10   
                        )<>"DATAMEMBER"   
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика]   
                )   
            )/   
            (
                Max   
                (
                    filter   
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right   
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10   
                        )<>"DATAMEMBER"   
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика]   
                )-Min   
                (
                    filter   
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right   
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10   
                        )<>"DATAMEMBER"   
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика]   
                )   
            ),
            (
                Max
                (
                    filter 
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right 
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10 
                        )<>"DATAMEMBER" 
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика] 
                ) -
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика] ,
                    [Measures].[Значение]
                )
            )/ 
            (
                Max 
                (
                    filter 
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right 
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10 
                        )<>"DATAMEMBER"  
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика] 
                )-Min 
                (
                    filter 
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right 
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10 
                        )<>"DATAMEMBER" 
                    ) ,
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[динамика] 
                ) 
            ) 
        ),null)' 
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Ранг]   
    as '<%selectedPok%>.properties("Показатель обратный")'   
    
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Ранг уровня]    
    as 'IIF   
        (
            not isempty   
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор уровня],
                    [Measures].[Значение]   
                )   
            ),
            Rank   
            (
                [Территории__РФ].[Территории__РФ].currentmember,
                Order   
                (
                    filter   
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right   
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10   
                        )<>"DATAMEMBER"  and not isempty   
                        (
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор уровня],
                                [Measures].[Значение]   
                            )  
                        )   
                    ),
                    Round  
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор уровня],
                        3
                    ), 
                    DESC   
                ),
                Round 
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор уровня],
                    3
                )   
            ),
            null
        ) '   
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Ранг динамики]   
    as 'IIF   
        (
            not isempty   
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор динамики],
                    [Период__Период].[Период__Период].currentmember,
                    [Measures].[Значение]   
                )   
            ),
            Rank   
            (
                [Территории__РФ].[Территории__РФ].currentmember,
                Order   
                (
                    filter   
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right   
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10   
                        )<>"DATAMEMBER" and not isempty   
                        (
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор динамики],
                                [Measures].[Значение]   
                            )  
                        )   
                    ),
                    Round  
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор динамики],
                        3
                    )  ,
                    DESC   
                ),
                Round 
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор динамики],
                    3
                )  
            ) ,
            null   
        )'   
    member [Measures].[Год] 
    as '[Период__Период].[Период__Период].currentmember.name+" "+[Период__Период].[Период__Период].currentmember.parent.parent.name+" года"'
select
  --  non empty   
    {
        {
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.]
        } 
        *{ [Measures].[Год] }  ,
        {
            filter 
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                right      
                (
                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                    10      
                )<>"DATAMEMBER"      
            ) 
        }
        * {[Measures].[Значение]} 
    }on rows,
     non empty 
    {
     filter
     ({{
            <%selectedPok%>,
           [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор уровня],
            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Ранг уровня],
            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Индикатор динамики],
            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Ранг динамики]    
        }   
        *   
        {
            <%prevPeriod%>,
            <%selectedPeriod%>  
        }}   
        ,not isempty([Measures].[Значение]) and not isempty
            (
                (
                    [Measures].[Значение],
                    <%selectedPeriod%>,
                     <%selectedPok%>
                )
            ) 
        )
    } on columns   
from     [ЭО_СЭР_Комплексная оценка]   
where   
    (
        
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]   
    )   
]]>
  </query>

  <query id="grid2">
    <![CDATA[
    --SEP_0001_ComplexSahalin grid2
 with 
    member [Measures].[Ед]       
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Единица измерения")'       
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Частный индикатор]
    as '  
        (
            (
                (
                   <%selectedPok%>,
                    [Measures].[Значение]       
                )-Min       
                (
                    filter       
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right       
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10       
                        )<>"DATAMEMBER"       
                    ) ,
                    <%selectedPok%>       
                )       
            )/       
            (
                Max       
                (
                    filter       
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right       
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10       
                        )<>"DATAMEMBER"       
                    ) ,
                    <%selectedPok%>       
                )-Min       
                (
                    filter       
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right       
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10       
                        )<>"DATAMEMBER"       
                    ) ,
                    <%selectedPok%>       
                )       
            )    
        )  '  
      
    
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Ранг индикатора]    
    as 'IIF  
        (
            not isempty  
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Частный индикатор],
                    [Measures].[Значение]  
                )  
            ),
            Rank  
            (
                [Территории__РФ].[Территории__РФ].currentmember,
                Order     
                (
                    filter     
                    (
                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                        right     
                        (
                            [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                            10     
                        )<>"DATAMEMBER"  and not isempty  
                        (
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Частный индикатор],
                                [Measures].[Значение]  
                            )  
                        )   
                    ),
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Частный индикатор],
                    DESC    
                ),
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Частный индикатор]     
            ),
            null 
        ) '  
   
    member [Measures].[Год] 
    as '[Период__Период].[Период__Период].currentmember.name+" "+[Период__Период].[Период__Период].currentmember.parent.parent.name+" года"'
select
   -- non empty    
    {
        {
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.]
        } 
        *{ [Measures].[Год] }  ,
        {
            filter 
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                right      
                (
                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                    10      
                )<>"DATAMEMBER"      
            ) 
        }
        * {[Measures].[Значение]}   
    }on rows,
      non empty 
    {
        {
            <%selectedPok%>,
            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Частный индикатор],
            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Ранг индикатора]  
        }    
        *    
        {
            <%prevPeriod%>,
            <%selectedPeriod%>
        }      
    } on columns    
from     [ЭО_СЭР_Комплексная оценка]    
where    
    (
        
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]    
    )   
]]>
  </query>

  <query id="Chart">
    <![CDATA[
    --SEP_0002_ComplexSahalin Chart
 with 
    member [Measures].[Ед]       
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Единица измерения")'       
    
select
    non empty    
    {
        {
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.] 
        } 
        * {[Measures].[Ед]   } ,
        {
            order 
            (
                filter 
                (
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                    right 
                    (
                        [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                        10 
                    )<>"DATAMEMBER" 
                ), 
                (<%selectedPok%>,[Measures].[Значение]),
                desc 
            ) 
        } 
        * {[Measures].[Значение]} 
    }on rows,
    NON EMPTY    
    {
            <%selectedPok%>
    } on columns    
from     [ЭО_СЭР_Комплексная оценка]    
where    
    (
        
        <%selectedPeriod%>,
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]    
    )    
]]>
  </query>

  <query id="Map">
    <![CDATA[
    --SEP_0002_ComplexSahalin Map
with
    member [Measures].[Ед]
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Единица измерения")'
     member [Measures].[Обратный]
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Показатель обратный")'
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Код]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.properties("Краткое наименование")'
select
    non empty
    {
        {
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область]
        }
        * {[Measures].[Обратный]},
        {
            filter
            ( 
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].children       ,
                right
                (
                   [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.uniquename,
                    10
                )<>"DATAMEMBER" and not isempty((<%selectedPok%>,[Measures].[Значение]))
            )
        }
        * {[Measures].[Значение]}
    }on rows,
    NON EMPTY
    {
            <%selectedPok%>,
            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[Социальная сфера].[Код]
    } on columns
from     [ЭО_СЭР_Комплексная оценка]
where
    (

        <%selectedPeriod%>,
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]
    ) 
]]>
  </query>

</root>
