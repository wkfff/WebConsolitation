<?xml version="1.0" encoding="windows-1251"?>
<root>

	<!-- ========================================================================================= -->
	<query id="skk_011_grid_updown">
		<![CDATA[
-- skk_011_grid_updown
with
    member [Периоды].[Год_Месяц].[отчетный период]
    as 'aggregate ({ <%selected_period%> })'
    member [Периоды].[Год_Месяц].[период для сравнения]
    as 'aggregate ({ <%selected_period_compare%> })'

    member [Measures].[Досмотрено#] 
    as ' 
        (
            [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[отчетный период] 
        )' 
    member [Measures].[Выявлено#]
    as ' 
        (
            [Показатели].[Показатель].[Выявлено больных и/или лиц с подозрением на инфекционные заболевания],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[отчетный период] 
        )' 
	member  [Measures].[ДосмотреноСравн#]
    as ' 
        (
            [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[период для сравнения] 
        )' 
    member  [Measures].[ВыявленоСравн#]
    as ' 
        (
            [Показатели].[Показатель].[Выявлено больных и/или лиц с подозрением на инфекционные заболевания],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[период для сравнения] 
        )'   
        
	<#skk_pattern_percent#>	
	<#skk_pattern_percent_cmp#>
	<#skk_pattern_rank#>
	<#skk_pattern_rank_cmp#>	
	<#skk_pattern_updown#>		
	
    member [Measures].[*Уровень]
    as 'IIF 
        (
            [Пункты пропуска].[Субъект_Пункт пропуска].CurrentMember.level_number < 3,
            0,
            1 
        )' 
	member [Measures].[УровеньИерархии]
    as 'IIF
		(
			[Пункты пропуска].[Субъект_Пункт пропуска].CurrentMember is [Пункты пропуска].[Субъект_Пункт пропуска].[Все],
			0,
			[Пункты пропуска].[Субъект_Пункт пропуска].CurrentMember.level_number-1
		)'
		
    member [Measures].[Название]
    as 'IIF
        (
			[Пункты пропуска].[Субъект_Пункт пропуска].currentMember is [Пункты пропуска].[Субъект_Пункт пропуска].[Все],
            [Пункты пропуска].[Участок границы].currentMember.name,
			[Пункты пропуска].[Субъект_Пункт пропуска].currentMember.name
        )'
    set [Участки]
    as 'IIF
		(
			<%selected_border%> is [Пункты пропуска].[Участок границы].[Все],
			filter
			(
				[Пункты пропуска].[Участок границы].[Все].children,
				not [Пункты пропуска].[Участок границы].currentMember is [Пункты пропуска].[Участок границы].[Все].[Не указан участок границы]				
			),
			{ <%selected_border%> }
		)'
    set [Строки] 	  
    as 'Generate 
        (
            [Участки],
            (
                [Пункты пропуска].[Участок границы].CurrentMember,
                [Пункты пропуска].[Субъект_Пункт пропуска].[Все]
            ) +  
            {
                [Пункты пропуска].[Участок границы].CurrentMember 
            } *
            descendants
            (
                [Пункты пропуска].[Субъект_Пункт пропуска].[Все],
                [Пункты пропуска].[Субъект_Пункт пропуска].[Субъект],
                SELF_AND_AFTER
            )
        )'
select
    {
	    [Measures].[Название],
		
        [Measures].[Досмотрено#],
		[Measures].[ДосмотреноСравн#],
        [Measures].[Выявлено#],        
		[Measures].[Выявлено%],	
		[Measures].[ВыявленоСравн#],
        [Measures].[ВыявленоСравн%],		
        [Measures].[рост/снижение],
		
		[Measures].[Выявлено% (ранг)],
		[Measures].[Выявлено%доп],
		[Measures].[ВыявленоСравн% (ранг)],
		[Measures].[ВыявленоСравн%доп],
		
        [Measures].[*рост/снижение (си)],
        [Measures].[*рост/снижение (флаг)],
        [Measures].[*рост/снижение (формат)],
		
		[Measures].[УровеньИерархии],
        [Measures].[*Уровень] 
    } on columns,
    {
        [Строки]
    } on rows 
from [СКК] 
where
    (
        <%selected_direction%>
    ) 
  ]]>
	</query>	
	
	<!-- ========================================================================================= -->
	<query id="skk_011_chart_points">
		<![CDATA[
-- skk_011_chart_points
with
    member [Периоды].[Год_Месяц].[отчетный период]
    as 'aggregate({ <%selected_period%> })'
    member [Measures].[Досмотрено#]  
    as '  
        (
            [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[отчетный период]  
        )'  
select
    { 
		[Measures].[Досмотрено#] 
	} on columns,
    {
        filter 
        (
            [Пункты пропуска].[Пункт пропуска].[Пункт пропуска],
            not IsEmpty( [Measures].[Досмотрено#] ) 
        )  
    } on rows  
from [СКК]
where
    (
        <%selected_direction%>,
		<%selected_border%>
    )
]]>
	</query>

	<!-- ========================================================================================= -->
	<query id="skk_011_chart_districts">
		<![CDATA[
-- skk_011_chart_districts
with
    member [Периоды].[Год_Месяц].[отчетный период]
    as 'aggregate({ <%selected_period%> })'
    member [Measures].[Досмотрено#]
    as '
        (
            [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[отчетный период]
        )'
select
    {
        [Measures].[Досмотрено#]
    } on columns,
    {
        filter 
        (
            [Пункты пропуска].[ФО].[ФО],
            not IsEmpty( [Measures].[Досмотрено#] ) 
        )  
    } on rows     
from [СКК]
where
    (
        <%selected_direction%>,
		<%selected_border%>
    )
]]>
	</query>
	
	<!-- ========================================================================================= -->
	<query id="skk_011_chart_compare">
		<![CDATA[
-- skk_011_chart_compare
with
    member [Периоды].[Год_Месяц].[отчетный период]
    as 'aggregate({ <%selected_period%> })'
    member [Периоды].[Год_Месяц].[период для сравнения]
    as 'aggregate({ <%selected_period_compare%> })'
        
    member [Measures].[Досмотрено#]   
    as '   
        (
            [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[отчетный период]   
        )'   
    member  [Measures].[ДосмотреноСравн#]   
    as '   
        (
            [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[период для сравнения]   
        )'   
    member [Measures].[Выявлено#]   
    as '   
        (
            [Показатели].[Показатель].[Выявлено больных и/или лиц с подозрением на инфекционные заболевания],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[отчетный период]   
        )'   
    member [Measures].[ВыявленоСравн#]   
    as '   
        (
            [Показатели].[Показатель].[Выявлено больных и/или лиц с подозрением на инфекционные заболевания],
            [Measures].[Значение],
            [Периоды].[Год_Месяц].[период для сравнения]   
        )'    
select
    {
        [Measures].[Досмотрено#],
        [Measures].[Выявлено#],
        [Measures].[ДосмотреноСравн#],
        [Measures].[ВыявленоСравн#]   
    } on columns   
from [СКК] 
where    
    (
        <%selected_direction%>,
		<%selected_border%>
    )  
]]>
	</query>

	<!-- ========================================================================================= -->
	<query id="skk_011_grid_transport">
		<![CDATA[
-- skk_011_grid_transport
with
    member [Measures].[Количество]
    as 'count
        (
            filter
            (
                (                    
                    [Пункты пропуска].[Пункт пропуска].[Пункт пропуска],
                    [Пункты пропуска].[Участок границы].CurrentMember,
                    [Пункты пропуска].[Вид сообщения].CurrentMember
                ),
                ( [Measures].[Значение] ) > 0
            )
        ) '
    member [Measures].[Уровень]       
    as 'IIF       
        (
            ( [Пункты пропуска].[Вид сообщения].CurrentMember is [Пункты пропуска].[Вид сообщения].[Все] ),
            0,
            1       
        )'	       
select
    {
        {
            [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний],
            [Показатели].[Показатель].[Выявлено больных и/или лиц с подозрением на инфекционные заболевания]        
        } 	       
        * { [Measures].[Количество] } +     
        {
            [Показатели].[Показатель].DefaultMember  
        }     
        * { [Measures].[Уровень] }     
    } on columns,
    {
		order
        (
            [Пункты пропуска].[Вид сообщения].members, 
            (
                [Measures].[Количество],
                [Показатели].[Показатель].[Число лиц, досмотренных на наличие признаков инфекционных заболеваний]
            ), 
            DESC
        )
    } on rows  
from [СКК] 
where
    (
		{ <%selected_period%> },
        <%selected_direction%>,
		<%selected_border%>
    ) 
]]>
	</query>

</root>