<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0039_0002_date">
    <![CDATA[
-- FO_0039_0002_date
with    
    member [Measures].[ДанныеНа]    
    as '[Период].[Период].CurrentMember.UniqueName'    
    set [NonEmptySet]    
    as 'Tail    
        (
            Filter    
            (
                Descendants   
                (
                    [Период].[Период].[Данные всех периодов],
                    [Период].[Период].[Квартал],
                    SELF   
                ),
                not IsEmpty    
                (
                    (
                        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р2]    
                    )    
                ) and   
                (
                    [Период].[Период].CurrentMember.Name <> "Квартал 1"  
                ) and   
                (
                    [Период].[Период].CurrentMember.Name <> "Остатки на начало года"  
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные квартала" 
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные полугодия" 
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Данные месяца"
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
                ) 
            ),
            1    
        )'    
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows    
from [ФО_Оценка качества ОиОБП_Показатели]  
]]>
  </query>

  <query id="FO_0039_0002_grid">
    <![CDATA[
-- FO_0039_0002_grid
with             
    set [Список показателей]             
    as '             
        {
            Filter             
            (
                Descendants             
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Показатели],
                    SELF             
                ) -             
                {
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Несопоставленные данные],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Группа МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Рейтинг МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Средняя оценка уровня качества ОиОБП],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Степень качества ОиОБП]             
                },
                IIF             
                (
                    [Measures].[Оценка показателя] is [Measures].[Значение],
                    not             
                    (
                        [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Name = "Р15"             
                    ),
                    not             
                    (
                        [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Name = "Р15_Здравоохранение" or [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Name = "Р15_Культура" or [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Name = "Р15_Молодежная политика" or [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Name = "Р15_Образование"             
                    )             
                )             
            )             
        }'             
    set [Список МО]             
    as 'Filter             
        (
            Descendants             
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF             
            ),
            not             
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember             
            ) and             
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"             
            )             
        )'             
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Группа МО ]             
    as '             
        (
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Группа МО],
            [Measures].[Значение],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]             
        )'          
 
    member [Период].[Период].[Отклонение]    
    as 'IIF  
        (
           IsEmpty([Период].[Период].[Данные всех периодов].<%selected_period%>) or
           IsEmpty([Период].[Период].[Данные всех периодов].<%selected_prev_period%>),
           null,
           [Период].[Период].[Данные всех периодов].<%selected_period%> - [Период].[Период].[Данные всех периодов].<%selected_prev_period%> 
        )'  
    set [Кварталы]    
    as 'Filter  
        (
            Descendants 
            (
                [Период].[Период].[Данные всех периодов].[<%period_year%>],
                [Период].[Период].[Квартал],
                SELF 
            ),
            not  
            (
                [Период].[Период].CurrentMember is [Период].[Период].CurrentMember.Parent.DataMember 
            ) and  
            (
                [Период].[Период].CurrentMember.Properties("PKID") <= [Период].[Период].[Данные всех периодов].<%selected_period%>.Properties("PKID")
            ) and 
            (
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года"
            ) and 
            (
                [Период].[Период].CurrentMember.Name <> "Данные квартала"
            ) and 
            (
                [Период].[Период].CurrentMember.Name <> "Данные полугодия"
            ) and 
            (
                [Период].[Период].CurrentMember.Name <> "Данные года"
            ) 
        ) '  
    set [Годы] 
    as '
        {
            [Период].[Период].[Данные всех периодов].[<%period_year%>].PrevMember,
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        }'   
    member [Районы].[Сопоставимый].[Аггрегированные районы]   
    as 'Aggregate  
        (
            {
                [Список МО]
            }   
        )'    
    member [Период].[Период].[Аггрегированные периоды]  
    as 'Aggregate ( { [<%period_set%>] } )' 
    
    member Measures.[Выводим пустоту]    
    as '[Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Год] and 
        IsEmpty
        (
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р4],
                [Период].[Период].[Данные всех периодов].<%selected_period%>.DataMember,
                [Measures].[<%selected_maasure%>]
            )   
        ) '     
select
    {
        Filter             
        (
            {
                {
                    Filter             
                    (
                        {
                            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]             
                        },
                        [Measures].[<%selected_maasure%>] is [Measures].[Оценка показателя]             
                    ) + 
                    Filter
                    (
                      [Список показателей],
                      not IsEmpty
                      (
                          (
                              [Районы].[Сопоставимый].[Аггрегированные районы],
                              [Период].[Период].[Аггрегированные периоды]
                          ) 
                      ) 
                    ) 
                }             
                *             
                {
                    [<%period_set%>] +    
                    {
                        [Период].[Период].[Отклонение]    
                    }    
                }             
            },
            true          
        )             
    } on columns,
    {
        Order             
        (
            Filter([Список МО], not (Measures.[Выводим пустоту])),
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП],
                [Период].[Период].[Данные всех периодов].<%selected_period%>     
            ),
            BDESC             
        )             
    } on rows             
from  [ФО_Оценка качества ОиОБП_Показатели]             
where             
    (
        [Measures].[<%selected_maasure%>] 
    )              
  ]]>
</query>

<query id="FO_0039_0002_indicatorDescription">
<![CDATA[
-- FO_0039_0002_indicatorDescription

With
    set [Список показателей]
    as '
        {
                Descendants
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Показатели],
                    SELF
                ) -
                {
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Несопоставленные данные],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Группа МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Рейтинг МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Средняя оценка уровня качества ОиОБП],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Степень качества ОиОБП]
                }
        }'

    member [Measures].[Наименование]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Наименование")'
    member [Measures].[Единицы измерения]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Единицы измерения")'
    member [Measures].[Направление]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Properties("Направление оценки качества ОиОБП")'
Select
    {
       [Measures].[Наименование],
       [Measures].[Направление],
       [Measures].[Единицы измерения]
    } on columns,
    { [Список показателей] }  on rows
From [ФО_Оценка качества ОиОБП_Показатели]
  ]]>
</query>

</root>