<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id="STAT_0002_0003_Sakhalin_date">
    <![CDATA[
-- STAT_0002_0003_Sakhalin_compare_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as 'Tail 
        (
            Filter 
            (
                [Период__Период].[Период__Период].Members,
                not IsEmpty
                (
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:]
                ) or not IsEmpty
                (
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты] 
                ) 
            ),
            1 
        )' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from [СТАТ_Мониторинг СЭР] 
  ]]>
  </query>

  <query id="STAT_0002_0003_Sakhalin_regions">
    <![CDATA[
-- STAT_0002_0003_Sakhalin_regions
with 
    member [Measures].[Уровень] 
    as '0'
    member [Measures].[Уникальное имя] 
    as '
        [Территории__РФ].[Территории__РФ].CurrentMember.UniqueName
        '
    member [Measures].[Имя] 
    as ' [Территории__РФ].[Территории__РФ].CurrentMember.Name '
    set [Регионы] 
    as 'Filter
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].Children,
            not 
            (
                [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
            ) 
        )' 
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень] 
    }ON COLUMNS,
    non empty { [Регионы] }   ON ROWS 
FROM    [СТАТ_Мониторинг СЭР]   
  ]]>
  </query>

  
  <query id="STAT_0002_0003_Sakhalin_compare_Grid">
    <![CDATA[
-- STAT_0002_0003_Sakhalin_compare_Grid  
SELECT
      
    {
        crossjoin 
        (
            {
                Descendants   
                (
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[объемы] ,
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[объемы].Level ,
                    SELF_AND_AFTER   
                ) ,
                Except   
                (
                    Descendants   
                    (
                        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[процентная ставка по выданным кредитам (средневзвешенная)] ,
                        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[процентная ставка по выданным кредитам (средневзвешенная)].Level ,
                        SELF_AND_AFTER   
                    ) ,
                    {
                        {
                            Descendants   
                            (
                                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[процентная ставка по выданным кредитам (средневзвешенная)].DataMember ,
                                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[процентная ставка по выданным кредитам (средневзвешенная)].DataMember.Level ,
                                SELF_AND_AFTER   
                            )   
                        }   
                    }   
                ),
                Descendants  
                (
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты] ,
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты].Level ,
                    SELF_AND_AFTER  
                ) 
            },
            {
                [Measures].[Значение] ,
                [Measures].[Минимальное значение] ,
                [Measures].[Максимальное значение]  
            }    
        ) 
    } ON COLUMNS ,
    NON EMPTY     
    {
        Descendants 
        (
            [Период].[Период].[Данные всех периодов],
            [Период].[Период].[День],
            SELF  
        )
    }   ON ROWS 
FROM [СТАТ_Мониторинг СЭР]     
WHERE     
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Ведомственный раздел], 
        <%region%>
    )       
    ]]>
</query>


<query id="Chart_query">
<![CDATA[
---CHART
-- Whith hint
WITH
    MEMBER [Период].[Период].[Slicer]
    AS ' Aggregate
        (
            {
                {
                   <%LastDate%>
                } 
            }
        )'
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты ]
    as '[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты].[объемы]'
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты ]
    as '[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[объемы]'
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Итого ]
    as '[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты ] + [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты ] '
SELECT
    NON EMPTY
    {
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты ],
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты ]
        --[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Итого ]
    } ON rows ,
    NON EMPTY Descendants
    (
        [Период].[Период].[Данные всех периодов].[<%periodYear%>],
        [Период].[Период].[День],
        SELF
    ) ON columns
FROM [СТАТ_Мониторинг СЭР]
WHERE
    (
        <%region%> ,
        [Measures].[Значение]
    )  
    
  
  ]]>
  </query>

  <query id="Chart1_query">
    <![CDATA[
-- Chart1_query
WITH     
 member [Measures].[Значение ] 
    as 'IIF
        (
            isEmpty([Measures].[Значение]),
            0,
            [Measures].[Значение]
        )'
    SET [Территории]  
    AS 'Filter
        (
            Descendants 
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ],
                [Территории__РФ].[Территории__РФ].[Субъект РФ],
                SELF     
            ),
            not
            (
                [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
            )
        )' 
    SET [Периоды]  
    AS 'Filter  
        (
            Descendants  
            (
                [Период].[Период].[Данные всех периодов].[<%periodYear%>],
                [Период].[Период].[День],
                SELF  
            ),
            [Период].[Период].CurrentMember.Name = "1" and
            not IsEmpty([Measures].[Значение] )
        ) '  
    member [Территории__РФ].[Территории__РФ].[UniqName]  
    AS '[Период].[Период].CurrentMember.UniqueName' 
SELECT
    {
        {[Территории__РФ].[Территории__РФ].[UniqName]} + [Территории] 
    }  ON COLUMNS ,
   NON EMPTY {[Периоды]} ON ROWS  
FROM [СТАТ_Мониторинг СЭР]     
WHERE     
    (
        [Measures].[Значение ] ,
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[объемы]     
    )     
  
  ]]>
  </query>

  <query id="Chart2_query">
    <![CDATA[
-- Chart2_query 

WITH
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты ]
    as '[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты].[объемы]'
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты ]
    as '[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:].[объемы]'
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Итого ]
    as '[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты ] + [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты ] '
SELECT
    NON EMPTY {<%LastDate%>} ON COLUMNS ,
    NON EMPTY
    {
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты ],
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты ]
        --[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Итого ]
    } ON ROWS
FROM [СТАТ_Мониторинг СЭР]
WHERE
    (
        <%region%>,
        [Measures].[Значение]
    )
  ]]>
  </query>

  <query id="Chart3_query">
    <![CDATA[
--    Chart3_query
WITH    
 member [Measures].[Значение ] 
    as 'IIF
        (
            isEmpty([Measures].[Значение]),
            0,
            [Measures].[Значение]
        )'
    SET [Территории]  
    AS 'Filter
        (
            Descendants 
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ],
                [Территории__РФ].[Территории__РФ].[Субъект РФ],
                SELF     
            ),
            not
            (
                [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
            )
        )' 
    SET [Периоды]  
    AS 'Filter  
        (
            Descendants  
            (
                [Период].[Период].[Данные всех периодов].[<%periodYear%>],
                [Период].[Период].[День],
                SELF  
            ),
            [Период].[Период].CurrentMember.Name = "1" and
            not IsEmpty([Measures].[Значение] )
        ) '  
    member [Территории__РФ].[Территории__РФ].[UniqName]  
    AS '[Период].[Период].CurrentMember.UniqueName' 
SELECT
    {
        {[Территории__РФ].[Территории__РФ].[UniqName]} + [Территории] 
    }  ON COLUMNS ,
   NON EMPTY {[Периоды]} ON ROWS  
FROM [СТАТ_Мониторинг СЭР]     
WHERE     
    (
        [Measures].[Значение ] ,
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты].[объемы]     
    )

  ]]>
  </query>

  <query id="Dates">
    <![CDATA[
   -- STAT_0002_0003_Sakhalin_Dates
WITH 
    
    Set [Непустые периоды] 
    as 'Descendants 
        (
            [Период].[Период].[Данные всех периодов].[<%periodYear%>],
            [Период].[Период].[День],
            SELF 
        ) ' 
        
     member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Показатель]
    as ' Aggregate
        (
            {
                
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:],
                
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты]
            }
        ) '
SELECT
    {[Measures].[Значение]} ON COLUMNS ,
    NON EMPTY {[Непустые периоды]} DIMENSION PROPERTIES MEMBER_UNIQUE_NAME ON ROWS 
FROM [СТАТ_Мониторинг СЭР] 
WHERE 
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Ведомственный раздел] ,
        <%region%>,
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Показатель]
    ) 
      ]]>
  </query>

  <query id="Dates1">
    <![CDATA[
      -- STAT_0002_0003_Sakhalin_Dates1  
WITH
    Set [Непустые периоды]
    as ' 
           Descendants 
        (
            [Период].[Период].[Данные всех периодов],
            [Период].[Период].[День],
            SELF  
        ) '
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Показатель]
    as ' Aggregate
        (
            {
                
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:],
                
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты]
            }
        ) '
SELECT
    {[Measures].[Значение]} ON COLUMNS ,
    NON EMPTY {[Непустые периоды]} DIMENSION PROPERTIES MEMBER_UNIQUE_NAME ON ROWS
FROM [СТАТ_Мониторинг СЭР]
WHERE  
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Ведомственный раздел] ,
        <%region%>,
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Показатель] 
    ) 
    
      ]]>
  </query>

  <query id="LastDate">
    <![CDATA[
    
    -- последняя дата
with
    member Measures.[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    member [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Показатель]
    as ' Aggregate
        (
            {
                
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Потребительские кредиты:],
                
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты]
            }
        ) '
select

    {Measures.[ДанныеНа]} on columns, NON EMPTY
    {
        Tail
        (
            NonEmptyCrossjoin({[Период].[Период].[День].Members})
        )
    } on rows
FROM [СТАТ_Мониторинг СЭР]
WHERE
    (<%region%>,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Ведомственный раздел],
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Показатель]
        
    )
    
    ]]>
  </query>

  <query id="ChartDate">
    <![CDATA[

WITH
    SET [Территории]
    AS 'Filter
        (
            Descendants
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ],
                [Территории__РФ].[Территории__РФ].[Субъект РФ],
                SELF
            ),
            not
            (
                [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
            )
        )'
    SET [Периоды]
    AS 'Filter
        (
            Descendants
            (
                [Период].[Период].[Данные всех периодов].[<%periodYear%>],
                [Период].[Период].[День],
                SELF
            ),
            [Период].[Период].CurrentMember.Name = "1" and
            not IsEmpty([Measures].[Значение] )
        ) '
    member [Территории__РФ].[Территории__РФ].[UniqName]
    AS '[Период].[Период].CurrentMember.UniqueName'
SELECT
    {
        {[Территории__РФ].[Территории__РФ].[UniqName]} + [Территории]
    } ON COLUMNS ,
    NON EMPTY {[Периоды]} ON ROWS
FROM [СТАТ_Мониторинг СЭР]
WHERE
    (
        [Measures].[Значение] ,
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Ипотечные кредиты].[объемы]
    )
    
    ]]>
  </query>

</root>

