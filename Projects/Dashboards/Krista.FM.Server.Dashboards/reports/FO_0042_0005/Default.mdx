<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0042_0005_date">
    <![CDATA[
-- FO_0042_0005_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период].[Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as 'Tail 
        (
            Filter 
            (
                [Период].[Период].Members,
                not IsEmpty 
                (
                    (
                        [Measures].[Значение],
                        [Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели]
                    ) 
                ) and 
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and 
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and 
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and 
                [Период].[Период].CurrentMember.Name <> "Данные года" and 
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and 
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты" 
            ),
            1 
        )' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
]]>
  </query>

  <query id="FO_0042_0005_chart">
    <![CDATA[
-- FO_0042_0005_chart
with 
    set [Администраторы] 
    as 'Order
        (
            Filter
            (
                Descendants 
                (
                    [Администратор].[Сопоставим].[Все администраторы],
                    [Администратор].[Сопоставим].[Администратор],
                    SELF 
                ),
                not IsEmpty
                (
                    ([Measures].[Оценка показателя], [Период].[Период].[Данные всех периодов].[<%period_year%>])
                ) and
                IIF 
                (
                   ("<%selected_indicator%>" = "[Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели].[Оценка качества финансового менеджмента]"),
                   true,
                   ([Measures].[Применим ли в оценке], <%selected_indicator%>, [Период].[Период].[Данные всех периодов].[<%period_year%>]) <> 0
                ) 
            ),
            StrToValue([Администратор].[Сопоставим].CurrentMember.Properties("Код")),
            BDESC
        )'         
    set [Показатели] 
    as 'Filter 
        (
            Descendants 
            (
                [Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели],
                [Показатели].[Оценка качества ФМ_Сопоставимый].[Показатели 1],
                SELF 
            ),
            not 
            (
                [Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Parent.DataMember 
            ) and
            (InStr([Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Обозначение"), "Рейтинг") = 0) and
            (InStr([Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Обозначение"), "Р") > 0)  
        ) ' 
    member [Показатели].[Оценка качества ФМ_Сопоставимый].[Код] 
    as '[Администратор].[Сопоставим].CurrentMember.Properties("Код")' 
    member [Показатели].[Оценка качества ФМ_Сопоставимый].[Наименование] 
    as '[Администратор].[Сопоставим].CurrentMember.Name' 
    member [Показатели].[Оценка качества ФМ_Сопоставимый].[Значение оценки показателей] 
    as 'Sum 
        (
            [Показатели],
            [Measures].CurrentMember 
        )' 
    member [Measures].[Множитель] 
    as 'IIF
        (
            [Период].[Период].CurrentMember is [Период].[Период].[Данные всех периодов].[2008],
            4,
            1
        )'        
    member [Показатели].[Оценка качества ФМ_Сопоставимый].[Максимально возможное (наилучшее) значение оценки показателей]
    as '[Measures].[Множитель]
        * Sum 
        (
            [Показатели],
            [Measures].[Применим ли в оценке] 
        )'       
    member [Показатели].[Оценка качества ФМ_Сопоставимый].[Значение оценки качества финансового менеджмента ГРБС] 
    as 'IIF
        (
          (
              [Период].[Период].CurrentMember is [Период].[Период].[Данные всех периодов].[2008]  
          ) or   
          (
              [Период].[Период].CurrentMember is [Период].[Период].[Данные всех периодов].[2009]  
          ),
          IIF 
          (
              IsEmpty 
              (
                   [Показатели].[Оценка качества ФМ_Сопоставимый].[Максимально возможное (наилучшее) значение оценки показателей] 
              ) or [Показатели].[Оценка качества ФМ_Сопоставимый].[Максимально возможное (наилучшее) значение оценки показателей] = 0,
              null,
              100*
              (
                  [Показатели].[Оценка качества ФМ_Сопоставимый].[Значение оценки показателей] 
              ) / 
              (
                  [Показатели].[Оценка качества ФМ_Сопоставимый].[Максимально возможное (наилучшее) значение оценки показателей] 
              ) 
          ),
          [Measures].[Множитель показателя]  * <%selected_indicator%>
        ) ' 
    
    member [Measures].[Множитель показателя] 
    as 'IIF
        (
            "<%selected_indicator%>" = "[Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели].[Оценка качества финансового менеджмента]",
            100,
            1
        )' 
        
    set [Cписок администраторов]              
    as 'Order              
        (
            [Администраторы],
            StrToValue([Администратор].[Сопоставим].CurrentMember.Properties("Код")),
            BDESC              
        )'    
select
    {
        [Период].[Период].[Данные всех периодов].[<%period_year%>].PrevMember,
        [Период].[Период].[Данные всех периодов].[<%period_year%>]
    } on columns,
    non empty
    {
        [Cписок администраторов]
    } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
where 
    (
        [Показатели].[Оценка качества ФМ_Сопоставимый].[Значение оценки качества финансового менеджмента ГРБС],
        [Measures].[<%selected_maasure%>] 
    )             
  ]]>
  </query>

  <query id="FO_0042_0005_grbsDigest">
    - <![CDATA[ 
-- FO_0042_0005_grbsDigest
with   
    set [Администраторы]   
    as 'Descendants   
        (
            [Администратор].[Сопоставим],
            [Администратор].[Сопоставим].[Администратор],
            SELF   
        ) - {[Администратор].[Сопоставим].[Все администраторы].[Несопоставленные данные]}'
    member [Measures].[Имя]   
    as ' [Администратор].[Сопоставим].CurrentMember.Name '   
    member [Measures].[Уникальное имя]   
    as '[Администратор].[Сопоставим].CurrentMember.UniqueName'  
    member [Measures].[Краткое имя]  
    as '[Администратор].[Сопоставим].CurrentMember.Properties("Краткое наименование")'  
    member [Measures].[Полное имя]  
    as '[Администратор].[Сопоставим].CurrentMember.Name'  
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Краткое имя],
        [Measures].[Полное имя] 
    } on columns,
    { [Администраторы] } on rows
From  [ФО_Оценка качества ФМ_Показатели]
  ]]>
  </query>

  <query id="FO_0042_0005_indicatorDigest">
    - <![CDATA[ 
-- FO_0042_0005_indicatorDigest
with 
    set [Показатели] 
    as 'Order
        (
          Filter
          (
              [Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели].Children,
              (InStr([Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Обозначение"), "Рейтинг") = 0) and
              (InStr([Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Обозначение"), "Р") > 0)
          ),
          StrToValue([Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Код"))
        ) +
        {
           [Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели].[Оценка качества финансового менеджмента]
        }' 
    member [Measures].[Имя] 
    as 'IIF
        (
           [Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели].[Оценка качества финансового менеджмента],
           [Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Name,
           [Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Обозначение") + " " + [Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.Name
        )   '
    member [Measures].[Уникальное имя] 
    as '[Показатели].[Оценка качества ФМ_Сопоставимый].CurrentMember.UniqueName'
    member [Measures].[Уровень]
    as '0'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]
    } on columns,
    { [Показатели] } on rows 
From [ФО_Оценка качества ФМ_Показатели]
  ]]>
  </query>

</root>