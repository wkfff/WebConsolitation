<?xml version="1.0" encoding="Windows-1251"?>
<root>  
  <query id="FK_0001_0001_date">
    <![CDATA[
-- FK_0001_0001_gadget_date    
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФК_МесОтч_Расходы]
  ]]>
  </query>

  <query id="FK_0001_0001">
    <![CDATA[
-- FK_0001_0001_gadget_chart        
with
    set [Разделы ФКР]
    as 'Except
        (
            [РзПр].[Сопоставимый].[Раздел].Members,
            {
                [РзПр].[Сопоставимый].[Все коды ФКР].[Несопоставленные данные],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Итого внутренних оборотов],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ВСЕГО]
            }
        ) '
    member Measures.[Доля Empty]
    as 'IIF (IsEmpty([Measures].[Исполнено]) or [Measures].[Исполнено] <= 0, null,   
        (
            [Measures].[Исполнено],
            [РзПр].[Сопоставимый].CurrentMember
        )/Sum
        (
            [Разделы ФКР],
            [Measures].[Исполнено]
        ))'
    member Measures.[Доля]
    as 'CoalesceEmpty
        (
            Measures.[Доля Empty],
            0
        )'
    member Measures.[Доля план Empty]
    as 'IIF (IsEmpty([Measures].[Назначено]) or [Measures].[Назначено] <= 0, null,   
        (
            [Measures].[Назначено],
            [РзПр].[Сопоставимый].CurrentMember
        )/Sum
        (
            [Разделы ФКР],
            [Measures].[Назначено]
        ))'
    member Measures.[Доля план]
    as 'CoalesceEmpty
        (
            Measures.[Доля план Empty],
            0
        )'

    member [РзПр].[Сопоставимый].[Общегосуд.вопросы]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ОБЩЕГОСУДАРСТВЕННЫЕ ВОПРОСЫ]'
    member [РзПр].[Сопоставимый].[Национальная оборона_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ОБОРОНА]'
    member [РзПр].[Сопоставимый].[Нац.безопасность и правоохранит.деят.]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ БЕЗОПАСНОСТЬ И ПРАВООХРАНИТЕЛЬНАЯ ДЕЯТЕЛЬНОСТЬ]'
    member [РзПр].[Сопоставимый].[Национальная экономика_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ЭКОНОМИКА]'
    member [РзПр].[Сопоставимый].[ЖКХ]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО]'
    member [РзПр].[Сопоставимый].[Охрана окруж.среды]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ОХРАНА ОКРУЖАЮЩЕЙ СРЕДЫ]'
    member [РзПр].[Сопоставимый].[Образование_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ОБРАЗОВАНИЕ]'
    member [РзПр].[Сопоставимый].[Культура, кинематография_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[КУЛЬТУРА, КИНЕМАТОГРАФИЯ]'
    member [РзПр].[Сопоставимый].[СМИ]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[СРЕДСТВА МАССОВОЙ ИНФОРМАЦИИ]'
    member [РзПр].[Сопоставимый].[Здравоохранение_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ЗДРАВООХРАНЕНИЕ]'
    member [РзПр].[Сопоставимый].[Физическая культура, спорт]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ФИЗИЧЕСКАЯ КУЛЬТУРА И СПОРТ]'
    member [РзПр].[Сопоставимый].[Социальная политика_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[СОЦИАЛЬНАЯ ПОЛИТИКА]'
    member [РзПр].[Сопоставимый].[Межбюджетные трансферты_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ]'
    member [РзПр].[Сопоставимый].[Целевые бюджетные фонды_]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ЦЕЛЕВЫЕ БЮДЖЕТНЫЕ ФОНДЫ]'
    member [РзПр].[Сопоставимый].[Сокращенное наименование]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ОБРАЗОВАНИЕ]'
    member [РзПр].[Сопоставимый].[Межбюджетные трансферты общего характера]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ ОБЩЕГО ХАРАКТЕРА БЮДЖЕТАМ СУБЪЕКТОВ РОССИЙСКОЙ ФЕДЕРАЦИИ И МУНИЦИПАЛЬНЫХ ОБРАЗОВАНИЙ]'
    member [РзПр].[Сопоставимый].[Обслуживание гос. и муниц. долга]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[ОБСЛУЖИВАНИЕ ГОСУДАРСТВЕННОГО И МУНИЦИПАЛЬНОГО ДОЛГА]'

    set [Список субъектов]
    as '
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>],
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>],
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]
        }'
select
    Filter
    (
        {
            [РзПр].[Сопоставимый].[Общегосуд.вопросы],
            [РзПр].[Сопоставимый].[Национальная оборона_],
            [РзПр].[Сопоставимый].[Нац.безопасность и правоохранит.деят.],
            [РзПр].[Сопоставимый].[Национальная экономика_], 
            [РзПр].[Сопоставимый].[ЖКХ],  
            [РзПр].[Сопоставимый].[Охрана окруж.среды],
            [РзПр].[Сопоставимый].[Образование_],  
            [РзПр].[Сопоставимый].[Культура, кинематография_],  
            [РзПр].[Сопоставимый].[Здравоохранение_],
            [РзПр].[Сопоставимый].[Социальная политика_],  
            [РзПр].[Сопоставимый].[Физическая культура, спорт],
            [РзПр].[Сопоставимый].[СМИ], 
            [РзПр].[Сопоставимый].[Обслуживание гос. и муниц. долга],  
            [РзПр].[Сопоставимый].[Межбюджетные трансферты общего характера],
            [РзПр].[Сопоставимый].[Целевые бюджетные фонды_],
            [РзПр].[Сопоставимый].[Межбюджетные трансферты_]
        },
        Sum([Список субъектов]) > 0
    ) on columns,
    {{([Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>], Measures.[Доля])} +
    {([Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>], Measures.[Доля план])} +
    {([Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>], Measures.[Доля])} +
    {([Территории].[Сопоставимый].[Все территории].[Российская  Федерация], Measures.[Доля])}} on rows
from [ФК_МесОтч_Расходы]
where
    (
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
        <%period_day_fk%>
    )
  ]]>
  </query>
  </root>