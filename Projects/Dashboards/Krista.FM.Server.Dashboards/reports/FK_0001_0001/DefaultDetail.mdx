<?xml version="1.0" encoding="Windows-1251"?>
<root>
<query id="FK_0001_0001_date">
    <![CDATA[
-- FK_0001_0001_detail_date
-- <#[ФК_МесОтч_Расходы]#>
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФК_МесОтч_Расходы]
  ]]>
</query>

<query id="FK_0001_0001_detail_grid">
<![CDATA[
-- FK_0001_0001_detail_grid
-- <#[ФК_МесОтч_Расходы]#>
    with 
    set [Разделы ФКР] 
    as 'Except 
        (
            [РзПр].[Сопоставимый].[Раздел].Members,
            {
                [РзПр].[Сопоставимый].[Все коды ФКР].[Несопоставленные данные],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Итого внутренних оборотов],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ВСЕГО] 
            } 
        )' 
    member Measures.[Исполнено Доля] 
    as 'IIF
        (
            IsEmpty([Measures].[Исполнено]) or [Measures].[Исполнено] = 0,
            null,
            (
                [Measures].[Исполнено],
                [РзПр].[Сопоставимый].CurrentMember 
            )/ 
            (
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                [Measures].[Исполнено] 
            )
        )' 
    member Measures.[Назначено Доля] 
    as 'IIF
        (
            IsEmpty([Measures].[Назначено]) or [Measures].[Назначено] = 0,
            null,
            (
                [Measures].[Назначено],
                [РзПр].[Сопоставимый].CurrentMember 
            )/ 
            (
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                [Measures].[Назначено] 
            )
        )' 
    member Measures.[ФО доля] 
    as ' 
        (
            [Measures].[Исполнено доля],
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>] 
        )' 
    member Measures.[РФ доля] 
    as ' 
        (
            [Measures].[Исполнено доля],
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация] 
        )' 
    member Measures.[Исполнено Доля прошлый год] 
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Исполнено прошлый год]
            ) or [Measures].[Исполнено прошлый год] = 0,
            null,
            (
                [Measures].[Исполнено прошлый год],
                [РзПр].[Сопоставимый].CurrentMember 
            )/ 
            (
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                [Measures].[Исполнено прошлый год] 
            )
        )' 
    member Measures.[Процент выполнения прошлый год] 
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Назначено прошлый год]
            ) or [Measures].[Назначено прошлый год] = 0,
            null,
            [Measures].[Исполнено прошлый год] / [Measures].[Назначено прошлый год]
        )' 
    member Measures.[Уровень] 
    as '[РзПр].[Сопоставимый].CurrentMember.Level.Name' 
    member Measures.[Код]
    as '[РзПр].[Сопоставимый].CurrentMember.Properties("Код")'
-- Уровни бюджета
    member [Уровни бюджета].[СКИФ].[Консолидированный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет субъекта]'
    
    member [Уровни бюджета].[СКИФ].[Собственный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Бюджет субъекта]'
    
    member [Уровни бюджета].[СКИФ].[Местные бюджеты]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет МО]'
    
    member [Уровни бюджета].[СКИФ].[Городские округа]
    as '[Уровни бюджета].[СКИФ].[Бюджет гор.округа]'

    member [Уровни бюджета].[СКИФ].[Муниципальные районы]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Бюджет поселения]
            }
        )'

    member [Уровни бюджета].[СКИФ].[Собственные бюджеты районов]
    as '[Уровни бюджета].[СКИФ].[Бюджет района]'
    
    member [Уровни бюджета].[СКИФ].[Городские и сельские поселения]
    as '[Уровни бюджета].[СКИФ].[Бюджет поселения]'
--         
select
    {
        Measures.[Код],
        Measures.[Исполнено],
        Measures.[Исполнено доля],
        Measures.[ФО доля],
        Measures.[РФ доля],
        Measures.[Назначено],
        Measures.[Назначено доля],
        [Measures].[Процент выполнения назначений],
        [Measures].[Исполнено прошлый год],
        [Measures].[Назначено прошлый год],
        Measures.[Исполнено Доля прошлый год],
        Measures.[Процент выполнения прошлый год],
        [Measures].[Темп роста к аналогичному периоду предыдущего года_Исполнено],
        Measures.[Уровень] 
    } on columns,
    {
        Filter 
        (
            Generate 
            (
                [Разделы ФКР],
                Descendants 
                (
                    [РзПр].[Сопоставимый].CurrentMember,
                    [РзПр].[Сопоставимый].[Подраздел],
                    SELF_AND_BEFORE 
                ) 
            ),
            (
                not IsEmpty(Measures.[Исполнено]) and Measures.[Исполнено]<>0 
            ) 
        )+ 
        {
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Итого внутренних оборотов],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Итого внутренних оборотов].[Перечисления другим бюджетам бюджетной системы Российской Федерации], 
            [РзПр].[Сопоставимый].[Все коды ФКР].[Итого внутренних оборотов].[Обслуживание внутреннего долга]
        } 
    } on rows 
from [ФК_МесОтч_Расходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>],
        [Уровни бюджета].[СКИФ].[<%skif_level%>]
    ) 
  ]]>
  </query>
  
</root>