<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0010_0002_date">
    <![CDATA[
-- FO_0010_0002_date
-- <#[МОФО_Дополнительные мероприятия]#>
with
    member [Мероприятия].[ДопМероприятия_Сопоставимый].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            nonemptycrossjoin
            (
                [Период].[Период].[Год].Members
            )
        ) '
select
    { [Мероприятия].[ДопМероприятия_Сопоставимый].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [МОФО_Дополнительные мероприятия]
where ([Measures].[Согласованная оценка])
]]>
</query>

<query id="FO_0010_0002_grid">
<![CDATA[
-- FO_0010_0002_grid
-- <#[МОФО_Дополнительные мероприятия]#>
with               
    member [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'
    
    member [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'
    
    member [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'

    member [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'

    member [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'

    member [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'
    
    member [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'    

    member [Районы].[Сопоставимый].[Консолид.бюджеты районов]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'
    member [Районы].[Сопоставимый].[Все районы].[Городские округа Всего]
    as '[Районы].[Сопоставимый].[Все районы].[Вологодская область]'

    set [Все муниципальные образования]
    as '{
           [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего],
           [Районы].[Сопоставимый].[Консолид.бюджеты районов],
           [Районы].[Сопоставимый].[Все районы].[Городские округа Всего],
           [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего],
           [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего],
           [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений],
           [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений]
        } +
        Generate
        (
            Filter
            (
                Descendants
                (
                   [Районы].[Сопоставимый].[Все районы].[Вологодская область].[Города областного подчинения Вологодской области],
                   <%region_level%>,
                   SELF
                ) +
                Descendants
                (
                   [Районы].[Сопоставимый].[Все районы].[Вологодская область].[Районы Вологодской области],
                   <%region_level%>,
                   SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ),
            {
                [Районы].[Сопоставимый].CurrentMember
            } + Descendants
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    <%settlement_level%>,
                    SELF
                )
        )'
    set [Выбранные МО]    
    as '{<%selected_region_set%>}'
    
    set [Муниципальные образования]
    as 'Filter
        (
          Descendants               
          (
             [Районы].[Сопоставимый].[Все районы].[Вологодская область],
             <%region_level%>,
             SELF               
          ),
          not  
          (
             [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember  
          )
       )'
    
    set [Собственные районы]
    as 'Filter
        (
          Descendants               
          (
             [Районы].[Сопоставимый].[Все районы].[Вологодская область],
             <%settlement_level%>,
             SELF               
          ),
          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"
       )'
    
    set [Муниципальные районы]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы].[Вологодская область],
                <%region_level%>,
                SELF
            ),
            [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"
        )'
        
    set [Городские округа]
    as 'Filter
        (
          Descendants               
          (
             [Районы].[Сопоставимый].[Все районы].[Вологодская область],
             <%region_level%>,
             SELF               
          ),
          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
       )'
    
    set [Поселения текущего района]
    as 'Filter
        (
          Descendants               
          (
             <%selected_region%>,
             <%settlement_level%>,
             SELF               
          ),
          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП" or
          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"
       )'
    
    set [Сельские поселения]
    as 'Filter
        (
          Descendants               
          (
             [Районы].[Сопоставимый].[Все районы].[Вологодская область],
             <%settlement_level%>,
             SELF               
          ),
          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"
       )'
    
    set [Городские поселения]
    as 'Filter
        (
          Descendants               
          (
             [Районы].[Сопоставимый].[Все районы].[Вологодская область],
             <%settlement_level%>,
             SELF               
          ),
          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"
       )'
    
    set [Городские и сельские поселения]
    as '[Сельские поселения] + [Городские поселения]'
    
    set [Мероприятия]  
    as 'Filter    
        (
            Generate    
            (
                Descendants    
                (
                    <%selected_activity%>,
                    <%selected_activity%>.Level,
                    SELF    
                ),
                {
                    [Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember  
                } + 
                Descendants    
                    (
                        [Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember,
                        [Мероприятия].[ДопМероприятия_Сопоставимый].[Мероприятия уровень 05],
                        SELF_AND_BEFORE    
                    )
            ),
            not    
            (
                [Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember is [Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember.Parent.DataMember  
            )    
        ) - {[Мероприятия].[ДопМероприятия_Сопоставимый].[Все].[Проведенная работа в рамках реализации программы Мероприятий по увеличению доходной базы бюджета]}'
        
    member [Measures].[Тип терри- тории]
    as 'IIF  
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего],
            "Все",
            IIF   
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолид.бюджеты районов],
                "МР",
                IIF   
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего] or
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Городские округа Всего],
                    "ГО",
                    IIF   
                    (
                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего] or
                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений] or
                        <%settelment_total_selected%>,
                        "ГСП",
                        IIF   
                        (
                            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений],
                            "СП",
                            IIF   
                            (
                                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений],
                                "ГП",
                                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории")
                            )   
                        )   
                    )   
                )   
            )
        )'              
    member [Measures].[Код]
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего],
            "Все",
            IIF 
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего],
                "МР",
                IIF 
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего] or
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Городские округа Всего],
                    "ГО",
                    IIF 
                    (
                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего] or
                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений] or
                        <%settelment_total_selected%>,
                        "ГСП",
                        IIF 
                        (
                            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений],
                            "ГCП",
                            IIF 
                            (
                                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений],
                                "ГСП",
                                IIF 
                                (
                                     
                                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолид.бюджеты районов],
                                    "кон",
                                    IIF 
                                    (
                                      [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СБ",
                                      "Все",
                                      IIF 
                                      (
                                          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" or
                                          [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП",
                                          "ГСП",
                                          IIF 
                                          (
                                            [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" and not 
                                            (
                                                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember 
                                            ),
                                            "кон",
                                            [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") 
                                          )   
                                      )   
                                    )  
                                ) 
                            ) 
                        ) 
                    ) 
                ) 
            ) 
        )'          
    member [Measures].[Муниципальное образование]            
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember,
            [Районы].[Сопоставимый].CurrentMember.Name + " (собственный бюджет)",
            IIF 
            (
               <%settelment_total_selected%> and not ([Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего]),
               "Бюджеты поселений (" + [Районы].[Сопоставимый].CurrentMember.Name + ")",
               [Районы].[Сопоставимый].CurrentMember.Name
            )
        )'  
    member [Measures].[Согласованная оценка ]
    as 'IIF
        (
            (
                [Measures].[Согласованная оценка]
            ) = 0 or
            ([Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember.Level is [Мероприятия].[ДопМероприятия_Сопоставимый].[Мероприятия уровень 2]),
            null,
            IIF
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего],
                Sum
                (
                    [Муниципальные образования],
                    [Measures].[Согласованная оценка ]
                ),
                IIF
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего],
                    Sum
                    (
                        [Собственные районы],
                        [Measures].[Согласованная оценка ]
                    ),
                    IIF
                    (
                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего],
                        Sum
                        (
                            [Городские округа],
                            [Measures].[Согласованная оценка ]
                        ),
                        IIF
                        (
                            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего],
                            Sum
                            (
                                [Городские и сельские поселения],
                                [Measures].[Согласованная оценка ] 
                            ),
                            IIF
                            (
                                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений],
                                Sum
                                (
                                    [Сельские поселения],
                                    [Measures].[Согласованная оценка ]
                                ),
                                IIF
                                (
                                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений],
                                    Sum
                                    (
                                        [Городские поселения],
                                        [Measures].[Согласованная оценка ]
                                    ),
                                    IIF
                                    (
                                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолид.бюджеты районов],
                                        Sum
                                        (
                                            [Муниципальные районы],
                                            [Measures].[Согласованная оценка ]
                                        ),
                                        IIF
                                        (
                                            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Городские округа Всего],
                                            Sum
                                            (
                                                [Городские округа],
                                                [Measures].[Согласованная оценка ]
                                            ),
                                            IIF       
                                                (
                                                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений],
                                                    Sum 
                                                    (
                                                        [Поселения текущего района],
                                                        [Measures].[Согласованная оценка ]   
                                                    ),                                                    
                                                    IIF
                                                    (
                                                        <%settelment_total_selected%>,
                                                        Sum        
                                                        (
                                                            Filter       
                                                            (
                                                                Descendants       
                                                                (
                                                                    [Районы].[Сопоставимый].CurrentMember,
                                                                    <%settlement_level%>,
                                                                    SELF       
                                                                ),
                                                                ([Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП" or 
                                                                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СП") and
                                                                ([Measures].[Согласованная оценка]) <> 0
                                                            ),
                                                            [Measures].[Согласованная оценка]      
                                                        ),
                                                        [Measures].[Согласованная оценка]
                                                    )
                                                )  
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
        )'
        
    member [Measures].[За 1 квартал]
    as '([Measures].[Согласованная оценка ], [Вариант].[МОФО_Доп мероприятия].[Все].[1 квартал])'

    member [Measures].[За 1 полугодие]
    as '([Measures].[Согласованная оценка ], [Вариант].[МОФО_Доп мероприятия].[Все].[2 квартал])'

    member [Measures].[За 9 месяцев]
    as '([Measures].[Согласованная оценка ], [Вариант].[МОФО_Доп мероприятия].[Все].[3 квартал])'

    member [Measures].[Итого за год]
    as '([Measures].[Согласованная оценка ], [Вариант].[МОФО_Доп мероприятия].[Все].[Итоговый за год])'
    
    member [Measures].[Наименование мероприятия]    
    as '[Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember.Name'    
    member [Measures].[Уровень]    
    as '[Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember.Level.Name'  
    
    member [Measures].[Фильтр по коду]    
    as 'IIF   
        (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолид.бюджеты районов] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Городские округа Всего],
                "<%selected_region_code%>" = "Все" or
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего] and "<%selected_region_code%>" = "Все"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего] and "<%selected_region_code%>" = "МР"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего] and "<%selected_region_code%>" = "ГО"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего] and "<%selected_region_code%>" = "ГСП"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений] and "<%selected_region_code%>" = "ГСП"  
                ) or                  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений] and "<%selected_region_code%>" = "ГСП"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений] and "<%selected_region_code%>" = "ГСП"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолид.бюджеты районов] and "<%selected_region_code%>" = "кон"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Городские округа Всего] and "<%selected_region_code%>" = "ГО"  
                ),
                IIF    
                (
                    "<%selected_region_code%>" = "ГСП",
                    [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" or
                    <%settelment_total_selected%>,
                    IIF    
                    (
                        "<%selected_region_code%>" = "Все",
                        true,
                        IIF 
                        (
                            [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" and not 
                            (
                                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember 
                            ),
                            "<%selected_region_code%>" = "кон",
                            "<%selected_region_code%>" = [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории")
                        ) 
                    )    
                 )    
         )' 
    member [Measures].[Фильтр по типу]
    as 'IIF   
        (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолид.бюджеты районов] or
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Городские округа Всего],
                "<%selected_region_type%>" = "Все" or
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Местные бюджеты – Всего] and "<%selected_region_type%>" = "Все"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Собственные бюджеты МР - Всего] and "<%selected_region_type%>" = "МР"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты ГО – Всего] and "<%selected_region_type%>" = "ГО"  
                ) or  
                (
                    ([Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений – Всего] or <%settelment_total_selected%>) and "<%selected_region_type%>" = "ГСП"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты поселений] and "<%selected_region_type%>" = "ГСП"  
                ) or 
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты сельских поселений] and "<%selected_region_type%>" = "СП"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Бюджеты городских поселений] and "<%selected_region_type%>" = "ГП"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолид.бюджеты районов] and "<%selected_region_type%>" = "МР"  
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Все районы].[Городские округа Всего] and "<%selected_region_type%>" = "ГО"  
                ),
                IIF
                (
                    "<%selected_region_type%>" = "Все",
                    true,
                    "<%selected_region_type%>" = [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории")
                )
         )'  
    member [Measures].[Число непустых потомков]   
    as 'IIF   
        (
            [Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember.Level is [Мероприятия].[ДопМероприятия_Сопоставимый].[Мероприятия уровень 2],
            Count   
            (
                Filter   
                (
                    Descendants   
                    (
                        [Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember,
                        [Мероприятия].[ДопМероприятия_Сопоставимый].[Мероприятия уровень 3],
                        SELF
                    ),
                    not
                    (
                        IsEmpty ( [Measures].[За 1 квартал] ) and 
                        IsEmpty ( [Measures].[За 1 полугодие] ) and 
                        IsEmpty ( [Measures].[За 9 месяцев] ) and 
                        IsEmpty ( [Measures].[Итого за год] )
                    ) 
                )   
            ),
            1   
        )'          
SELECT
    {
        [Measures].[Код],
        [Measures].[Тип терри- тории],
        [Measures].[Муниципальное образование],
        [Measures].[Наименование мероприятия],
        [Measures].[За 1 квартал],
        [Measures].[За 1 полугодие],
        [Measures].[За 9 месяцев],
        [Measures].[Итого за год],
        [Measures].[Уровень]
    } on columns,
    Filter
    (
        Filter
        (
           {<%selected_region_set%>},
           [Measures].[Фильтр по коду] = true and
           [Measures].[Фильтр по типу] = true
        )  
        * {[Мероприятия]},
        [Measures].[Число непустых потомков] > 0 and
        not (
              not
              (
                [Мероприятия].[ДопМероприятия_Сопоставимый].CurrentMember.Level is [Мероприятия].[ДопМероприятия_Сопоставимый].[Мероприятия уровень 2]
              ) and
              IsEmpty
              (
                  [Measures].[За 1 квартал]
              ) and IsEmpty
              (
                  [Measures].[За 1 полугодие]
              ) and IsEmpty
              (
                  [Measures].[За 9 месяцев]
              ) and IsEmpty
              (
                  [Measures].[Итого за год]
              )
           )
    ) on rows         
FROM [МОФО_Дополнительные мероприятия]   
WHERE ( [Период].[Период].[Данные всех периодов].[<%period_year%>] )
  ]]>
      </query>

    </root>