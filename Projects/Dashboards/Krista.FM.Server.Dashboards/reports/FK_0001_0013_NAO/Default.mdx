<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FK_0001_0013_NAO_date">
    <![CDATA[
-- FK_0001_0013_NAO_compare_date   
-- <#[ФК_МесОтч_Доходы]#>
-- Дата
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФК_МесОтч_Доходы]
  ]]>
  </query>

  <query id="FK_0001_0013_NAO_grid">
    <![CDATA[
-- FK_0001_0013_NAO_grid
with    
    member [КД].[Сопоставимый].[ИТОГО ДОХОДОВ ]   
    as '[КД].[Сопоставимый].[Все коды доходов].[Доходы - всего в том числе:]'    
    member [КД].[Сопоставимый].[ИТОГО РАСХОДОВ]   
    as 'LookupCube   
        (
            "[ФК_МесОтч_Расходы]",
            "   
            (
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                " + MemberToStr ( [Measures].CurrentMember ) + ",
                " + MemberToStr   
                (
                    [Территории].[Сопоставимый].CurrentMember   
                ) + ",
                " + MemberToStr   
                (
                    [Период].[Период].CurrentMember   
                ) + ",
                " + MemberToStr   
                (
                    [Уровни бюджета].[СКИФ].CurrentMember   
                ) + "   
            )"   
        )'    
    member [КД].[Сопоставимый].[ДЕФИЦИТ/ПРОФИЦИТ]   
    as 'LookupCube   
        (
            "[ФК_МесОтч_Дефицит Профицит]",
            "   
            (
                " + MemberToStr ( [Measures].CurrentMember ) + ",
                " + MemberToStr   
                (
                    [Территории].[Сопоставимый].CurrentMember   
                ) + ",
                " + MemberToStr   
                (
                    [Период].[Период].CurrentMember   
                ) + ",
                " + MemberToStr   
                (
                    [Уровни бюджета].[СКИФ].CurrentMember   
                ) + "   
            )"   
        )'    
    member Measures.[Текущий год]   
    as '[Measures].[Исполнено] / 1000000'   
    member Measures.[Прошлый год]   
    as '[Measures].[Исполнено прошлый год]  / 1000000'   
    member Measures.[Позапрошлый год]  
    as '  
        (
            ParallelPeriod 
            (
                [Период].[Период].[Год],
                1,
                [Период].[Период].CurrentMember  
            ),
            [Measures].[Исполнено прошлый год]  
        ) / 1000000'   
    member Measures.[Темп роста к прошлому году] 
    as '[Measures].[Темп роста к аналогичному периоду предыдущего года_Исполнено]'     
    member Measures.[Темп роста к позапрошлому году] 
    as 'IIF
        (
            IsEmpty(Measures.[Позапрошлый год]) or Measures.[Позапрошлый год] = 0,
            null,
            Measures.[Текущий год] / Measures.[Позапрошлый год]
        )' 
    
    member [Уровни бюджета].[СКИФ].[Консолидированный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта]'        
    member [Уровни бюджета].[СКИФ].[Собственный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Бюджет субъекта]'
    member [Уровни бюджета].[СКИФ].[Местные бюджеты]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет МО]'
    member [Уровни бюджета].[СКИФ].[Городские округа]
    as '[Уровни бюджета].[СКИФ].[Бюджет гор.округа]'
    member [Уровни бюджета].[СКИФ].[Муниципальные районы]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Бюджет поселения]
            }
        )'
    member [Уровни бюджета].[СКИФ].[Собственные бюджеты районов]
    as '[Уровни бюджета].[СКИФ].[Бюджет района]'
    member [Уровни бюджета].[СКИФ].[Городские и сельские поселения]
    as '[Уровни бюджета].[СКИФ].[Бюджет поселения]'        
select
    {
        {
            {
                [КД].[Сопоставимый].[ИТОГО ДОХОДОВ ],
                [КД].[Сопоставимый].[ИТОГО РАСХОДОВ]
            } 
            * 
            {
                Measures.[Позапрошлый год],
                Measures.[Прошлый год],
                Measures.[Текущий год],
                Measures.[Темп роста к позапрошлому году],
                Measures.[Темп роста к прошлому году] 
            }
        } +
        {
            {
                [КД].[Сопоставимый].[ДЕФИЦИТ/ПРОФИЦИТ]
            }
            *
            {
                Measures.[Позапрошлый год],
                Measures.[Прошлый год],
                Measures.[Текущий год]
            }
        }
    } on columns,
    non empty   
    {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]   
        }+ Generate   
        (
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%selected_fo%>   
            },
            {
                [Территории].[Сопоставимый].CurrentMember   
            } + Filter   
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                not   
                (
                    [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember   
                )   
            )   
        )   
    } on rows   
from [ФК_МесОтч_Доходы]   
where   
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [Уровни бюджета].[СКИФ].[<%skif_level%>]  
    )   
  ]]>
  </query>

</root>