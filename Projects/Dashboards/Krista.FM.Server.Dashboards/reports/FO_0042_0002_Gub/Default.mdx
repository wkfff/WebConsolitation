<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0042_0002_date">
    <![CDATA[
-- FO_0042_0002_date
-- <#[ФО_Оценка качества ФМ_Показатели]#>

select
      {  [Показатели].[Оценка качества ФМ].[Данные всех источников] } on columns,
 non empty   { [Период].[Период].[Год].members } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
]]>
  </query>

  <query id="shortGRBSNames">
    <![CDATA[
-- shared_shortGRBSNames
WITH
    member [Measures].[Краткое наименование]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование")'
    member [Measures].[Код]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")'
SELECT
    {
        [Measures].[Краткое наименование],
        [Measures].[Код]
    } on columns,
    {
         [Администратор__Сопоставим].[Администратор__Сопоставим].children
    } on rows
FROM  [ФО_Оценка качества ФМ_Показатели]

]]>
  </query>


  <query id="FO_0042_0002_chart">
    <![CDATA[
-- FO_0042_0002_chart
with 
    set [Администраторы]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор].members'
    set [Показатели] 
    as 'Filter 
        (
            Descendants 
            (
                [Показатели].[Оценка качества ФМ].[Данные всех источников].[ФО\0042 Оценка качества ФМ - <%period_year%> квартал 0],
                [Показатели].[Оценка качества ФМ].[Показатели 1],
                SELF 
            ),
            not 
            (
                [Показатели].[Оценка качества ФМ].CurrentMember is [Показатели].[Оценка качества ФМ].CurrentMember.Parent.DataMember 
            ) 
        ) ' 
    member [Показатели].[Оценка качества ФМ].[Код] 
    as '[Администратор].[Анализ].CurrentMember.Properties("Код")' 
    member [Показатели].[Оценка качества ФМ].[Наименование] 
    as '[Администратор].[Анализ].CurrentMember.Name' 
    member [Показатели].[Оценка качества ФМ].[Значение оценки показателей] 
    as 'Sum 
        (
            [Показатели],
            [Measures].CurrentMember 
        )' 
    member [Measures].[Множитель] 
    as 'IIF
        (
            [Период].[Период].[Данные всех периодов].[<%period_year%>] is [Период].[Период].[Данные всех периодов].[2008],
            4,
            1
        )'        
    member [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей]
    as '[Measures].[Множитель]
        * Sum 
        (
            [Показатели],
            [Measures].[Применим ли в оценке] 
        )'       
    member [Показатели].[Оценка качества ФМ].[Значение оценки качества финансового менеджмента ГРБС] 
    as 'IIF 
        (
            IsEmpty 
            (
                [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей] 
            ) or [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей] = 0,
            null,
            100 *
            (
                [Показатели].[Оценка качества ФМ].[Значение оценки показателей] 
            ) / 
            (
                [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей] 
            ) 
        )' 
    set [Cписок администраторов]              
    as 'Order              
        (
            [Администраторы],
            [Показатели].[Оценка качества ФМ].[Уровень качества финансового менеджмента],
            BDESC              
        )'               
    member [Measures].[Оценка показателя1] 
    as '[Measures].[Оценка показателя] *100'
select
    {
       [Показатели].[Оценка качества ФМ].[Уровень качества финансового менеджмента]
    } on columns,
   non empty {
        [<%grbs_set%>]
    } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
where 
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%selected_quater%>],
        [Measures].[Оценка показателя1] 
    )             
  ]]>
  </query>

  
</root>