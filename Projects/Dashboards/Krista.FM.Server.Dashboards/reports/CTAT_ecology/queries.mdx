<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id = "ComboPeriod">
    <![CDATA[with   
    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[ParentDate]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.parent.parent.parent.name'  
    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[UniqueName]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.UniqueName'
    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Level]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.Level_Number'
select
    non empty   
    {
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год].[2009].datamember,
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год].[2010].datamember,
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год].[2011].datamember,
        filter 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц].members ,
            not isempty 
            (
                [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Все показатели] 
            )and [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[ParentDate]>2010 
        )  
    }on rows,
    non empty   
    {
        [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[UniqueName],
        [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Level]
    } on columns   
FROM  [СТАТ_Экология_Атмосферный воздух]   
where   
    (
        [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра],
        [Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - ДепЭкологии ХМАО-Югры],
        [Группировки__Экология_Атмосферный воздух].[Группировки__Экология_Атмосферный воздух].[Группировка].[По городам и районам],
        [Measures].[За период]   
    )   
]]></query>
  <query id = "ComboField">
    <![CDATA[with
    member [ISDATAMEMBER]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.IS_DATAMEMBER'
    member [UniqueName]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.UniqueName'
    member [LevelNumber]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level_Number-1'
    member [reverce]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Примечание")'
    member [Unit]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Единица измерения")'
    member [Comporable]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Сопоставимость")'
select
    {
    [Comporable],
    [Unit],
    [reverce],
        [UniqueName],
        [LevelNumber]
    }on columns,
    {
        filter
        (
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].members,
            (
                not IsEmpty([Measures].[Значение])
                and [LevelNumber] >= 0
                and not [ISDATAMEMBER]
            )
        )
    } on rows
from [СТАТ_Паспорт МО_СП и ГП]
]]>
  </query>
  <query id = "ComboRegion">
    <![CDATA[with
    member [ISDataMember]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.IS_DATAMEMBER'
    member [UniqueName]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'
    member [LevelNumber]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Level_Number - 5'
select
    {
        [UniqueName],
        [LevelNumber]
    }on columns,
    {
        filter
        (
            [Территории__РФ].[Территории__РФ].members,
            (
                (
                    [Территории__РФ].[Территории__РФ].CurrentMember.parent.UniqueNAme = "[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра]"
                )and (not [ISDataMember])and
                [Территории__РФ].[Территории__РФ].CurrentMember.children.count>0
            )
        )
    } on rows
from [СТАТ_Паспорт МО_СП и ГП]
]]>



  </query>
    <query id = "Grid">
    <![CDATA[with
    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Cur-IZA]
    as '([Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Все показатели].[Индекс загрязненности атмосферы],<%ChosenPeriod%>)'

    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Prev-IZA]
    as '([Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Все показатели].[Индекс загрязненности атмосферы],<%ChosenPrevPeriod%>)'

    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Cur-SZ]
    as '([Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Все показатели].[Степень загрязнения атмосферы],<%ChosenPeriod%>)'

    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Prev-SZ]
    as '([Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Все показатели].[Степень загрязнения атмосферы],<%ChosenPrevPeriod%>)'

    member [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[substance]
    as '([Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Все показатели].[Вещества, вносящие основной вклад в загрязнение атмосферы],<%ChosenPeriod%>)'

select
   -- non empty
    {
        [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Белоярский муниципальный район].[Белоярский],
        [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Березово],
        [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Город Ханты-Мансийск],
        [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Город Нефтеюганск],
        [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Город Нижневартовск],
        [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Город Радужный]
    }on rows,
    --non empty
    {
        [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Cur-IZA]   ,
        [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Prev-IZA]  ,
        [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Cur-SZ]    ,
        [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[Prev-SZ]   ,
        [Экология__Атмосферный воздух].[Экология__Атмосферный воздух].[substance]
    } on columns
FROM  [СТАТ_Экология_Атмосферный воздух]
where
    (
        [Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - ДепЭкологии ХМАО-Югры],
        [Группировки__Экология_Атмосферный воздух].[Группировки__Экология_Атмосферный воздух].[Группировка].[По городам и районам],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год].[2010],
        [Measures].[За период]
    )
    /*
    <%ChosenPrevPeriod%>
    <%ChosenPeriod%>
    */
    
    ]]>
  </query>

  
</root>