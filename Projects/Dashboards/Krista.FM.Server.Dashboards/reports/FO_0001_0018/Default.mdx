<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0001_0018_date">
    <![CDATA[
-- FO_0001_0018_detail_date
-- <#[ФО_МесОтч_Доходы]#>
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Поступило за период]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_Доходы бюджета]
  ]]>
  </query>

  <query id="FO_0001_0018_grid">
    <![CDATA[
-- FO_0001_0018_detail_grid

  
    with      
    member Measures.[Уровень]    
    as '[КД].[Сопоставимый].CurrentMember.Level.Name'    
    member Measures.[Код] 
    as 'IIF
        (
            [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
            [Администратор].[Сопоставим].CurrentMember.Properties("Код"),
            [КД].[Сопоставимый].CurrentMember.Properties("Код")
        )'     
    member Measures.[Назначено]    
    as 'Round(IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            LookupCube 
        (
            "[ФО_МесОтч_Доходы]",
            " 
            (
                [Measures].[Годовые назначения],
                [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
                [ТипДокумента].[СКИФ].[Все].[Отчетность главных распорядителей средств бюджета],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                " + MemberToStr 
                (
                    [КД].[Сопоставимый].CurrentMember 
                ) + " ,
                " + MemberToStr 
                (
                    [Администратор].[Сопоставим].CurrentMember 
                ) + " 
            ) " 
        )/1000),7)' 
    member Measures.[Исполнено (Бюджет)]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                [КД].[Сопоставимый].DefaultMember,
                IIF   
                (
                    [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>].Name = "Декабрь",
                    null,
                    (
                        [Measures].[Поступило с начала года],
                       [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>],
                       [КД].[Сопоставимый].CurrentMember
                    )/1000   
                )   
            )
           
        )),7)'      
    member Measures.[Исполнено %]    
    as 'IIF    
        (
            Measures.[Назначено] = 0,
            null,
            Measures.[Исполнено за год]/Measures.[Назначено]    
        )'    
    member Measures.[Остаток до исполнения бюджета]    
    as 'Measures.[Назначено] - Measures.[Исполнено за год]'    
    member Measures.[Назначено прошлый год]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                [КД].[Сопоставимый].DefaultMember,
                IIF   
                (
                    (
                        LookupCube    
                        (
                            "[ФО_ГодОтч_Доходы]",
                            "    
                            (
                                [Measures].[Назначено],
                                [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                                " + MemberToStr    
                                (
                                    [КД].[Сопоставимый].CurrentMember    
                                ) + " ,
                                " + MemberToStr    
                                (
                                    [Администратор].[Сопоставим].CurrentMember    
                                ) + "    
                            ) "    
                        )/1000   
                    ) = null,
                    LookupCube    
                    (
                        "[ФО_АС Бюджет_План доходов]",
                        "    
                        (
                            [Measures].[План],
                            [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                            [Роспись Кассовый план].[Все].[Кассовый план],
                            " + MemberToStr    
                            (
                                [КД].[Сопоставимый].CurrentMember    
                            ) + " ,
                            " + MemberToStr    
                            (
                                [Администратор].[Сопоставим].CurrentMember    
                            ) + "    
                        )"    
                    )/1000,
                    LookupCube    
                    (
                        "[ФО_ГодОтч_Доходы]",
                        "    
                        (
                            [Measures].[Назначено],
                            [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                            " + MemberToStr    
                            (
                                [КД].[Сопоставимый].CurrentMember    
                            ) + " ,
                            " + MemberToStr    
                            (
                                [Администратор].[Сопоставим].CurrentMember    
                            ) + "    
                        ) "    
                    )/1000   
                )   
            )   
        )),7)'    
    member Measures.[Исполнено прошлый год]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                SUM 
                (
                    {
                        Descendants 
                        (
                            [Доходы],
                            [КД].[Сопоставимый].[Статья],
                            SELF 
                        ) 
                    } 
                ),
                
                    (
                        [Measures].[Поступило с начала года],
                        [Период].[Период].[Данные всех периодов].[<%period_last_year%>]  
                    )/1000
            )   
        )),7)'    
    member Measures.[Исполнено за год прошлый год]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                [КД].[Сопоставимый].DefaultMember,
                (
                    [Measures].[Поступило с начала года],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>].[<%day%>]
                )/1000   
            )   
        )),7)'   
    member Measures.[Исполнено % прошлый год]    
    as 'IIF   
        (
            Measures.[Назначено прошлый год] = 0,
            null,
            Measures.[Исполнено за год прошлый год]/Measures.[Назначено прошлый год]   
        )'    
    member Measures.[Темп роста плановых назначений]    
    as 'IIF   
        (
            Measures.[Назначено прошлый год] = 0,
            null,
            Measures.[Назначено]/Measures.[Назначено прошлый год]   
        )'    
    member Measures.[Темп роста  выполнения бюджетных назначений ]    
    as 'IIF(
    (IIF   
        (
            Measures.[Исполнено за год прошлый год] = 0,
            null,
            Measures.[Исполнено за год]/Measures.[Исполнено за год прошлый год]   
        )) < 0, null,
        IIF   
        (
            Measures.[Исполнено за год прошлый год] = 0,
            null,
            Measures.[Исполнено за год]/Measures.[Исполнено за год прошлый год]   
        ))'    
    member Measures.[Прирост / снижение доходов]    
    as 'Measures.[Исполнено за год] - Measures.[Исполнено за год прошлый год]'    
    member Measures.[kduniquename]    
    as '[КД].[Сопоставимый].CurrentMember.UniqueName'    
    member Measures.[Доходы]
    as 'IIF
        (
            [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
            [Администратор].[Сопоставим].CurrentMember.name,
            IIF([КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
            [Администратор].[Сопоставим].CurrentMember.name + " (за исключением невыясненных поступлений)",
            [КД].[Сопоставимый].CurrentMember.name
        ))'
    set [Доходы искл] 
    as ' 
        {
            {
                Descendants 
                (
                    [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [КД].[Сопоставимый].[Элемент подстатьи],
                    SELF_AND_BEFORE 
                ) 
            } - 
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ] 
            }- 
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] 
            } 
        }' 
    member [КД].[Сопоставимый].[Искл]
    as '[КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ' 
    set [Доходы]      
    as '      
        {
            {
                Descendants      
                (
                    [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [КД].[Сопоставимый].[Элемент подстатьи],
                    SELF_AND_BEFORE      
                )      
            } -      
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]      
            }      
        }'      
    member [КД].[Сопоставимый].[Итого]       
    as '[КД].[Сопоставимый].DefaultMember'       
    set [Все Администраторы]       
    as '       
        {
            [Администратор].[Сопоставим].[Все администраторы].Children       
        }-       
        {
            [Администратор].[Сопоставим].[Все администраторы].[Несопоставленные данные]       
        } -       
        {
            [Администратор].[Сопоставим].[Все администраторы].[Неуказанная ведомственная статья]       
        }'       
    set [Администраторы]       
    as '{<%adm%>}'        
    member Measures.[Исполнено (ежем. отч.)]       
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                SUM 
                (
                    {
                        Descendants 
                        (
                            [Доходы],
                            [КД].[Сопоставимый].[Статья],
                            SELF 
                        ) 
                    } 
                ),IIF   
                (
                    [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>].Name = "Декабрь",
                    null,
        IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
             IIF  
                            (
                                [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[ИТОГО ДОХОДОВ],
                                sum
                                (
                                    {[Администратор].[Сопоставим].[Все администраторы].Children},
                                    LookupCube 
                                    (
                                        "[ФО_МесОтч_Доходы]",
                                        " 
                                        (
                                            [Measures].[Факт],
                                            [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>],
                                            [ТипДокумента].[СКИФ].[Все].[Отчетность главных распорядителей средств бюджета],
                                            [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                                            [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                                            " + MemberToStr 
                                            (
                                                [Администратор].[Сопоставим].CurrentMember 
                                            ) + "  
                                        ) " 
                                    )/1000
                                ),
            LookupCube       
        (
            "[ФО_МесОтч_Доходы]",
            "       
            (
                [Measures].[Факт],
                [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>],
                [ТипДокумента].[СКИФ].[Все].[Отчетность главных распорядителей средств бюджета],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                " + MemberToStr       
                (
                    [КД].[Сопоставимый].CurrentMember       
                ) + " ,
                " + MemberToStr       
                (
                    [Администратор].[Сопоставим].CurrentMember       
                ) + "       
            ) "       
        )/1000))))),7)' 
    member Measures.[Исполнено за месяц]       
    as 'Round(
        (
            [Measures].[Поступило с начала месяца],
            [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>].[<%day%>]       
        ),7)/1000' 
     member Measures.[Исполнено за год] 
    as 'Round(
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
     IIF((
            Measures.[Исполнено (ежем. отч.)],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        ) = NULL, (
            Measures.[Исполнено (Бюджет)],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        ), (
            Measures.[Исполнено (ежем. отч.)],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        )) + 
        (
            Measures.[Исполнено за месяц],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        )),7)' 
    member [Администратор].[Сопоставим].[Все администраторы].[Непустая]      
    as '1'
    member [Администратор].[Сопоставим].[Все администраторы].[ИТОГО ДОХОДОВ]
    as 'SUM({[Администратор].[Сопоставим].[Все администраторы].Children},Measures.CurrentMember)'
    member [КД].[Сопоставимый].[Все коды доходов].[ИТОГО ДОХОДОВ]
    as '[КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]'
select
    {
        Measures.[Доходы],
        Measures.[Код],
        Measures.[Исполнено (ежем. отч.)],
        Measures.[Исполнено (Бюджет)],
        Measures.[Исполнено за месяц],
        Measures.[Исполнено за год],
        Measures.[Исполнено прошлый год],
        Measures.[Исполнено за год прошлый год],
        Measures.[Темп роста  выполнения бюджетных назначений ],
        Measures.[Уровень]    
    } on columns,
    filter
    (
        {
            {
                [Администратор].[Сопоставим].[Все администраторы].[Непустая]
            }
            *
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]
            },
            {
                [Администратор].[Сопоставим].[Все администраторы].[ИТОГО ДОХОДОВ]
            }
            *
            {
                [КД].[Сопоставимый].[Все коды доходов].[ИТОГО ДОХОДОВ]
            },
            [Администраторы]
            *
            {
                {[КД].[Сопоставимый].[Итого]}+ {[КД].[Сопоставимый].[Искл]} + [Доходы]
            }
        }, (Measures.CurrentMember <> Null)
    ) on rows       
from [ФО_Доходы бюджета]       
    
  ]]>
  </query>

  <query id="FO_0001_0018_grid_light">
    <![CDATA[
-- FO_0001_0018_detail_grid

  
    with      
    member Measures.[Уровень]    
    as '[КД].[Сопоставимый].CurrentMember.Level.Name'    
    member Measures.[Код]    
    as '[Администратор].[Сопоставим].CurrentMember.Properties("Код")' -- Уровни бюджета     
    member Measures.[Назначено]    
    as 'Round(IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            LookupCube 
        (
            "[ФО_МесОтч_Доходы]",
            " 
            (
                [Measures].[Годовые назначения],
                [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
                [ТипДокумента].[СКИФ].[Все].[Отчетность главных распорядителей средств бюджета],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                " + MemberToStr 
                (
                    [КД].[Сопоставимый].CurrentMember 
                ) + " ,
                " + MemberToStr 
                (
                    [Администратор].[Сопоставим].CurrentMember 
                ) + " 
            ) " 
        )/1000),7)' 
    member Measures.[Исполнено (Бюджет)]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                [КД].[Сопоставимый].DefaultMember,
                IIF   
                (
                    [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>].Name = "Декабрь",
                    null,
                    (
                        [Measures].[Поступило с начала года],
                       [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>],
                       [КД].[Сопоставимый].CurrentMember
                    )/1000   
                )   
            )
           
        )),7)'      
    member Measures.[Исполнено %]    
    as 'IIF    
        (
            Measures.[Назначено] = 0,
            null,
            Measures.[Исполнено за год]/Measures.[Назначено]    
        )'    
    member Measures.[Остаток до исполнения бюджета]    
    as 'Measures.[Назначено] - Measures.[Исполнено за год]'    
    member Measures.[Назначено прошлый год]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                [КД].[Сопоставимый].DefaultMember,
                IIF   
                (
                    (
                        LookupCube    
                        (
                            "[ФО_ГодОтч_Доходы]",
                            "    
                            (
                                [Measures].[Назначено],
                                [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                                " + MemberToStr    
                                (
                                    [КД].[Сопоставимый].CurrentMember    
                                ) + " ,
                                " + MemberToStr    
                                (
                                    [Администратор].[Сопоставим].CurrentMember    
                                ) + "    
                            ) "    
                        )/1000   
                    ) = null,
                    LookupCube    
                    (
                        "[ФО_АС Бюджет_План доходов]",
                        "    
                        (
                            [Measures].[План],
                            [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                            [Роспись Кассовый план].[Все].[Кассовый план],
                            " + MemberToStr    
                            (
                                [КД].[Сопоставимый].CurrentMember    
                            ) + " ,
                            " + MemberToStr    
                            (
                                [Администратор].[Сопоставим].CurrentMember    
                            ) + "    
                        )"    
                    )/1000,
                    LookupCube    
                    (
                        "[ФО_ГодОтч_Доходы]",
                        "    
                        (
                            [Measures].[Назначено],
                            [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                            " + MemberToStr    
                            (
                                [КД].[Сопоставимый].CurrentMember    
                            ) + " ,
                            " + MemberToStr    
                            (
                                [Администратор].[Сопоставим].CurrentMember    
                            ) + "    
                        ) "    
                    )/1000   
                )   
            )   
        )),7)'    
    member Measures.[Исполнено прошлый год]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                SUM 
                (
                    {
                        Descendants 
                        (
                            [Доходы],
                            [КД].[Сопоставимый].[Статья],
                            SELF 
                        ) 
                    } 
                ),
                
                    (
                        [Measures].[Поступило с начала года],
                        [Период].[Период].[Данные всех периодов].[<%period_last_year%>]  
                    )/1000
            )   
        )),7)'    
    member Measures.[Исполнено за год прошлый год]    
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
            IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                [КД].[Сопоставимый].DefaultMember,
                (
                    [Measures].[Поступило с начала года],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>].[<%day%>]
                )/1000   
            )   
        )),7)'   
    member Measures.[Исполнено % прошлый год]    
    as 'IIF   
        (
            Measures.[Назначено прошлый год] = 0,
            null,
            Measures.[Исполнено за год прошлый год]/Measures.[Назначено прошлый год]   
        )'    
    member Measures.[Темп роста плановых назначений]    
    as 'IIF   
        (
            Measures.[Назначено прошлый год] = 0,
            null,
            Measures.[Назначено]/Measures.[Назначено прошлый год]   
        )'    
    member Measures.[Темп роста  выполнения бюджетных назначений ]    
    as 'IIF(
    (IIF   
        (
            Measures.[Исполнено за год прошлый год] = 0,
            null,
            Measures.[Исполнено за год]/Measures.[Исполнено за год прошлый год]   
        )) < 0, null,
        IIF   
        (
            Measures.[Исполнено за год прошлый год] = 0,
            null,
            Measures.[Исполнено за год]/Measures.[Исполнено за год прошлый год]   
        ))'    
    member Measures.[Прирост / снижение доходов]    
    as 'Measures.[Исполнено за год] - Measures.[Исполнено за год прошлый год]'    
    member Measures.[kduniquename]    
    as '[КД].[Сопоставимый].CurrentMember.UniqueName'    
    member Measures.[Доходы]
    as '[Администратор].[Сопоставим].CurrentMember.name'
    set [Доходы искл] 
    as ' 
        {
            {
                Descendants 
                (
                    [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [КД].[Сопоставимый].[Элемент подстатьи],
                    SELF_AND_BEFORE 
                ) 
            } - 
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ] 
            }- 
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] 
            } 
        }' 
    member [КД].[Сопоставимый].[Искл]
    as '[КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ' 
    set [Доходы]      
    as '      
        {
            {
                Descendants      
                (
                    [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [КД].[Сопоставимый].[Элемент подстатьи],
                    SELF_AND_BEFORE      
                )      
            } -      
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]      
            }      
        }'      
    member [КД].[Сопоставимый].[Итого]       
    as '[КД].[Сопоставимый].DefaultMember'       
    set [Все Администраторы]       
    as '       
        {
            [Администратор].[Сопоставим].[Все администраторы].Children       
        }-       
        {
            [Администратор].[Сопоставим].[Все администраторы].[Несопоставленные данные]       
        } -       
        {
            [Администратор].[Сопоставим].[Все администраторы].[Неуказанная ведомственная статья]       
        }'       
    set [Администраторы]       
    as '{<%adm%>}'        
    member Measures.[Исполнено (ежем. отч.)]       
    as 'Round(IIF 
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Искл],
                [КД].[Сопоставимый].[Итого] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] - [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] ,
                IIF   
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Итого],
                SUM 
                (
                    {
                        Descendants 
                        (
                            [Доходы],
                            [КД].[Сопоставимый].[Статья],
                            SELF 
                        ) 
                    } 
                ),IIF   
                (
                    [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>].Name = "Декабрь",
                    null,
        IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
             IIF  
                            (
                                [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[ИТОГО ДОХОДОВ],
                                sum
                                (
                                    {[Администраторы]},
                                    LookupCube 
                                    (
                                        "[ФО_МесОтч_Доходы]",
                                        " 
                                        (
                                            [Measures].[Факт],
                                            [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>],
                                            [ТипДокумента].[СКИФ].[Все].[Отчетность главных распорядителей средств бюджета],
                                            [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                                            <%kd%>,
                                            " + MemberToStr 
                                            (
                                                [Администратор].[Сопоставим].CurrentMember 
                                            ) + "  
                                        ) " 
                                    )/1000
                                ),
            LookupCube       
        (
            "[ФО_МесОтч_Доходы]",
            "       
            (
                [Measures].[Факт],
                [Период].[Период].[Данные всех периодов].[<%LastYear%>].[<%LastHalf%>].[<%LastQuart%>].[<%LastMonth%>],
                [ТипДокумента].[СКИФ].[Все].[Отчетность главных распорядителей средств бюджета],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                " + MemberToStr       
                (
                    [КД].[Сопоставимый].CurrentMember       
                ) + " ,
                " + MemberToStr       
                (
                    [Администратор].[Сопоставим].CurrentMember       
                ) + "       
            ) "       
        )/1000))))),7)' 
    member Measures.[Исполнено за месяц]       
    as 'Round(
        (
            [Measures].[Поступило с начала месяца],
            [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>].[<%day%>]       
        ),7)/1000' 
     member Measures.[Исполнено за год] 
    as 'Round(
                IIF   
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы].[Непустая],
            111111,
     IIF((
            Measures.[Исполнено (ежем. отч.)],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        ) = NULL, (
            Measures.[Исполнено (Бюджет)],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        ), (
            Measures.[Исполнено (ежем. отч.)],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        )) + 
        (
            Measures.[Исполнено за месяц],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        )),7)' 
    member [Администратор].[Сопоставим].[Все администраторы].[Непустая]      
    as '1'
    member [Администратор].[Сопоставим].[Все администраторы].[ИТОГО ДОХОДОВ] 
    as 'SUM
        (
            [Администраторы],
            Measures.CurrentMember
        )'
select
    {
        Measures.[Доходы],
        Measures.[Код],
        Measures.[Исполнено (ежем. отч.)],
        Measures.[Исполнено (Бюджет)],
        Measures.[Исполнено за месяц],
        Measures.[Исполнено за год],
        Measures.[Исполнено прошлый год],
        Measures.[Исполнено за год прошлый год],
        Measures.[Темп роста  выполнения бюджетных назначений ],
        Measures.[Уровень]    
    } on columns,
    filter
    (
        {
            {
                [Администратор].[Сопоставим].[Все администраторы].[Непустая]
            }
            *
            {
                [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]
            },
            {
                [Администратор].[Сопоставим].[Все администраторы].[ИТОГО ДОХОДОВ]
            }
            *
            {
                {<%kd%>}
            },
            [Администраторы]
            *
            {
                {<%kd%>}
            }
        }, (Measures.CurrentMember <> Null)
    ) on rows       
from [ФО_Доходы бюджета]       
    
  ]]>
  </query>

  <query id="FO_0001_0018_adm">
    <![CDATA[
-- FO_0001_0018_adm
with
    member [Measures].[Уровень]
    as 'IIF
        (
            [Администратор].[Сопоставим].CurrentMember is [Администратор].[Сопоставим].[Все администраторы ],
            0,
            1
        )'
    member [Measures].[Уникальное имя]
    as '[Администратор].[Сопоставим].CurrentMember.UniqueName'
    member [Measures].[Имя]
    as '[Администратор].[Сопоставим].CurrentMember.Name'
    member [Администратор].[Сопоставим].[Все администраторы ]
    as '[Администратор].[Сопоставим].[Все администраторы]'
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]
    }ON COLUMNS,
    {
        {[Администратор].[Сопоставим].[Все администраторы ]}+
        {[Администратор].[Сопоставим].[Все администраторы].Children - {
                    [Администратор].[Сопоставим].[Все администраторы].[Несопоставленные данные],
                    [Администратор].[Сопоставим].[Все администраторы].[Неуказанная ведомственная статья],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление рыболовства Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Росприроднадзор],
                    [Администратор].[Сопоставим].[Все администраторы].[Региональное агентство по недропользованию],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное агентство водных ресурсов],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное агентство лесного хозяйства],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное агентство по культуре и кинематографии],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральная служба по надзору в сфере здравоохранения и социального развития],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное агентство по здравоохранению и социальному развитию],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное агентство по образованию],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление Россвязьнадзора по Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное агентство по сельскому хозяйству],
                    [Администратор].[Сопоставим].[Все администраторы].[Фельдъегерская служба],
                    [Администратор].[Сопоставим].[Все администраторы].[Комитет историко-культурного наследия Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Министерство финансов РФ],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное дорожное агентство],
                    [Администратор].[Сопоставим].[Все администраторы].[Министерство экономического развития и торговли РФ],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральная служба по надзору в сфере защиты прав потребителей и благополучия человека],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление лесами Федеральной службы лесного хозяйства Российской Федерации],
                    [Администратор].[Сопоставим].[Все администраторы].[Государственная инспекция труда],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральное архивное агентство],
                    [Администратор].[Сопоставим].[Все администраторы].[Вологдастат],
                    [Администратор].[Сопоставим].[Все администраторы].[Фед. агентство по управлению гос имуществом],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральная служба по интеллектуальной собственности патентам и товарным знакам],
                    [Администратор].[Сопоставим].[Все администраторы].[Вологодский центр по гидрометеорологии и мониторингу окр среды],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление Министерства РФ по налогам и сборам],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление Федеральной службы безопасности Российской Федерации по Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральная миграционная служба],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление Государственного комитета по контролю за оборотом наркотических средств и психотропных веществ по Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[ВНКЦ ЦЭМИ РАН],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральная служба исполнения наказаний],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление Федеральной регистрационной службы по Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Федеральная служба судебных приставов],
                    [Администратор].[Сопоставим].[Все администраторы].[Государственная дума федерального собрания],
                    [Администратор].[Сопоставим].[Все администраторы].[Совет Федерации Федерального Собрания РФ],
                    [Администратор].[Сопоставим].[Все администраторы].[Отделение Пенсионного Фонда РФ по Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Фонд социального страхования],
                    [Администратор].[Сопоставим].[Все администраторы].[Прокуратура Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Областной суд],
                    [Администратор].[Сопоставим].[Все администраторы].[Управление судебного департамента при Верховном суде РФ в Вологодской области],
                    [Администратор].[Сопоставим].[Все администраторы].[Вологодский областной совет Российского оборонного спортивно-технического общества],
                    [Администратор].[Сопоставим].[Все администраторы].[Вологодский областной Центр контроля качества]
                }}
    } ON ROWS
FROM    [ФО_Доходы бюджета]  
  ]]>
  </query>
  <query id="FO_0001_0018_KD">
    <![CDATA[
-- FO_0001_0018_KD
with   
    member [Measures].[Уровень]         
    as 'IIF         
        (
            [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
            0,
            IIF 
            (
                [КД].[Сопоставимый].CurrentMember.level.name = "Статья",
                1,
                IIF 
                (
                    [КД].[Сопоставимый].CurrentMember.level.name = "Подстатья",
                    2,
                    3 
                ) 
            )  
        )'   
    member [Measures].[Уникальное имя]   
    as '[КД].[Сопоставимый].CurrentMember.UniqueName'  
    member [Measures].[Имя]   
    as '[КД].[Сопоставимый].CurrentMember.Name'  
    member [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]' 
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]   
    }ON COLUMNS,
    {
        {
            Filter
            (
                Descendants 
                (
                    [КД].[Сопоставимый].[Все коды доходов].[Всего доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [КД].[Сопоставимый].[Элемент подстатьи],
                    SELF_AND_BEFORE  
                ),
                not
                (
                    [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ) 
        }   
    } ON ROWS   
FROM    [ФО_Доходы бюджета]   
  ]]>
  </query>
</root>