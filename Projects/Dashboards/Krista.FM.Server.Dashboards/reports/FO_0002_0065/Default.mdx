<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0002_0065_date">
    <![CDATA[
-- FO_0002_0065_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as 'Tail 
        (
            Filter 
            (
                [Период__Период].[Период__Период].Members,
                not IsEmpty([Measures].[Расход]) 
            ),
            1 
        )' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from  [ФО_АС Бюджет_КазнИсп_Факт расхода] 
]]>
  </query>

  <query id="FO_0002_0065_grid">
    <![CDATA[
		-- FO_0002_0065_grid
WITH     
    member [Финансирование]     
    as 'LookupCube     
        (
            "ФО_АС Бюджет_КазнИсп_Финансирование",
            "     
            (
                [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов].[Региональные целевые программы].[Расходы на финансирование региональных целевых программ в области национальной экономики].[Долгосрочная целевая программа ""Энергосбережение и повышение энергетической эффективности в Алтайском крае"" на 2011-2015 годы и на перспективу до 2020 года],
                [Measures].[Финансирование нараст итог],
                <%period_end_year%>,
                " +  MemberToStr     
                (
                    [Администратор__Сопоставим].[Администратор__Сопоставим].currentmember     
                ) + "     
            )    "     
        )'     
    member [Кассовый расход]     
    as 'LookupCube     
        (
            "ФО_АС Бюджет_КазнИсп_Факт расхода",
            "     
            (
                aggregate     
                ({<%period_first_year%>:<%period_cur_date%>}
                     ,
                    aggregate     
                    (
                        {
                            [Блоки казначейства].[Блоки казначейства].[Все блоки казначейства].[Учет кассовых выплат] ,
                            [Блоки казначейства].[Блоки казначейства].[Все блоки казначейства].[Утверждение ОФ]     
                        },
                        (
                            [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов].[Региональные целевые программы].[Расходы на финансирование региональных целевых программ в области национальной экономики].[Долгосрочная целевая программа ""Энергосбережение и повышение энергетической эффективности в Алтайском крае"" на 2011-2015 годы и на перспективу до 2020 года],
                            [Measures].[Расход],
                            " +  MemberToStr     
                            (
                                [Администратор__Сопоставим].[Администратор__Сопоставим].currentmember     
                            ) + "     
                        )     
                    )     
                )     
            )    "     
        )'     
    member [Measures].[Ассигнования нараст итог ]     
    as '[Measures].[Ассигнования нараст итог]/<%kd_level_un%>'     
    member [Финансирование ]   
    as 'IIF   
        (
            IsEmpty([Финансирование]),
            null,
            [Финансирование]/<%kd_level_un%>  
        )'  
    member [Кассовый расход ]  
    as 'IIF 
        (
            IsEmpty([Кассовый расход]),
            null,
            [Кассовый расход]/<%kd_level_un%> 
        )'  
    member [Остаток на счете управления]     
    as 'IIF     
        (
            IsEmpty([Финансирование ]),
            0,
            IIF
            (
              IsEmpty([Кассовый расход]),
              [Финансирование ],
              [Финансирование ]-[Кассовый расход ]
            )  
        )'     
    member [% освоения перечисленных средств]     
    as 'IIF     
        (
            IsEmpty([Финансирование ]) or IsEmpty ( [Кассовый расход ]  )or ([Финансирование ]=0),
            null,
            [Кассовый расход ]/[Финансирование ]  
        )'     
    member [Остаток плановых назначений]     
    as 'IIF     
        (
            IsEmpty     
            (
                [Measures].[Ассигнования нараст итог ] 
            ) and IsEmpty([Кассовый расход ]),
            null,
            [Measures].[Ассигнования нараст итог ]-[Кассовый расход ] 
        )'     
    member [Остаток плановых назначений %]     
    as 'IIF     
        (
            IsEmpty([Остаток плановых назначений]) or IsEmpty     
            (
                [Measures].[Ассигнования нараст итог]      
            )or     
            (
                [Measures].[Ассигнования нараст итог]=0    
            ),
            null,
            [Остаток плановых назначений]/[Measures].[Ассигнования нараст итог ]     
        )'      
    SET [NonFilterColumnSet]     
    AS '     
        {   [Measures].[Код],
            [Measures].[Наименование],
            [Measures].[Ассигнования нараст итог ]  ,
            [Финансирование ] ,
            [Кассовый расход ] ,
            [Остаток на счете управления],
            [% освоения перечисленных средств],
            [Остаток плановых назначений],
            [Остаток плановых назначений %]     
        }'     
    SET [NonFilterRowSet]     
    AS ' filter     
        (
            Descendants     
            (
                [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы] ,
                [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                SELF     
            ),
            not [Администратор__Сопоставим].[Администратор__Сопоставим].currentmember.is_datamember and not isEmpty    
            (
                [Measures].[Ассигнования нараст итог]     
            )     
        ) '   
    member [Measures].[Код] as'[Администратор__Сопоставим].[Администратор__Сопоставим].Properties("Код") ' 
    member [Measures].[Наименование] 
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Name'
SELECT
    {[NonFilterColumnSet]} ON COLUMNS ,
    NON EMPTY     
    {
        {
            [NonFilterRowSet] ,
            {
                [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы]     
            }     
        }     
    } DIMENSION PROPERTIES [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор].[Код]  ON ROWS     
FROM [ФО_АС Бюджет_План расходов]     
WHERE     
    (
        <%period_end_year%> ,
        <%period_last_year%> ,
        [Роспись Кассовый план].[Роспись Кассовый план].[Все].[Кассовый план] ,
        [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[СБР, кассовый план (расходы)] ,
        [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов].[Региональные целевые программы].[Расходы на финансирование региональных целевых программ в области национальной экономики].[Долгосрочная целевая программа "Энергосбережение и повышение энергетической эффективности в Алтайском крае" на 2011-2015 годы и на перспективу до 2020 года]     
    )                      
    ]]>
  </query>
</root>