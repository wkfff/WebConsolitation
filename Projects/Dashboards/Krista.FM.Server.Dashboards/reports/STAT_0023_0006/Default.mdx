<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="STAT_0023_0006_grid">
    <![CDATA[
-- STAT_0023_0006_grid 
with 
    set [Периоды] 
    as ' 
        {
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%period_year%>],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%period_year%>].PrevMember 
        }' 
    set [НК ЛУКОЙЛ] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[НК ЛУКОЙЛ] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "НК ЛУКОЙЛ" 
        )' 
    set [ТНК-ВР - Менеджмент] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[ТНК-ВР - Менеджмент] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "ТНК-ВР - Менеджмент" 
        )' 
    set [ОАО "Сургутнефтегаз"] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[ОАО "Сургутнефтегаз"] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "ОАО ""Сургутнефтегаз""" 
        )' 
    set [НК РосНефть] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[НК РосНефть] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "НК РосНефть" 
        )' 
    set [НК Славнефть] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[НК Славнефть] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "НК Славнефть" 
        )' 
    set [ОАО "Газпромнефть"] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[ОАО "Газпромнефть"] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "ОАО ""Газпромнефть""" 
        )' 
    set [ОАО НК "Русснефть"] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[ОАО НК "Русснефть"] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "ОАО НК ""Русснефть""" 
        )' 
    set [Прочие предприятия] 
    as ' 
        {
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия].[Прочие предприятия] 
        }+ Filter 
        (
            [Все компании],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = "Прочие предприятия" 
        )' 
    set [Компании] 
    as ' 
        {
            [НК ЛУКОЙЛ],
            [ТНК-ВР - Менеджмент],
            [ОАО "Сургутнефтегаз"],
            [НК РосНефть],
            [НК Славнефть],
            [ОАО "Газпромнефть"],
            [ОАО НК "Русснефть"],
            [Прочие предприятия] 
        }' 
    set [Все компании] 
    as '[Организации__Реестр предприятий].[Организации__Реестр предприятий].Children' 
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Тип строки] 
    as 'IIF 
        (
            [Measures].CurrentMember is [Measures].[За период],
            "0",
            IIF 
            (
                [Measures].CurrentMember is [Measures].[Прирост цепной],
                "1",
                "2" 
            ) 
        )' 
    member [Measures].[За период прошлый год] 
    as ' 
        (
            [Measures].[За период],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%period_year%>].PrevMember 
        )' 
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Имя] 
    as '[Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Name' 
    member [Measures].[Отклонение] 
    as ' IIF 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Примечание],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание"),
            IIF 
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Имя],
                [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Name,
                IIF
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Уровень],
                    IIF 
                    (
                        [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Name,
                        0,
                        1 
                    ),
                    IIF 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Тип строки] OR [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Уровень],
                        1,
                        IIF 
                        (
                            IsEmpty 
                            (
                                [Measures].[За период прошлый год] 
                            ) or 
                            (
                                [Measures].[За период прошлый год] 
                            ) = 0 or IsEmpty   ( [Measures].[За период] ) or ( [Measures].[За период] ) = 0,
                            null,
                            [Measures].[За период] - [Measures].[За период прошлый год] 
                        ) 
                    ) 
                )
            )
        )' 
    member [Measures].[Темп прироста] 
    as ' IIF 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Примечание],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание"),
            IIF 
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Имя],
                [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Name,
                IIF
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Уровень],
                    IIF 
                    (
                        [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Name,
                        0,
                        1 
                    ),
                    IIF 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Тип строки],
                        2,
                        IIF 
                        (
                            IsEmpty 
                            (
                                [Measures].[За период прошлый год] 
                            ) or 
                            (
                                [Measures].[За период прошлый год] 
                            ) = 0 or IsEmpty  ( [Measures].[За период] ) or ( [Measures].[За период] ) = 0,
                            null,
                            [Measures].[За период] / [Measures].[За период прошлый год] - 1 
                        ) 
                    ) 
                )
            )
        )' 
    member [Measures].[Расчетные показатели] 
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Показатель] or [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Тип строки]' 
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Уровень] 
    as 'IIF 
        (
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание") = [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Name,
            0,
            1 
        )' 
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Примечание] 
    as '[Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Примечание")' 
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Единица измерения] 
    as '[Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Properties("Единица измерения")' 
select
    non empty 
    {
        {
            [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели] 
        } 
        * 
        {
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Имя] 
        } + 
        {
            [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Коэффициент утилизации газа],
            [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Сожжено в факелах] 
        } 
        *   {   [Периоды]    } + 
        {
            [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели] 
        } 
        * 
        {
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Примечание],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Тип строки],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Уровень] 
        } 
    } on columns,
    Filter 
    (
        { [Компании] } 
        * 
        {
            [Measures].[За период],
            [Measures].[Отклонение],
            [Measures].[Темп прироста] 
        },
        not 
        (
            IsEmpty([Measures].[За период]) 
        ) 
    ) on rows 
From  [СТАТ_Экология_Отходы производства]  
  ]]>
  </query>




  <query id="STAT_0023_0006_periodDigest">
    <![CDATA[
-- STAT_0023_0006_periodDigest  
with 
    set [Непустые периоды] 
    as 'Filter 
        (
            Descendants 
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
                SELF 
            ),
            (
                Count 
                (
                    [Показатели] 
                    * [Measures].[За период],
                    ExcludeEmpty 
                ) > 0 
            ) 
        ) ' 
    set [Показатели] 
    as ' [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия]' 
    member [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Имя] 
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name' 
    member [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Уникальное имя] 
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName' 
    member [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Уровень] 
    as '0' 
    member    [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Slicer] 
    as 'Aggregate 
        (
            {
                [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Коэффициент утилизации газа],
                [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Сожжено в факелах] 
            } 
        )' 
select
    {
        [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Имя],
        [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Уникальное имя],
        [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Уровень] 
    } on columns,
    { [Непустые периоды] } on rows 
from [СТАТ_Экология_Отходы производства] 
Where 
    (
        [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Slicer] 
    )     
  ]]>
  </query>

</root>