<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0001_0006_Samara_date">
    <![CDATA[
-- FO_0001_0006_Samara_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Дата принятия].[Период__Дата принятия].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Дата принятия].[Период__Дата принятия].[Данные всех периодов],
                    [Период__Дата принятия].[Период__Дата принятия].[День],
                    SELF
                ),
                ( [Measures].[Ассигнования], [Вид плана__Сопоставимый].[Вид плана__Сопоставимый].[Все].[Плановые документы по ГРБС , ОФ ГРБС])
                or ([Measures].[Ассигнования], [Вид плана__Сопоставимый].[Вид плана__Сопоставимый].[Все].[СБР])
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_АС Бюджет_План расходов]
where ([СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[Все субкоды ЭКР].[НЕПубличное нормативное обязательство, ИНВЕСТИЦИИ в объекты капитального строительства],
[Роспись Кассовый план].[Роспись Кассовый план].[Все].[Роспись])
]]>
  </query>

  <query id="FO_0001_0006_Samara_grid">
    <![CDATA[
-- FO_0001_0006_grid
WITH
    set [Администраторы]
    as 'Filter
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].Children,
            (
                StrToValue([Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")) >= 701
            ) and
            (
                StrToValue([Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")) <= 806
            )
        )'
    member [Measures].[СБР]
    as '
        (
            [Measures].[Ассигнования нараст итог],
            ([Вид плана__Сопоставимый].[Вид плана__Сопоставимый].[Все].[СБР],
            [Период__Дата принятия].[Период__Дата принятия].[Данные всех периодов].<%selected_period%>)
        ) '
    member [Measures].[ГРБС]
    as '
        (
            [Measures].[Ассигнования нараст итог],
            ([Вид плана__Сопоставимый].[Вид плана__Сопоставимый].[Все].[Плановые документы по ГРБС , ОФ ГРБС],
            [Период__Дата принятия].[Период__Дата принятия].[Данные всех периодов].<%selected_period%>)
        )'
        member [Measures].[Кассов.исполнение] 
    as ' LookupCube 
        (
            "[ФО_АС Бюджет_КазнИсп_Факт расхода]",
            " 
            (
                [Measures].[Расход с возвратом нараст итог],
                (
                    [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[Все субкоды ЭКР].[НЕПубличное нормативное обязательство, ИНВЕСТИЦИИ в объекты капитального строительства],
                    [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>,
                    " + MemberToStr 
                    (
                        [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember 
                    ) + " 
                )
            )" 
        ) ' 
    member [Measures].[Процент] 
    as 'IIF 
        (
            (([Measures].[СБР] = 0) or ([Measures].[СБР] = null)),
            null,
            [Measures].[Кассов.исполнение] / [Measures].[СБР]
        )' 
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Итого]
    as 'Sum([Администраторы])'
SELECT
    { [Measures].[СБР],
    [Measures].[ГРБС],
    [Measures].[Кассов.исполнение],
    [Measures].[Процент]  }ON COLUMNS ,
    NON EMPTY{ [Администраторы] + [Администратор__Сопоставим].[Администратор__Сопоставим].[Итого]} ON ROWS
FROM   [ФО_АС Бюджет_План расходов]
WHERE
    (
        [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[Все субкоды ЭКР].[НЕПубличное нормативное обязательство, ИНВЕСТИЦИИ в объекты капитального строительства],
        [Роспись Кассовый план].[Роспись Кассовый план].[Все].[Роспись]
    )
    ]]>
  </query>

</root>