<?xml version="1.0" encoding="windows-1251"?>
<root>  
<query id="sgm_0010_date">
    <![CDATA[
-- sgm_0010__date
-- <#[ФК_МесОтч_Расходы]#>
with
member Measures.[ДанныеНа] as '[Период].[Период].CurrentMember.UniqueName'
select
    {Measures.[ДанныеНа]} on columns,
    {Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )} on rows
from  [ФК_МесОтч_Расходы]
  ]]>
  </query>

  <query id="sgm_0010_grid">
    <![CDATA[
-- sgm_0010_grid 
-- <#[МФ РФ_Фонды];[ФК_МесОтч_Расходы]#>
with   
    member [РзПр].[Сопоставимый].[Группы расходов]       
    as 'Aggregate       
        (
            {
              <%kd_group%>     
            }       
        )'     
    member Measures.[Численность постоянного населения_Prev]  
    as 'IIF   
        (
            [Территории].[Сопоставимый].CurrentMember.Level.Name = "РФ",
            LookupCube   
            (
                "[МФ РФ_Фонды]",
                "   
                (
                    [Период].[Год].[Данные всех периодов].[<%period_last_year%>],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд финансовой поддержки регионов].[Численность постоянного населения],
                    " + MemberToStr   
                    (
                        [Территории].[Сопоставимый].CurrentMember.DataMember   
                    ) + "   
                )"   
            ),
            LookupCube   
            (
                "[МФ РФ_Фонды]",
                "   
                (
                    [Период].[Год].[Данные всех периодов].[<%period_last_year%>],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд финансовой поддержки регионов].[Численность постоянного населения],
                    " + MemberToStr   
                    (
                        [Территории].[Сопоставимый].CurrentMember   
                    ) + "   
                )"   
            )   
        )'   
    member Measures.[Численность постоянного населения_This]   
    as 'IIF   
        (
            [Территории].[Сопоставимый].CurrentMember.Level.Name = "РФ",
            LookupCube   
            (
                "[МФ РФ_Фонды]",
                "   
                (
                    [Период].[Год].[Данные всех периодов].[<%period_year%>],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд финансовой поддержки регионов].[Численность постоянного населения],
                    " + MemberToStr   
                    (
                        [Территории].[Сопоставимый].CurrentMember.DataMember   
                    ) + "   
                )"   
            ),
            LookupCube   
            (
                "[МФ РФ_Фонды]",
                "   
                (
                    [Период].[Год].[Данные всех периодов].[<%period_year%>],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд финансовой поддержки регионов].[Численность постоянного населения],
                    " + MemberToStr   
                    (
                        [Территории].[Сопоставимый].CurrentMember   
                    ) + "   
                )"   
            )   
        )'   
    member Measures.[Численность постоянного населения]   
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Численность постоянного населения_This]   
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]   
        ) '   
    member Measures.[Исполнено_]   
    as 'IIF   
        (
            (
                (
                    [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ"  
                ) or   
                (
                    [Территории].[Сопоставимый].CurrentMember.Level.Name = "РФ"  
                )  
            ),
            Measures.[Исполнено],
            Sum   
            (
                Filter   
                (
                    [Территории].[Сопоставимый].Children,
                    (
                        Measures.[Численность постоянного населения] <> 0   
                    )   
                ),
                Measures.[Исполнено_]   
            )   
        ) '   
    member Measures.[Бюджетные расходы на душу населения]  
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Численность постоянного населения]   
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Исполнено_]/   
            (
                Measures.[Численность постоянного населения]   
                *10000   
            )   
        )'   
    member Measures.[Ранг бюдж.обесп. РФ]
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Бюджетные расходы на душу населения]  
            ) or [Территории].[Сопоставимый].CurrentMember.Level.Name <> "Субъект РФ",
            null,
            Rank   
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order   
                (
                    Filter   
                    (
                        [Территории].[Сопоставимый].[Субъект РФ].Members,
                        not IsEmpty   
                        (
                            Measures.[Бюджетные расходы на душу населения]  
                        )   
                    ),
                    Measures.[Бюджетные расходы на душу населения],
                    BDESC   
                ),
                Measures.[Бюджетные расходы на душу населения]  
            )   
        )'   
    member Measures.[Худший ранг бюдж.обесп. РФ]
    as 'max   
        (
            [Территории].[Сопоставимый].[Субъект РФ].Members,
            Measures.[Ранг бюдж.обесп. РФ]
        )'   
    member Measures.[ShortName]
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование")'   
    member Measures.[ParentShortName]   
    as '[Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование")'   
    member Measures.[ФО]   
    as 'IIF   
        (
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ" or [Территории].[Сопоставимый].CurrentMember.Level.Name = "Федеральный округ"   
            ) and  not
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember             
            ),
            IIF   
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ",
                Measures.[ParentShortName],
                Measures.[ShortName]   
            ),
            null   
        )'   
    member Measures.[Ранг бюдж.обесп. ФО]
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Бюджетные расходы на душу населения]  
            ) or [Территории].[Сопоставимый].CurrentMember.Level.Name <> "Субъект РФ",
            null,
            Rank   
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order   
                (
                    Filter   
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty   
                        (
                            Measures.[Бюджетные расходы на душу населения]  
                        )   
                    ),
                    Measures.[Бюджетные расходы на душу населения],
                    DESC   
                ),
                Measures.[Бюджетные расходы на душу населения]  
            )   
        )'   
    member Measures.[Худший ранг бюдж.обесп. ФО]
    as 'max   
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг бюдж.обесп. ФО]
        )'           
select
    {
        Measures.[ФО],
        Measures.[Численность постоянного населения],
        Measures.[Назначено],
        Measures.[Исполнено],
        Measures.[Темп роста к аналогичному периоду предыдущего года_Исполнено],
        Measures.[Процент выполнения назначений],
        Measures.[Исполнено прошлый год],
        Measures.[Бюджетные расходы на душу населения],
        Measures.[Ранг бюдж.обесп. ФО],
        Measures.[Худший ранг бюдж.обесп. ФО],
        Measures.[Ранг бюдж.обесп. РФ],
        Measures.[Худший ранг бюдж.обесп. РФ]
    } on columns,
    non empty Filter  
    (
        {
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]   
            } + Generate   
            (
                [Территории].[Сопоставимый].[Федеральный округ].Members,
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF_AND_BEFORE   
                )   
            ) -
                {
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Дальневосточный федеральный округ].[Камчатская область],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Дальневосточный федеральный округ].[Корякский автономный округ],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Приволжский федеральный округ].[Коми-Пермяцкий автономный округ],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Приволжский федеральный округ].[Пермская область],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Агинский-Бурятский автономный округ],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Таймырский автономный округ],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Усть-Ордынский Бурятский автономный округ],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Читинская область],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Эвенкийский автономный округ]
                }   
        },
        not  
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
        )  
    ) on rows  
from  [ФК_МесОтч_Расходы]  
where   
    (
        [Период].[Период].[Данные всех периодов].[<%period_last_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [РзПр].[Сопоставимый].[Группы расходов] 
    )
  ]]>
</query>
  
</root>