<?xml version="1.0" encoding="windows-1251"?>
<root>

  <query id="STAT_0002_0002_Sakhalin_date">
    <![CDATA[
-- STAT_0002_0002_Sakhalin_date
  with  
    member [Measures].[Уровень]  
    as 'IIF 
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            0,
            IIF 
            (
                [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Месяц],
                1,
                2 
            ) 
        )' 
    member [Measures].[Уникальное имя]  
    as ' [Период__Период].[Период__Период].CurrentMember.UniqueName '  
    member [Measures].[Имя]
    as ' IIF
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            [Период__Период].[Период__Период].CurrentMember.Name + " год",
            [Период__Период].[Период__Период].CurrentMember.Name
        )'
    set [Периоды]  
    as 'Filter  
        (
            Descendants 
            (
                [Период__Период].[Период__Период].[Данные всех периодов],
                [Период__Период].[Период__Период].[День],
                SELF_AND_BEFORE 
            ),
            not 
            (
                [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Полугодие] 
            ) and not 
            (
                [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Квартал] 
            ) and not 
            (
                [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Данные всех периодов] 
            ) and 
            (
                not isEmpty 
                (
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:] 
                ) or 
                (
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:] 
                ) 
            ) 
        )'  
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]  
    }ON COLUMNS,
    non empty { [Периоды] }   ON ROWS  
FROM    [СТАТ_Мониторинг СЭР]  
  ]]>
  </query>
  
  <query id="STAT_0002_0002_Sakhalin_compare_Grid">
    <![CDATA[
-- STAT_0002_0002_Sakhalin_compare_Grid  
SELECT
    crossjoin 
    (
        {

            Descendants 
            (
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:] ,
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:].Level ,
                SELF_AND_AFTER 
            ) ,
            Descendants 
            (
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:] ,
                [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:].Level ,
                SELF_AND_AFTER 
            )  
        },
        {
            [Measures].[Значение] ,
            [Measures].[Максимальное значение] ,
            [Measures].[Минимальное значение] 
        } 
    ) ON COLUMNS ,
    NON EMPTY Filter (
        Descendants 
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ] ,
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].Level ,
            AFTER
        ),
        not 
        (
            [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].DATAMEMBER
        ) 
    )ON ROWS 
FROM [СТАТ_Мониторинг СЭР] 
WHERE 
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Ведомственный раздел],
        <%period_current_date%>
    ) 
    
    
    
    
  ]]>
</query>


<query id="Chart_query">
<![CDATA[
-- STAT_0002_0002_Sakhalin_Chart


SELECT
    NON EMPTY [Период].[Период].[День].members ON COLUMNS ,
    NON EMPTY 
    {
        [Measures].[Минимальное значение] ,
        [Measures].[Максимальное значение] 
    } ON ROWS 
FROM [СТАТ_Мониторинг СЭР] 
WHERE 
    (
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:].[<%Faces%>].[<%Units%>]
    )  
    

  
  ]]>
  </query>

  <query id="Chart1_query">
    <![CDATA[
-- STAT_0002_0002_Sakhalin_Chart1
SELECT
    NON EMPTY [Период].[Период].[День].members ON COLUMNS ,
    NON EMPTY 
    {
        [Measures].[Минимальное значение] ,
        [Measures].[Максимальное значение] 
    } ON ROWS 
FROM [СТАТ_Мониторинг СЭР] 
WHERE 
    (
        [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:].[<%Faces%>].[<%Units%>]
    )  
    
  
  ]]>
  </query>




  <query id="Dates">
    <![CDATA[
   -- STAT_0002_0002_Sakhalin_Dates
WITH 
    
    Set [Непустые периоды] 
    as 'Descendants 
        (
            [Период].[Период].[Данные всех периодов],
            [Период].[Период].[День],
            SELF 
        ) ' 
SELECT
    {[Measures].[Значение]} ON COLUMNS ,
    NON EMPTY {[Непустые периоды]} DIMENSION PROPERTIES MEMBER_UNIQUE_NAME ON ROWS 
FROM [СТАТ_Мониторинг СЭР] 
WHERE 
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Ведомственный раздел] 
    ) 
      ]]>
  </query>

  <query id="chart_сandle">
    <![CDATA[
 
 
 
 -- Японская свеча
With
    Member [Measures].[Минимум]
    as 'Tail
        (
            Order
            (
                Filter
                (
                    Descendants
                    (
                        [Период].[Период].[Данные всех периодов].[<%currYear%>],
                        [Период].[Период].[День],
                        SELF
                    ),
                    not IsEmpty
                    (
                        (
                           [Measures].[Минимальное значение],
                            [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:].[<%Faces%>].[<%Units%>],
                            [Территории__РФ].[Территории__РФ].CurrentMember,
                            [Период].[Период].CurrentMember
                        )
                    ) and [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and [Период].[Период].CurrentMember.Name <> "Данные квартала" and [Период].[Период].CurrentMember.Name <> "Данные полугодия" and [Период].[Период].CurrentMember.Name <> "Данные месяца" and [Период].[Период].CurrentMember.Name <> "Данные года" and not IsEmpty([Measures].[Значение])
                ),
                (
                   [Measures].[Минимальное значение],
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:].[<%Faces%>].[<%Units%>],
                    [Территории__РФ].[Территории__РФ].CurrentMember,
                    [Период].[Период].CurrentMember
                ),
                BDESC
            )
        ).Item(0).UniqueName'
    Member [Measures].[Максимум]
    as 'Head
        (
            Order
            (
                Filter
                (
                    Descendants
                    (
                        [Период].[Период].[Данные всех периодов].[<%currYear%>],
                        [Период].[Период].[День],
                        SELF
                    ),
                    not IsEmpty
                    (
                        (
                            [Measures].[Максимальное значение],
                            [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:].[<%Faces%>].[<%Units%>],
                            [Территории__РФ].[Территории__РФ].CurrentMember,
                            [Период].[Период].CurrentMember
                        )
                    ) and [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and [Период].[Период].CurrentMember.Name <> "Данные квартала" and [Период].[Период].CurrentMember.Name <> "Данные полугодия" and [Период].[Период].CurrentMember.Name <> "Данные месяца" and [Период].[Период].CurrentMember.Name <> "Данные года" and not IsEmpty([Measures].[Значение])
                ),
                (
                    [Measures].[Максимальное значение],
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:].[<%Faces%>].[<%Units%>],
                    [Территории__РФ].[Территории__РФ].CurrentMember,
                    [Период].[Период].CurrentMember
                ),
                BDESC
            )
        ).Item(0).UniqueName'
    Member [Measures].[Открытие]
    as '
        (
            [Measures].[Минимальное значение],
            <%period_current_date%>
        )'
    Member [Measures].[Закрытие]
    as '
        (
            [Measures].[Максимальное значение],
            <%period_current_date%>
        )'
     Member [Measures].[Высокий]
    as 'Max
        (
            [Период].[Период].[День].MEMBERS,
            [Measures].[Максимальное значение]
        )'
    Member [Measures].[Низкий]
    as 'Min
        (
            [Период].[Период].[День].MEMBERS,
            [Measures].[Минимальное значение]
        )'
    Member [Measures].[Объем]
    as '
        (
            <%period_current_date%>,
            [Measures].[Значение]
        )'


    Member measures.[Субъект]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Name'
    member [Measures].[Наименование]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Properties("Краткое наименование")'
SELECT
    {
        [Measures].[Наименование],
        [Measures].[Открытие],
        [Measures].[Закрытие],
        [Measures].[Низкий],
        [Measures].[Высокий],
        [Measures].[Объем],
        [Measures].[Минимум],
        [Measures].[Максимум]
    } ON COLUMNS ,
    NON EMPTY Filter
    (
        Descendants
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ] ,
            [Территории__РФ].[Территории__РФ].[Субъект РФ],
             SELF
        ),
        not
        (
            [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
        )
    ) ON ROWS
FROM [СТАТ_Мониторинг СЭР]
WHERE
(
[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по кредитам:].[<%Faces%>].[<%Units%>]
)
 
 
 


	]]>
</query>

  <query id="chart_сandle1">
    <![CDATA[

 -- Японская свеча
With
    Member [Measures].[Минимум]
    as 'Tail
        (
            Order
            (
                Filter
                (
                    Descendants
                    (
                        [Период].[Период].[Данные всех периодов].[<%currYear%>],
                        [Период].[Период].[День],
                        SELF
                    ),
                    not IsEmpty
                    (
                        (
                           [Measures].[Минимальное значение],
                            [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:].[<%Faces%>].[<%Units%>],
                            [Территории__РФ].[Территории__РФ].CurrentMember,
                            [Период].[Период].CurrentMember
                        )
                    ) and [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and [Период].[Период].CurrentMember.Name <> "Данные квартала" and [Период].[Период].CurrentMember.Name <> "Данные полугодия" and [Период].[Период].CurrentMember.Name <> "Данные месяца" and [Период].[Период].CurrentMember.Name <> "Данные года" and not IsEmpty([Measures].[Значение])
                ),
                (
                   [Measures].[Минимальное значение],
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:].[<%Faces%>].[<%Units%>],
                    [Территории__РФ].[Территории__РФ].CurrentMember,
                    [Период].[Период].CurrentMember
                ),
                BDESC
            )
        ).Item(0).UniqueName'
    Member [Measures].[Максимум]
    as 'Head
        (
            Order
            (
                Filter
                (
                    Descendants
                    (
                        [Период].[Период].[Данные всех периодов].[<%currYear%>],
                        [Период].[Период].[День],
                        SELF
                    ),
                    not IsEmpty
                    (
                        (
                            [Measures].[Максимальное значение],
                            [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:].[<%Faces%>].[<%Units%>],
                            [Территории__РФ].[Территории__РФ].CurrentMember,
                            [Период].[Период].CurrentMember
                        )
                    ) and [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and [Период].[Период].CurrentMember.Name <> "Данные квартала" and [Период].[Период].CurrentMember.Name <> "Данные полугодия" and [Период].[Период].CurrentMember.Name <> "Данные месяца" and [Период].[Период].CurrentMember.Name <> "Данные года" and not IsEmpty([Measures].[Значение])
                ),
                (
                    [Measures].[Максимальное значение],
                    [Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:].[<%Faces%>].[<%Units%>],
                    [Территории__РФ].[Территории__РФ].CurrentMember,
                    [Период].[Период].CurrentMember
                ),
                BDESC
            )
        ).Item(0).UniqueName'
    Member [Measures].[Открытие]
    as '
        (
            [Measures].[Минимальное значение],
            <%period_current_date%>
        )'
    Member [Measures].[Закрытие]
    as '
        (
            [Measures].[Максимальное значение],
            <%period_current_date%>
        )'
     Member [Measures].[Высокий]
    as 'Max
        (
            [Период].[Период].[День].MEMBERS,
            [Measures].[Максимальное значение]
        )'
    Member [Measures].[Низкий]
    as 'Min
        (
            [Период].[Период].[День].MEMBERS,
            [Measures].[Минимальное значение]
        )'
    Member [Measures].[Объем]
    as '
        (
            <%period_current_date%>,
            [Measures].[Значение]
        )'


    Member measures.[Субъект]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Name'
    member [Measures].[Наименование]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Properties("Краткое наименование")'
SELECT
    {
        [Measures].[Наименование],
        [Measures].[Открытие],
        [Measures].[Закрытие],
        [Measures].[Низкий],
        [Measures].[Высокий],
        [Measures].[Объем],
        [Measures].[Минимум],
        [Measures].[Максимум]
    } ON COLUMNS ,
    NON EMPTY Filter
    (
        Descendants
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ] ,
            [Территории__РФ].[Территории__РФ].[Субъект РФ],
             SELF
        ),
        not
        (
            [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
        )
    ) ON ROWS
FROM [СТАТ_Мониторинг СЭР]
WHERE
(
[Показатели__Мониторинг СЭР].[Показатели__Мониторинг СЭР].[Все показатели].[Банковские минимальные/максимальные средневзвешенные процентные ставки в области по депозитам:].[<%Faces%>].[<%Units%>]
)
 
 
  
	]]>
  </query>
  
</root>

