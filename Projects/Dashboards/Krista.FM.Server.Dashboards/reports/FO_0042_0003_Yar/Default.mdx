<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0042_0003_Yar_date">
    <![CDATA[
-- FO_0042_0003_Yar_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов].[2009] : [Период__Период].[Период__Период].[Данные всех периодов].[2013],
                    [Период__Период].[Период__Период].[Год],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Measures].[Оценка показателя],
                        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей]
                    )
                ) and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_Оценка качества ФМ_Показатели]

]]>
  </query>

  <query id="FO_0042_0003_Yar_chart">
    <![CDATA[
-- FO_0042_0003_Yar_chart
with 
    set [Администраторы]                 
    as 'Descendants                 
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
            SELF                 
        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]'               
select
    {
       [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Рейтинговая оценка каждого ГРБС за качество финансового менеджмента]
    } on columns,
    non Empty
    {
        Order
        (
            [Администраторы],
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Рейтинговая оценка каждого ГРБС за качество финансового менеджмента],
            BDESC
        )   
    } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
where 
    (
        [Период].[Период].[Данные всех периодов].[<%selected_year%>],
        [Measures].[Взвешенное значение]
    )             
  ]]>
  </query>

  <query id="FO_0042_0003_Yar_avg_chart">
    <![CDATA[
-- FO_0042_0003_Yar_avg_chart
with    
    set [Администраторы]                 
    as 'Descendants                 
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
            SELF                 
        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]'    
        
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Средняя оценка]    
    as 'AVG    
        (
            [Администраторы],
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Рейтинговая оценка каждого ГРБС за качество финансового менеджмента]
        )'     

select
    {
        [Администратор__Сопоставим].[Администратор__Сопоставим].[Средняя оценка]
    } on columns,
    {
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Рейтинговая оценка каждого ГРБС за качество финансового менеджмента]  
    } on rows    
from [ФО_Оценка качества ФМ_Показатели]    
where 
    (
        [Период].[Период].[Данные всех периодов].[<%selected_year%>],
        [Measures].[Взвешенное значение]
    )    
  ]]>
  </query>

  <query id="FO_0042_0001_Yar_adminstratorDescription">
    <![CDATA[
-- FO_0042_0001_Yar_adminstratorDescription
With 
    set [Администраторы] 
    as 'Descendants 
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
            SELF 
        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]' 
    member [Measures].[Тип]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")' 
    member [Measures].[Имя] 
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Name' 
    member [Measures].[Полное имя]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Name'
    member [Measures].[Краткое имя]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование")' 
Select
    {
        [Measures].[Имя],
        [Measures].[Краткое имя],
        [Measures].[Полное имя],
        [Measures].[Тип] 
    } on columns,
    { [Администраторы] } on rows 
From [ФО_Оценка качества ФМ_Показатели] 
  ]]>
  </query>

</root>