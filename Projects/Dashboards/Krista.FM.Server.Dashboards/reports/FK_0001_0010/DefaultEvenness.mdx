<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id="FK_0001_0010_date">
    <![CDATA[
-- FK_0001_0010_evenness_date
-- <#[ФК_МесОтч_Доходы]#>
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФК_МесОтч_Доходы]
  ]]>
  </query>
  
  <query id="FK_0001_0010_evenness_Grid">
    <![CDATA[
-- FK_0001_0010_evenness_Grid
-- <#[ФК_МесОтч_Доходы]#>
with 
---------- Краткий список доходов
    member [КД].[Сопоставимый].[Налоговые доходы ]
    as 'Aggregate
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[СТРАХОВЫЕ ВЗНОСЫ НА ОБЯЗАТЕЛЬНОЕ СОЦИАЛЬНОЕ СТРАХОВАНИЕ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Единый социальный налог],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ГОСУДАРСТВЕННАЯ ПОШЛИНА]
            }
        )'
    member [КД].[Сопоставимый].[Налог на прибыль ]
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]'
    member [КД].[Сопоставимый].[НДФЛ ]
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]'
    member [КД].[Сопоставимый].[Налоги на имущество ]
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО]'
    member [КД].[Сопоставимый].[Акцизы ]
    as 'Aggregate
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации]
            }
        )'
    member [КД].[Сопоставимый].[НДПИ ]
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]'
    member [КД].[Сопоставимый].[Налоги на совокупный доход ]
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД]'
    member [КД].[Сопоставимый].[Неналоговые доходы ]
    as 'Aggregate
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ВНЕШНЕЭКОНОМИЧЕСКОЙ ДЕЯТЕЛЬНОСТИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ]
            }
        )'
    member [КД].[Сопоставимый].[Доходы от предпринимательской деятельности ]
    as '[КД].[Сопоставимый].[Все коды доходов].[ДОХОДЫ ОТ ПРЕДПРИНИМАТЕЛЬСКОЙ И ИНОЙ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]'
    member [КД].[Сопоставимый].[Налоговые и неналоговые доходы ]
    as '[КД].[Сопоставимый].[Налоговые доходы ] + [КД].[Сопоставимый].[Неналоговые доходы ]'
    member [КД].[Сопоставимый].[Безвозмездные поступления ]
    as '[КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ]'
    member [КД].[Сопоставимый].[Доходы ВСЕГО ]
    as '[КД].[Сопоставимый].[Все коды доходов].[Доходы - всего в том числе:]'
------    
   member Measures.[Численность постоянного населения_Prev]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения_This]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '
    member Measures.[Численность постоянного населения_]  
    as 'IIF 
        (
           [Территории].[Сопоставимый] is [Территории].[Сопоставимый].[Общие итоги], 
           0,
           Measures.[Численность постоянного населения]
        )'

    member Measures.[Сумма налога] 
    as '[Measures].[Исполнено] / 1000000'
    member Measures.[Сумма налога_]   
    as 'IIF   
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Тюменская область],
            SUM   
            (
                {
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Тюменская область]   
                },
                Measures.[Сумма налога]   
            ),
            IIF   
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Северо-Западный федеральный округ].[Архангельская область],
                SUM   
                (
                    {
                        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Северо-Западный федеральный округ].[Архангельская область],
                        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Северо-Западный федеральный округ].[Ненецкий автономный округ]   
                    },
                    Measures.[Сумма налога]   
                ),
                Measures.[Сумма налога] 
            )         
        )'     
    member Measures.[ФО] 
    as '[Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование")'  

    member [Территории].[Сопоставимый].[Общие итоги]                 
    as 'SUM                 
        (
            Filter 
            (
                [Территории].[Сопоставимый].[Субъект РФ].AllMembers,
                (
                    not 
                    (
                        [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
                    )                  and 
                    (
                        Measures.[Исполнено] + Measures.[Назначено] 
                    ) <> 0 
                ) 
            ),
            Measures.CurrentMember                
        )'   
    
    member [Территории].[Сопоставимый].[Максимум]
    as 'MAX ([Список субъектов], Measures.CurrentMember)'
    
    member [Территории].[Сопоставимый].[Минимум]
    as 'MIN ([Список субъектов], Measures.CurrentMember)'
    
    member Measures.[Среднедушевые доходы]   
    as 'IIF   
        (
            [Территории].[Сопоставимый] is [Территории].[Сопоставимый].[Общие итоги],
            0,
            IIF 
            (
                [Территории].[Сопоставимый] is [Территории].[Сопоставимый].[Минимум],
                MIN 
                (
                    [Список субъектов],
                    Measures.CurrentMember 
                ),
                IIF 
                (
                    [Территории].[Сопоставимый] is [Территории].[Сопоставимый].[Максимум],
                    MAX 
                    (
                        [Список субъектов],
                        Measures.CurrentMember 
                    ),
                    IIF   
                    (
                        IsEmpty   
                        (
                            Measures.[Численность постоянного населения_]   
                        ),
                        null,
                        1000   
                        * Measures.[Сумма налога_] / Measures.[Численность постоянного населения_]   
                    ) 
                )
            ) 
        ) '
    
    set [Список субъектов] 
    as 'Filter                
        (
            Order                
            (
                {
                    [Территории].[Сопоставимый].[Субъект РФ].AllMembers -            
                    {
                        {
                            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ],
                            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Северо-Западный федеральный округ].[Ненецкий автономный округ],
                            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Читинская область],
                            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Агинский-Бурятский автономный округ]     
                        }               
                    } <%filter%>
                } ,
                Measures.[Среднедушевые доходы],
                BASC          
            ),
            (
                not                
                (
                    [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember                
                ) and          
                (
                    Measures.[Исполнено] + Measures.[Назначено]         
                ) <> 0          
            )                  
        )'
    member [Уровни бюджета].[СКИФ].[Уровень] 
    as 'SUM 
        (
            {
                [Уровни бюджета].[СКИФ].[Конс.бюджет субъекта]<%budget_level_enum%>
            },
            [Measures].[Исполнено]
        )' 
select
    {
        Measures.[Численность постоянного населения_],
        Measures.[Сумма налога_],
        Measures.[Среднедушевые доходы]
    } on columns,
    { {[Территории].[Сопоставимый].[Общие итоги]} + [Список субъектов] + {[Территории].[Сопоставимый].[Максимум], [Территории].[Сопоставимый].[Минимум]}} on rows
from [ФК_МесОтч_Доходы] 
where 
    (
        [КД].[Сопоставимый].[<%kd_group%>],
        [Уровни бюджета].[СКИФ].[Уровень],
        [Период].[Период].[Данные всех периодов].[<%period_year%>] 
    ) 
  ]]>
</query>

</root>