<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="MO_0003_0002_date">
    <![CDATA[
-- MO_0003_0002_date   
with   
    member Measures.[ДанныеНа]   
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName'   
    member Measures.[ParentYear]   
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Name'   
select
    { [Measures].[Значение] } on columns,
    non empty  
    {
        filter
        (
            Descendants 
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[(All)],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                SELF_AND_BEFORE  
            ) ,
            right 
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.uniquename,
                2 
            )<>"er" 
        ) 
    } on rows   
from [СТАТ_Паспорт МО_МР и Административный центр]   
]]>
</query>

<query id="MO_0003_0002_grid">
    <![CDATA[
-- MO_0003_0002_grid     
with        
    
    member [Measures].[Отклонение]        
    as ' IIF        
        (
            (
                ParallelPeriod        
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%Period%>],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember        
                ),
                [Measures].[Значение]        
          ) <>0 and [Measures].[Значение]<>0 and not isempty([Measures].[Значение]),
            [Measures].[Значение]-        
            (
                ParallelPeriod        
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%Period%>],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember        
                ),
                [Measures].[Значение]        
            ) ,
            IIF  
            (
                Right  
                (
                    (
                        ParallelPeriod  
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%Period%>],
                            1,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                        )  
                    ).uniquename ,
                    2  
                ) ="er" and [Measures].[Значение]<>0 and not isempty([Measures].[Значение]) and 
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%Period%>],
                        2,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                ) <>0,
                [Measures].[Значение]-  
                (
                    ParallelPeriod  
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[<%Period%>],
                        2,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    ),
                    [Measures].[Значение]  
                ) ,
                null  
            )         
        ) '        
    member measures.[Уровень]        
    as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Level.Name'        
    member measures.[Имя]        
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level.Name'        
    member measures.[Примечание]        
    as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Properties("Примечание")'        
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды]        
    as 'aggregate        
        (
            {
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 1],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 2].[Квартал 3],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 2].[Квартал 4]        
            }        
        )'        
    member [Measures].[Единица измерения]        
    as 'IIF        
        (
            [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Properties("Единица измерения") = "Неизвестные данные",
            null,
            [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Properties("Единица измерения")        
        )'        
    member [Measures].[Значение1]  
    as ' IIF  
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл" ,
                        measures.[Уровень],
            IIF           
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл1",
                measures.[Примечание] ,
                IIF        
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл2",
                    [Measures].[Единица измерения],
                    [Measures].[Значение]        
                )        
            )         
        ) '
       member [Measures].[Ранг] as '0'
SELECT
    {
        [Measures].[Значение],
        [Measures].[Отклонение],
        [Measures].[Темп роста цепной]  ,
        [Measures].[Ранг],
        measures.[Примечание],
        [Measures].[Единица измерения]
        
    }   ON columns ,
     {
       filter( {
            filter 
            (
                {
                    <%baseRegion%>.Children  
                },
                Right 
                (
                    [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                    10 
                ) <> "DATAMEMBER" 
            ) 
        }, not isempty([Measures].[Значение]) 
        )
    }   ON rows        
FROM   [СТАТ_Паспорт МО_МР и Административный центр]        
where   
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        <%selectedPok%>,
        <%selectedPeriod%>
    )         

  ]]>
</query>

  <query id="MO_0003_0002_chart">
    <![CDATA[
-- MO_0003_0002_chart
with        
    
    member [Measures].[Отклонение]        
    as ' IIF        
        (
            (
                ParallelPeriod        
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember        
                ),
                [Measures].[Значение]        
            ) <>0,
            [Measures].[Значение]-        
            (
                ParallelPeriod        
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember        
                ),
                [Measures].[Значение]        
            ) ,
            null        
        ) '        
    member measures.[Уровень]        
    as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Level.Name'        
    member measures.[Имя]        
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level.Name'        
    member measures.[Примечание]        
    as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Properties("Примечание")'        
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды]        
    as 'aggregate        
        (
            {
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 1],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 2].[Квартал 3],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009].[Полугодие 2].[Квартал 4]        
            }        
        )'        
    member [Measures].[Единица измерения]        
    as 'IIF        
        (
            [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Properties("Единица измерения") = "Неизвестные данные",
            null,
            [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Properties("Единица измерения")        
        )'        
    member [Measures].[Значение1]  
    as ' IIF  
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл" ,
                        measures.[Уровень],
            IIF           
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл1",
                measures.[Примечание] ,
                IIF        
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл2",
                    [Measures].[Единица измерения],
                    [Measures].[Значение]        
                )        
            )         
        ) '
       member [Measures].[Ранг] as '0'
       member [Measures].[Сопоставимость]
       as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Properties("Сопоставимость")'
SELECT
    {
        [Measures].[Значение],
        [Measures].[Сопоставимость]
    }   ON columns ,
 {
 [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].datamember,
        order
        (
            {
                filter 
                (
                    {
                   
                        filter   
                        (
                            {
                                [Территории__РФ].[Территории__РФ].[РФ].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children   
                            },
                            Right   
                            (
                                [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                                10   
                            ) <> "DATAMEMBER"   
                        )   
                    },
                    not isempty([Measures].[Значение])  
                )   
            },
            [Measures].[Значение]
            ,
           asc
        )   
    }   ON rows       
FROM   [СТАТ_Паспорт МО_МР и Административный центр]        
where   
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        <%selectedPok%>,
        <%selectedPeriod%>
    )    
  ]]>
  </query>

<query id="MO_0003_0001_indicators">
<![CDATA[
-- MO_0003_0001_indicators
with

    member [Measures].[Уровень]
    as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Level.Name '
    member [Measures].[Юник нейм]
    as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.UniqueName'
    member [Measures].[Юник нейм родителя]
    as '[Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Parent.UniqueName'
    set [Показатели]
    as ' filter
        (
            Descendants
            (
                [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].[Все показатели],
                [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].[Уровень 4],
                SELF_AND_BEFORE
            ),
            not
            (
               [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember is [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember.Parent.DataMember
            ) and not ([Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].CurrentMember is [Паспорт МО__МР и Административный центр].[Паспорт МО__МР и Административный центр].[Все показатели])
        ) '
SELECT
    {

        [Measures].[Уровень],
        [Measures].[Юник нейм],
        [Measures].[Юник нейм родителя]
    }   ON columns ,
    { [Показатели] }  ON rows
FROM   [СТАТ_Паспорт МО_МР и Административный центр]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра]
    )
  ]]>
</query>

  <query id="MO_0003_0001_mo">
    <![CDATA[
-- MO_0003_0001_mo
with   
    member [Measures].[Юник нейм]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'
    set [Показатели]  
    as ' filter  
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
            not  
            (
                [Территории__РФ].[Территории__РФ].CurrentMember is  [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember  
            )  
        ) '  
SELECT
    { [Measures].[Юник нейм] }   ON columns ,
    { [Показатели] }  ON rows  
FROM    [СТАТ_Паспорт МО_МР и Административный центр]  
where  
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]   
    )  
  ]]>
  </query>

</root>