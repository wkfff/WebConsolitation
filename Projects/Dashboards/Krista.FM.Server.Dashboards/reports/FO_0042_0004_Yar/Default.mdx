<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0042_0004_Yar_date">
    <![CDATA[
-- FO_0042_0004_Yar_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов].[2009] : [Период__Период].[Период__Период].[Данные всех периодов].[2013],
                    [Период__Период].[Период__Период].[Год],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Measures].[Оценка показателя],
                        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей]
                    )
                ) and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_Оценка качества ФМ_Показатели]

]]>
  </query>

  <query id="FO_0042_0004_Yar_grid">
    <![CDATA[
-- FO_0042_0004_Yar_grid
with 
    set [Администраторы] 
    as 'Filter 
        (
            {
                Descendants 
                (
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                    SELF 
                ) - 
                {
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные] 
                } 
            },
            not IsEmpty 
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей]
            ) 
        )' 
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Аггрегированные администраторы] 
    as 'Aggregate({ [Администраторы] })' 
    set [Показатели] 
    as 'Filter 
        (
            Descendants 
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 3],
                SELF_AND_BEFORE 
            ) - 
            {
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Несопоставленные данные],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Уровень качества финансового менеджмента ГРБС],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Интегральная оценка качества финансового менеджмента ГРБС],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Рейтинговая оценка каждого ГРБС за качество финансового менеджмента] 
            },
            not 
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Parent.DataMember 
            )  
        ) ' 
    member [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Аггрегированные показатели] 
    as 'Aggregate({ [Показатели] })' 
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[Наименование] 
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Name' 
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[UniqName] 
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.UniqueName'  
    
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[Кол-во ГРБС с применимой оценкой]
    as 'Sum
        (
            [Администраторы],
            [Measures].[Применим ли в оценке]
        )'
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[Сумма оценок по ГРБС]
    as 'Sum
        (
            Filter
            (
                [Администраторы],
                [Measures].[Применим ли в оценке] = 1
            ),
            [Measures].[Оценка показателя]
        )'
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[Средняя оценка показателя исходя из его применимости к ГРБС]
    as 'IIF
        (
            IsEmpty
            (
                [Администратор__Сопоставим].[Администратор__Сопоставим].[Кол-во ГРБС с применимой оценкой]
            ) or  [Администратор__Сопоставим].[Администратор__Сопоставим].[Кол-во ГРБС с применимой оценкой] = 0,
            null,
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Сумма оценок по ГРБС]  /  [Администратор__Сопоставим].[Администратор__Сопоставим].[Кол-во ГРБС с применимой оценкой]
        )'
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[ГРБС, получившие неудовлетворительную оценку по показателю]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                [Measures].[Применим ли в оценке] = 1 and [Measures].[Оценка показателя] < 300
            ),
            [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ", "
        )'
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[ГРБС, получивший максимальную оценку]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                [Measures].[Применим ли в оценке] = 1 and [Measures].[Оценка показателя] = 500
            ),
            [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ", "
        )'
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[ГРБС, по которому показатель не применим]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                [Measures].[Применим ли в оценке] = 0
            ),
            [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ", "
        )'
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[№ п/п]
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Код") + "_"'
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[UniqName]
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.UniqueName'
    
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Уровень]  
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].Level.Name'
    
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Пустая строка]   
    as 'IIF 
        (
            (
                (
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Level is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 1]  
                ) or   
                (
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Level is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 2]  
                )  
            ) and Count 
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Children 
            ) <> 0 ,
            "true",
            "false" 
        )'      
select
    {
        [Администратор__Сопоставим].[Администратор__Сопоставим].[№ п/п],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[Наименование],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[Средняя оценка показателя исходя из его применимости к ГРБС],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[ГРБС, получившие неудовлетворительную оценку по показателю],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[ГРБС, получивший максимальную оценку],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[ГРБС, по которому показатель не применим],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[Уровень],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[Пустая строка],
        [Администратор__Сопоставим].[Администратор__Сопоставим].[UniqName]
    } on columns,
    {
        [Показатели]
    } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
where 
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%selected_year%>],
        [Measures].[Оценка показателя] 
    ) 
  ]]>
  </query>

  <query id="FO_0042_0004_Yar_chart">
    <![CDATA[
-- FO_0042_0004_Yar_chart
with
    set [Администраторы] 
    as 'Filter 
        (
            {
                Descendants 
                (
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                    SELF 
                ) - 
                {
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные] 
                } 
            },
            not IsEmpty 
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей]
            ) 
        )' 
    member [Measures].[Оценка]  
    as 'IIF
        (
            [Measures].[Применимость к оценке],
            [Measures].[Оценка показателя],
            null
        )' 
    member [Measures].[Применимость к оценке]
    as '[Measures].[Применим ли в оценке] = 1'
-----------Кол-во МО
    member [Measures].[Число 0]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                     [Measures].[Оценка] = 0
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число 100]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 100
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число 200]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 200
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число 300]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 300
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число 400]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 400
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число 500]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 500
                ) and [Measures].[Применимость к оценке]
            )
        )'
 
----------- Хинты
    member [Measures].[Хинт 0]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 0
                ) and [Measures].[Применимость к оценке]
            ),
             [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ";"
        )'
    member [Measures].[Хинт 100]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 100
                ) and [Measures].[Применимость к оценке]
            ),
             [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ";"
        )'
    member [Measures].[Хинт 200]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 200
                ) and [Measures].[Применимость к оценке]
            ),
             [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ";"
        )'
    member [Measures].[Хинт 300]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 300
                ) and [Measures].[Применимость к оценке]
            ),
             [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ";"
        )'
    member [Measures].[Хинт 400]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 400
                ) and [Measures].[Применимость к оценке]
            ),
             [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ";"
        )'
    member [Measures].[Хинт 500]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] = 500
                ) and [Measures].[Применимость к оценке]
            ),
             [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование"),
            ";"
        )'

----------- Меры
    member [Measures].[_0]
    as 'IIF  
        (
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт],
            [Measures].[Хинт 0],
            IIF
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля],
                IIF
                (
                   IsEmpty([Measures].[Кол-во ГРБС с применимой оценкой]) or [Measures].[Кол-во ГРБС с применимой оценкой] = 0,
                   null,
                   [Measures].[Число 0] / [Measures].[Кол-во ГРБС с применимой оценкой]
                ),
                [Measures].[Число 0] 
            ) 
        )'
    member [Measures].[_100]
    as 'IIF  
        (
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт],
            [Measures].[Хинт 100],
            IIF
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля],
                IIF
                (
                   IsEmpty([Measures].[Кол-во ГРБС с применимой оценкой]) or [Measures].[Кол-во ГРБС с применимой оценкой] = 0,
                   null,
                   [Measures].[Число 100] / [Measures].[Кол-во ГРБС с применимой оценкой]
                ),
                [Measures].[Число 100] 
            ) 
        )'
    member [Measures].[_200]
    as 'IIF  
        (
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт],
            [Measures].[Хинт 200],
            IIF
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля],
                IIF
                (
                   IsEmpty([Measures].[Кол-во ГРБС с применимой оценкой]) or [Measures].[Кол-во ГРБС с применимой оценкой] = 0,
                   null,
                   [Measures].[Число 200] / [Measures].[Кол-во ГРБС с применимой оценкой]
                ),
                [Measures].[Число 200] 
            ) 
        )'
    member [Measures].[_300]
    as 'IIF  
        (
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт],
            [Measures].[Хинт 300],
            IIF
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля],
                IIF
                (
                   IsEmpty([Measures].[Кол-во ГРБС с применимой оценкой]) or [Measures].[Кол-во ГРБС с применимой оценкой] = 0,
                   null,
                   [Measures].[Число 300] / [Measures].[Кол-во ГРБС с применимой оценкой]
                ),
                [Measures].[Число 300] 
            ) 
        )'
    member [Measures].[_400]
    as 'IIF  
        (
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт],
            [Measures].[Хинт 400],
            IIF
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля],
                IIF
                (
                   IsEmpty([Measures].[Кол-во ГРБС с применимой оценкой]) or [Measures].[Кол-во ГРБС с применимой оценкой] = 0,
                   null,
                   [Measures].[Число 400] / [Measures].[Кол-во ГРБС с применимой оценкой]
                ),
                [Measures].[Число 400] 
            ) 
        )'
    member [Measures].[_500]
    as 'IIF  
        (
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт],
            [Measures].[Хинт 500],
            IIF
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля],
                IIF
                (
                   IsEmpty([Measures].[Кол-во ГРБС с применимой оценкой]) or [Measures].[Кол-во ГРБС с применимой оценкой] = 0,
                   null,
                   [Measures].[Число 500] / [Measures].[Кол-во ГРБС с применимой оценкой]
                ),
                [Measures].[Число 500] 
            ) 
        )'

---------------
    member [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт]
    as '<%selected_indicator%>'

    member [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля]
    as '<%selected_indicator%>'
    member [Measures].[Кол-во ГРБС с применимой оценкой] 
    as '-Sum
        (
            [Администраторы],
            (
                [Measures].[Применим ли в оценке],
                <%selected_indicator%> 
            ) = 1 
        )' 

select
    {
        <%selected_indicator%>,
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Хинт],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Доля]
    } on columns,

       {
        [Measures].[_0],
        [Measures].[_100],
        [Measures].[_200],
        [Measures].[_300],
        [Measures].[_400],
        [Measures].[_500]
       }
     on rows
from [ФО_Оценка качества ФМ_Показатели]
where
    (
        [Период].[Период].[Данные всех периодов].[<%selected_year%>]
    )
  ]]>
  </query>
  
</root>