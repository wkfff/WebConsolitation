<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="STAT_0030_0001_grid">
    <![CDATA[
-- STAT_0030_0001_grid
with                 
    set [Районы]                 
    as 'Filter                 
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
            not                 
            (
                [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember                 
            ) and                 
            (
                [Территории__РФ].[Территории__РФ].CurrentMember.Properties("Тип территории") = "МР"                 
            )                 
        )'                 
    set [Водные объекты год]  
    as ' 
        {
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Обь - д. Белогорье 3,1 км выше д. Белогорье],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Вах - с. Ларьяк в черте с. Ларьяк],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Вах - с. Большетархово в черте с. Большетархово],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Тром-Юган - д. Руссинская в черте д. Руссинская],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Пим - г. Лянтор в черте г. Лянтор],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Назым - с. Кышик в черте с. Кышик],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Конда - с. Болчары в черте с. Болчары],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Конда - п. Выкатной в черте п. Выкатной],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Казым - г. Белоярский 1,5 км ниже г. Белоярский],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Амня - с. Казым в черте с. Казым],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Сев. Сосьва - п. Сосьва 1,7 км ниже п. Сосьва],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Ляпин - с. Ламбовож 1 км к ЮЗ от с. Ламбовож],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Вах - п. Ваховск в черте п. Ваховск] 
        }' 
    set [Водные объекты месяц] 
    as '
        {
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Обь - г. Нижневартовск 5,8 км ниже г. Нижневартовск],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Обь - г. Сургут 22 км ниже г. Сургут],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Обь - пгт. Октябрьское 0,5 км ниже пгт. Октябрьское],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Обь - с. Полноват в черте с. Полноват],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Аган - пгт. Новоаганск в черте пгт. Новоаганск],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Обь - г. Нефтеюганск 0,5 км ниже г. Нефтеюганск],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Обь - с. Сытомино в черте с. Сытомино],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Иртыш - п. Горноправдинск в черте п. Горноправдинск],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Иртыш - г. Ханты-Мансийск 3 км выше г. Ханты-Мансийск],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Иртыш - г. Ханты-Мансийск 3,4 км ниже г. Ханты-Мансийск],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Конда - г. Урай 0,5 км ниже г. Урай],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Казым - д. Юильск в черте д. Юильск],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Казым - г. Белоярский в промзоне г. Белоярский],
            [Экология__Водные объекты].[Экология__Водные объекты].[Все объекты].[р. Сев. Сосьва - пгт. Березово 1,3 км ниже пгт. Березово]
        }' 
    member Measures.[Район]       
    as ' [Экология__Водные объекты].[Экология__Водные объекты].CurrentMember.Properties("Примечание") '       
    member Measures.[Наименование]       
    as ' [Экология__Водные объекты].[Экология__Водные объекты].CurrentMember.Name'        
   member Measures.[УКИЗВ]                  
    as 'IIF              
        (
            IsEmpty ( Measures.[УКИЗВ прирост] ) and IsEmpty(Measures.[УКИЗВ теип прироста]),
            Str             
            (
                Measures.[УКИЗВ текущий период]             
            ) + ";" + " "  + ";" + " ",
            IIF     
            (
                IsEmpty ( Measures.[УКИЗВ прирост] ),
                Str     
                (
                    Measures.[УКИЗВ текущий период]     
                ) + ";" +  " " + ";" + Str(Measures.[УКИЗВ теип прироста]),
                IIF
                (
                    IsEmpty(Measures.[УКИЗВ теип прироста]),
                    Str
                    (
                        Measures.[УКИЗВ текущий период]
                    )  + ";" +  Str(Measures.[УКИЗВ прирост]) + ";" + " ",
                    Str  
                    (
                        Measures.[УКИЗВ текущий период]                  
                    ) + ";" +  Str(Measures.[УКИЗВ прирост]) + ";" + Str(Measures.[УКИЗВ теип прироста])               
                ) 
            ) 
        )'     
    member Measures.[УКИЗВ текущий период]         
    as 'IIF   
        (
            IsEmpty 
            (
                (
                    [Экология__Водные ресурсы].[Экология__Водные ресурсы].[Все показатели].[УКИЗВ],
                    [Measures].[За период],
                    <%current_period%>        
                ) 
            ),
            0,
            (
			  [Экология__Водные ресурсы].[Экология__Водные ресурсы].[Все показатели].[УКИЗВ],
              [Measures].[За период],
              <%current_period%>        
			)
        ) '         
    member Measures.[УКИЗВ прошлый период]         
    as '         
        (
            [Экология__Водные ресурсы].[Экология__Водные ресурсы].[Все показатели].[УКИЗВ],
            [Measures].[За период],
            <%previous_period%>
        ) '          
    member Measures.[УКИЗВ прирост]         
    as 'IIF         
        (
            IsEmpty        
            (
                Measures.[УКИЗВ текущий период]        
            ) or IsEmpty        
            (
                Measures.[УКИЗВ прошлый период]        
            ),
            null,
            Measures.[УКИЗВ текущий период] - Measures.[УКИЗВ прошлый период]         
        ) '          
    member Measures.[УКИЗВ теип прироста]         
    as 'IIF         
        (
            IsEmpty        
            (
                Measures.[УКИЗВ текущий период]        
            ) or IsEmpty        
            (
                Measures.[УКИЗВ прошлый период]        
            ) or Measures.[УКИЗВ прошлый период] = 0,
            null,
            Measures.[УКИЗВ текущий период] / Measures.[УКИЗВ прошлый период]         
        ) '          
    member Measures.[Качество воды]                
    as '      
        (
            [Экология__Водные ресурсы].[Экология__Водные ресурсы].[Все показатели].[Качество воды],
            [Measures].[За период]       
        ) '       
    member Measures.[Качество воды стр]       
    as 'IIF      
        (
            Measures.[Качество воды] = 1,
            "Условно чистая",
            IIF      
            (
                Measures.[Качество воды] = 2,
                "Слабо загрязненная",
                IIF      
                (
                    Measures.[Качество воды] = 3,
                    "Загрязненная",
                    IIF      
                    (
                        Measures.[Качество воды] = 4,
                        "Весьма загрязненная",
                        IIF      
                        (
                            Measures.[Качество воды] = 5,
                            "Очень загрязненная",
                            IIF      
                            (
                                Measures.[Качество воды] = 6,
                                "Грязная",
                                IIF     
                                (
                                    Measures.[Качество воды] = 7,
                                    "Очень грязная",
                                    IIF     
                                    (
                                        Measures.[Качество воды] = 8,
                                        "Экстремально грязная",
                                        Measures.[Качество воды]     
                                    )     
                                )     
                            )      
                        )      
                    )      
                )      
            )      
        )'       
    member Measures.[Вещества]              
    as '             
        (
            [Экология__Водные ресурсы].[Экология__Водные ресурсы].[Все показатели].[Вещества, вносящие основной вклад в загрязнение],
            [Measures].[За период]         
        ) '    
    member Measures.[Вещества стр]    
    as 'IIF    
        (
            Measures.[Вещества]  = 1,
            "Марганец",
            IIF   
            (
                Measures.[Вещества]  = 2,
                "Медь",
                IIF   
                (
                    Measures.[Вещества]  = 3,
                    "Железо общее",
                    IIF   
                    (
                        Measures.[Вещества]  = 4,
                        "Взвешенные вещества",
                        IIF   
                        (
                            Measures.[Вещества]  = 5,
                            "Медь,
                            марганец",
                            IIF   
                            (
                                Measures.[Вещества]  = 6,
                                "Марганец,
                                железо общее",
                                IIF   
                                (
                                    Measures.[Вещества]  = 7,
                                    "Медь,
                                    марганец,
                                    железо общее",
                                    IIF   
                                    (
                                        Measures.[Вещества]  = 8,
                                        "Медь,
                                        железо общее,
                                        цинк",
                                        IIF   
                                        (
                                            Measures.[Вещества]  = 9,
                                            "Медь,
                                            железо общее",
                                            IIF   
                                            (
                                                Measures.[Вещества]  = 10,
                                                "Медь,
                                                марганец,
                                                железо общее,
                                                NO2",
                                                IIF   
                                                (
                                                    Measures.[Вещества]  = 11,
                                                    "Хлориды,
                                                    сульфиты",
                                                    IIF   
                                                    (
                                                        Measures.[Вещества]  = 12,
                                                        "Железо общее,
                                                        хлориды,
                                                        сульфиты",
                                                        IIF   
                                                        (
                                                            Measures.[Вещества]  = 13,
                                                            "Хлориды,
                                                            сульфиты,
                                                            взвешенные вещества",
                                                            Measures.[Вещества]  
                                                        )   
                                                    )   
                                                )   
                                            )   
                                        )   
                                    )   
                                )   
                            )   
                        )   
                    )   
                )   
            )   
        ) '    
	 member Measures.[Первая буква]       
    as 'Mid        
        (
            Measures.[Район],
            1,
            1          
        )'       
    member Measures.[Номер буквы]       
    as 'IIF      
        (
            Measures.[Первая буква]="А",
            1,
            IIF       
            (
                Measures.[Первая буква]="Б",
                2,
                IIF      
                (
                    Measures.[Первая буква]="В",
                    3,
                    IIF      
                    (
                        Measures.[Первая буква]="Г",
                        4,
                        IIF     
                        (
                            Measures.[Первая буква]="Д",
                            5,
                            IIF     
                            (
                                Measures.[Первая буква]="К",
                                12,
                                IIF     
                                (
                                    Measures.[Первая буква]="Н",
                                    15,
                                    IIF     
                                    (
                                        Measures.[Первая буква]="О",
                                        16,
                                        IIF    
                                        (
                                            Measures.[Первая буква]="С",
                                            19,
                                            IIF   
                                            (
                                                Measures.[Первая буква]="Х",
                                                23,
                                                33  
                                            )   
                                        )    
                                    )     
                                )      
                            )     
                        )      
                    )      
                )       
            )       
        )'    
select
    {
        {
            Measures.[Район],
            Measures.[Наименование],
            Measures.[УКИЗВ],
            Measures.[УКИЗВ прошлый период]       
        }         
        *         
        {
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов]         
        } +       
        {
            { Measures.[Качество воды стр] }    
            *         
            {
                 <%current_period%>  ,
                <%previous_period%>       
            }       
        } +         
        {
            { Measures.[Вещества стр] }  
            *         
            {
               <%current_period%> 
            }         
        }         
    } on columns,
    {
	   ORDER
        (
		   Filter                   
            (
               <%grid_row_set%>,
               not
                (
				  IsEmpty
                  (
                    Measures.[УКИЗВ текущий период] 
                  ) 
				  and
				  IsEmpty
                  (
                    Measures.[УКИЗВ прошлый период]
                  )
                )
            ),
            -Measures.[Номер буквы],
            BDESC                   
        ) 
	} on rows
from [СТАТ_Экология_Водные ресурсы]                    
  ]]>
  </query>

  <query id="STAT_0030_0001_periodDigest">
    <![CDATA[
-- STAT_0030_0001_periodDigest
with  
    set [Периоды]  
    as ' 
        {
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2009],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2010],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2011]
        } + Filter 
        (
            Descendants  
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2011] : [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2020],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц],
                SELF  
            ),
            not IsEmpty ( ( [Measures].[За период] ) ) and not  
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember  
            )  
        )'   
    member [Measures].[Имя] 
    as 'IIF 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + " год",
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + " "+ [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent.Name + " года"
        )    ' 
    member [Measures].[Уникальное имя]  
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName' 
    member [Measures].[Уровень]  
    as 'IIF
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
            0,
            1
        )' 
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]  
    } on columns,
    [Периоды]   on rows 
from [СТАТ_Экология_Водные ресурсы] 
  ]]>
  </query>

	
</root>