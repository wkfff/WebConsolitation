<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="last_date">
    <![CDATA[ -- name: last_date   
SELECT
    { [Measures].[Значение]  } on columns,
    {
        Tail
        (
            Filter
            (
                [Период].[Год Квартал Месяц].[Год].Members,
                [Measures].[Значение] > 0
            )
        ).Item(0)
    } DIMENSION PROPERTIES MEMBER_UNIQUE_NAME on rows
FROM [ВЕДСТАТ_Свод]
where
    (
        <%baseRegion%>,
        [Источники данных].[Все источники данных],
        [Показатели].[ВедСтат_Свод].[Все показатели].[<%way_last_year%>]
    )  
	  ]]>
  </query>

  <query id="grid1">
    <![CDATA[ -- name: grid1
WITH 
    MEMBER [Measures].[Единица измерения] 
    AS  '[Показатели].[ВедСтат_Свод].CurrentMember.Properties("Единица измерения")' 
select
    non empty filter 
    (
        {
            except 
            (
                [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].children,
                {
                    [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Среднесписочная численность работников по малым предприятиям],
                    [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Численности работающих по отраслям],
                    [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Объем платных услуг населению (включая НДС)],
                    [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Оборот розничной торговли],
                    [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Оборот оптовой торговли],
                    [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Налоговые поступления] 
                } 
            )         
        },
        [Measures].[Значение]>0 
    )DIMENSION PROPERTIES MEMBER_UNIQUE_NAME on rows,
    non empty 
    {
        [Measures].[Значение],
        [Measures].[Единица измерения] 
    } on columns 
FROM [ВЕДСТАТ_Свод] 
where 
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        <%last_year%>
    )     
    ]]>
  </query>

  <query id="grid2">
    <![CDATA[ -- name: grid2
select
    non empty   
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Объем платных услуг населению (включая НДС)],
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Оборот розничной торговли],
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Оборот оптовой торговли]
    } on rows,
    non empty   
    {
        <%last_year%>.Lag(9):<%last_year%>
    } on columns   
FROM [ВЕДСТАТ_Свод]   
where   
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]   
    )     
    ]]>
  </query>

  <query id="grid3">
    <![CDATA[ -- name: grid3
select
    non empty 
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Среднесписочная численность работников по малым предприятиям],
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Численности работающих по отраслям]
    } on columns,
    non empty 
    {
        <%last_year%>.Lag(9):<%last_year%>
    } on rows 
FROM [ВЕДСТАТ_Свод] 
where 
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение] 
    )   
    ]]>
  </query>

  <query id="grid4">
    <![CDATA[ -- name: grid4
select
    non empty
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Налоговые поступления]
    } on columns,
    non empty
    {
        <%last_year%>.Lag(5):<%last_year%>
    } on rows
FROM [ВЕДСТАТ_Свод]
where
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]
    )    
    ]]>
  </query>  
  

  <query id="chart1">
    <![CDATA[ -- name: chart1
select
    non empty 
    {
        <%current_way1%>
    } on rows,
    non empty 
    {
        <%last_year%>.Lag(9):<%last_year%>
    } on columns 
FROM [ВЕДСТАТ_Свод] 
where 
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение] 
    )   
    ]]>
  </query>

  <query id="chart2">
    <![CDATA[ -- name: chart2
select
    non empty
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Объем платных услуг населению (включая НДС)].children
    } on rows,
    non empty
    {
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%selected_year%>]
    } on columns
FROM [ВЕДСТАТ_Свод]
where
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]
    )    
    ]]>
  </query>
 
  <query id="chart3">
    <![CDATA[ -- name: chart3
select
    non empty
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Оборот розничной торговли].children
    } on rows,
    non empty
    {
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%selected_year%>]
    } on columns
FROM [ВЕДСТАТ_Свод]
where
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]
    )    
    ]]>
  </query>

  <query id="chart4">
    <![CDATA[ -- name: chart4
select
    non empty
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Оборот оптовой торговли].children
    } on rows,
    non empty
    {
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%selected_year%>]
    } on columns
FROM [ВЕДСТАТ_Свод]
where
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]
    )    
    ]]>
  </query>

  <query id="chart5">
    <![CDATA[ -- name: chart5
select
    non empty
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Среднесписочная численность работников по малым предприятиям].children
    } on rows,
    non empty
    {
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%selected_year2%>]
    } on columns
FROM [ВЕДСТАТ_Свод]
where
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]
    )    
    ]]>
  </query>

  <query id="chart6">
    <![CDATA[ -- name: chart6
select
    non empty
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[ТРАНСПОРТНОЕ ОБСЛУЖИВАНИЕ И ОБЕСПЕЧЕНИЕ УСЛУГАМИ СВЯЗИ НАСЕЛЕНИЯ, ПРЕДПРИЯТИЙ, ОРГАНИЗАЦИЙ И УЧРЕЖДЕНИЙ].[Оказание основных услуг предприятиями связи (по видам услуг)].[Исходящий обмен].children
    } on rows,
    non empty
    {
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%selected_year2%>]
    } on columns
FROM [ВЕДСТАТ_Свод]
where
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]
    )    
    ]]>
  </query>

  <query id="chart7">
    <![CDATA[ -- name: chart7
select
    non empty
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[МАЛЫЕ ПРЕДПРИЯТИЯ].[Налоговые поступления].children
    } on columns,
    non empty
    {
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%current_way2%>]
    } on rows
FROM [ВЕДСТАТ_Свод]
where
    (
        [Источники данных].[Все источники данных],
        <%baseRegion%>,
        [Measures].[Значение]
    )    
    ]]>
  </query>


</root>