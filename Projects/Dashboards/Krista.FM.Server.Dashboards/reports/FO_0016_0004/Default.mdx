<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0016_0004_date">
    <![CDATA[
-- FO_0016_0004_date
with
    member [Measures].[ДанныеНа]
    as '<%period_dimension%>.CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                <%period_dimension%>.Members,
                not IsEmpty( ([Measures].[Значение], [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2]) ) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_БККУ_Показатели]
]]>
  </query>

  <query id="FO_0016_0004_grid">
    <![CDATA[
-- FO_0016_0004_grid
With 
    set [Индикаторы]    
    as '    
        {
            Filter 
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].Children,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 2" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 3" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 3_обл" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 3_мест" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 4" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 5" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл_а" or                
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл_б" or                
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл_г" or                
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_г" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_д" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_г" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_д" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_г" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_д" or
                ([Период__Период].[Период__Период].CurrentMember.Parent.Parent is [Период__Период].[Период__Период].[2009] and [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 9") or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 11" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 12" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 13" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 14" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 15"
            )  
        } ' 
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений ]
    as 'Sum
        (
            [Индикаторы],
            [Measures].CurrentMember
        )'
    member [Measures].[Наименование]
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Наименование")' 
    Member [Measures].[Содержание] 
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Содержание")' 
    member [Measures].[Обозначение] 
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name' 
    member [Measures].[Пороговое значение] 
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Пороговое значение")' 
    member [Measures].[Условие проверки] 
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Условия проверки") + [Measures].[Пороговое значение]' 
    member [Measures].[IndicatorUniqueName]
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.UniqueName'    
    member [Measures].[Число нарушений в МР и ГО]
    as 'Sum
        (
            Filter
            (
                Descendants
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)],
                    <%region_level%>,
                    SELF
                ),
                not
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
                )
            ),
            [Measures].[Количество нарушений ]
        )'
    member [Measures].[Число нарушений в поселениях]
    as 'Sum
        (
            Filter
            (
                Descendants
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)],
                    <%settlement_level%>,
                    SELF
                ),
                not
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
                )
            ),
            [Measures].[Количество нарушений ]
        )'
    member [Measures].[Количество нарушений ]    
    as 'IIF    
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            (
                [Measures].[Количество нарушений],
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.DataMember    
            ),
            [Measures].[Количество нарушений]    
        )'     
Select
    {
        [Measures].[Наименование],
        [Measures].[Условие проверки],
        [Measures].[Число нарушений в МР и ГО],
        [Measures].[Число нарушений в поселениях],
        [Measures].[IndicatorUniqueName]
    } on columns,
    {
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений ]
        } + Filter([Индикаторы], not(IsEmpty([Measures].[Число нарушений в МР и ГО]) and IsEmpty([Measures].[Число нарушений в поселениях])))
    }  on rows 
From [ФО_БККУ_Показатели] 
Where ([Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>])
  ]]>
  </query>

  <query id="FO_0016_0004_map">
    <![CDATA[
-- FO_0016_0004_map
With 
    set [Индикаторы]
    as '
        {
            Filter
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].Children,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 2" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 3" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 3_обл" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 3_мест" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 4" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 5" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл_а" or                
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл_б" or                
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_обл_г" or                
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_г" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_мест_д" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 6_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_г" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 7_д" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_г" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 8_д" or
                ([Период__Период].[Период__Период].CurrentMember.Parent.Parent is [Период__Период].[Период__Период].[2009] and [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 9") or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10_а" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10_б" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10_в" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 10" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 11" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 12" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 13" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 14" or
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Name = "БК 15"
            )
        } '
    set [Районы]   
    as 'Filter   
        (
            Descendants  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)],
                <%region_level%>,
                SELF   
            ),
            not
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            ) 
        )'   
    member [Measures].[Количество нарушений ] 
    as 'IIF   
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            (
                [Measures].[Количество нарушений],
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.DataMember   
            ),
            [Measures].[Количество нарушений]   
        )' 
    member [Measures].[Количество нарушений в поселениях]
    as 'Sum 
        (
            Filter 
            (
                Descendants 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                    <%settlement_level%>,
                    SELF 
                ),
                not
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
                ) 
            ),
            [Measures].[Количество нарушений ] 
        )'
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений ]
    as 'Sum
        (
            [Индикаторы],
            [Measures].CurrentMember
        )'        
Select
    {
        [Measures].[Количество нарушений ],
        [Measures].[Количество нарушений в поселениях]
    } on columns,
    {  [Районы]  }  on rows
From [ФО_БККУ_Показатели]   
Where   
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>],
        <%selected_indicator%>
    )   
  ]]>
  </query>


</root>