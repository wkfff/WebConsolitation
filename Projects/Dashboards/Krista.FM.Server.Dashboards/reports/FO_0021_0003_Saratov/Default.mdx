<?xml version="1.0" encoding="Windows-1251"?>
<root>
    <query id="FO_0021_0003_Saratov_endYear">
    <![CDATA[
-- FO_0021_0003_Saratov_endYear
    with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    select
    { [Measures].[ДанныеНа] } on columns,
    {
    Tail
    (
    Filter
    (
    [Период__Период].[Период__Период].[Год].Members,
    not IsEmpty([Measures].[Взвешенное значение])
    )
    )
    } on rows
    from  [ФО_ФПКУ_Показатели]
]]>
</query>
    
    <query id="FO_0021_0003_Saratov_date">
    <![CDATA[
-- FO_0021_0003_Saratov_date
with      
    member [Measures].[Уровень]      
    as 'IIF        
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            0,
            1       
        )'        
    member [Measures].[Уникальное имя]        
    as ' [Период__Период].[Период__Период].CurrentMember.UniqueName'
    member [Measures].[Имя]        
    as ' IIF
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            [Период__Период].[Период__Период].CurrentMember.Name + " год",
            [Период__Период].[Период__Период].CurrentMember.Name

        ) ' 
    set [Периоды]     
    as 'Filter    
        (
            Descendants     
            (
                {
                    [Период__Период].[Период__Период].[Данные всех периодов].[<%first_year%>]:[Период__Период].[Период__Период].[Данные всех периодов].[<%end_year%>] 
                },
                [Период__Период].[Период__Период].[Квартал],
                SELF_AND_BEFORE  
            ),
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"  
            ) and   
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"  
            )  and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Полугодие 1"  
            ) and  
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Полугодие 2"  
            ) and not isempty  
            (
                [Measures].[Взвешенное значение] 
            )  
        )'    
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]      
    }ON COLUMNS,
    { [Периоды] } ON ROWS      
FROM    [ФО_ФПКУ_Показатели]       
]]>
  </query>

  <query id="FO_0021_0003_Saratov_dateCompare">
    <![CDATA[
-- FO_0021_0003_Saratov_dateCompare
with         
    member [Measures].[Уровень]         
    as 'IIF         
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            0,
            1         
        )'         
    member [Measures].[Уникальное имя]         
    as ' [Период__Период].[Период__Период].CurrentMember.UniqueName'         
    member [Measures].[Имя]         
    as ' IIF         
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            [Период__Период].[Период__Период].CurrentMember.Name + " год",
            [Период__Период].[Период__Период].CurrentMember.Name         
        ) '         
    set [Периоды]
    as 'Filter
        (
            Descendants
            (
                {
                    [Период__Период].[Период__Период].[Данные всех периодов].[<%first_year%>]:[Период__Период].[Период__Период].[Данные всех периодов].[<%end_year%>]
                },
                [Период__Период].[Период__Период].[Квартал],
                SELF_AND_BEFORE
            ),
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
            )  and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Полугодие 1"
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Полугодие 2"
            ) and not isempty
            (
                [Measures].[Взвешенное значение]
            )
        )'
    set [Фильтрованные периоды]   
    as '[Периоды] - Tail([Периоды]).Item(0)'
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]         
    }ON COLUMNS,
    {
        Filter   
        (
            [Фильтрованные периоды],
            not
            (
                (
                    [Период__Период].[Период__Период].CurrentMember is Tail([Фильтрованные периоды]).Item(0) 
                ) and   
                (
                    Tail([Фильтрованные периоды]).Item(0).Level is [Период__Период].[Период__Период].[Год] 
                )
            ) 
        )     
    } ON ROWS    
FROM [ФО_ФПКУ_Показатели]               
]]>
  </query>

  <query id="FO_0021_0003_Saratov_grid">
    <![CDATA[
-- FO_0021_0003_Saratov_grid
with  
    set [Список районов]  
    as 'Filter  
        (
            Descendants  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 03],
                SELF  
            ),
            not  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember  
            ) and  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"  
            )  
        )'  
    member [Период__Период].[Период__Период].[Отклонение]  
    as ' IIF 
        (
            IsEmpty 
            (
               [Период__Период].[Период__Период].[Текущий_Период]
            ) or IsEmpty 
            (
                [Период__Период].[Период__Период].[Предыдущий_Период]
            ),
            null,
            [Период__Период].[Период__Период].[Текущий_Период]  - [Период__Период].[Период__Период].[Предыдущий_Период] 
         )'
    member [Период__Период].[Период__Период].[Текущий_Период]  
    as '  
          <%selected_period%>
        '
    member [Период__Период].[Период__Период].[Предыдущий_Период] 
    as '  
          <%selected_prev_period%>
        '
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Аггрегироавнные районы]  
    as 'Aggregate({[Список районов]})'  
    set [Список показателей до Итого]  
    as 'Filter  
        (
            Descendants  
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели],
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Показатели],
                SELF  
            ),
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Несопоставленные данные"  
            ) and  
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Итоговая оценка"  
            ) and  
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Ранг"  
            ) and  
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Средняя оценка"  
            ) and  
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Группа МО"  
            )  
        )'  
    set [Список общих показателей]  
    as 'Filter  
        (
            {
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Итоговая оценка],
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Ранг],
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Средняя оценка]  
            },
            Measures.[Выбран удельный вес] = true  
        )'    
    member Measures.[Выбран удельный вес]  
    as '"<%selected_measure%>" = "Взвешенное значение"'    
select
    {
        Filter  
        (
            {
                {[Список показателей до Итого]} + { [Список общих показателей]}  
            },
            not  
            (
                IsEmpty  
                (
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].[Аггрегироавнные районы],
                        [Период__Период].[Период__Период].[Текущий_Период]
                    )  
                ) and IsEmpty  
                (
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].[Аггрегироавнные районы],
                        [Период__Период].[Период__Период].[Предыдущий_Период]
                    )  
                )  
            )  
        )  
        *  
        {
            [Период__Период].[Период__Период].[Предыдущий_Период],
            [Период__Период].[Период__Период].[Текущий_Период],
            [Период__Период].[Период__Период].[Отклонение]
        }  
    } on columns,
    non empty  
    {
        Order  
        (
            [Список районов],
            [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Ранг],
            BASC  
        )  
    } on rows  
from  [ФО_ФПКУ_Показатели]  
where  
    (
        [Measures].[<%selected_measure%>]  
    )  
    ]]>
  </query>

  <query id="FO_0021_0003_Saratov_indicatorDescription">
    <![CDATA[
-- FO_0021_0003_Saratov_indicatorDescription
with
    set [Список показателей]
    as '
        {
            Descendants
                (
                   [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели],
                   [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Показатели],
                    SELF
                ) -
                {
                    [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Группа МО],
                    [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Ранг],
                    [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Средняя оценка],
                    [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Несопоставленные данные]
                }
        }'

    member [Measures].[Наименование]
    as '[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Properties("Наименование")'
Select
    {
       [Measures].[Наименование]
    } on columns,
    { [Список показателей] } on rows
From [ФО_ФПКУ_Показатели]
  ]]>
  </query>

</root>