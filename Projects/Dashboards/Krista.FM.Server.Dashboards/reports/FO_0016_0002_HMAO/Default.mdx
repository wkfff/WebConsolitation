<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0016_0002_HMAO_date">
    <![CDATA[
-- FO_0016_0002_HMAO_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
                    )
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_БККУ_Показатели]
]]>
  </query>

  <query id="FO_0016_0002_HMAO_grid">
    <![CDATA[
-- FO_0016_0002_HMAO_grid
With    
    set [Список районов]  
    as 'Filter  
        (
            Descendants  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER  
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"  
            ) or  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember  
            )   
        ) '   
    set [Список показателей]
    as '
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]
        }'
    member [Measures].[Наименование]    
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Наименование")'  
    member [Measures].[Содержание]    
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Содержание")'  
    member [Measures].[Число нарушений в МР и ГО]  
    as 'Sum  
        (
            [Список районов],
            (
                [Measures].[Количество нарушений],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember
            )  
        )'
    member [Measures].[IndicatorUniqueName]
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.UniqueName'
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений]
    as 'Sum
        (
            [Список показателей],
            [Measures].CurrentMember
        )'
Select
    {
        [Measures].[Наименование],
        [Measures].[Содержание],
        [Measures].[Число нарушений в МР и ГО],
        [Measures].[IndicatorUniqueName]
    } on columns,
    Filter 
    (
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений] + [Список показателей]
        },
        not IsEmpty 
        (
            [Measures].[Число нарушений в МР и ГО]
        )
    ) on rows 
From [ФО_БККУ_Показатели]    
Where    
    (
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>
    )      ]]>
  </query>

  <query id="FO_0016_0002_HMAO_map">
    <![CDATA[
-- FO_0016_0002_HMAO_map
With
    set [Список районов]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            ) or
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
        ) '
    set [Список показателей]
    as '
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]
        }'
    member [Measures].[Количество нарушений ]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            (
                [Measures].[Количество нарушений],
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.DataMember
            ),
            [Measures].[Количество нарушений]
        )'
    member [Measures].[Наименование района]
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'
Select
    {
        [Measures].[Наименование района],
        [Measures].[Количество нарушений ]
    } on columns,
    {  [Список районов]  }  on rows
From [ФО_БККУ_Показатели]
Where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>,
        <%selected_indicator%>
    )
  ]]>
  </query>

  <query id="FO_0016_0002_HMAO_map_sum">
    <![CDATA[
-- FO_0016_0002_HMAO_map_sum
With  
    set [Список районов]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            ) or
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
        ) '
    set [Список показателей]  
    as '  
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]  
        }'  
    member [Measures].[Количество нарушений ]  
    as 'Sum  
        (
            [Список показателей],
            (
                [Measures].[Количество нарушений],
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
            ) 
        )' 
    member [Measures].[Наименование района]
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'
Select
    {
        [Measures].[Наименование района],
        [Measures].[Количество нарушений ]  
    } on columns,
    {  [Список районов]  }  on rows  
From [ФО_БККУ_Показатели]  
Where  
    (
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>  
    )  
  ]]>  
  </query>

</root>