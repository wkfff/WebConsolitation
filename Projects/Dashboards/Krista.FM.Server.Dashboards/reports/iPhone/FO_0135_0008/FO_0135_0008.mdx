<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="date">
    <![CDATA[
-- fo_0035_0001_date
with 
    member Measures.[ДанныеНа] 
    as '[Период].[Период].CurrentMember.UniqueName' 
select
    {Measures.[ДанныеНа]} on columns,
    {
        Tail  
        (
            NonEmptyCrossjoin 
            (
                {
                    Filter
                    (
                        [Период].[Период].Members,
                        [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                        [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                        [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                        [Период].[Период].CurrentMember.Name <> "Данные года"
                    ) 
                } 
            )  
        )  
    } on rows 
from [ФО_Исполнение кассового плана] 
  ]]>
  </query>

  <query id="data">
    <![CDATA[
-- fo_0035_0001_data  
with 
    member Measures.[Код] 
    as '[Показатели__ИспКасПлан].[Показатели__ИспКасПлан].CurrentMember.Properties("Код")' 
    member Measures.[План ] 
    as '[Measures].[План_Нарастающий итог] / 1000' 
    member Measures.[Факт ] 
    as '[Measures].[Факт_Нарастающий итог] / 1000' 
    member [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Расходы] 
    as '[Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Все].[Итого]' 
    member [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Капитальные вложения] 
    as '[Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Все].[Увеличение стоимости основных средств]' 
    member [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Коммунальные услуги] 
    as '[Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Все].[Коммунальные расходы]' 
    member [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Безвозмездные перечисления другим бюджетам бюджетной системы] 
    as '[Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Все].[Межбюджетные трансферты]' 
    member [Measures].[Всего ГРБС]
    as 'count
        (
            filter
            (
                Except
                (
                    [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[ГРБС].Members,
                    {
                        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[Несопоставленные данные],
                        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[Расходы- всего],
                        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[в том числе по главным распорядителям:]
                    }
                ),
                not
                (
                    isEmpty
                    (
                        (
                            [Measures].[Процент исполнения],
                            [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].CurrentMember
                        )
                    )
                )
            )
        )'
    member [Measures].[Сумма процента исполнения]
    as 'sum
        (
            filter
            (
                Except
                (
                    [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[ГРБС].Members,
                    {
                        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[Несопоставленные данные],
                        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[Расходы- всего],
                        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[в том числе по главным распорядителям:]
                    }
                ),
                not
                (
                    isEmpty
                    (
                        (
                            [Measures].[Процент исполнения],
                            [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].CurrentMember
                        )
                    )
                )
            ),
            [Measures].[Процент исполнения]
        )'
    member [Measures].[Средний процент исполнения]
    as 'IIF
        (
            isEmpty
            (
                [Measures].[Сумма процента исполнения]
            ) or [Measures].[Сумма процента исполнения] = 0,
            0,
            [Measures].[Сумма процента исполнения] / [Measures].[Всего ГРБС]
        )'
select
    {
        [Measures].[План ],
        [Measures].[Факт ],
        [Measures].[Процент исполнения],
        [Measures].[Средний процент исполнения]
    } on columns,
    {
        [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Расходы],
        [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Все].[Заработная плата],
        [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Капитальные вложения],
        [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Коммунальные услуги],
        [Расходы__ИспКасПлан].[Расходы__ИспКасПлан].[Безвозмездные перечисления другим бюджетам бюджетной системы]
    } on rows 
from  [ФО_Исполнение кассового плана_Расходы] 
where     
    (
        <%period_cur_date%>,
        [Администратор].[ИспКасПланСопост].[Все].[<%grbs%>]    
    ) 
  ]]>
</query>

  <query id="person">
    <![CDATA[
-- fo_0035_0001_data   
  with         
    member [Measures].[Имя ]   
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Краткое наименование")' 
    member [Measures].[Сайт ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Сайт")' 
    member [Measures].[ФИО ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("ФИО")' 
    member [Measures].[Телефон ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Телефон")' 
    member [Measures].[Адрес электронной почты ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Адрес электронной почты")' 
select
    {
        [Measures].[Имя ],
        [Measures].[Сайт ],
        [Measures].[ФИО ],
        [Measures].[Телефон ],
        [Measures].[Адрес электронной почты ]
    }   on columns,
    {
        [Администратор].[ИспКасПланСопост].[Все].[<%grbs%>]   
    }  on rows     
from [ФО_Исполнение кассового плана_Расходы]        
where        
    (
        <%period_cur_date%>   
    )  
  ]]>
</query>

</root>