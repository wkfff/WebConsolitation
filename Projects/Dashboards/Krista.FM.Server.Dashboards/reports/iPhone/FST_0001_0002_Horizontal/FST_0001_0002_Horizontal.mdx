<?xml version="1.0" encoding="Windows-1251"?>
<root>
    <query id="FST_0001_0001_Inflation">
        <![CDATA[
-- FST_0001_0001_Inflation
WITH  
    SET [NonFilterColumnSet]  
    AS ' {[Measures].[За период]}'  
SELECT
    [NonFilterColumnSet] ON COLUMNS,
    {
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта]
    } on rows 
FROM [СТАТ_СЭП_Годовой сборник]  
WHERE  
    (
        [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Цены и тарифы].[Прогноз инфляции] ,
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].DataMember ,
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011].DataMember  
    ) 
]]>
    </query>

    <query id="FST_0001_0002_Horizontal_all_electro">
        <![CDATA[
-- FST_0001_0002_Horizontal_all_electro
with   
    set [Все регионы] 
    as 'filter 
        (
            Descendants 
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[Субъект РФ],
                SELF 
            ) ,
            not 
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    member [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию прошлый год] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию] = 0 ,
            0,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] / [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию] 
        )' 
    member [ФСТ].[Показатели].[Синий] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Прирост тарифа] > 0,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию прошлый год],
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
        )' 
    member [ФСТ].[Показатели].[Красный] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Прирост тарифа] > 0,
            [ФСТ].[Показатели].[Прирост тарифа],
            0 
        )' 
    member [ФСТ].[Показатели].[Прирост тарифа] 
    as ' [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] - [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию прошлый год]' 
   
    member [ФСТ].[Показатели].[Ранг тариф РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
                        ) 
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг прирост тарифа РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
                        ) 
                    ),
                    [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
    as ' [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию] - 1' 
    member [ФСТ].[Показатели].[Единицы измерения ] 
    as '"руб./кВт.ч."' 
select
    {
        [ФСТ].[Показатели].[Синий],
        [ФСТ].[Показатели].[Красный],
        [ФСТ].[Показатели].[Прирост тарифа],
        [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ],
        [ФСТ].[Показатели].[Ранг тариф РФ],
        [ФСТ].[Показатели].[Ранг прирост тарифа РФ],
        [ФСТ].[Показатели].[Единицы измерения ],
        [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
    }on columns,
    {  [Все регионы]  } on rows
from  [ФСТ_ЖКХ_Тарифы] 
WHERE 
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011]
    ) 
]]>
    </query>

    <query id="FST_0001_0002_Horizontal_TopCount_Electro">
        <![CDATA[
-- FST_0001_0002_Horizontal_TopCount_Electro
with 
    set [Все регионы] 
    as 'filter 
        (
            Descendants 
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[Субъект РФ],
                SELF 
            ) ,
            not 
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг тариф РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
            ) or [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] = 0,
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
                        )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] = 0 
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг прирост тарифа РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
            ) or 
            (
                [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] = -1 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
                        )  and not [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] = -1 
                    ),
                    [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
    as ' [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию] - 1' 
    member [ФСТ].[Показатели].[Единицы измерения ] 
    as '"руб./кВт.ч."' 
    set [Наибольший тариф] 
    as 'TopCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
                )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] = 0 
            ),
            3,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
        )' 
    set [Наибольший прирост тарифа] 
    as 'TopCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
                )  and not [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] =  -1
            ),
            3,
            [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
        )' 
    set [Наименьший тариф] 
    as 'BottomCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
                )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] = 0 
            ),
            3,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] 
        )' 
    set [Наименьший прирост тарифа] 
    as 'BottomCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
                )  and not [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] = -1
            ),
            3,
            [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ] 
        )' 
select
    {
        [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию],
        [ФСТ].[Показатели].[Рост тарифа на электрическую энергию ],
        [ФСТ].[Показатели].[Ранг тариф РФ],
        [ФСТ].[Показатели].[Ранг прирост тарифа РФ],
        [ФСТ].[Показатели].[Единицы измерения ] 
    }on columns,
    {
        [Наибольший тариф],
        [Наибольший прирост тарифа],
        [Наименьший тариф],
        [Наименьший прирост тарифа] 
    } on rows 
from  [ФСТ_ЖКХ_Тарифы] 
WHERE 
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011] 
    ) 
]]>
    </query>


    <query id="FST_0001_0002_Horizontal_all_heat">
        <![CDATA[
-- FST_0001_0002_Horizontal_all_heat
with    
    set [Все регионы] 
    as 'filter 
        (
            Descendants 
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[Субъект РФ],
                SELF 
            ) ,
            not 
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    member [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию прошлый год] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на тепловую энергию] = 0 ,
            0,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] / [ФСТ].[Показатели].[Все показатели].[Рост тарифа на тепловую энергию] 
        )' 
    member [ФСТ].[Показатели].[Синий] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Прирост тарифа] > 0,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию прошлый год],
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
        )' 
    member [ФСТ].[Показатели].[Красный] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Прирост тарифа] > 0,
            [ФСТ].[Показатели].[Прирост тарифа],
            0 
        )' 
    member [ФСТ].[Показатели].[Прирост тарифа] 
    as ' [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] - [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию прошлый год]' 
   
    member [ФСТ].[Показатели].[Ранг тариф РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
                        ) 
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг прирост тарифа РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
                        ) 
                    ),
                    [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
    as ' [ФСТ].[Показатели].[Все показатели].[Рост тарифа на тепловую энергию] - 1' 
    member [ФСТ].[Показатели].[Единицы измерения ] 
    as '"руб./Гкал."' 
select
    {
        [ФСТ].[Показатели].[Синий],
        [ФСТ].[Показатели].[Красный],
        [ФСТ].[Показатели].[Прирост тарифа],
        [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ],
        [ФСТ].[Показатели].[Ранг тариф РФ],
        [ФСТ].[Показатели].[Ранг прирост тарифа РФ],
        [ФСТ].[Показатели].[Единицы измерения ],
        [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
    }on columns,
    {  [Все регионы]  } on rows
from  [ФСТ_ЖКХ_Тарифы] 
WHERE 
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011]
    ) 
]]>
    </query>

    <query id="FST_0001_0002_Horizontal_TopCount_heat">
        <![CDATA[
-- FST_0001_0002_Horizontal_TopCount_heat
with 
    set [Все регионы] 
    as 'filter 
        (
            Descendants 
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[Субъект РФ],
                SELF 
            ) ,
            not 
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг тариф РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
            ) or [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] = 0,
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
                        )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] = 0 
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг прирост тарифа РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
            ) or 
            (
                [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] = -1 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
                        )  and not [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] = -1 
                    ),
                    [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
    as ' [ФСТ].[Показатели].[Все показатели].[Рост тарифа на тепловую энергию] - 1' 
    member [ФСТ].[Показатели].[Единицы измерения ] 
    as '"руб./Гкал."' 
    set [Наибольший тариф] 
    as 'TopCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
                )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] = 0 
            ),
            3,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
        )' 
    set [Наибольший прирост тарифа] 
    as 'TopCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
                )  and not [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] =  -1
            ),
            3,
            [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
        )' 
    set [Наименьший тариф] 
    as 'BottomCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
                )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] = 0 
            ),
            3,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию] 
        )' 
    set [Наименьший прирост тарифа] 
    as 'BottomCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
                )  and not [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] = -1
            ),
            3,
            [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ] 
        )' 
select
    {
        [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на тепловую энергию],
        [ФСТ].[Показатели].[Рост тарифа на тепловую энергию ],
        [ФСТ].[Показатели].[Ранг тариф РФ],
        [ФСТ].[Показатели].[Ранг прирост тарифа РФ],
        [ФСТ].[Показатели].[Единицы измерения ] 
    }on columns,
    {
        [Наибольший тариф],
        [Наибольший прирост тарифа],
        [Наименьший тариф],
        [Наименьший прирост тарифа] 
    } on rows 
from  [ФСТ_ЖКХ_Тарифы] 
WHERE 
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011] 
    ) 
]]>
    </query>


    <query id="FST_0001_0002_Horizontal_all_water">
        <![CDATA[
-- FST_0001_0002_Horizontal_all_water
with   
    set [Все регионы] 
    as 'filter 
        (
            Descendants 
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[Субъект РФ],
                SELF 
            ) ,
            not 
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    member [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение прошлый год] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] = 0 ,
            0,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] / [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] 
        )' 
    member [ФСТ].[Показатели].[Синий] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Прирост тарифа] > 0,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение прошлый год],
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
        )' 
    member [ФСТ].[Показатели].[Красный] 
    as 'IIF 
        (
            [ФСТ].[Показатели].[Прирост тарифа] > 0,
            [ФСТ].[Показатели].[Прирост тарифа],
            0 
        )' 
    member [ФСТ].[Показатели].[Прирост тарифа] 
    as ' [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] - [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение прошлый год]' 
   
    member [ФСТ].[Показатели].[Ранг тариф РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
                        ) 
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг прирост тарифа РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
                        ) 
                    ),
                    [ФСТ].[Показатели].[Рост тарифа на водоснабжение ],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
    as ' [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] - 1' 
    member [ФСТ].[Показатели].[Единицы измерения ] 
    as '"руб./куб.м."' 
select
    {
        [ФСТ].[Показатели].[Синий],
        [ФСТ].[Показатели].[Красный],
        [ФСТ].[Показатели].[Прирост тарифа],
        [ФСТ].[Показатели].[Рост тарифа на водоснабжение ],
        [ФСТ].[Показатели].[Ранг тариф РФ],
        [ФСТ].[Показатели].[Ранг прирост тарифа РФ],
        [ФСТ].[Показатели].[Единицы измерения ],
        [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
    }on columns,
    {  [Все регионы]  } on rows
from  [ФСТ_ЖКХ_Тарифы] 
WHERE 
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011]
    ) 
]]>
    </query>

    <query id="FST_0001_0002_Horizontal_TopCount_water">
        <![CDATA[
-- FST_0001_0002_Horizontal_TopCount_water
with 
    set [Все регионы] 
    as 'filter 
        (
            Descendants 
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[Субъект РФ],
                SELF 
            ) ,
            not 
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг тариф РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
            ) or [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] = 0,
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
                        )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] = 0 
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Ранг прирост тарифа РФ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
            ) or 
            (
                [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] = -1 
            ),
            null,
            Rank 
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order 
                (
                    Filter 
                    (
                        [Все регионы],
                        not IsEmpty 
                        (
                            [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
                        )  and not [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] = -1 
                    ),
                    [ФСТ].[Показатели].[Рост тарифа на водоснабжение ],
                    BDESC 
                ),
                [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
            ) 
        )' 
    member [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
    as ' [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] - 1' 
    member [ФСТ].[Показатели].[Единицы измерения ] 
    as '"руб./куб.м."' 
    set [Наибольший тариф] 
    as 'TopCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
                )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] = 0 
            ),
            3,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
        )' 
    set [Наибольший прирост тарифа] 
    as 'TopCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
                )  and not [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] =  -1
            ),
            3,
            [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
        )' 
    set [Наименьший тариф] 
    as 'BottomCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
                )  and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] = 0 
            ),
            3,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] 
        )' 
    set [Наименьший прирост тарифа] 
    as 'BottomCount 
        (
            Filter 
            (
                [Все регионы],
                not IsEmpty 
                (
                    [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
                )  and not [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] = -1
            ),
            3,
            [ФСТ].[Показатели].[Рост тарифа на водоснабжение ] 
        )' 
select
    {
        [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение],
        [ФСТ].[Показатели].[Рост тарифа на водоснабжение ],
        [ФСТ].[Показатели].[Ранг тариф РФ],
        [ФСТ].[Показатели].[Ранг прирост тарифа РФ],
        [ФСТ].[Показатели].[Единицы измерения ] 
    }on columns,
    {
        [Наибольший тариф],
        [Наибольший прирост тарифа],
        [Наименьший тариф],
        [Наименьший прирост тарифа] 
    } on rows 
from  [ФСТ_ЖКХ_Тарифы] 
WHERE 
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011] 
    ) 
]]>
    </query>



</root>