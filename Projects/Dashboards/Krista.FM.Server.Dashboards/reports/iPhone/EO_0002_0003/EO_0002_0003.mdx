<?xml version="1.0" encoding="Windows-1251"?>
<root>
    <query id="FK_0004_0006_lastDate">
  <![CDATA[
-- FK_0004_0006_lastDate
with  
    set [Месяцы с данными]  
    as 'tail  
        (
            filter  
            (
                [Период__Период].[Период__Период].[Месяц].Members,
                not IsEmpty ( [Measures].[Факт] ) and not 
                (
                    [Measures].[Факт] = 0
                )  
            ),
            1  
        )'  
    member [Measures].[Месяц]  
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'     
select
    {[Measures].[Месяц]} on columns,
    {[Месяцы с данными]} on rows  
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП]  
where 
    (
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Развитие лесопромышленного комплекса ХМАО-Югры на 2011-2013 годы] 
    )
  ]]>
</query>
    
    <query id="EO_0002_0003_grid">
        <![CDATA[ -- EO_0002_0003_grid
   with      
    member measures.[Объем ЦП]      
    as 'count ([Программы])'      
    member measures.[План ]      
    as 'measures.[План] / 1000'      
    member measures.[Факт ]      
    as 'measures.[Факт] / 1000'      
    member [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП]      
    as 'aggregate ([Программы])'      
    member measures.[Количество программ]      
    as 'count ([Программы])'      
    member measures.[Процент исполнения]      
    as 'IIF      
        (
            not isEmpty([Measures].[План ]) and not ([Measures].[План ]) = 0,
            measures.[Факт ] / [Measures].[План ],
            0      
        )'       
    member measures.[Тип]      
    as '[Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].CurrentMember.Properties("REFTYPEPROG")'      
    member [Период__Период].[Период__Период].[Всего] 
    as 'aggregate ([Годы])' 
    member [Исполнение расходов__Источники финансирования].[Исполнение расходов__Источники финансирования].[Все источники] 
    as 'aggregate 
        (
            [Источники финансирования]
        )' 
    set [Годы]     
    as '
        {
            [Период__Период].[Период__Период].[Данные всех периодов].[2011],
            [Период__Период].[Период__Период].[Данные всех периодов].[2012],
            [Период__Период].[Период__Период].[Данные всех периодов].[2013]     
        }'  
    set [Источники финансирования]  
    as '  
        {
            [Исполнение расходов__Источники финансирования].[Исполнение расходов__Источники финансирования].[Все источники финансирования].[Федеральный бюджет],
            [Исполнение расходов__Источники финансирования].[Исполнение расходов__Источники финансирования].[Все источники финансирования].[Бюджет автономного округа],
            [Исполнение расходов__Источники финансирования].[Исполнение расходов__Источники финансирования].[Все источники финансирования].[Бюджеты муниципальных образований],
            [Исполнение расходов__Источники финансирования].[Исполнение расходов__Источники финансирования].[Все источники финансирования].[Другие источники]  
        }'  
select
    {
        {
            [Исполнение расходов__Источники финансирования].[Исполнение расходов__Источники финансирования].[Все источники],
            [Источники финансирования] 
        } 
        *    
        {
            [Measures].[План ],
            [Measures].[Факт ]     
        }   
    } on columns,
    {
        [Период__Период].[Период__Период].[Всего],
        [Годы] 
    } on rows 
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП]      
where      
    (
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Развитие лесопромышленного комплекса ХМАО-Югры на 2011-2013 годы]      
    )  
    ]]>
    </query>

    <query id="EO_0002_0003_Chart">
        <![CDATA[ -- EO_0002_0003_Chart
   with 
    member measures.[Объем ЦП] 
    as 'count ([Программы])' 
    member measures.[План ] 
    as 'measures.[План] / 1000' 
    member measures.[Факт ] 
    as 'measures.[Факт] / 1000' 
    member [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП] 
    as 'aggregate ([Программы])' 
    member measures.[Количество программ] 
    as 'count ([Программы])' 
    member measures.[Процент исполнения] 
    as 'IIF 
        (
            not isEmpty([Measures].[План ]) and not ([Measures].[План ]) = 0,
            measures.[Факт ] / [Measures].[План ],
            0 
        )' 
  
    member measures.[Тип] 
    as '[Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].CurrentMember.Properties("REFTYPEPROG")' 
   
select
    {
        
        [Measures].[План ],
        [Measures].[Факт ]
    } on columns,
    {
        [Период__Период].[Период__Период].[Данные всех периодов].[2011],
        [Период__Период].[Период__Период].[Данные всех периодов].[2012],
        [Период__Период].[Период__Период].[Данные всех периодов].[2013] 
    } on rows 
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП] 
where 
    (
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Развитие лесопромышленного комплекса ХМАО-Югры на 2011-2013 годы] 
    )
    ]]>
    </query>

    <query id="EO_0002_0003_percent">
        <![CDATA[ -- EO_0002_0003_percent
  with
    member measures.[Процент исполнения]
    as 'IIF
        (
            not isEmpty([Measures].[План]) and not ([Measures].[План]) = 0,
            measures.[Факт] / [Measures].[План],
            0
        )'
select
    {
        [Measures].[Процент исполнения]  
    } on columns,
    { [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Развитие лесопромышленного комплекса ХМАО-Югры на 2011-2013 годы] } on rows      
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП] 
where 
    (
        <%selected_period%>.Parent.Parent.Parent
    ) 
    ]]>
    </query>

<query id="EO_0002_0003_Action">
    <![CDATA[ -- EO_0002_0003_Action
   with                   
    member measures.[Объем ЦП]                   
    as 'count ([Программы])'                   
    member measures.[План ]                   
    as 'measures.[План] / 1000'                   
    member measures.[Факт ]                   
    as 'measures.[Факт] / 1000'                   
    member [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП]                   
    as 'aggregate ([Программы])'                   
    member measures.[Количество программ]                   
    as 'count ([Программы])'                   
    member measures.[Процент исполнения]                   
    as 'IIF                   
        (
            not isEmpty([Measures].[План ]) and not ([Measures].[План ]) = 0,
            measures.[Факт ] / [Measures].[План ],
            null        
        )'                    
    member measures.[Тип]                   
    as '[Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].CurrentMember.Properties("REFTYPEPROG")'
    set [Заказчики]      
    as '    filter     
        (
            [Исполнение расходов__Заказчики].[Исполнение расходов__Заказчики].Members,
            not isEmpty      
            (
                (
                    [Исполнение расходов__Мероприятия].[Исполнение расходов__Мероприятия],
                    measures.[План]    
                )  
            )    
        ) '   
    member measures.[Заказчик]     
    as 'Tail ([Заказчики]).Item(0).Name'  
select
    {
        filter        
        (
            {
                [Исполнение расходов__Мероприятия].[Исполнение расходов__Мероприятия].Members - 
                [Исполнение расходов__Мероприятия].[Исполнение расходов__Мероприятия].[Все мероприятия]      
            }  ,
            not IsEmpty (measures.[План]) 
        ) 
    } on columns,
    {
              
        {
            measures.[Заказчик],
            [Measures].[План ],
            [Measures].[Факт ],
            measures.[Процент исполнения]
           
        }       
    } on rows        
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП]           
where           
    (
         <%filter%>,
        <%selected_period%>.Parent.Parent.Parent
    ) 
    ]]>
    </query>

    <query id="EO_0002_0002_grid_v">
        <![CDATA[ -- EO_0002_0002_grid_v
  with          
    set [Показатели непосредственного результата]    
    as '        
        {
            Filter       
            (
                descendants        
                (
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Все показатели],
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель],
                    SELF        
                ),
                not isEmpty    
                (
                    (
                        [Measures].[План],
                        [Исполнение расходов__Типы показателей].[Исполнение расходов__Типы показателей].[Все типы показателей].[Показатель непосредственного результата]  
                    )   
                )    
            )        
        }'  
    set [Показатели конечного результата]  
    as '  
        {
            Filter  
            (
                descendants  
                (
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Все показатели],
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель],
                    SELF  
                ),
                not isEmpty  
                (
                    (
                        [Measures].[План],
                        [Исполнение расходов__Типы показателей].[Исполнение расходов__Типы показателей].[Все типы показателей].[Показатель конечного результата]  
                    )  
                )  
            )  
        }'  
    Member [Measures].[Имя]      
    as '[Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].CurrentMember.name'      
    Member [Measures].[Базовый показатель на начало реализации программы]      
    as '     
        (
            measures.[Факт],
            [Период__Период].[Период__Период].[2010]     
        )'      
    Member [Measures].[Отчетная дата]      
    as '     
        (
            measures.[Факт],
            <%selected_period%>     
        )'      
    Member [Measures].[Значение на год план]      
    as '     
        (
            measures.[План],
            <%selected_period%>.Parent.Parent.Parent       
        )'      
    Member [Measures].[Значение на год факт]     
    as '     
        (
            measures.[факт], 
            StrToMember(MemberToStr(<%selected_period%>.Parent.Parent.Parent) + ".[Данные года]")
        )' 
    Member [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатели непосредственных результатов] 
    as 'null' 
    Member [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатели конечных результатов] 
    as 'null' 
select
    {
        [Measures].[Базовый показатель на начало реализации программы],
        [Measures].[Отчетная дата],
  [Measures].[Значение на год факт],
        [Measures].[Значение на год план]      
    } on columns,
    {
        [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатели непосредственных результатов],
        [Показатели непосредственного результата],
        [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатели конечных результатов],
        [Показатели конечного результата]
    } on rows  
from  [ЭО_Сбор исполнения расходов_Целевые показатели ЦП]        
where        
    (
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Развитие лесопромышленного комплекса ХМАО-Югры на 2011-2013 годы],
        <%selected_period%>.Parent.Parent.Parent        
    )
    ]]>
    </query>
    
</root>