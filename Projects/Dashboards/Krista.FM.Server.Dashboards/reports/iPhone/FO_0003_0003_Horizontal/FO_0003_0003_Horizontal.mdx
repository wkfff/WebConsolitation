<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="date">
    <![CDATA[
-- fo_0035_0001_date
with 
    member Measures.[ДанныеНа] 
    as '[Период].[Период].CurrentMember.UniqueName' 
select
    {Measures.[ДанныеНа]} on columns,
    {
        Tail  
        (
            NonEmptyCrossjoin 
            (
                {
                    Filter
                    (
                        [Период].[Период].Members,
                        [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                        [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                        [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                        [Период].[Период].CurrentMember.Name <> "Данные года"
                    ) 
                } 
            )  
        )  
    } on rows 
from [ФО_Исполнение кассового плана] 
  ]]>
  </query>

  <query id="data">
    <![CDATA[
-- fo_0035_0001_data   
   -- fo_0035_0001_data     
with     
    member [Measures].[План ]     
    as '[Measures].[План] / 1000'     
    member [Measures].[Факт ]     
    as '[Measures].[Факт] / 1000'     
    member [Measures].[Имя ]     
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Краткое наименование")'     
select
    {
        {
            [Measures].[План ],
            [Measures].[Факт ],
            [Measures].[Процент исполнения] 
        }     
    }   on columns,
    {
        {
            [Расходы].[ИспКасПлан].[Все].[Итого]    
        }  + 
        {
            Except    
            (
                [Расходы].[ИспКасПлан].[Вид расходов].Members,
                {
                    [Расходы].[ИспКасПлан].[Все].['Значение не указано'],
                    [Расходы].[ИспКасПлан].[Все].[Итого]   
                }    
            )    
        } 
    }  on rows  
from [ФО_Исполнение кассового плана_Расходы]     
where     
    (
        <%period_cur_date%>,
        [Администратор].[ИспКасПланСопост].[Все].[<%grbs%>]    
    ) 
  ]]>
</query>

  <query id="person">
    <![CDATA[
-- fo_0035_0001_data   
  with         
    member [Measures].[Имя ]   
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Краткое наименование")' 
    member [Measures].[Сайт ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Сайт")' 
    member [Measures].[ФИО ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("ФИО")' 
    member [Measures].[Телефон ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Телефон")' 
    member [Measures].[Адрес электронной почты ] 
    as '[Администратор].[ИспКасПланСопост].CurrentMember.Properties("Адрес электронной почты")' 
select
    {
        [Measures].[Имя ],
        [Measures].[Сайт ],
        [Measures].[ФИО ],
        [Measures].[Телефон ],
        [Measures].[Адрес электронной почты ]
    }   on columns,
    {
        [Администратор].[ИспКасПланСопост].[Все].[<%grbs%>]   
    }  on rows     
from [ФО_Исполнение кассового плана_Расходы]        
where        
    (
        <%period_cur_date%>   
    )  
  ]]>
</query>

</root>