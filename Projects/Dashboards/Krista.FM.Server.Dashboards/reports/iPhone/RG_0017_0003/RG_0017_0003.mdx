<?xml version="1.0" encoding="Windows-1251"?>
<root>

    <query id="RG_0017_0003_last_period">
        <![CDATA[
-- RG_0017_0003_last_period
with 
    member [Measures].[ДанныеНа] 
    as 'tail 
        (
            filter 
            (
                descendants 
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов],
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц],
                    SELF 
                ),
                not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия политикам],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Электоральные предпочтения],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия институтам власти],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс восприятия уровня распространенности коррупции],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия главам],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия Думе],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия председателю Думы],
                        [Measures].[Значение]
                    ) 
                ) 
            ),
            1 
        ).item(0).uniqueName'
select
    { [Measures].[ДанныеНа] } on columns 
from  [РЕГИОН_Данные опросов] 
where 
    (
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        <%param_territory%>.DATAMEMBER        
    )  
    ]]>
    </query>

    <query id="RG_0017_0003_electorate">
        <![CDATA[
-- RG_0017_0003_electorate
with    
    member [Measures].[pkid]    
    as '[СоцОпрос__Партии].[СоцОпрос__Партии].currentMember.properties("PKID")'  
    set [Территории]   
    as 'descendants  
        (
            <%param_territory%>,
            [Территории__РФ].[Территории__РФ].[МР ГО],
            SELF   
        )'    
    set [Партии]  
    as 'filter    
        (
            [СоцОпрос__Партии].[СоцОпрос__Партии].[Партия].members,
            not [СоцОпрос__Партии].[СоцОпрос__Партии].currentMember is [СоцОпрос__Партии].[СоцОпрос__Партии].[Все партии].[Значение не указано]  
        )'    
select
    {
        {[Measures].[Значение]}  
        *[Территории] 
        +
        {[Measures].[pkid]}  
        *  
        {
            <%param_territory%>.DATAMEMBER 
        }
    } on columns,
    {
        [Партии]         
    } on rows  
from  [РЕГИОН_Данные опросов]    
where    
    (
        <%param_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Электоральные предпочтения]  
    )
    ]]>
    </query>
        
</root>
