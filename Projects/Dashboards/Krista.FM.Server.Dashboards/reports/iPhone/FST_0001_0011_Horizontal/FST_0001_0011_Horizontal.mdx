<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FST_0001_0011_Horizontal_Inflation">
    <![CDATA[
-- FST_0001_0011_Horizontal_Inflation
select
    { [Measures].[За период] }on columns,
    {
        [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: 2009].[Прогноз инфляции] 
    } on rows      
from  [СТАТ_СЭП_Годовой сборник]    
WHERE  
    (
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011]
    ) 
]]>
  </query>
  
  <query id="FST_0001_0011_Horizontal_Grid">
    <![CDATA[
-- FST_0001_0011_Horizontal_Grid
with
    member [ФСТ].[Показатели].[Уровень]
    as '[Территории].[Сопоставимый].CurrentMember.Level.Name'
    set [Все регионы]
    as 'filter
        (
            Descendants
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[РФ],
                SELF_AND_AFTER
            ) ,
            not
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and not [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Несопоставленные данные]    and not
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "МР ГО"
            )
        )'
    member [ФСТ].[Показатели].[Ранг среднеотпускной тариф ФО]
    as 'IIF
        (
            IsEmpty
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию]
            ) or  [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] = 0,
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию]
                        ) and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию] = 0
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию],
                    BDESC
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию]
            )
        )'
    member [ФСТ].[Показатели].[Ранг тариф для населения ФО]
    as 'IIF
        (
            IsEmpty
            (
                [ФСТ].[Показатели].[Все показатели].[Тариф на электрическую энергию для населения]
            ) or [ФСТ].[Показатели].[Все показатели].[Тариф на электрическую энергию для населения] = 0,
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            [ФСТ].[Показатели].[Все показатели].[Тариф на электрическую энергию для населения]
                        )and not [ФСТ].[Показатели].[Все показатели].[Тариф на электрическую энергию для населения] = 0
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Тариф на электрическую энергию для населения],
                    BDESC
                ),
                [ФСТ].[Показатели].[Все показатели].[Тариф на электрическую энергию для населения]
            )
        )'
    member [ФСТ].[Показатели].[Ранг прирост тарифа ФО]
    as 'IIF
        (
            IsEmpty
            (
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию]
            ) or  [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию] = 0,
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty
                        (
                            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию]
                        ) and not [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию] = 0
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию],
                    BDESC
                ),
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию]
            )
        )'
    member [ФСТ].[Показатели].[Ранг прирост тарифа для населения ФО]
    as 'IIF
        (
            IsEmpty
            (
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию для населения]
            ) or [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию для населения] = 0,
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию для населения]
                        )and not [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию для населения] = 0
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию для населения],
                    BDESC
                ),
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию для населения]
            )
        )'
    member [ФСТ].[Показатели].[Единицы измерения ]
    as '"руб./кВт.ч."'
    member [ФСТ].[Показатели].[Худший среднеотпускной тариф ФО]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг среднеотпускной тариф ФО]
        )'
    member [ФСТ].[Показатели].[Худший тариф для населения ФО]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг тариф для населения ФО]
        )'
    member [ФСТ].[Показатели].[Худший прирост тарифа ФО]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг прирост тарифа ФО]
        )'
    member [ФСТ].[Показатели].[Худший прирост тарифа для населения ФО]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг прирост тарифа для населения ФО]
        )'
select
    {
        [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на электрическую энергию],
        [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию],
        [ФСТ].[Показатели].[Все показатели].[Тариф на электрическую энергию для населения],
        [ФСТ].[Показатели].[Все показатели].[Рост тарифа на электрическую энергию для населения],
        [ФСТ].[Показатели].[Ранг среднеотпускной тариф ФО],
        [ФСТ].[Показатели].[Худший среднеотпускной тариф ФО],
        [ФСТ].[Показатели].[Ранг прирост тарифа ФО],
        [ФСТ].[Показатели].[Худший прирост тарифа ФО],
        [ФСТ].[Показатели].[Ранг тариф для населения ФО],
        [ФСТ].[Показатели].[Худший тариф для населения ФО],
        [ФСТ].[Показатели].[Ранг прирост тарифа для населения ФО],
        [ФСТ].[Показатели].[Худший прирост тарифа для населения ФО],
        [ФСТ].[Показатели].[Уровень]
    }on columns,
    { filter 
        (
            [Все регионы],
            not isEmpty 
            (
                [ФСТ].[Показатели].[Ранг среднеотпускной тариф ФО]
            ) 
        )   } on rows
from  [ФСТ_ЖКХ_Тарифы]
WHERE
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011]
    )
]]>
</query>


</root>