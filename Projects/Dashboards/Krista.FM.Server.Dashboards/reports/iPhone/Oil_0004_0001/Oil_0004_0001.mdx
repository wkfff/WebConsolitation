<?xml version="1.0" encoding="Windows-1251"?>
<root>
    <query id="Oil_0004_0002_incomes_federal_date">
        <![CDATA[
    --Oil_0004_0002_incomes_federal_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as '{ Head 
        (
            Filter 
            (
                Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF_AND_AFTER 
                ) ,
                not IsEmpty 
                (
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                    ) 
                ) and not 
                (
                    [Measures].[Цена],
                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                ) = 0 and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Parent.Parent.Name = tail 
                    (
                        Filter 
                        (
                            Descendants 
                            (
                                [Период__Период].[Период__Период].[Данные всех периодов],
                                [Период__Период].[Период__Период].[День],
                                SELF_AND_AFTER 
                            ) ,
                            not IsEmpty 
                            (
                                (
                                    [Measures].[Цена],
                                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                                ) 
                            ) and not 
                            (
                                [Measures].[Цена],
                                [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                            ) = 0 
                        ),
                        1 
                    ).Item(0).Parent.Parent.Parent.Parent.Properties("Name") 
                ) 
            ),
            1 
        ), tail 
        (
            Filter 
            (
                Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF_AND_AFTER 
                ) ,
                not IsEmpty 
                (
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                    ) 
                ) and not 
                (
                    [Measures].[Цена],
                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                ) = 0 
            ),
            2 
        )}' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from   [ФСГС_Цены РФ] 
where 
    (
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше] 
    ) 
  ]]>
    </query>

    <query id="Oil_0004_0002_Label">
        <![CDATA[
    --Oil_0004_0002_Label
WITH    
    member [Measures].[Текущая средняя цена ]    
    as 'measures.[Текущая цена]'    
    member measures.[Текущая цена]    
    as ' IIF    
        (
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]    
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]    
            )    
        ) '    
    member measures.[Прошлая цена]    
    as ' IIF    
        (
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]    
            ) = 0,
            null,
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]    
            )    
        ) '    
    member measures.[Конец пред года цена]    
    as ' IIF    
        (
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]    
            ) = 0,
            null,
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]    
            )    
        ) '    
    member measures.[Абсолютное отклонение к прошлой дате]    
    as 'measures.[Текущая цена]  - measures.[Прошлая цена]'    
    member measures.[Темп прироста (динамика к предыдущему периоду)]    
    as 'IIF    
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                measures.[Текущая цена] / measures.[Прошлая цена] - 1    
            )    
            ,
            null    
        )'    
    member measures.[Темп прироста (динамика за период с начала года) ]    
    as 'IIF    
        (
            not IsEmpty(measures.[Конец пред года цена]) and not    
            (
                measures.[Конец пред года цена] = 0    
            ),
            (
                measures.[Текущая цена] / measures.[Конец пред года цена] - 1    
            )    
           ,
            null    
        )'    
    member measures.[Абсолютное отклонение к началу года]    
    as 'IIF    
        (
            isEmpty(measures.[Конец пред года цена]),
            null,
            measures.[Текущая цена]  - measures.[Конец пред года цена]    
        )'      
SELECT
    {        
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DATAMEMBER,        
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DATAMEMBER
    }    
    *    
    {
        [Measures].[Текущая средняя цена ],
        measures.[Абсолютное отклонение к прошлой дате],
        measures.[Темп прироста (динамика к предыдущему периоду)],
        measures.[Абсолютное отклонение к началу года],
        measures.[Темп прироста (динамика за период с начала года) ]    
    } on columns,
    {
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>]   
    } on rows    
from   [ФСГС_Цены РФ]    
where    
    (
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена]    
    )
      ]]>
    </query>

<query id="Oil_0004_0002_taxes">
    <![CDATA[
    --Oil_0004_0002_taxes
    with   
    member [Measures].[Текущая цена]   
    as '
        (
             measures.[Цена],
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>],
            <%period_cur_date%> 
        )'  
    set [Наибольший тариф]   
    as 'TopCount   
        (
            Filter   
            (
                filter   
                (
                    Descendants   
                    (
                        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории],
                        [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                        SELF   
                    ) ,
                    not   
                    (
                        [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember   
                    )   
                ),
                not IsEmpty ( measures.[Текущая цена] )  and not measures.[Текущая цена] = 0   
            ),
            7,
            measures.[Текущая цена]   
        )'    
    set [Наименьший тариф]   
    as 'BottomCount   
        (
            Filter   
            (
                filter  
                (
                    Descendants  
                    (
                        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории],
                        [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                        SELF  
                    ) ,
                    not  
                    (
                        [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember  
                    )  
                ),
                not IsEmpty ( measures.[Текущая цена] )  and not measures.[Текущая цена] = 0   
            ),
            7,
            measures.[Текущая цена]   
        )'    
select
    {
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена] 
    }on columns,
    {
        [Наибольший тариф],
        [Наименьший тариф]   
    } on rows   
from   [ФСГС_Цены РФ]   
where ([Measures].[Текущая цена])
      ]]>
    </query>
</root>