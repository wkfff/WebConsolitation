<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="Oil_0001_0003_incomes_federal_date">
    <![CDATA[ -- Oil_0001_0003_incomes_federal_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Union
        (
            Head
            (
                Filter
                (
                    Descendants
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов],
                        [Период__Период].[Период__Период].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty
                    (
                        (
                            [Measures].[Цена],
                            [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                        )
                    ) and not
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                    ) = 0 and
                    (
                        [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Parent.Parent.Name = tail
                        (
                            Filter
                            (
                                Descendants
                                (
                                    [Период__Период].[Период__Период].[Данные всех периодов],
                                    [Период__Период].[Период__Период].[День],
                                    SELF_AND_AFTER
                                ) ,
                                not IsEmpty
                                (
                                    (
                                        [Measures].[Цена],
                                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                                    )
                                ) and not
                                (
                                    [Measures].[Цена],
                                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                                ) = 0
                            ),
                            1
                        ).Item(0).Parent.Parent.Parent.Parent.Properties("Name")
                    )
                ),
                1
            ),
            tail
            (
                Filter
                (
                    Descendants
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов],
                        [Период__Период].[Период__Период].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty
                    (
                        (
                            [Measures].[Цена],
                            [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                        )
                    ) and not
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                    ) = 0
                ),
                2
            ),
            All
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФСГС_Цены РФ]
where
    (
        [Источники данных].[Источники данных].[Все источники данных],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>]
    )
    ]]>
  </query>

  <query id="Oil_0001_0003_incomes_regional_date">
    <![CDATA[ -- Oil_0001_0003_incomes_regional_date
with
    member [Measures].[ДанныеНа]
    as '[Период__День].[Период__День].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Union
        (
            Head
            (
                Filter
                (
                    Descendants
                    (
                        [Период__День].[Период__День].[Данные всех периодов],
                        [Период__День].[Период__День].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty
                    (
                        (
                            [Measures].[Цена],
                            [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                        )
                    ) and not
                    (
                        [Measures].[Цена],
                        [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                    ) = 0 and
                    (
                        [Период__День].[Период__День].CurrentMember.Parent.Parent.Parent.Parent.Name = tail
                        (
                            Filter
                            (
                                Descendants
                                (
                                    [Период__День].[Период__День].[Данные всех периодов],
                                    [Период__День].[Период__День].[День],
                                    SELF_AND_AFTER
                                ) ,
                                not IsEmpty
                                (
                                    (
                                        [Measures].[Цена],
                                        [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                                    )
                                ) and not
                                (
                                    [Measures].[Цена],
                                    [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                                ) = 0
                            ),
                            1
                        ).Item(0).Parent.Parent.Parent.Parent.Properties("Name")
                    )
                ),
                1
            ),
            tail
            (
                Filter
                (
                    Descendants
                    (
                        [Период__День].[Период__День].[Данные всех периодов],
                        [Период__День].[Период__День].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty
                    (
                        (
                            [Measures].[Цена],
                            [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                        )
                    ) and not
                    (
                        [Measures].[Цена],
                        [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                    ) = 0
                ),
                2
            ),
            All
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [Организации_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Тип цены].[Организации__Тип цены].[Тип цены].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
    )
    ]]>
  </query>

  <query id="Oil_0001_0003_grid_hmao">
    <![CDATA[ -- Oil_0001_0003_grid_hmao
with
    set [Территории]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                LEAVES
            ),
            not IsEmpty ([Measures].[Цена])
        )'
    set [Организации]
    as 'filter
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            not IsEmpty
            (
                [Measures].[Средняя по организации]
            )
        )'
    set [Даты]
    as '
        {
            <%period_cur_date%>,
            <%period_last_date%>,
            <%period_first_year%>
        }'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории],
            ( [Measures].[Цена ] )
        )'
    member [Measures].[Цена ]
    as '
        (
            [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
            [Measures].[Цена],
            [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            [Период__День].[Период__День].CurrentMember,
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
        )'
select
    [Даты] on columns,
    [Организации] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Measures].[Средняя по организации]
    )
    ]]>
  </query>

  <query id="Oil_0001_0003_table1">
    <![CDATA[ -- Oil_0001_0003_table1
with
    set [МР]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                SELF_AND_BEFORE
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and not IsEmpty
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[Средняя розничная цена на текущую дату]
                )
            ) and
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[МР]
                ) or
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[ГП СП]
                )
            )
        )'
    set [ГО]
    as 'filter
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Ханты-Мансийск] + Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                SELF_AND_BEFORE
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and not IsEmpty
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[Средняя розничная цена на текущую дату]
                )
            ) and
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Город]
            )
        )'
    set [Территории]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
                SELF
            ),
            not IsEmpty
            (
                [Measures].[Средняя розничная цена на текущую дату]
            )
        )'
    set [Организации]
    as '[Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children'
    member [Measures].[Город]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[МР]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count > 0,
            true,
            false
        )'
    member [Measures].[ГП СП]
    as 'iif
        (
            [Measures].[Уровень] = "ГП СП ВТГФЗ" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[Средняя розничная цена_Город]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена_МР]
    as 'avg
        (
            [Организации],
            [Measures].[Средняя по организации]
        )'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children,
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
                [Measures].[Цена]
            )
        )'
    member [Measures].[Средняя розничная цена_ГП СП]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена]
    as 'iif
        (
            [Measures].[Город],
            [Measures].[Средняя розничная цена_Город],
            iif
            (
                [Measures].[МР],
                [Measures].[Средняя розничная цена_МР],
                iif
                (
                    [Measures].[ГП СП],
                    [Measures].[Средняя розничная цена_ГП СП],
                    null
                )
            )
        )'
    member [Measures].[Средняя розничная цена на текущую дату]
    as '
        (
            <%period_cur_date%>,
            [Measures].[Средняя розничная цена]
        )'
    member [Measures].[Уровень]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Level.Name'
    member [Measures].[Минимум]
    as '
        (
            tail
            (
                order
                (
                    [Территории],
                    [Measures].[Средняя розничная цена на текущую дату],
                    BDESC
                )
            ).Item(0),
            [Measures].[Средняя розничная цена на текущую дату]
        )'
    member [Measures].[Минимум город]
    as ' tail
        (
            order
            (
                [Территории],
                [Measures].[Средняя розничная цена на текущую дату],
                BDESC
            )
        ).Item(0).Name'
    member [Measures].[Максимум]
    as '
        (
            head
            (
                order
                (
                    [Территории],
                    [Measures].[Средняя розничная цена на текущую дату],
                    BDESC
                )
            ).Item(0),
            [Measures].[Средняя розничная цена на текущую дату]
        )'
    member [Measures].[Максимум город]
    as ' head
        (
            order
            (
                [Территории],
                [Measures].[Средняя розничная цена на текущую дату],
                BDESC
            )
        ).Item(0).Name'
    member [Measures].[Текущая средняя цена]
    as '0.0'
    member [Measures].[Абсолютное отклонение к прошлой дате]
    as '0.0'
    member [Measures].[Темп прироста (динамика к предыдущему периоду)]
    as '0.0'
    member [Measures].[Абсолютное отклонение к началу года]
    as '0.0'
    member [Measures].[Темп прироста (динамика за период с начала года)]
    as '0.0'
select
    {
        [Measures].[Текущая средняя цена],
        [Measures].[Абсолютное отклонение к прошлой дате],
        [Measures].[Темп прироста (динамика к предыдущему периоду)],
        [Measures].[Абсолютное отклонение к началу года],
        [Measures].[Темп прироста (динамика за период с начала года)],
        [Measures].[Минимум],
        [Measures].[Минимум город],
        [Measures].[Максимум],
        [Measures].[Максимум город]
    } on columns,
    { [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена] } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
    )
    ]]>
  </query>

  <query id="Oil_0001_0003_table2">
    <![CDATA[ -- Oil_0001_0003_table2
with
    member [Measures].[Текущая средняя цена]
    as '[Measures].[Текущая цена]'
    member [Measures].[Текущая цена]
    as 'iif
        (
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]
            )
        ) '
    member [Measures].[Прошлая цена]
    as 'iif
        (
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]
            ) = 0,
            null,
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]
            )
        ) '
    member [Measures].[Начало года цена]
    as 'iif
        (
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]
            ) = 0,
            null,
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]
            )
        ) '
    member [Measures].[Абсолютное отклонение к прошлой дате]
    as '[Measures].[Текущая цена]  - [Measures].[Прошлая цена]'
    member [Measures].[Темп прироста (динамика к предыдущему периоду)]
    as 'IIF
        (
            not IsEmpty([Measures].[Прошлая цена]) and not ([Measures].[Прошлая цена] = 0),
            (
                [Measures].[Текущая цена] / [Measures].[Прошлая цена] - 1
            )
            * 100,
            null
        )'
    member [Measures].[Темп прироста (динамика за период с начала года)]
    as 'IIF
        (
            not IsEmpty([Measures].[Начало года цена]) and not
            (
                [Measures].[Начало года цена] = 0
            ),
            (
                [Measures].[Текущая цена] / [Measures].[Начало года цена] - 1
            )
            * 100,
            null
        )'
    member [Measures].[Абсолютное отклонение к началу года]
    as 'IIF
        (
            isEmpty([Measures].[Начало года цена]),
            null,
            [Measures].[Текущая цена]  - [Measures].[Начало года цена]
        )'
    set [Территории]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                LEAVES
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Цена])
        )'
    member [Measures].[Территория ]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name'
    member [Measures].[Максимум]
    as '
        (
           iif
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
                Tail
                (
                    Order
                    (
                        filter
                        (
                            Descendants
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                        ),
                        [Measures].[Текущая цена],
                        BASC
                    )
                ).Item(0),
                Tail
                (
                    Order
                    (
                        filter
                        (
                            Descendants
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                        ),
                        [Measures].[Текущая цена],
                        BASC
                    )
                ).Item(0)
            ),
            [Measures].[Текущая цена]
        ) '
    member [Measures].[Минимум]
    as '
        (
           iif
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
                Tail
                (
                    Order
                    (
                        filter
                        (
                            Descendants
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                        ),
                        [Measures].[Текущая цена],
                        BDESC
                    )
                ).Item(0),
                Tail
                (
                    Order
                    (
                        filter
                        (
                            Descendants
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                        ),
                        [Measures].[Текущая цена],
                        BDESC
                    )
                ).Item(0)
            ),
            [Measures].[Текущая цена]
        ) '
    member [Measures].[Минимум город]
    as 'IIF
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
            Tail
            (
                Order
                (
                    filter
                    (
                        Descendants
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                    ),
                    [Measures].[Текущая цена],
                    BDESC
                )
            ).Item(0).Properties("Name"),
            Tail
            (
                Order
                (
                    filter
                    (
                        Descendants
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                    ),
                    [Measures].[Текущая цена],
                    BDESC
                )
            ).Item(0).Properties("Name")
        ) '
    member [Measures].[Максимум город]
    as 'iif
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
            Tail
            (
                Order
                (
                    filter
                    (
                        Descendants
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                    ),
                    [Measures].[Текущая цена],
                    BASC
                )
            ).Item(0).Properties("Name"),
            Tail
            (
                Order
                (
                    filter
                    (
                        Descendants
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Текущая цена])
                    ),
                    [Measures].[Текущая цена],
                    BASC
                )
            ).Item(0).Properties("Name")
        )'
SELECT
    {
        [Measures].[Текущая средняя цена],
        [Measures].[Абсолютное отклонение к прошлой дате],
        [Measures].[Темп прироста (динамика к предыдущему периоду)],
        [Measures].[Абсолютное отклонение к началу года],
        [Measures].[Темп прироста (динамика за период с начала года)],
        [Measures].[Минимум],
        [Measures].[Минимум город],
        [Measures].[Максимум],
        [Measures].[Максимум город]
    } on columns,
    {
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember
    } on rows
from [ФСГС_Цены РФ]
where
    (
        [Источники данных].[Источники данных].[Все источники данных],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>]
    )
    ]]>
  </query>

  <query id="GSM_0003_0001_grid_hmao">
    <![CDATA[ -- GSM_0003_0001_grid_hmao
with
    set [Территории]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                LEAVES
            ),
            not IsEmpty ([Measures].[Цена])
        )'
    set [Организации]
    as 'filter
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            not IsEmpty
            (
                [Measures].[Средняя по организации]
            )
        )'
    set [Даты]
    as '
        {
            <%period_cur_date%>,
            <%period_last_date%>,
            <%period_year%>
        }'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории],
            ( [Measures].[Цена ] )
        )'
    member [Measures].[Цена ]
    as '
        (
            [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
            [Measures].[Цена],
            [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            [Период__День].[Период__День].CurrentMember,
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
        )'
select
    [Даты] on columns,
    [Организации] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Measures].[Средняя по организации]
    )
    ]]>
  </query>

  <query id="Oil_0001_0003_chart">
    <![CDATA[ -- Oil_0001_0003_chart
with
    set [МР]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                SELF_AND_BEFORE
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and not IsEmpty
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[Средняя розничная цена на текущую дату]
                )
            ) and
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[МР]
                ) or
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[ГП СП]
                )
            )
        )'
    set [ГО]
    as 'filter
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Ханты-Мансийск] + Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                SELF_AND_BEFORE
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and not IsEmpty
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[Средняя розничная цена на текущую дату]
                )
            ) and
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Город]
            )
        )'
    set [Территории]
    as 'order
        (
            filter
            (
                Descendants
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                    [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
                    SELF
                ),
                not IsEmpty
                (
                    [Measures].[Средняя розничная цена на текущую дату]
                )
            ),
            [Measures].[Средняя розничная цена на текущую дату],
            BASC
        )'
    set [Организации]
    as '[Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children'
    member [Measures].[Город]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[МР]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count > 0,
            true,
            false
        )'
    member [Measures].[ГП СП]
    as 'iif
        (
            [Measures].[Уровень] = "ГП СП ВТГФЗ" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[Средняя розничная цена_Город]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена_МР]
    as 'avg
        (
            [Организации],
            [Measures].[Средняя по организации]
        )'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children,
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
                [Measures].[Цена]
            )
        )'
    member [Measures].[Средняя розничная цена_ГП СП]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена]
    as 'iif
        (
            [Measures].[Город],
            [Measures].[Средняя розничная цена_Город],
            iif
            (
                [Measures].[МР],
                [Measures].[Средняя розничная цена_МР],
                iif
                (
                    [Measures].[ГП СП],
                    [Measures].[Средняя розничная цена_ГП СП],
                    null
                )
            )
        )'
    member [Measures].[Средняя розничная цена на текущую дату]
    as '
        (
            <%period_cur_date%>,
            [Measures].[Средняя розничная цена]
        )'
    member [Measures].[Уровень]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Level.Name'
select
    {
        [Measures].[Средняя розничная цена на текущую дату]
    } on columns,
    { [Территории] } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
    )
    ]]>
  </query>

  <query id="Oil_0001_0003_chart1">
    <![CDATA[ -- Oil_0001_0003_chart1
with
    set [Территории]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                LEAVES
            ),
            not IsEmpty ([Measures].[Цена])
        )'
    set [Организации]
    as '[Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Период] + filter
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            not IsEmpty
            (
                [Measures].[Средняя по организации]
            )
        )'
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Период]
    as 'null'
    set [Даты]
    as 'tail
        (
            Filter
            (
                Descendants
                (
                    [Период__День].[Период__День].[Данные всех периодов],
                    [Период__День].[Период__День].[День],
                    SELF_AND_AFTER
                ) ,
                not IsEmpty
                (
                    (
                        [Measures].[Цена ],
                        [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                    )
                ) and not
                (
                    [Measures].[Цена ],
                    [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                ) = 0
            ),
            26
        )'
    member [Measures].[Средняя по организации]
    as 'iif(not [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember is [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Период],
       avg
        (
            [Территории],
            ( [Measures].[Цена ] )
        ),
        [Период__День].[Период__День].CurrentMember.UniqueName)'
    member [Measures].[Цена ]
    as '
        (
            [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
            [Measures].[Цена],
            [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            [Период__День].[Период__День].CurrentMember,
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
        )'
select
    [Организации] on columns,
    [Даты] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Measures].[Средняя по организации]
    )
    ]]>
  </query>

</root>