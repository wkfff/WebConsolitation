<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="Oil_0008_0003_incomes_federal_date">
    <![CDATA[ -- Oil_0008_0003_incomes_federal_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Union
        (
            Tail
            (
                Filter
                (
                    Descendants
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов],
                        [Период__Период].[Период__Период].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty
                    (
                        (
                            [Measures].[Цена],
                            [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                        )
                    ) and not
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                    ) = 0 and
                    (
                        [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Parent.Parent.Name = tail
                        (
                            Filter
                            (
                                [Период__Период].[Период__Период].[Год].Members,
                                not IsEmpty
                                (
                                    (
                                        [Measures].[Цена],
                                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                                    )
                                ) and not
                                (
                                    [Measures].[Цена],
                                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                                ) = 0
                            ),
                            2
                        ).Item(0).Properties("Name")
                    )
                ),
                1
            ),
            tail
            (
                Filter
                (
                    Descendants
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов],
                        [Период__Период].[Период__Период].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty
                    (
                        (
                            [Measures].[Цена],
                            [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                        )
                    ) and not
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember
                    ) = 0
                ),
                2
            ),
            All
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФСГС_Цены РФ]
where
    (
        [Источники данных].[Источники данных].[Все источники данных],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>]
    )
    ]]>
  </query>

  <query id="Oil_0008_0003_incomes_regional_date">
    <![CDATA[ --Oil_0008_0003_incomes_regional_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Union
        (
            Tail
            (
                Filter
                (
                    Descendants
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов],
                        [Период__Период].[Период__Период].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty([Measures].[Розничная цена]) and not [Measures].[Розничная цена] = 0 and
                    (
                        Ancestor
                        (
                            [Период__Период].[Период__Период].CurrentMember,
                            [Период__Период].[Период__Период].[Год]
                        ).Name = tail
                        (
                            Filter
                            (
                                [Период__Период].[Период__Период].[Год].Members,
                                not IsEmpty
                                (
                                    (
                                        [Measures].[Розничная цена],
                                        [Организации__Виды ГСМ].[Организации__Виды ГСМ].CurrentMember
                                    )
                                ) and not
                                (
                                    [Measures].[Розничная цена],
                                    [Организации__Виды ГСМ].[Организации__Виды ГСМ].CurrentMember
                                ) = 0
                            ),
                            2
                        ).Item(0).Properties("Name")
                    )
                ),
                1
            ),
            tail
            (
                Filter
                (
                    Descendants
                    (
                        [Период__Период].[Период__Период].[Данные всех периодов],
                        [Период__Период].[Период__Период].[День],
                        SELF_AND_AFTER
                    ) ,
                    not IsEmpty
                    (
                        (
                            [Measures].[Розничная цена],
                            [Организации__Виды ГСМ].[Организации__Виды ГСМ].CurrentMember
                        )
                    ) and not
                    (
                        [Measures].[Розничная цена],
                        [Организации__Виды ГСМ].[Организации__Виды ГСМ].CurrentMember
                    ) = 0
                ),
                2
            ),
            All
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [Организации_Цены на ГСМ]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[ОРГАНИЗАЦИИ Цены на ГСМ],
        [Организации__Виды ГСМ].[Организации__Виды ГСМ].[Все].[ОРГАНИЗАЦИИ Цены на ГСМ].[<%oil%>]
    )
    ]]>
  </query>

  <query id="Oil_0008_0003_table1">
    <![CDATA[ -- Oil_0008_0003_table1
with
    member [Организации__АЗС].[Организации__АЗС].[sumregion]
    as 'Aggregate
        (
            Filter
            (
                [Организации__АЗС].[Организации__АЗС].[АЗС].members,
                not isempty
                (
                    [Организации__АЗС].[Организации__АЗС].currentmember
                ) and [Организации__АЗС].[Организации__АЗС].currentmember > 0
            )
        )/ Filter
        (
            [Организации__АЗС].[Организации__АЗС].[АЗС].members,
            not isempty
            (
                [Организации__АЗС].[Организации__АЗС].currentmember
            ) and [Организации__АЗС].[Организации__АЗС].currentmember > 0
        ).count '
    member measures.[Цена ]
    as '
        (
            [Measures].[Розничная цена],
            [Организации__АЗС].[Организации__АЗС].[sumregion]
        )'
    member measures.[Текущая цена]
    as ' IIF
        (
            (
                <%period_cur_date%>,
                [Measures].[Цена ]
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Measures].[Цена ]
            )
        ) '
    member measures.[Прошлая цена]
    as ' IIF
        (
            (
                <%period_last_date%>,
                [Measures].[Средняя цена ]
            ) = 0,
            null,
            (
                <%period_last_date%>,
                [Measures].[Средняя цена ]
            )
        ) '
    member measures.[Начало года цена]
    as ' IIF
        (
            (
                <%period_first_year%>,
                [Measures].[Средняя цена ]
            ) = 0,
            null,
            (
                <%period_first_year%>,
                [Measures].[Средняя цена ]
            )
        ) '
    member measures.[Абсолютное отклонение к прошлой дате]
    as '[Measures].[Текущая средняя цена ]  - measures.[Прошлая цена]'
    member measures.[Темп прироста (динамика к предыдущему периоду)]
    as 'IIF
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                [Measures].[Текущая средняя цена ] / measures.[Прошлая цена] - 1
            )
            * 100,
            null
        )'
    member measures.[Темп прироста (динамика за период с начала года) ]
    as 'IIF
        (
            not IsEmpty(measures.[Начало года цена]) and not
            (
                measures.[Начало года цена] = 0
            ),
            (
                [Measures].[Текущая средняя цена ] / measures.[Начало года цена] - 1
            )
            * 100,
            null
        )'
    member measures.[Абсолютное отклонение к началу года]
    as 'IIF
        (
            isEmpty(measures.[Начало года цена]),
            null,
            [Measures].[Текущая средняя цена ]  - measures.[Начало года цена]
        )' 	
    set [Территории]
    as 'filter
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].children ,
            not [Территории__РФ].[Территории__РФ].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
        )'
    member measures.[Территория ]
    as 'Tail
        (
            Order
            (
                [Территории],
                measures.[Текущая цена],
                BASC
            )
        ).Item(0).Name'
    member [Measures].[Максимум ]
    as '
        (
            Tail
            (
                Order
                (
                    [Территории],
                    measures.[Текущая цена],
                    BASC
                )
            ).Item(0),
            measures.[Текущая цена]
        )'
    member [Measures].[Минимум ]
    as '
        (
            Tail
            (
                Order
                (
                    [Территории],
                    measures.[Текущая цена],
                    BDESC
                )
            ).Item(0),
            measures.[Текущая цена]
        ) '
    member [Measures].[Минимум город]
    as ' Tail
        (
            Order
            (
                [Территории],
                measures.[Текущая цена],
                BDESC
            )
        ).Item(0).Properties("Name") '
    member [Measures].[Максимум город]
    as ' Tail
        (
            Order
            (
                [Территории],
                measures.[Текущая цена],
                BASC
            )
        ).Item(0).Properties("Name")'
    member [Территории__РФ].[Территории__РФ].[Аггрегированные территории]
    as 'aggregate ([Территории])'
    member [Measures].[Средняя цена ]
    as '
        (
            [Measures].[Цена ],
            [Территории__РФ].[Территории__РФ].[Аггрегированные территории]
        ) / [Территории].Count'
    member [Measures].[Текущая средняя цена ]
    as ' IIF
        (
            (
                <%period_cur_date%>,
                [Measures].[Средняя цена ]
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Measures].[Средняя цена ]
            )
        ) '
select
    {
        [Measures].[Текущая средняя цена ],
        measures.[Абсолютное отклонение к прошлой дате],
        measures.[Темп прироста (динамика к предыдущему периоду)],
        measures.[Абсолютное отклонение к началу года],
        measures.[Темп прироста (динамика за период с начала года) ],
        [Measures].[Минимум ],
        [Measures].[Минимум город],
        [Measures].[Максимум ],
        [Measures].[Максимум город]
    } on columns,
    {[Источники данных].[Источники данных].[Все источники данных].[ОРГАНИЗАЦИИ Цены на ГСМ]} on rows
from [Организации_Цены на ГСМ]
where
    (
        [Организации__Виды ГСМ].[Организации__Виды ГСМ].[Все].[ОРГАНИЗАЦИИ Цены на ГСМ].[<%oil%>]
    )
    ]]>
  </query>

  <query id="Oil_0008_0003_table2">
        <![CDATA[ -- Oil_0008_0003_table2
WITH      
 member [Measures].[Текущая средняя цена ]
 as 'measures.[Текущая цена]'
    member measures.[Текущая цена]          
    as ' IIF          
        (
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]       
            )          
        ) '          
    member measures.[Прошлая цена]          
    as ' IIF          
        (
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            ) = 0,
            null,
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            )          
        ) '          
    member measures.[Начало года цена]          
    as ' IIF          
        (
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            ) = 0,
            null,
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            )          
        ) '          
    member measures.[Абсолютное отклонение к прошлой дате]          
    as 'measures.[Текущая цена]  - measures.[Прошлая цена]'          
    member measures.[Темп прироста (динамика к предыдущему периоду)]          
    as 'IIF          
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                measures.[Текущая цена] / measures.[Прошлая цена] - 1          
            )          
            * 100,
            null          
        )'          
    member measures.[Темп прироста (динамика за период с начала года) ]          
    as 'IIF          
        (
            not IsEmpty(measures.[Начало года цена]) and not          
            (
                measures.[Начало года цена] = 0          
            ),
            (
                measures.[Текущая цена] / measures.[Начало года цена] - 1          
            )          
            * 100,
            null          
        )'          
    member measures.[Абсолютное отклонение к началу года]          
    as 'IIF          
        (
            isEmpty(measures.[Начало года цена]),
            null,
            measures.[Текущая цена]  - measures.[Начало года цена]          
        )'     
    set [Территории]     
    as 'filter     
        (
            Descendants    
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                LEAVES    
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Цена])   
        )'     
    member measures.[Территория ]          
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name'     
      member [Measures].[Максимум ] 
    as '
        (
            IIF 
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BASC 
                    ) 
                ).Item(0),
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BASC 
                    ) 
                ).Item(0) 
            ),
            measures.[Текущая цена] 
        ) ' 
    member [Measures].[Минимум ] 
    as ' 
        (
            IIF 
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BDESC 
                    ) 
                ).Item(0),
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BDESC 
                    ) 
                ).Item(0) 
            ),
            measures.[Текущая цена] 
        ) ' 
    member [Measures].[Минимум город] 
    as 'IIF 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BDESC 
                ) 
            ).Item(0).Properties("Name"),
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BDESC 
                ) 
            ).Item(0).Properties("Name") 
        ) ' 
    member [Measures].[Максимум город] 
    as ' IIF 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BASC 
                ) 
            ).Item(0).Properties("Name"),
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BASC 
                ) 
            ).Item(0).Properties("Name") 
        )' 
SELECT
    {
       [Measures].[Текущая средняя цена ],       
        measures.[Абсолютное отклонение к прошлой дате],
        measures.[Темп прироста (динамика к предыдущему периоду)],
        measures.[Абсолютное отклонение к началу года],
        measures.[Темп прироста (динамика за период с начала года) ],
        [Measures].[Минимум ],
        [Measures].[Минимум город],
        [Measures].[Максимум ],
        [Measures].[Максимум город]
    } on columns,
    {
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember    
    } on rows          
from [ФСГС_Цены РФ]        
where        
    (
        [Источники данных].[Источники данных].[Все источники данных],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>]        
    ) 
  ]]>
    </query> 

  <query id="Oil_0008_0003_chart">
    <![CDATA[ -- Oil_0008_0003_chart
with
    member [Организации__АЗС].[Организации__АЗС].[sumregion]
    as 'Aggregate
        (
            Filter
            (
                [Организации__АЗС].[Организации__АЗС].[АЗС].members,
                not isempty
                (
                    [Организации__АЗС].[Организации__АЗС].currentmember
                ) and [Организации__АЗС].[Организации__АЗС].currentmember > 0
            )
        ) / Filter
        (
            [Организации__АЗС].[Организации__АЗС].[АЗС].members,
            not isempty
            (
                [Организации__АЗС].[Организации__АЗС].currentmember
            ) and [Организации__АЗС].[Организации__АЗС].currentmember > 0
        ).count '
    member [Measures].[Цена ]
    as '  IIF
        (
            isEmpty
            (
                (
                    [Measures].[Розничная цена],
                    [Организации__АЗС].[Организации__АЗС].[sumregion]
                )
            ),
            null,
            (
                [Measures].[Розничная цена],
                [Организации__АЗС].[Организации__АЗС].[sumregion]
            )
        )'
    set [Территории]
    as 'filter
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].children ,
            not [Территории__РФ].[Территории__РФ].currentmember.is_datamember and not isEmpty([Measures].[Цена ])
        )'
    member [Территории__РФ].[Территории__РФ].[Аггрегированные территории]
    as 'aggregate ([Территории])'
    member measures.[Период ]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    member measures.[Имя ]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Name'
select
    {
        measures.[Имя ],
        [Measures].[Цена ]
    }  on columns,
    {
        Order
        (
            [Территории],
            [Measures].[Цена ],
            BASC
        )
    }on rows
from [Организации_Цены на ГСМ]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[ОРГАНИЗАЦИИ Цены на ГСМ],
        <%period_cur_date%>,
        [Организации__Виды ГСМ].[Организации__Виды ГСМ].[Все].[ОРГАНИЗАЦИИ Цены на ГСМ].[<%oil%>]
    )
  ]]>
      </query>

  <query id="Oil_0008_0003_chart1">
    <![CDATA[ --Oil_0008_0003_chart1
with
    set [FilterColumnSet]
    as 'tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF_AND_AFTER
                ) ,
                not IsEmpty
                (
                    (
                        [Measures].[Розничная цена],
                        [Организации__Виды ГСМ].[Организации__Виды ГСМ].CurrentMember
                    )
                ) and not
                (
                    [Measures].[Розничная цена],
                    [Организации__Виды ГСМ].[Организации__Виды ГСМ].CurrentMember
                ) = 0
            ),
            25
        )'
    member [Measures].[Цена ]
    as 'avg
        (
            [Организации__АЗС].[Организации__АЗС].[Все].[ОРГАНИЗАЦИИ Цены на ГСМ].Children,
            [Measures].[Розничная цена]
        )'
    set [Территории]
    as '[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].children'
    member [Measures].[Средняя цена ]
    as 'avg
        (
            [Территории],
            [Measures].[Цена ]
        )'
    member measures.[Период ]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [Строки]
    as 'iif(Rank(<%period_first_year%>, [FilterColumnSet]) = 0,
    Union({<%period_first_year%>}, [FilterColumnSet], All),
    [FilterColumnSet])'
select
    {
        measures.[Период ],
        [Measures].[Средняя цена ]
    }  on columns,
    [Строки] on rows
from [Организации_Цены на ГСМ]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[ОРГАНИЗАЦИИ Цены на ГСМ],
        [Организации__Виды ГСМ].[Организации__Виды ГСМ].[Все].[ОРГАНИЗАЦИИ Цены на ГСМ].[<%oil%>]
    )
    ]]>
  </query>
</root>