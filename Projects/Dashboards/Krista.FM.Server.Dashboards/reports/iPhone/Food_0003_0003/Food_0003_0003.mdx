<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="Food_0003_0003_incomes_date">
    <![CDATA[ -- Food_0003_0003_incomes_date
with
    member [Measures].[ДанныеНа]
    as '[Период__День].[Период__День].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период__День].[Период__День].[День].Members,
                not IsEmpty([Measures].[Цена]) and [Measures].[Цена] > 0
            ),
            2
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    {
        [NonEmptySet]
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Департамент экономики],
        <%food%>,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
        [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )
    ]]>
  </query>

  <query id="Food_0003_0003_grid">
    <![CDATA[ -- Food_0003_0003_grid
with
    set [Предприятия]
    as 'filter
        (except(
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Значение не указано]),
            (not IsEmpty([Measures].[Цена на предыдущую дату]) and [Measures].[Цена на предыдущую дату] > 0) or
            (not IsEmpty([Measures].[Цена на текущую дату]) and [Measures].[Цена на текущую дату] > 0)
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Цена],
            <%period_last_date%>
        )'
    member [Measures].[Цена на текущую дату]
    as '
        (
            [Measures].[Цена],
            <%period_cur_date%>
        )'
    member [Measures].[Абсолютное отклонение]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and not IsEmpty
            (
                [Measures].[Цена на текущую дату]
            ),
            [Measures].[Цена на текущую дату] - [Measures].[Цена на предыдущую дату],
            null
        )'
    member [Measures].[ТП]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and not IsEmpty
            (
                [Measures].[Цена на текущую дату]
            ) and [Measures].[Цена на предыдущую дату] > 0,
            [Measures].[Цена на текущую дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
select
    {
        [Measures].[Цена на предыдущую дату],
        [Measures].[Цена на текущую дату],
        [Measures].[Абсолютное отклонение],
        [Measures].[ТП]
    } on columns,
    [Предприятия] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Департамент экономики],
        <%food%>,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[<%Mo%>],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )
    ]]>
  </query>
  
</root>