<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0016_0005_date">
    <![CDATA[
    --FO_0016_0005_date
with                
    member [Measures].[ДанныеНа]  
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'      
    set [Показатели]      
    as 'Filter             
        (
            Descendants      
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF      
            ),
            not isEmpty 
            (
                [Measures].[Количество нарушений] 
            ) and not 
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]            
            ) and not  
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]  
            ) and 
            (
                [Период__Период].[Период__Период].CurrentMember 
            ) 
        )'          
    set [NonEmptySet]                
    as 'Tail                
        (
            Filter                
            (
                Descendants                
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF                
                ),
                not IsEmpty  ( Aggregate([Показатели]) ) and    
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"                
                )                
            ),
            1  
        )'                
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows  
from [ФО_БККУ_Показатели]             
    ]]>
  </query> 
  
  <query id="FO_0016_0005_labelMax">
    <![CDATA[
    --FO_0016_0005_labelMax
  with 
    set [ГО] 
    as ' Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО" 
            ) and not 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    set [СП] 
    as ' Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" 
            ) or 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП" 
            ) 
        )' 
    set [МР] 
    as ' Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" 
            ) and 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    set [Районы] 
    as 'IIF 
        (
            "<%selected_motype%>" = "Городские округа",
            [ГО],
            IIF (
                 "<%selected_motype%>" = "Муниципальные районы",
                 [МР],
                 [СП]
                )
        )' 
    member [Measures].[Количество нарушений ]
    as '
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
            )
        )'
    member [Measures].[Максимальное количество нарушений]
    as ' Max
        (
            [Районы],
            [Measures].[Количество нарушений ]
        )'
    set [Районы с максимальным количеством нарушений]
    as 'Filter
        (
            [Районы],
            [Measures].[Количество нарушений ] = [Measures].[Максимальное количество нарушений]
        )'
    member [Measures].[Количество районов max]
    as '[Районы с максимальным количеством нарушений].Count'
    member [Measures].[Район]  
    as 'IIF  
        (
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"  
            ) or  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"  
            ),
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.Name,
            null  
        )' 
    member [Measures].[Наименование района]
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'
select
    {
        [Measures].[Наименование района],
        [Measures].[Район],
        [Measures].[Максимальное количество нарушений],
        [Measures].[Количество районов max]
    } on columns,
    { [Районы с максимальным количеством нарушений] } on rows
from  [ФО_БККУ_Показатели]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>] 
    )
  ]]>
  </query>

  <query id="FO_0016_0005_labelMin">
    <![CDATA[
    --FO_0016_0005_labelMin
    with 
    set [ГО] 
    as ' Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО" 
            ) and not 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    set [СП] 
    as ' Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" 
            ) or 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП" 
            ) 
        )' 
    set [МР] 
    as ' Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" 
            ) and 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
            ) 
        )' 
    set [Районы] 
    as 'IIF 
        (
            "<%selected_motype%>" = "Городские округа",
            [ГО],
            IIF (
                 "<%selected_motype%>" = "Муниципальные районы",
                 [МР],
                 [СП]
                )
        )' 
    member [Measures].[Количество нарушений ]
    as '
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
            )
        )'
    member [Measures].[Минимальное количество нарушений]
    as ' Min
        (
            [Районы],
            [Measures].[Количество нарушений ]
        )'
    set [Районы с минимальным количеством нарушений]
    as 'Filter
        (
            [Районы],
            [Measures].[Количество нарушений ] = [Measures].[Минимальное количество нарушений]
        )'
    member [Measures].[Количество районов min]
    as '[Районы с минимальным количеством нарушений].Count'
    member [Measures].[Район]  
    as 'IIF  
        (
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"  
            ) or  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"  
            ),
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.Name,
            null  
        )'  
    member [Measures].[Наименование района]
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'
select
    {
        [Measures].[Наименование района],
        [Measures].[Район],
        [Measures].[Минимальное количество нарушений],
        [Measures].[Количество районов min]
    } on columns,
    { [Районы с минимальным количеством нарушений] } on rows
from  [ФО_БККУ_Показатели]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>] 
    )
  ]]>
  </query>

 
</root>
