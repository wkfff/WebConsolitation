<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="Food_0002_0001_incomes_date">
    <![CDATA[
    --Food_0002_0001_incomes_date
with
    member [Measures].[ДанныеНа]
    as '[Период].[День].CurrentMember.UniqueName'
    set [NonEmptySet]
    as ' Tail
        (
            Filter
            (
                [Период].[День].[День].Members,
                not IsEmpty
                (
                    (
                        [Measures].[Средняя цена],
                        [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары]
                    )
                )
            ),
            2
        )'
select
    {
        [Measures].[ДанныеНа]
    } on columns,
    { [NonEmptySet] } on rows
from   [ОРГАНИЗАЦИИ_Цены и тарифы]
WHERE        
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена]  
    )   
  ]]>
  </query>

  <query id="Food_0002_0001_table1_v">
    <![CDATA[
    --Food_0002_0001_table1_v
WITH         
    SET [Территории]
    AS '(
            Filter      
            (
                [Территории].[РФ].[МР ГО].Members,
                not IsEmpty      
                (
                    (
                        [Measures].[Средняя цена],
                        [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары]      
                    )      
                )   and      
                (
                    [Территории].[РФ].CurrentMember.Properties("Тип территории") = "ГО"      
                )  and not    
                (
                    [Территории].[РФ].CurrentMember is  [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область].[Город Вологда]    
                )    
            )  
        ) '  
    SET [Товары]  
    AS ' Descendants       
        (
            [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары],
            [Организации].[Товары и услуги].[Уровень 3],
            SELF_AND_AFTER       
        )' 
    member measures.[Текущая цена] 
    as ' 
        (
            <%period_cur_date%>,
            [Measures].[Средняя цена] 
        )' 
    member measures.[Прошлая цена] 
    as ' 
        (
            <%period_last_date%>,
            [Measures].[Средняя цена] 
        )' 
    member measures.[Абсолютное отклонение к прошлой дате] 
    as 'measures.[Текущая цена]  - measures.[Прошлая цена]' 
    member measures.[Темп прироста (динамика к предыдущему периоду)] 
    as 'IIF 
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                measures.[Текущая цена] / measures.[Прошлая цена] - 1 
            ) 
            * 100,
            null 
        )' 
SELECT
    {
        {
            {
                [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область].[Город Вологда] 
            } 
        }           
        * 
        {
            measures.[Текущая цена],
            measures.[Абсолютное отклонение к прошлой дате],
            measures.[Темп прироста (динамика к предыдущему периоду)]
        } 
    } on columns,
    NON EMPTY{[Товары]} on rows  
FROM [ОРГАНИЗАЦИИ_Цены и тарифы]        
WHERE        
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена]  
    )        
  ]]>
  </query>

  <query id="Food_0002_0001_charts">
    <![CDATA[
    --Food_0002_0001_charts
WITH
    SET [Территории]
    AS 'Filter
        (
            [Территории].[РФ].[МР ГО].Members,
            not IsEmpty
            (
                (
                    [Measures].[Средняя цена],
                    [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары]
                )
            )   and
            (
                [Территории].[РФ].CurrentMember.Properties("Тип территории") = "ГО"
            )  and not
            (
                [Территории].[РФ].CurrentMember is  [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область].[Город Вологда]
            )
        )'
    SET [Товары]
    AS ' Descendants
        (
            [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары],
            [Организации].[Товары и услуги].[Уровень 3],
            SELF_AND_AFTER
        )'
    member measures.[Текущая цена]
    as '
        (
            <%period_cur_date%>,
            [Measures].[Средняя цена]
        )'
    member measures.[Прошлая цена]
    as '
        (
            <%period_last_date%>,
            [Measures].[Средняя цена]
        )'
    member measures.[Абсолютное отклонение к прошлой дате]
    as ' measures.[Текущая цена]  - measures.[Прошлая цена]  '
    member measures.[Темп прироста (динамика к предыдущему периоду) модуль]
    as 'IIF
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                abs
                (
                    measures.[Текущая цена] / measures.[Прошлая цена] - 1
                )
            )
            * 100,
            null
        )'
    member measures.[Темп прироста (динамика к предыдущему периоду) ]
    as 'IIF
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                measures.[Текущая цена] / measures.[Прошлая цена] - 1
            )
            * 100,
            null
        )'
    set [Максимум товар]
    as ' Head
        (
            Order
            (
                Filter
                (
                    [Товары],
                    not IsEmpty
                    (
                        measures.[Темп прироста (динамика к предыдущему периоду) модуль]
                    )
                ),
                measures.[Темп прироста (динамика к предыдущему периоду) модуль],
                BDESC
            ),
            6
        )'
    member [Measures].[Минимум ]
    as '
        (
            Tail
            (
                Order
                (
                    Filter
                    (
                        [Территории],
                        not IsEmpty
                        (
                            (
                                measures.[Текущая цена],
                                [Организации].[Товары и услуги].CurrentMember
                            )
                        )
                    ),
                    measures.[Текущая цена],
                    BDESC
                )
            ).Item(0),
            measures.[Текущая цена]
        ) '
    member [Measures].[Минимум прошлая дата]
    as '
        (
            Tail
            (
                Order
                (
                    Filter
                    (
                        [Территории] ,
                        not IsEmpty
                        (
                            (
                                measures.[Прошлая цена],
                                [Организации].[Товары и услуги].CurrentMember
                            )
                        )
                    ),
                    measures.[Прошлая цена],
                    BDESC
                )
            ).Item(0),
            measures.[Прошлая цена]
        ) '
    member measures.[Темп прироста (динамика к предыдущему периоду) минимум]
    as 'IIF
        (
            not IsEmpty
            (
                [Measures].[Минимум прошлая дата]
            ) and not
            (
                [Measures].[Минимум прошлая дата]   = 0
            ),
            (
                [Measures].[Минимум ] / [Measures].[Минимум прошлая дата] - 1
            )
            * 100,
            null
        )'
        member measures.[Абсолютное отклонение к прошлой дате минимум]
    as ' [Measures].[Минимум ]  - [Measures].[Минимум прошлая дата]'
    member [Measures].[Минимум город]
    as ' Tail
        (
            Order
            (
                Filter
                (
                    [Территории] ,
                    not IsEmpty
                    (
                        (
                            measures.[Текущая цена],
                            [Организации].[Товары и услуги].CurrentMember
                        )
                    )
                ),
                measures.[Текущая цена],
                BDESC
            )
        ).Item(0).Properties("Name") '
    member [Measures].[Максимум ]
    as '
        (
            Tail
            (
                Order
                (
                    Filter
                    (
                        [Территории] ,
                        not IsEmpty
                        (
                            (
                                measures.[Текущая цена],
                                [Организации].[Товары и услуги].CurrentMember
                            )
                        )
                    ),
                    measures.[Текущая цена],
                    BASC
                )
            ).Item(0),
            measures.[Текущая цена]
        )'
    member [Measures].[Максимум прошлая дата]
    as '
        (
            Tail
            (
                Order
                (
                    Filter
                    (
                        [Территории] ,
                        not IsEmpty
                        (
                            (
                                measures.[Прошлая цена],
                                [Организации].[Товары и услуги].CurrentMember
                            )
                        )
                    ),
                    measures.[Прошлая цена],
                    BASC
                )
            ).Item(0),
            measures.[Прошлая цена]
        )'
    member measures.[Темп прироста (динамика к предыдущему периоду) максимум]
    as 'IIF
        (
            not IsEmpty
            (
                [Measures].[Максимум прошлая дата]
            ) and not
            (
                [Measures].[Максимум прошлая дата]   = 0
            ),
            (
                [Measures].[Максимум ] / [Measures].[Максимум прошлая дата] - 1
            )
            * 100,
            null
        )'
        member measures.[Абсолютное отклонение к прошлой дате максимум]
    as ' [Measures].[Максимум ]  - [Measures].[Максимум прошлая дата]'
    member [Measures].[Максимум город]
    as ' Tail
        (
            Order
            (
                Filter
                (
                    [Территории] ,
                    not IsEmpty
                    (
                        (
                            measures.[Текущая цена],
                            [Организации].[Товары и услуги].CurrentMember
                        )
                    )
                ),
                measures.[Текущая цена],
                BASC
            )
        ).Item(0).Properties("Name")'
SELECT
    {   
        {
            measures.[Текущая цена],
            measures.[Темп прироста (динамика к предыдущему периоду) ],
            measures.[Абсолютное отклонение к прошлой дате],
            [Measures].[Минимум ],
            measures.[Темп прироста (динамика к предыдущему периоду) минимум],
            measures.[Абсолютное отклонение к прошлой дате минимум],
            [Measures].[Минимум город],
            [Measures].[Максимум ],
            measures.[Темп прироста (динамика к предыдущему периоду) максимум],
            measures.[Абсолютное отклонение к прошлой дате максимум],
            [Measures].[Максимум город]
        }
    } on columns,
    NON EMPTY   {[Максимум товар] }  on rows
FROM [ОРГАНИЗАЦИИ_Цены и тарифы]
WHERE
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена],
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область].[Город Вологда]        
    )
  ]]>
  </query>

  <query id="Food_0002_0001_Text">
    <![CDATA[
    --Food_0002_0001_Text
WITH
    SET [Товары]
    AS ' Descendants
        (
            [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары],
            [Организации].[Товары и услуги].[Уровень 3],
            SELF_AND_AFTER
        )'
    member measures.[Текущая цена]
    as '
        (
            <%period_cur_date%>,
            [Measures].[Средняя цена]
        )'
    member measures.[Прошлая цена]
    as '
        (
            <%period_last_date%>,
            [Measures].[Средняя цена]
        )'
    member measures.[Абсолютное отклонение к прошлой дате]
    as ' measures.[Текущая цена]  - measures.[Прошлая цена]  '
    member measures.[Темп прироста (динамика к предыдущему периоду) модуль]
    as 'IIF
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                measures.[Текущая цена] / measures.[Прошлая цена] - 1
            )
            * 100,
            null
        )'
    set [Рост товар]
    as ' Head
        (
            Order
            (
                Filter
                (
                    [Товары],
                    not IsEmpty
                    (
                        measures.[Темп прироста (динамика к предыдущему периоду) модуль]
                    )
                ),
                measures.[Темп прироста (динамика к предыдущему периоду) модуль],
                BDESC
            ),
            5
        )'
    set [Снижение товар]
    as ' Tail
        (
            Order
            (
                Filter
                (
                    [Товары],
                    not IsEmpty
                    (
                        measures.[Темп прироста (динамика к предыдущему периоду) модуль]
                    ) and (measures.[Темп прироста (динамика к предыдущему периоду) модуль] < 0)
                ),
                measures.[Темп прироста (динамика к предыдущему периоду) модуль],
                BDESC
            ),
            5
        )'
SELECT
    {
        {
            [Measures].[Средняя цена],
            measures.[Темп прироста (динамика к предыдущему периоду) модуль],
            measures.[Абсолютное отклонение к прошлой дате]
        }
    } on columns,
    NON EMPTY
    {
        {[Рост товар]}
        + {[Снижение товар]}
    } on rows
FROM [ОРГАНИЗАЦИИ_Цены и тарифы]
WHERE
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Вологдастат],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена] ,
        [Территории].[РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Вологодская область].[Вологодская область].[Город Вологда]
    )
  ]]>
  </query>

</root>