<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="Oil_0001_0004_incomes_regional_date">
    <![CDATA[ -- Oil_0001_0004_incomes_regional_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период__День].[Период__День].CurrentMember.UniqueName'
    set [NonEmptySet] 
    as 'Union(Head 
        (
            Filter 
            (
                Descendants 
                (
                    [Период__День].[Период__День].[Данные всех периодов],
                    [Период__День].[Период__День].[День],
                    SELF_AND_AFTER 
                ) ,
                not IsEmpty 
                (
                    (
                        [Measures].[Цена],
                        [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                    ) 
                ) and not 
                (
                    [Measures].[Цена],
                    [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                ) = 0 and 
                (
                    [Период__День].[Период__День].CurrentMember.Parent.Parent.Parent.Parent.Name = tail
                    (
                        Filter 
                        (
                            Descendants 
                            (
                                [Период__День].[Период__День].[Данные всех периодов],
                                [Период__День].[Период__День].[День],
                                SELF_AND_AFTER 
                            ) ,
                            not IsEmpty 
                            (
                                (
                                    [Measures].[Цена],
                                    [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                                ) 
                            ) and not 
                            (
                                [Measures].[Цена],
                                [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                            ) = 0 
                        ),
                        1 
                    ).Item(0).Parent.Parent.Parent.Parent.Properties("Name") 
                ) 
            ),
            1 
        ),
        tail 
        (
            Filter 
            (
                Descendants 
                (
                    [Период__День].[Период__День].[Данные всех периодов],
                    [Период__День].[Период__День].[День],
                    SELF_AND_AFTER 
                ) ,
                not IsEmpty 
                (
                    (
                        [Measures].[Цена],
                        [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                    ) 
                ) and not 
                (
                    [Measures].[Цена],
                    [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
                ) = 0 
            ),
            2 
        ), All)' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from  [Организации_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Тип цены].[Организации__Тип цены].[Тип цены].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[(All)].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
    )
    ]]>
  </query>

  <query id="Oil_0001_0004_incomes_federal_date">
    <![CDATA[ -- Oil_0001_0003_incomes_federal_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet] 
    as 'Union(Head 
        (
            Filter 
            (
                Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF_AND_AFTER 
                ) ,
                not IsEmpty 
                (
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                    ) 
                ) and not 
                (
                    [Measures].[Цена],
                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                ) = 0 and 
                (
                    [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Parent.Parent.Name = tail 
                    (
                        Filter 
                        (
                            Descendants 
                            (
                                [Период__Период].[Период__Период].[Данные всех периодов],
                                [Период__Период].[Период__Период].[День],
                                SELF_AND_AFTER 
                            ) ,
                            not IsEmpty 
                            (
                                (
                                    [Measures].[Цена],
                                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                                ) 
                            ) and not 
                            (
                                [Measures].[Цена],
                                [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                            ) = 0 
                        ),
                        1 
                    ).Item(0).Parent.Parent.Parent.Parent.Properties("Name") 
                ) 
            ),
            1 
        ),
        tail 
        (
            Filter 
            (
                Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF_AND_AFTER 
                ) ,
                not IsEmpty 
                (
                    (
                        [Measures].[Цена],
                        [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                    ) 
                ) and not 
                (
                    [Measures].[Цена],
                    [Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember 
                ) = 0 
            ),
            2 
        ), All)' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from [ФСГС_Цены РФ] 
where 
    (
        [Источники данных].[Источники данных].[Все источники данных],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>] 
    )
    ]]>
  </query>
    
  <query id="Oil_0001_0004_table1">
    <![CDATA[ -- Oil_0001_0004_table1
with
    set [МР]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                SELF_AND_BEFORE
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and not IsEmpty
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Итого],
                    [Measures].[Средняя розничная цена на текущую дату]
                )
            ) and
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[МР]
                ) or
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Measures].[ГП СП]
                )
            )
        )'
    set [ГО]
    as 'filter
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Ханты-Мансийск] + Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                SELF_AND_BEFORE
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and not IsEmpty
            (
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Итого],
                    [Measures].[Средняя розничная цена на текущую дату]
                )
            ) and
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Город]
            )
        )'
    set [Территории]
    as '[ГО] + [МР]'
    member [Measures].[Город]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[МР]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count > 0,
            true,
            false
        )'
    member [Measures].[ГП СП]
    as 'iif
        (
            [Measures].[Уровень] = "ГП СП ВТГФЗ" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[Средняя розничная цена_Город]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена_МР]
    as 'avg
        (
            [Организации],
            [Measures].[Средняя по организации]
        )'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children,
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
                [Measures].[Цена]
            )
        )'
    member [Measures].[Средняя по организации_Город]
    as '
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена_ГП СП]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[ХМАО]
    as 'null'
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Город]
    as 'null'
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[МР]
    as 'null'
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[ГП СП]
    as 'null'
    set [Организации]
    as '
        {
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[ХМАО]
        } +
        {
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[МР]
        } +
        {
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Город]
        } +
        {
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[ГП СП]
        } + [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children'
    member [Measures].[Средняя розничная цена]
    as 'iif([Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "ХМАО",
        1,
        iif
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "МР",
            [Measures].[Средняя розничная цена_МР],
            iif
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "Город",
                [Measures].[Средняя розничная цена_Город],
                iif
                (
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "ГП СП",
                    [Measures].[Средняя розничная цена_ГП СП],
                    [Measures].[Средняя по организации_Город]
                )
            )
        ))'
    member [Measures].[Средняя розничная цена на текущую дату]
    as '
        (
            <%period_cur_date%>,
            [Measures].[Средняя розничная цена]
        )'
    member [Measures].[Средняя розничная цена на предыдущую дату]
    as '
        (
            <%period_last_date%>,
            [Measures].[Средняя розничная цена]
        )'
    member [Measures].[Средняя розничная цена на начало года]
    as '
        (
            <%period_first_year%>,
            [Measures].[Средняя розничная цена]
        )'
    member [Measures].[Абсолютное отклонение к предыдущему периоду]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Средняя розничная цена на текущую дату]
            ) and not IsEmpty
            (
                [Measures].[Средняя розничная цена на предыдущую дату]
            ),
            [Measures].[Средняя розничная цена на текущую дату] - [Measures].[Средняя розничная цена на предыдущую дату],
            null
        )'
    member [Measures].[Темп прироста к предыдущему периоду]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Средняя розничная цена на текущую дату]
            ) and not IsEmpty
            (
                [Measures].[Средняя розничная цена на предыдущую дату]
            ) and [Measures].[Средняя розничная цена на предыдущую дату] > 0,
            [Measures].[Средняя розничная цена на текущую дату] / [Measures].[Средняя розничная цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Абсолютное отклонение к началу года]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Средняя розничная цена на текущую дату]
            ) and not IsEmpty
            (
                [Measures].[Средняя розничная цена на начало года]
            ),
            [Measures].[Средняя розничная цена на текущую дату] - [Measures].[Средняя розничная цена на начало года],
            null
        )'
    member [Measures].[Темп прироста к началу года]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Средняя розничная цена на текущую дату]
            ) and not IsEmpty
            (
                [Measures].[Средняя розничная цена на предыдущую дату]
            ) and [Measures].[Средняя розничная цена на начало года] > 0,
            [Measures].[Средняя розничная цена на текущую дату] / [Measures].[Средняя розничная цена на начало года] - 1,
            null
        )'
    member [Measures].[Уровень]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Level.Name'
    member [Measures].[Числовой уровень]
    as 'iif
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "МР" or
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "Город",
            1,
            iif
                (
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "ГП СП",
                    2,
                    3
                )
        )'
    set [Территории для ранга]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
                SELF
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and not IsEmpty
            (
                [Measures].[Средняя розничная цена на текущую дату]
            )
        )'
    member [Measures].[Прямой ранг]
    as 'Rank
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
            [Территории для ранга],
            [Measures].[Средняя розничная цена на текущую дату]
        )'
    member [Measures].[Худший ранг]
    as 'iif
        (
            [Measures].[Город] or [Measures].[МР],
        Max
        (
            [Территории для ранга],
            [Measures].[Прямой ранг]
        ),
        null)'
    member [Measures].[Обратный ранг]
    as '[Measures].[Худший ранг] - [Measures].[Прямой ранг] + 1'
    member [Measures].[Ранг]
    as 'iif
        (
            [Measures].[Город] or [Measures].[МР],
            [Measures].[Обратный ранг],
            null
        )'
    set [МО]
    as 'filter
        (
            descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                SELF_AND_BEFORE
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember
        )'
    member [Measures].[Тест]
    as 'iif
        (
            (
                [Measures].[Город] and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name <> "ХМАО" and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name <> "МР" and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name <> "ГП СП"
            ) or
            (
                [Measures].[ГП СП] and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name <> "ХМАО" and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name <> "МР" and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name <> "Город"
            ) or
            (
                [Measures].[МР] and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "МР"
            ) or ([Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name = "Ханты-Мансийский автономный округ" and [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "ХМАО"),
            true,
            false
        )'
    member [Measures].[Имя]
    as 'iif
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "МР" or [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "Город" or [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name = "ГП СП",
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name,
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember.Name
        )'
select
    {
        [Measures].[Имя],
        [Measures].[Средняя розничная цена на текущую дату],
        [Measures].[Абсолютное отклонение к предыдущему периоду],
        [Measures].[Темп прироста к предыдущему периоду],
        [Measures].[Абсолютное отклонение к началу года],
        [Measures].[Темп прироста к началу года],
        [Measures].[Числовой уровень],
        [Measures].[Ранг],
        [Measures].[Худший ранг]
    } on columns,
    nonempty
    (
        filter
        (
            [МО]
            * [Организации],
            [Measures].[Тест]
        ),
        [Measures].[Средняя розничная цена на текущую дату]
    ) on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
    )
    ]]>
  </query>

  <query id="Oil_0001_0004_table2">
    <![CDATA[ -- Oil_0001_0004_table2
with  
    member [Measures].[Текущая средняя цена ]  
    as '[Measures].[Текущая цена]'  
   member [Measures].[Текущая цена] 
    as ' IIF 
        (
            (
                <%period_cur_date%>,
                [Measures].[Цена] 
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Measures].[Цена] 
            ) 
        ) ' 
    member [Measures].[Прошлая цена] 
    as ' IIF 
        (
            (
                <%period_last_date%>,
                [Measures].[Цена] 
            ) = 0,
            null,
            (
                <%period_last_date%>,
                [Measures].[Цена] 
            ) 
        ) ' 
    member [Measures].[Начало года цена] 
    as ' IIF 
        (
            (
                <%period_first_year%>,
                [Measures].[Цена] 
            ) = 0,
            null,
            (
                <%period_first_year%>,
                [Measures].[Цена] 
            ) 
        ) ' 
     member [Measures].[Абсолютное отклонение к прошлой дате]      
    as 'IIF      
        (
            isEmpty( [Measures].[Прошлая цена]) or isEmpty( [Measures].[Текущая цена]),
            null,
            [Measures].[Текущая цена]  - [Measures].[Прошлая цена]   
        )'  
    member [Measures].[Абсолютное отклонение к началу года]   
    as 'IIF   
        (
            isEmpty([Measures].[Начало года цена]) or isEmpty( [Measures].[Текущая цена]),
            null,
            [Measures].[Текущая цена]  - [Measures].[Начало года цена]   
        )'   
    member [Measures].[Темп прироста (динамика к предыдущему периоду)]      
    as 'IIF
        (
            IsEmpty([Measures].[Прошлая цена]) or
            (
                [Measures].[Прошлая цена] = 0
            ),
            null,
            IIF
            (
                (
                    [Measures].[Текущая цена] = [Measures].[Прошлая цена]
                ),
                0,
                (
                    [Measures].[Текущая цена] / [Measures].[Прошлая цена] - 1
                )
            )
        )'
    member [Measures].[Темп прироста (динамика за период с начала года) ]      
    as 'IIF      
        (
            IsEmpty([Measures].[Начало года цена]) or
            (
                [Measures].[Начало года цена] = 0      
            ),
            null,
            IIF     
            (
                (
                    [Measures].[Текущая цена] = [Measures].[Начало года цена]      
                ),
                0,
                (
                    [Measures].[Текущая цена] / [Measures].[Начало года цена] - 1      
                )      
            )     
        )'    	      
    set [Территории]  
    as 'filter  
        (
            Descendants  
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                LEAVES  
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Цена])  
        )'  
   
   
    member [Measures].[Имя]  
    as '  [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.Name'  
    member [Measures].[Уровень] 
    as '1' 
    member [Measures].[Ранг цена]
    as '0'
    member [Measures].[Худший ранг цена]
    as '100'
SELECT
    {
        [Measures].[Имя],
        [Measures].[Текущая цена],
        [Measures].[Абсолютное отклонение к прошлой дате],
        [Measures].[Темп прироста (динамика к предыдущему периоду)],
        [Measures].[Абсолютное отклонение к началу года],
        [Measures].[Темп прироста (динамика за период с начала года) ],
        [Measures].[Уровень],
        [Measures].[Ранг цена],
        [Measures].[Худший ранг цена] 
    } on columns,
    {
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].DataMember
    } on rows  
from [ФСГС_Цены РФ]  
where  
    (
        [Источники данных].[Источники данных].[Все источники данных],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>]  
    )  
    ]]>
  </query>

  <query id="Oil_0001_0004_grid_hmao">
    <![CDATA[ -- Oil_0001_0004_grid_hmao
with
    set [Территории]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                LEAVES
            ),
            not IsEmpty ([Measures].[Цена])
        )'
    set [Организации]
    as 'filter
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            not IsEmpty
            (
                [Measures].[Средняя по организации]
            )
        )'
    set [Даты]
    as '
        {
            <%period_cur_date%>,
            <%period_last_date%>,
            <%period_first_year%>
        }'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории],
            ( [Measures].[Цена ] )
        )'
    member [Measures].[Цена ]
    as '
        (
            [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
            [Measures].[Цена],
            [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            [Период__День].[Период__День].CurrentMember,
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]
        )'
select
    [Даты] on columns,
    [Организации] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Measures].[Средняя по организации]
    )
    ]]>
  </query>

</root>