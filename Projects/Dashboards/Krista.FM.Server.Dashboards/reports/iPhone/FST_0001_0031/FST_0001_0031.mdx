<?xml version="1.0" encoding="Windows-1251"?>
<root>
<query id="FST_0001_0031_Grid">
    <![CDATA[
-- FST_0001_0031_Grid
with              
    member [ФСТ].[Показатели].[Уровень]              
    as '[Территории].[Сопоставимый].CurrentMember.Level.Name'              
    set [Все регионы]              
    as 'filter              
        (
            Descendants              
            (
                [Территории].[Сопоставимый].[Все территории],
                [Территории].[Сопоставимый].[РФ],
                SELF_AND_AFTER              
            ) ,
            not              
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember              
            ) and not [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Несопоставленные данные]    and not              
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "МР ГО"              
            )              
        )'              
    member [ФСТ].[Показатели].[Ранг среднеотпускной тариф ФО]              
    as 'IIF              
        (
            IsEmpty              
            (
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение]         
            ) or  [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] = 0,
            null,
            Rank              
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order              
                (
                    Filter              
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty              
                        (
                            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение]         
                        ) and not [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] = 0         
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение],
                    BDESC              
                ),
                [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение]         
            )              
        )'         
    member [ФСТ].[Показатели].[Ранг Рост тарифа]         
    as 'IIF         
        (
            IsEmpty         
            (
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение]         
            ) or [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] = 0,
            null,
            Rank         
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order         
                (
                    Filter         
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty         
                        (
                            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение]         
                        ) and not [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] = 0         
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение],
                    BDESC         
                ),
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение]         
            )         
        )'         
    member [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для населения]         
    as 'IIF         
        (
            IsEmpty         
            (
                [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения]         
            ) or [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения] = 0,
            null,
            Rank         
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order         
                (
                    Filter         
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty         
                        (
                            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения]         
                        ) and not [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения] = 0         
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения],
                    BDESC         
                ),
                [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения]         
            )         
        )'          
    member [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для населения]       
    as 'IIF       
        (
            IsEmpty       
            (
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения]       
            ) or [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения] = 0,
            null,
            Rank       
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order       
                (
                    Filter       
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty       
                        (
                            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения]       
                        ) and not [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения] = 0       
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения],
                    BDESC       
                ),
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения]       
            )       
        )'       
     
    member [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для бюджетных потребителей]    
    as 'IIF    
        (
            IsEmpty    
            (
                [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей]    
            ) or [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей] = 0,
            null,
            Rank    
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty    
                        (
                            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей]    
                        ) and not [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей] = 0    
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей],
                    BDESC    
                ),
                [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей]    
            )    
        )'    
    member [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для бюджетных потребителей]    
    as 'IIF    
        (
            IsEmpty    
            (
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей]    
            ) or [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей] = 0,
            null,
            Rank    
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty    
                        (
                            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей]    
                        ) and not [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей] = 0    
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей],
                    BDESC    
                ),
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей]    
            )    
        )'    
    member [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для прочих потребителей]   
    as 'IIF   
        (
            IsEmpty   
            (
                [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей]   
            ) or [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей] = 0,
            null,
            Rank   
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order   
                (
                    Filter   
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty   
                        (
                            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей]   
                        ) and not [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей] = 0   
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей],
                    BDESC   
                ),
                [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей]   
            )   
        )'   
    member [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для прочих потребителей]  
    as 'IIF  
        (
            IsEmpty  
            (
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей]  
            ) or [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей] = 0,
            null,
            Rank  
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order  
                (
                    Filter  
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings ,
                        not IsEmpty  
                        (
                            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей]  
                        ) and not [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей] = 0  
                    ),
                    [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей],
                    BDESC  
                ),
                [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей]  
            )  
        )'  
    member [ФСТ].[Показатели].[Единицы измерения ]              
    as '"руб./кВт.ч."'              
   member [ФСТ].[Показатели].[Худший среднеотпускной тариф ФО]              
    as 'max              
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг среднеотпускной тариф ФО]              
        )'         
    member [ФСТ].[Показатели].[Худший Рост тарифа]         
    as 'max         
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг Рост тарифа]         
        )'         
    member [ФСТ].[Показатели].[Худший Тариф на водоснабжение для населения]         
    as 'max         
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для населения]         
        )'       
    member [ФСТ].[Показатели].[Худший Рост тарифа на водоснабжение для населения]       
    as 'max       
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для населения]
        )'       
    member [ФСТ].[Показатели].[Худший Тариф на водоснабжение для бюджетных потребителей]      
    as 'max      
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для бюджетных потребителей]
        )'    
    member [ФСТ].[Показатели].[Худший Рост тарифа на водоснабжение для бюджетных потребителей]    
    as 'max    
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для бюджетных потребителей]
        )'    
    member [ФСТ].[Показатели].[Худший Тариф на водоснабжение для прочих потребителей]   
    as 'max   
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для прочих потребителей]
        )'   
    member [ФСТ].[Показатели].[Худший Рост тарифа на водоснабжение для прочих потребителей]  
    as 'max  
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для прочих потребителей]
        )'   
    member [ФСТ].[Показатели].[Рост тарифа на водоснабжение ]
    as 'IIF
        (
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] > 0,
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение] - 1,
            null
        )'
    member [ФСТ].[Показатели].[Рост тарифа на водоснабжение для населения ]
    as 'IIF
        (
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения] > 0,
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для населения] - 1,
            null
        )'
    member [ФСТ].[Показатели].[Рост тарифа на водоснабжение для бюджетных потребителей ]
    as 'IIF
        (
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей] > 0,
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для бюджетных потребителей] - 1,
            null
        )'
    member [ФСТ].[Показатели].[Рост тарифа на водоснабжение для прочих потребителей ]
    as 'IIF
        (
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей] > 0,
            [ФСТ].[Показатели].[Все показатели].[Рост тарифа на водоснабжение для прочих потребителей] - 1,
            null
        )'
        member [ФСТ].[Показатели].[Среднеотпускной тариф на водоснабжение ]  
    as 'IIF  
        (
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение] > 0,
            [ФСТ].[Показатели].[Все показатели].[Среднеотпускной тариф на водоснабжение],
            null  
        )'
    member [ФСТ].[Показатели].[Тариф на водоснабжение для населения ]  
    as 'IIF  
        (
            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения] > 0,
            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для населения],
            null  
        )'
    member [ФСТ].[Показатели].[Тариф на водоснабжение для бюджетных потребителей ]  
    as 'IIF  
        (
            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей] > 0,
            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для бюджетных потребителей],
            null  
        )'
    member [ФСТ].[Показатели].[Тариф на водоснабжение для прочих потребителей ]  
    as 'IIF  
        (
            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей] > 0,
            [ФСТ].[Показатели].[Все показатели].[Тариф на водоснабжение для прочих потребителей],
            null  
        )'
select
    {
        [ФСТ].[Показатели].[Среднеотпускной тариф на водоснабжение ],
        [ФСТ].[Показатели].[Рост тарифа на водоснабжение ],
        [ФСТ].[Показатели].[Тариф на водоснабжение для населения ],
        [ФСТ].[Показатели].[Рост тарифа на водоснабжение для населения ],
        [ФСТ].[Показатели].[Тариф на водоснабжение для бюджетных потребителей ],
        [ФСТ].[Показатели].[Рост тарифа на водоснабжение для бюджетных потребителей ],
        [ФСТ].[Показатели].[Тариф на водоснабжение для прочих потребителей ],
        [ФСТ].[Показатели].[Рост тарифа на водоснабжение для прочих потребителей ],
        [ФСТ].[Показатели].[Ранг среднеотпускной тариф ФО],
        [ФСТ].[Показатели].[Худший среднеотпускной тариф ФО],
        [ФСТ].[Показатели].[Ранг Рост тарифа],
        [ФСТ].[Показатели].[Худший Рост тарифа],
        [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для населения],
        [ФСТ].[Показатели].[Худший Тариф на водоснабжение для населения],
        [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для населения],
        [ФСТ].[Показатели].[Худший Рост тарифа на водоснабжение для населения],
        [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для бюджетных потребителей],
        [ФСТ].[Показатели].[Худший Тариф на водоснабжение для бюджетных потребителей],
        [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для бюджетных потребителей],
        [ФСТ].[Показатели].[Худший Рост тарифа на водоснабжение для бюджетных потребителей],
        [ФСТ].[Показатели].[Ранг Тариф на водоснабжение для прочих потребителей],
        [ФСТ].[Показатели].[Худший Тариф на водоснабжение для прочих потребителей],
        [ФСТ].[Показатели].[Ранг Рост тарифа на водоснабжение для прочих потребителей],
        [ФСТ].[Показатели].[Худший Рост тарифа на водоснабжение для прочих потребителей],
        [ФСТ].[Показатели].[Уровень]  
    }on columns,
    { 
            [Все регионы]  } on rows              
from  [ФСТ_ЖКХ_Тарифы]              
WHERE              
    (
        [Measures].[Факт],
        [Период].[Год Квартал Месяц].[Данные всех периодов].[2011]             
    )              
]]>
</query>

   




</root>