<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="SE_0001_0002_date">
    <![CDATA[
    --SE_0001_0002_date
with
    member [Measures].[ДанныеНа]
    as '[Период].[Год Квартал Месяц].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Год Квартал Месяц].Members,
                not IsEmpty([Measures].[За период]) and
                [Период].[Год Квартал Месяц].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Год Квартал Месяц].CurrentMember.Name <> "Данные квартала" and
                [Период].[Год Квартал Месяц].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Год Квартал Месяц].CurrentMember.Name <> "Данные года" and
                [Период].[Год Квартал Месяц].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [СТАТ_СЭП_Годовой сборник]
where      
    (        
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта],
        [ОК].[ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК].[ОКФС].[Все формы собственности].[Значение не указано],
        [ОК].[Основные возрастные группы].[Все возрастные группы].[Значение не указано],
        [Тип местности].[Все типы местности].[Значение не указано],
        [Половая принадлежность].[Все типы].[Значение не указано],
        [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Отгружено товаров собственного производства, выполнено работ и услуг собственным силами]
    ) 
  ]]>
  </query>

  <query id="SE_0001_0002_loaded">
    <![CDATA[
    --SE_0001_0002_loaded
with
    member [Measures].[Отгружено ]
    as '
        (
            [Measures].[За период],
            [Период].[Год Квартал Месяц].[Данные всех периодов]<%period_month%>
        )'
    member [Measures].[Отгружено прошлый год]
    as '
        (
            [Measures].[За период],
            [Период].[Год Квартал Месяц].[Данные всех периодов]<%period_last_date%>
        )'
    member [Measures].[Прирост ]
    as 'IIF
        (
            not isEmpty
            (
                [Measures].[Отгружено прошлый год]
            ) and not
            (
                [Measures].[Отгружено прошлый год]  = 0
            ) ,
            [Measures].[Отгружено ] / [Measures].[Отгружено прошлый год],
            null
        ) - 1'
    select
    {
        [Measures].[Отгружено ],
        [Measures].[Отгружено прошлый год] ,
        [Measures].[Прирост ]
      
    } on columns,
    {        
        [Территории].[СЭП].[Все территории].[Российская Федерация]
    }on rows
from  [СТАТ_СЭП_Годовой сборник]
where
    (
        [Период].[Год Квартал Месяц].[Данные всех периодов]<%period_month%>,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта],
        [ОК].[ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК].[ОКФС].[Все формы собственности].[Значение не указано],
        [ОК].[Основные возрастные группы].[Все возрастные группы].[Значение не указано],
        [Тип местности].[Все типы местности].[Значение не указано],
        [Половая принадлежность].[Все типы].[Значение не указано],
        [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Отгружено товаров собственного производства, выполнено работ и услуг собственным силами]
    )
  ]]>
  </query>
  
  <query id="SE_0001_0008_chart1">
    <![CDATA[
    --SE_0001_0008_chart5
with      
    member [Measures].[За период ]      
    as '[Measures].[За период] - 100'       
    member [Период].[Год Квартал Месяц].[Наши дни]      
    as '[Период].[Год Квартал Месяц].[Данные всех периодов]<%period_month%>'       
    set [Территории ]      
    as 'Filter   
        (
            [Территории].[СЭП].Children,
            [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"  
        )' 
select
    { {  [Территории ] } }  on rows,
    { [Measures].[За период] } on   columns     
from  [СТАТ_СЭП_Годовой сборник]      
where      
    (
        [Период].[Год Квартал Месяц].[Наши дни],
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта],
        [ОК].[ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК].[ОКФС].[Все формы собственности].[Значение не указано],
        [ОК].[Основные возрастные группы].[Все возрастные группы].[Значение не указано],
        [Тип местности].[Все типы местности].[Значение не указано],
        [Половая принадлежность].[Все типы].[Значение не указано],
        [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Отгружено товаров собственного производства, выполнено работ и услуг собственным силами]      
    ) 
]]>
  </query>

  <query id="SE_0001_0008_chart2">
    <![CDATA[
    --SE_0001_0008_chart2
with       
    member [Measures].[За период ]       
    as '[Measures].[За период] - 100'        
    member [Период].[Год Квартал Месяц].[Наши дни]       
    as '[Период].[Год Квартал Месяц].[Данные всех периодов]<%period_month%>'
    set [Территории ]       
    as 'Filter    
        (
            [Территории].[СЭП].Children,
            [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"   
        )'  
select
    {
        {
            [Территории].[СЭП].[Российская Федерация]
        } + { [Территории ]}
    }  on rows,
    { [Measures].[За период ] } on   columns
from  [СТАТ_СЭП_Годовой сборник]       
where       
    (
        [Период].[Год Квартал Месяц].[Наши дни],
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта],
        [ОК].[ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК].[ОКФС].[Все формы собственности].[Значение не указано],
        [ОК].[Основные возрастные группы].[Все возрастные группы].[Значение не указано],
        [Тип местности].[Все типы местности].[Значение не указано],
        [Половая принадлежность].[Все типы].[Значение не указано],
        [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Индекс промышленного производства]
    ) 
]]>
  </query>

  <query id="SE_0001_0008_index">
    <![CDATA[
    --SE_0001_0008_index
with       
    member [Measures].[За период ]       
    as '[Measures].[За период] - 100'        
    member [Период].[Год Квартал Месяц].[Наши дни]       
    as '[Период].[Год Квартал Месяц].[Данные всех периодов]<%period_month%>'
    set [Территории ]       
    as 'Filter    
        (
            [Территории].[СЭП].Children,
            [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"   
        )'  
select
    {
        {
            [Территории].[СЭП].[Российская Федерация]
        }
    }  on rows,
    { [Measures].[За период ] } on   columns
from  [СТАТ_СЭП_Годовой сборник]       
where       
    (
        [Период].[Год Квартал Месяц].[Наши дни],
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта],
        [ОК].[ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК].[ОКФС].[Все формы собственности].[Значение не указано],
        [ОК].[Основные возрастные группы].[Все возрастные группы].[Значение не указано],
        [Тип местности].[Все типы местности].[Значение не указано],
        [Половая принадлежность].[Все типы].[Значение не указано],
        [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Индекс промышленного производства]
    ) 
]]>
  </query>

  <query id="SE_0001_0008_index_grown_leaders">
    <![CDATA[
    --SE_0001_0008_index_grown_leaders
with     
  member [Measures].[Индекс]as '  
        (
            [Measures].[За период],
            [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Индекс промышленного производства]  
        )'  
    member [Measures].[Индекс ] 
    as ' IIF   
        (
            IsEmpty ( [Measures].[Индекс]) or ( [Measures].[Индекс] )=0,
            0 ,
            ( [Measures].[Индекс])- 100
        )', format_string = '0.00'
    set [Территории ]
    as '
            Order 
            (
                Filter   
                (
                    [Территории].[СЭП].Children,
                    not   
                    (
                        IsEmpty ( [Measures].[Индекс ] ) or   
                        (
                            [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"   
                        ) or   
                        (
                            [Территории].[СЭП].CurrentMember is [Территории].[СЭП].[Все территории].[Российская Федерация]   
                        )   
                    )   
                ),
                ( [Measures].[Индекс ] ),
                BDESC   
            )' 
    set [Рост ]
    as 'Head
        (
            [Территории ],
            3
        )'
        set [Снижение ]
    as 'Tail
        (
            [Территории ],
            3
        )'
select
    {  [Measures].[Индекс ]  }  on columns,
    { { [Рост ]} +  [Снижение ]} on rows
from  [СТАТ_СЭП_Годовой сборник]    
where    
    (
        [Период].[Год Квартал Месяц].[Данные всех периодов]<%period_month%>,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта],
        [ОК].[ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК].[ОКФС].[Все формы собственности].[Значение не указано],
        [ОК].[Основные возрастные группы].[Все возрастные группы].[Значение не указано],
        [Тип местности].[Все типы местности].[Значение не указано],
        [Половая принадлежность].[Все типы].[Значение не указано]    
    )    
]]>
  </query>

  <query id="SE_0001_0008_table1">
    <![CDATA[
    --SE_0001_0008_table1
    with         
    member [Measures].[Отгружено]    
    as '   
        (
            [Measures].[За период],
            [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Отгружено товаров собственного производства, выполнено работ и услуг собственным силами]   
        )'    
    member [Measures].[Индекс]   
    as '   
        (
            [Measures].[За период],
            [СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Индекс промышленного производства]
        )'
    member [Measures].[Доля ]      
    as 'IIF      
        (
            not isEmpty      
            (
                (
                    [Measures].[За период],
                    [Территории].[СЭП].[Все территории].[Российская Федерация]      
                )      
            ) and not      
            (
                (
                    [Measures].[За период],
                    [Территории].[СЭП].[Все территории].[Российская Федерация]      
                )  = 0      
            ) and not      
            (
                (
                    [Территории].[СЭП].CurrentMember is [Территории].[СЭП].[Все территории].[Российская Федерация]      
                )      
            ) ,
            [Measures].[За период] /      
            (
                [Measures].[За период],
                [Территории].[СЭП].[Все территории].[Российская Федерация]      
            ),
            null      
        ) * 100'      
    set [Территории ]         
    as ' [Территории].[СЭП].Children '        
    member Measures.[Ранг по РФ]         
    as 'IIF         
        (
            IsEmpty ( [Measures].[Отгружено]  ) or   
            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"         
            ) or         
            (
                [Территории].[СЭП].CurrentMember is [Территории].[СЭП].[Все территории].[Российская Федерация]         
            ) ,
            null,
            Rank         
            (
                [Территории].[СЭП].CurrentMember,
                Order         
                (
                    Filter        
                    (
                        [Территории ],
                        not        
                        (
                            IsEmpty ( [Measures].[Отгружено]  ) or   
                            (
                                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"        
                            ) or        
                            (
                                [Территории].[СЭП].CurrentMember is [Территории].[СЭП].[Все территории].[Российская Федерация]        
                            )        
                        )       
                    ),
                    ( [Measures].[Отгружено]  ),
                    BDESC         
                ),
                ( [Measures].[Отгружено]  )   
            )         
        ) '         
    member measures.[Худший ранг РФ]         
    as ' max         
        (
            [Территории ],
            Measures.[Ранг по РФ]         
        ) '             
    member Measures.[Ранг по РФ доля]   
    as 'IIF     
        (
            IsEmpty ( [Measures].[Индекс]) or   
            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"     
            ) or     
            (
                [Территории].[СЭП].CurrentMember is [Территории].[СЭП].[Все территории].[Российская Федерация]     
            ) ,
            null,
            Rank     
            (
                [Территории].[СЭП].CurrentMember,
                Order     
                (
                    Filter     
                    (
                        [Территории ],
                        not     
                        (
                            IsEmpty ( [Measures].[Индекс] ) or   
                            (
                                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"     
                            ) or     
                            (
                                [Территории].[СЭП].CurrentMember is [Территории].[СЭП].[Все территории].[Российская Федерация]     
                            )     
                        )     
                    ),
                    ( [Measures].[Индекс] ),
                    BDESC     
                ),
                ( [Measures].[Индекс])   
            )     
        ) '     
    member measures.[Худший ранг РФ доля]     
    as ' max     
        (
            [Территории ],
            Measures.[Ранг по РФ доля]     
        ) '     
select
    {
        {
            [Measures].[Индекс],
            [Measures].[Ранг по РФ доля],
            [measures].[Худший ранг РФ доля],
             [Measures].[Отгружено],
            [Measures].[Ранг по РФ],
            [measures].[Худший ранг РФ],
            [Measures].[Доля ]   
        }         
    }  on columns,
    {   [Территории ] } on rows       
from  [СТАТ_СЭП_Годовой сборник]         
where         
    (
        [Период].[Год Квартал Месяц].[Данные всех периодов]<%period_month%>,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - Без варианта],
        [ОК].[ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК].[ОКФС].[Все формы собственности].[Значение не указано],
        [ОК].[Основные возрастные группы].[Все возрастные группы].[Значение не указано],
        [Тип местности].[Все типы местности].[Значение не указано],
        [Половая принадлежность].[Все типы].[Значение не указано]    
    ) 
    ]]>
  </query>
</root>