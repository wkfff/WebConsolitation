<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FK_0001_0013_date">
    <![CDATA[
-- FK_0001_0013_compare_date   
-- <#[ФК_МесОтч_Доходы]#>
-- Дата
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФК_МесОтч_Доходы]
  ]]>
  </query>

  <query id="FK_0001_0013_compare_Grid">
    <![CDATA[
-- FK_0001_0013_compare_Grid
-- <#[ФК_МесОтч_Доходы]#>
with ---------- Краткий список доходов 
member Measures.[ФО]  
    as 'IIF  
        (
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ" or [Территории].[Сопоставимый].CurrentMember.Level.Name = "Федеральный округ"  
            ) and  
            (
                (
                    Measures.[Исполнено] + Measures.[Назначено]  
                ) <> 0   
            ),
            IIF  
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ",
                Measures.[ParentShortName],
                Measures.[ShortName]  
            ),
            null  
        )'  
    member [КД].[Сопоставимый].[Налоговые и неналоговые доходы ] 
    as 'Aggregate 
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ] 
            } 
        )' 
    member [КД].[Сопоставимый].[Оплата труда с начислениями (фактическая) ] 
    as 'Measures.CurrentMember' 
    member [КД].[Сопоставимый].[Капитальные вложения ] 
    as ' Measures.CurrentMember ' 
    member [КД].[Сопоставимый].[Дефицит / профицит] 
    as ' Measures.CurrentMember ' 
  --  member [КД].[Сопоставимый].[Материальные затраты ] 
  --  as ' Measures.CurrentMember ' 
    
    member [КД].[Сопоставимый].[ИТОГО ДОХОДОВ ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[Доходы - всего в том числе:]' 
    member [КД].[Сопоставимый].[Дотация на выравнивание бюджетной обеспеченности ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований].[Дотации на выравнивание бюджетной обеспеченности]' 
    member [КД].[Сопоставимый].[Налог на прибыль организаций ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]' 
    member [КД].[Сопоставимый].[НДФЛ ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]' 
    member [КД].[Сопоставимый].[Налог на имущество организаций ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[налог на имущество организаций]'
     
    
    member [КД].[Сопоставимый].[Акцизы ] 
    as 'Aggregate 
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации] 
            } 
        )' 
    member [КД].[Сопоставимый].[Налог на имущество физических лиц ]
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц]'
    member [КД].[Сопоставимый].[НДПИ ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]' 
    member [КД].[Сопоставимый].[Земельный налог ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог]'
    member [КД].[Сопоставимый].[Прочие налоговые доходы ] 
    as 'Aggregate 
        (
            {
                --[КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ И ВЗНОСЫ НА СОЦИАЛЬНЫЕ НУЖДЫ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары (работы, услуги), реализуемые на территории Российской Федерации],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары, ввозимые на территорию Российской Федерации],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],                
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на игорный бизнес],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на недвижимость, взимаемый с объектов недвижимого имущества, расположенных в границах городов Великий Новгород и Тверь],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Регулярные платежи за добычу полезных ископаемых (роялти) при выполнении соглашений о разделе продукции],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Водный налог],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Сборы за пользование объектами животного мира и за пользование объектами водных биологических ресурсов],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ГОСУДАРСТВЕННАЯ ПОШЛИНА],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ] 
            } 
        )' 
    member [КД].[Сопоставимый].[Неналоговые доходы ] 
    as 'Aggregate 
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ВНЕШНЕЭКОНОМИЧЕСКОЙ ДЕЯТЕЛЬНОСТИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ (РАБОТ) И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА],
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ]
             } 
        )' 
    member [КД].[Сопоставимый].[Доходы от приносящей доход деятельности ]
    as '[КД].[Сопоставимый].[Все коды доходов].[ДОХОДЫ ОТ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]' 
    member [КД].[Сопоставимый].[Безвозмездные перечисления от других бюджетов ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации]' 
    member [КД].[Сопоставимый].[Доходы ВСЕГО ] 
    as '[КД].[Сопоставимый].[Все коды доходов].[Доходы - всего в том числе:]' ------ 
    member Measures.[Исполнено млн] 
    as '[Measures].[Исполнено]' 
    member Measures.[Темп роста] 
    as '[Measures].[Темп роста к аналогичному периоду предыдущего года_Исполнено]'
    member Measures.[ShortName] 
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование")' 
    member Measures.[ParentShortName] 
    as '[Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование")' 

-- Уровни бюджета 
    member [Уровни бюджета].[СКИФ].[Консолидированный бюджет субъекта] 
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет субъекта]' 
    member [Уровни бюджета].[СКИФ].[Собственный бюджет субъекта] 
    as '[Уровни бюджета].[СКИФ].[Бюджет субъекта]' 
    member [Уровни бюджета].[СКИФ].[Местные бюджеты] 
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет МО]' 
    member [Уровни бюджета].[СКИФ].[Городские округа] 
    as '[Уровни бюджета].[СКИФ].[Бюджет гор.округа]' 
    member [Уровни бюджета].[СКИФ].[Муниципальные районы] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Бюджет поселения] 
            } 
        )' 
    member [Уровни бюджета].[СКИФ].[Собственные бюджеты районов] 
    as '[Уровни бюджета].[СКИФ].[Бюджет района]' 
    member [Уровни бюджета].[СКИФ].[Городские и сельские поселения] 
    as '[Уровни бюджета].[СКИФ].[Бюджет поселения]' -- 
            
select
    {
        {   
            [КД].[Сопоставимый].[ИТОГО ДОХОДОВ ],
            [КД].[Сопоставимый].[Налоговые и неналоговые доходы ],
            [КД].[Сопоставимый].[Налог на прибыль организаций ],
            [КД].[Сопоставимый].[НДФЛ ],
            [КД].[Сопоставимый].[Акцизы ],
            [КД].[Сопоставимый].[Налог на имущество организаций ],
            [КД].[Сопоставимый].[Налог на имущество физических лиц ],
            [КД].[Сопоставимый].[НДПИ ],
            [КД].[Сопоставимый].[Земельный налог ],
            [КД].[Сопоставимый].[Прочие налоговые доходы ],
            [КД].[Сопоставимый].[Неналоговые доходы ],
            [КД].[Сопоставимый].[Безвозмездные перечисления от других бюджетов ],
            [КД].[Сопоставимый].[Дотация на выравнивание бюджетной обеспеченности ]
          
        } 
        * 
        {
            Measures.[Исполнено прошлый год],
            Measures.[Исполнено млн],
            [Measures].[Темп роста] 
        } 
    } on columns,
    non empty   
    {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]  
        }+ Generate   
        (
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%filter%>
            },
            {
                [Территории].[Сопоставимый].CurrentMember
            } + Filter 
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                not   
                (
                    [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember   
                )   
            )   
        )   
    } on rows
from [ФК_МесОтч_Доходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].[<%period_end_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [Уровни бюджета].[СКИФ].[<%skif_level%>]
    ) 
  ]]>
  </query>

  <query id="FK_0001_0013_compare_Grid1">
    <![CDATA[
     ---------- дополнительный запрос к таблице, расходы
with
    member [КОСГУ].[Сопоставимый].[Оплата труда с начислениями (фактическая) ]  as'Aggregate
        (
            {
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы]. [Оплата труда и начисления на оплату труда].[Заработная плата],
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы]. [Оплата труда и начисления на оплату труда].[Начисления на оплату труда]
            }
        )'
    member [КОСГУ].[Сопоставимый].[Капитальные вложения ] 
    as 'Aggregate 
        (
            {
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости основных средств],
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости нематериальных активов]  
            }
        )' 
  --  member [КОСГУ].[Сопоставимый].[Материальные затраты ]
   -- as 'Aggregate
     --   (
       --     {
         --       [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на оплату труда].[Прочие выплаты],
           --     [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Приобретение услуг],
             --   [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Обслуживание долговых обязательств],
               -- [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные и безвозвратные перечисления организациям],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные и безвозвратные перечисления бюджетам],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Прочие расходы],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости нематериальных активов],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости непроизведенных активов],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости материальных запасов],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление финансовых активов],
                --[КОСГУ].[Сопоставимый].[Все коды ЭКР].[Выбытие финансовых активов]
            --}
        --)'
    member [КОСГУ].[Сопоставимый].[Дефицит / профицит]
    as ' Measures.CurrentMember '
    member Measures.[Исполнено млн] as' IIF
        (
            [КОСГУ].[Сопоставимый].CurrentMember is [КОСГУ].[Сопоставимый].[Дефицит / профицит],
            LookupCube
            (
                "[ФК_МесОтч_Дефицит Профицит]",
                "
                (
                    [Measures].[Исполнено],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    " + MemberToStr
                    (
                        [Период].[Период].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                ) "
            ),
            [Measures].[Исполнено]
        ) '
    member      Measures.[Исполнено прошлый год ]
    as ' IIF
        (
            [КОСГУ].[Сопоставимый].CurrentMember is [КОСГУ].[Сопоставимый].[Дефицит / профицит],
            LookupCube
            (
                "[ФК_МесОтч_Дефицит Профицит]",
                "
                (
                    [Measures].[Исполнено прошлый год],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    " + MemberToStr
                    (
                        [Период].[Период].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                ) "
            ),
            [Measures].[Исполнено прошлый год]
        )'

    member [Уровни бюджета].[СКИФ].[Консолидированный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта]'

    member Measures.[Темп роста]
    as 'IIF
        (
            [КОСГУ].[Сопоставимый].CurrentMember is [КОСГУ].[Сопоставимый].[Дефицит / профицит],
            LookupCube
            (
                "[ФК_МесОтч_Дефицит Профицит]",
                "
                (
                    [Measures].[Темп роста к аналогичному периоду предыдущего года_Исполнено],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    " + MemberToStr
                    (
                        [Период].[Период].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                ) "
            ),
			IIF    
            (
                [КОСГУ].[Сопоставимый].CurrentMember is [КОСГУ].[Сопоставимый].[Иные расходы ],
                (
                    (
                      [КОСГУ].[Сопоставимый].[Иные расходы ],
                      Measures.[Исполнено млн]
                    )
                    /
                    (
                        (
                            [КОСГУ].[Сопоставимый].[Расходы итого ],
                            Measures.[Исполнено млн],
                            ParallelPeriod    
                            (
                                [Период].[Период].[Год],
                                1,
                                [Период].[Период].CurrentMember   
                            )    
                        )  -   
                        (
                            [КОСГУ].[Сопоставимый].[Капитальные вложения ],
                            Measures.[Исполнено млн],
                            ParallelPeriod   
                            (
                                [Период].[Период].[Год],
                                1,
                                [Период].[Период].CurrentMember   
                            )   
                        ) -  
                        (
                            [КОСГУ].[Сопоставимый].[Оплата труда с начислениями (фактическая) ],
                            Measures.[Исполнено млн],
                            ParallelPeriod  
                            (
                                [Период].[Период].[Год],
                                1,
                                [Период].[Период].CurrentMember  
                            )  
                        ) 
                    ) 
                ),
            [Measures].[Темп роста к аналогичному периоду предыдущего года_Исполнено]
		  )
        ) '
               -- Уровни бюджета

    member [Уровни бюджета].[СКИФ].[Собственный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Бюджет субъекта]'
    member [Уровни бюджета].[СКИФ].[Местные бюджеты]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет МО]'
    member [Уровни бюджета].[СКИФ].[Городские округа]
    as '[Уровни бюджета].[СКИФ].[Бюджет гор.округа]'
    member [Уровни бюджета].[СКИФ].[Муниципальные районы]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Бюджет поселения]
            }
        )'
    member [Уровни бюджета].[СКИФ].[Собственные бюджеты районов]
    as '[Уровни бюджета].[СКИФ].[Бюджет района]'
    member [Уровни бюджета].[СКИФ].[Городские и сельские поселения]
    as '[Уровни бюджета].[СКИФ].[Бюджет поселения]' --
	member [КОСГУ].[Сопоставимый].[Расходы итого ]
    as '(
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
            [КОСГУ].[Сопоставимый].[Все коды ЭКР]
        )'
    member [КОСГУ].[Сопоставимый].[Иные расходы ]
    as '[КОСГУ].[Сопоставимый].[Расходы итого ]-[КОСГУ].[Сопоставимый].[Капитальные вложения ]-[КОСГУ].[Сопоставимый].[Оплата труда с начислениями (фактическая) ]'

select
    {
        {          
            [КОСГУ].[Сопоставимый].[Оплата труда с начислениями (фактическая) ],
            [КОСГУ].[Сопоставимый].[Капитальные вложения ],
            [КОСГУ].[Сопоставимый].[Иные расходы ]
          --[КОСГУ].[Сопоставимый].[Дефицит / профицит]
        }
        *
        {
            Measures.[Исполнено прошлый год ],
            Measures.[Исполнено млн],
            [Measures].[Темп роста]
        }
    } on columns,
    non empty   
    {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]  
        }+ Generate   
        (
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%filter%>
            },
            {
                [Территории].[Сопоставимый].CurrentMember
            } + Filter 
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                not   
                (
                    [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember   
                )   
            )   
        )   
    } on rows
from [ФК_МесОтч_Расходы]
where
    (
        [Период].[Период].[Данные всех периодов].[<%period_end_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [Уровни бюджета].[СКИФ].[<%skif_level%>] 
    )
  ]]>
  </query>
  <query id="FK_0001_0013_compare_Grid2a">
    <![CDATA[
    ---------- Дополнительный запрос - Итого расходов
    with 
   
               -- Уровни бюджета

    member [Уровни бюджета].[СКИФ].[Собственный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Бюджет субъекта]'
    member [Уровни бюджета].[СКИФ].[Местные бюджеты]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет МО]'
    member [Уровни бюджета].[СКИФ].[Городские округа]
    as '[Уровни бюджета].[СКИФ].[Бюджет гор.округа]'
    member [Уровни бюджета].[СКИФ].[Муниципальные районы]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Бюджет поселения]
            }
        )'
    member [Уровни бюджета].[СКИФ].[Собственные бюджеты районов]
    as '[Уровни бюджета].[СКИФ].[Бюджет района]'
    member [Уровни бюджета].[СКИФ].[Консолидированный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет субъекта]'
    member [Уровни бюджета].[СКИФ].[Городские и сельские поселения]
    as '[Уровни бюджета].[СКИФ].[Бюджет поселения]' --
    
   

    member[РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ]
    as '[РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]'

select
    {
        {
           [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ]
          
        }
        *
        {
            Measures.[Исполнено прошлый год],
            Measures.[Исполнено],
            [Measures].[Темп роста к аналогичному периоду предыдущего года_Исполнено]
        }
    } on columns,
    non empty   
    {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]  
        }+ Generate   
        (
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%filter%>
            },
            {
                [Территории].[Сопоставимый].CurrentMember
            } + Filter 
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                not   
                (
                    [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember   
                )   
            )   
        )   
    } on rows
from [ФК_МесОтч_Расходы]
where
    (
        [Период].[Период].[Данные всех периодов].[<%period_end_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [Уровни бюджета].[СКИФ].[<%skif_level%>] 
    )
    ]]>
  </query>

  <query id="FK_0001_0013_compare_Grid2">
    <![CDATA[
with        -- Дефицит - профицит - запрос
    member[РзПр].[Сопоставимый].[Профицит(+)/Дефицит(-) ]    
    as 'LookupCube  
        (
            "[ФК_МесОтч_Дефицит Профицит]",
            "  
            (
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                " + MemberToStr  
                (
                    [Период].[Период].CurrentMember  
                ) + ",
                " + MemberToStr 
                (
                    [Measures].CurrentMember
                ) + ",
                 " + MemberToStr  
                (
                    [Территории].[Сопоставимый].CurrentMember  
                ) + "  
            ) "  
        )'  
    member Measures.[Исполнено млн]           
    as ' [Measures].[Исполнено]    '     
    member Measures.[Темп роста]           
    as '[Measures].[Темп роста к аналогичному периоду предыдущего года_Исполнено]' 
   
    member Measures.[ФО]
    as 'IIF
        (
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ" or [Территории].[Сопоставимый].CurrentMember.Level.Name = "Федеральный округ"
            ) and
            (
                (
                    Measures.[Исполнено] + Measures.[Назначено]
                ) <> 0
            ),
            IIF
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ",
                Measures.[ParentShortName],
                Measures.[ShortName]
            ),
            null
        )'
        -- Уровни бюджета
    member [Уровни бюджета].[СКИФ].[Консолидированный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет субъекта]'
    member [Уровни бюджета].[СКИФ].[Собственный бюджет субъекта]
    as '[Уровни бюджета].[СКИФ].[Бюджет субъекта]'
    member [Уровни бюджета].[СКИФ].[Местные бюджеты]
    as '[Уровни бюджета].[СКИФ].[Конс.бюджет МО]'
    member [Уровни бюджета].[СКИФ].[Городские округа]
    as '[Уровни бюджета].[СКИФ].[Бюджет гор.округа]'
    member [Уровни бюджета].[СКИФ].[Муниципальные районы]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Бюджет поселения]
            }
        )'
    member [Уровни бюджета].[СКИФ].[Собственные бюджеты районов]
    as '[Уровни бюджета].[СКИФ].[Бюджет района]'
    member [Уровни бюджета].[СКИФ].[Городские и сельские поселения]
    as '[Уровни бюджета].[СКИФ].[Бюджет поселения]' --
    member Measures.[ParentShortName]
    as '[Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование")'
    member Measures.[ShortName]
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование")'
select
    {
        {
            
           [РзПр].[Сопоставимый].[Профицит(+)/Дефицит(-) ]
        }     
        *      
        {
            Measures.[Исполнено прошлый год],
            Measures.[Исполнено млн]                 
        }   
       + 
        {
            {
               [РзПр].[Сопоставимый].[Все коды ФКР]
            } 
            *{Measures.[ФО]}     
        }  
    } on columns,
    non empty   
    {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]  
        }+ Generate   
        (
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%filter%>
            },
            {
                [Территории].[Сопоставимый].CurrentMember
            } + Filter 
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                not   
                (
                    [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember   
                )   
            )   
        )   
    } on rows           
from [ФК_МесОтч_Расходы]           
where           
    (
         [Период].[Период].[Данные всех периодов].[<%period_end_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [Уровни бюджета].[СКИФ].[<%skif_level%>]
    )
  ]]>
  </query>

  
  
</root>