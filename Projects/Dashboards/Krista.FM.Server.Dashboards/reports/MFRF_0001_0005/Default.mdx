<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="mfrf_0001_0005_grid">
    <![CDATA[
With       
    member [Measures].[ShortName]      
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование")'      
    member [Measures].[ParentShortName]      
    as '[Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование")'      
    member [Measures].[ФО]      
    as 'IIF      
        (
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ" or [Территории].[Сопоставимый].CurrentMember.Level.Name = "Федеральный округ"      
            ),
            IIF      
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ",
                [Measures].[ParentShortName],
                [Measures].[ShortName]      
            ),
            null      
        )'      
    member [Measures].[Исполнено текущий год]      
    as '      
        (
            [Measures].[Прогноз_очередной год],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]     
        )'      
    member [Measures].[Исполнено прошлый год]      
    as '      
        (
            [Measures].[Прогноз_очередной год],
            [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
            <%filter%>      
        )'      
    member [Measures].[Темп роста_]      
    as 'IIF      
        (
            IsEmpty      
            (
                [Measures].[Исполнено прошлый год]      
            ) or  [Measures].[Исполнено прошлый год] = 0,
            null,
            (
                [Measures].[Исполнено текущий год] / [Measures].[Исполнено прошлый год]      
            )      
        )'       
    member  [МФ РФ].[Сопост Показатели].[Итоговый элемент]      
    as ' [МФ РФ].[Сопост Показатели].CurrentMember.LastChild'   
      
    member [Measures].[Доля в общем объеме]      
    as 'IIF   
        (
            IsEmpty 
            (
                (
                    [Measures].[Исполнено текущий год],
                    [МФ РФ].[Сопост Показатели].CurrentMember.Parent  
                ) 
            ) or  
            (
                [Measures].[Исполнено текущий год],
                [МФ РФ].[Сопост Показатели].CurrentMember.Parent  
            ) = 0,
            null,
            (
                [Measures].[Исполнено текущий год],
                [МФ РФ].[Сопост Показатели].CurrentMember   
            ) /   
            (
                [Measures].[Исполнено текущий год],
                [МФ РФ].[Сопост Показатели].CurrentMember.Parent   
            )  
        )  '   
        
    member [Measures].[Общая сумма]
    as 'Sum
            (
                {
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд финансовой поддержки регионов].[Всего трансферт из Федерального фонда финансовой поддержки регионов],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд компенсаций].[Всего трансферт из Федерального фонда компенсаций],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд софинансирования расходов].[Всего трансферт из Федерального фонда софинансирования социальных расходов],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд регионального развития].[Всего межбюджетный трансферт субъектам РФ из ФФРР],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Иные межбюджетные трансферты].[Всего по иным трансфертам]
                    
                    
                },
                (
                    [Measures].[Исполнено текущий год],
                    [МФ РФ].[Сопост Показатели].CurrentMember
                )
            )
         '
    member [Measures].[Доля в общей сумме]  
    as ' IIF  
        (
            IsEmpty  
            (
                [Measures].[Общая сумма]
            ) or  
            (
                [Measures].[Общая сумма]
            ) = 0,
            null,
            (
                [Measures].[Исполнено текущий год],
                [МФ РФ].[Сопост Показатели].CurrentMember  
            ) / [Measures].[Общая сумма]
        ) ' 
                  
                  
  set [Группы фондов]
   as 'Filter
            (  
                Descendants 
                (
                    <%select_FF%>,
                    [МФ РФ].[Сопост Показатели].[Группа],
                    SELF   
                ),
                not
                 (
                        IsEmpty([Measures].[Исполнено прошлый год]) and
						IsEmpty([Measures].[Исполнено текущий год]) and
						IsEmpty([Measures].[Темп роста_]) and
						IsEmpty([Measures].[Доля в общем объеме]) and
						IsEmpty([Measures].[Доля в общей сумме])
                 ) 
            )'  
  set [Субъекты]
    as 'Filter
        (
            Generate
            (
                Descendants
                (
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%select_FO%>,
                    [Территории].[Сопоставимый].[Федеральный округ],
                    SELF
                ),
                {
                    [Территории].[Сопоставимый].CurrentMember
                } +  Descendants
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF
                )
            ),   not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember) 
            and not IsEmpty
            (
                (
                    [Measures].[Прогноз_очередной год],
                    [МФ РФ].[Сопост Показатели].[Аггрегированные фонды]
                )
            ) and 
            (
                [Measures].[Прогноз_очередной год],
                [МФ РФ].[Сопост Показатели].[Аггрегированные фонды]
            ) <> 0 
        )'    
    member [МФ РФ].[Сопост Показатели].[Аггрегированные фонды] 
    as 'Aggregate 
        (
            [Группы фондов]
        )'          
SELECT
  {
        {
            {
                [МФ РФ].[Сопост Показатели].[Все показатели]
            } 
            *
            {
                [Measures].[ФО]
            } 
           } + <%dolya%>
        
    } on columns,
     {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация] 
        } + [Субъекты] 
    } on rows   
    
   
FROM [МФ РФ_Фонды]      
WHERE      
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>],
       <%variant_mes_otch%>
    )      
	]]>
      </query>
  
 <query id="mfrf_0001_0005_chart">
    <![CDATA[ 
 
 
 WITH
    SET  [Субъекты]
    AS ' Descendants
        (
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%select_FO%>,
            [Территории].[Сопоставимый].[Субъект РФ],
            SELF
        ) '
        
 member [Measures].[Исполнено текущий год]
    as '
        (
            [Measures].[Прогноз_очередной год],
            [Период].[Период].[Данные всех периодов].[<%period_year%>]
        )'
 member [Measures].[Все федеральные фонды]
    as 'Sum
            (
                {
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд финансовой поддержки регионов].[Всего трансферт из Федерального фонда финансовой поддержки регионов],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд компенсаций].[Всего трансферт из Федерального фонда компенсаций],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд софинансирования расходов].[Всего трансферт из Федерального фонда софинансирования социальных расходов],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Федеральный фонд регионального развития].[Всего межбюджетный трансферт субъектам РФ из ФФРР],
                    [МФ РФ].[Сопост Показатели].[Все показатели].[Иные межбюджетные трансферты].[Всего по иным трансфертам]


                },
                (
                    [Measures].[Исполнено текущий год],
                    [МФ РФ].[Сопост Показатели].CurrentMember
                )
            )
         '

SELECT
    { <%fond%>
    } ON COLUMNS ,
     Filter  ( [Субъекты], not IsEmpty(<%fond%>) and (<%fond%>) <> 0 and  not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember) ) ON ROWS
FROM [МФ РФ_Фонды]
WHERE
    (
      [Период].[Период].[Данные всех периодов].[<%period_year%>],
       <%variant_mes_otch%>
    )
   ]]>
 </query>
</root>

