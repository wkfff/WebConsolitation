<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0005_0004_date">
    <![CDATA[
-- FO_0005_0003_date 
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период__Период].[Период__Период].[День].Members,
                not IsEmpty ([Measures].[Расход с возвратом])
                and [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_АС Бюджет_КазнИсп_Факт расхода]

]]>
</query>

<query id="FO_0005_0004_month">
  <![CDATA[
    with   
    member [Measures].[ДанныеНа]   
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'   
    set [NonEmptySet]   
    as 'Tail   
        (
            Filter   
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>],
                    [Период__Период].[Период__Период].[День],
                    self_and_after  
                ),
                 not IsEmpty 
                (
                    [Measures].[Расход с возвратом]  
                ) and [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"   
            ),
            1   
        )'   
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows   
from  [ФО_АС Бюджет_КазнИсп_Факт расхода]    
    ]]>
</query>

<query id="FO_0005_0004_Grid">
<![CDATA[
-- FO_0005_0003_Grid 
WITH       
    member [Measures].[Утвержденный план, тыс. руб]       
    as 'IIF       
        (
           (
		     [Measures].[Ассигнования],
             [Период__Дата принятия].[Период__Дата принятия].[Данные всех периодов].[<%year%>],
             [Период__Период].[Период__Период].[Данные всех периодов].[<%year%>],
             [Роспись Кассовый план].[Роспись Кассовый план].[Все].[Роспись],
             [Роспись Уведомления].[Уточненный план].[Утвержденный план]  ,
			 [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все документы ],
			 [Фиксированный__БА_ЛБО].[Фиксированный__БА_ЛБО].[Все].[Бюджетные ассигнования, лимиты бюджетных обязательств]
		   ) =0 ,
		    null,
			(
			  [Measures].[Ассигнования],
             [Период__Дата принятия].[Период__Дата принятия].[Данные всех периодов].[<%year%>],
             [Период__Период].[Период__Период].[Данные всех периодов].[<%year%>],
             [Роспись Кассовый план].[Роспись Кассовый план].[Все].[Роспись],
             [Роспись Уведомления].[Уточненный план].[Утвержденный план],
			 [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все документы ] ,
			 [Фиксированный__БА_ЛБО].[Фиксированный__БА_ЛБО].[Все].[Бюджетные ассигнования, лимиты бюджетных обязательств]
			)/1000	
		 )' 
	
	member [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все документы ]  
    as 'Aggregate  
        (
            {
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[Внутренние расходные расписания (БА, ЛБО)],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[ Внутренние расходные расписания (ПОФ)],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[СБР, кассовый план (расходы)],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[Кассовый план (расходы)],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[ Бюджет (расходы)],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[Кассовый план по ПБС (расходы)],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[Кассовый план ПБС помесячно],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[Роспись, кассовый план по ПБС (расходы)],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[Уведомление об изменении лимитов],
                [Фиксированный__Плановые документы].[Фиксированный__Плановые документы].[Все].[Прочие данные]  
            }  
        )'  	 
    member [Measures].[Исполнено, тыс. руб]     
    as 'IIF   
        (
            [Расходы__АС Бюджет].[Расходы__АС Бюджет]. CurrentMember is [Расходы__АС Бюджет].[Расходы__АС Бюджет].[Итого],
            sum 
            (
                [Расходы],
                 [Measures].[Исполнено, тыс. руб] 
            ),
	   IIF
        (
           ( LookupCube
            (
                "[ФО_АС Бюджет_КазнИсп_Факт расхода]",
                "     
                (
                    [Measures].[Расход с возвратом],
                    " + MemberToStr     
                    (
                        [Расходы__АС Бюджет].CurrentMember 
                    ) + ",
					 " + MemberToStr     
                    (
                        [Тип средств__АС Бюджет].[Тип средств__АС Бюджет].CurrentMember 
                    ) + ",
                   [Администратор__АС Бюджет].[Администратор__АС Бюджет].[Данные всех источников].<%admin_type%>,
                   [КВР__АС Бюджет].[КВР__АС Бюджет].[Данные всех источников].<%vr_type%>,
                   <%csr_type%>,
                   <%rspr_type%>,
                   [Период__Период].[Период__Период].[Данные всех периодов].[<%year%>]     
                ) "     
            )
		  ) =0 ,
		  null,
		  (
		    LookupCube
            (
                "[ФО_АС Бюджет_КазнИсп_Факт расхода]",
                "     
                (
                    [Measures].[Расход с возвратом],
                    " + MemberToStr     
                    (
                        [Расходы__АС Бюджет].CurrentMember 
                    ) + ",
					" + MemberToStr     
                    (
                        [Тип средств__АС Бюджет].[Тип средств__АС Бюджет].CurrentMember 
                    ) + ",
                   [Администратор__АС Бюджет].[Администратор__АС Бюджет].[Данные всех источников].<%admin_type%>,
                   [КВР__АС Бюджет].[КВР__АС Бюджет].[Данные всех источников].<%vr_type%>,
                   <%csr_type%>,
                   <%rspr_type%>,
                   [Период__Период].[Период__Период].[Данные всех периодов].[<%year%>]     
                ) "     
            )
		  )/1000
        ) )' 
	member [Measures].[% исполнения]
    as '1'	
    member measures.[ГРБС]       
    as '[Расходы__АС Бюджет].CurrentMember.Properties("Администратор")'       
    member measures.[РзПр]
    as 'IIF
          (
            [Расходы__АС Бюджет].CurrentMember.Properties("ФКР") = "0" ,
            null,
            [Расходы__АС Бюджет].CurrentMember.Properties("ФКР")
          )'
    member measures.[ЦСР]
    as 'IIF
         (
           [Расходы__АС Бюджет].CurrentMember.Properties("КЦСР") = "0",
           null,
           [Расходы__АС Бюджет].CurrentMember.Properties("КЦСР")
         )'
    member measures.[ВР]
    as 'IIF
         (
           [Расходы__АС Бюджет].CurrentMember.Properties("КВР") = "0",
           null,
           [Расходы__АС Бюджет].CurrentMember.Properties("КВР")
         )'     
    set [Расходы]    
    as 'Filter    
        (
            Descendants   
            (
                [Расходы__АС Бюджет].[Расходы__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>],
                [Расходы__АС Бюджет].[Расходы__АС Бюджет].[Расходы уровень 8],
                Self_and_before    
            ) - [Расходы__АС Бюджет].[Расходы__АС Бюджет].[Расходы уровень 1].AllMembers  ,
            not IsEmpty    
            (
                [Measures].[Утвержденный план, тыс. руб]    
            ) and not    
            (
                [Measures].[Утвержденный план, тыс. руб]=0    
            )     
        )'    
    member measures.[Уровень] 
    as '[Расходы__АС Бюджет].CurrentMember.Properties("LEVEL_NUMBER")'		
	 member [Расходы__АС Бюджет].[Расходы__АС Бюджет].[Итого]      
    as 'Aggregate({ [Расходы] })'  
	
	Member Measures.[Код] 
	as 'StrToValue([Расходы__АС Бюджет].CurrentMember.Properties("Администратор"))'
SELECT
    {
        measures.[ГРБС],
        measures.[РзПр],
        measures.[ЦСР],
        measures.[ВР],
        [Measures].[Утвержденный план, тыс. руб],
        [Measures].[Исполнено, тыс. руб],
		[Measures].[% исполнения],
		measures.[Уровень] 
    } on columns,
    Order 
    (
        Filter  
        (
            		 [Расходы],
            				 not IsEmpty   
            (
                [Measures].[Утвержденный план, тыс. руб]   
            ) and not   
            (
                [Measures].[Утвержденный план, тыс. руб]=0   
            )   
        ),
        Measures.[Код],
        BASC
    )    on rows      
FROM [ФО_АС Бюджет_План расходов]       
WHERE       
    (
        [Администратор__АС Бюджет].[Администратор__АС Бюджет].[Данные всех источников].<%admin_type%>,
        [КВР__АС Бюджет].[КВР__АС Бюджет].[Данные всех источников].<%vr_type%>,
        <%csr_type%>,
        <%rspr_type%>,
        [Период__Период].[Период__Период].[Данные всех периодов].[<%year%>],
		[Тип средств__АС Бюджет].[Тип средств__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>].[Бюджетные средства]
    )        
]]>
</query>

<query id="NovosibRZPRType">
<![CDATA[
-- NovosibRZPRType 
with    
    member [Measures].[Уровень]    
    as 'IIF  
        (
            [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember is [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Все разделы/подразделы],
            0,
            (
                [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Properties("LEVEL_NUMBER")
            )-2 
        )'  
    member [Measures].[Уникальное имя]    
    as 'IIF  
        (
            [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember is [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Все разделы/подразделы],
            [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>],
            [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.UniqueName  
        )'  
    member [Measures].[Имя]    
    as ' IIF   
        (
		    [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember is [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Все разделы/подразделы],
			[РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Name,
			"("+ [РзПр__АС Бюджет].CurrentMember.Properties("Код") +")" +[РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Name    
            
        )'    
    set [РзПр]    
    as ' Filter    
        (
            Descendants    
            (
                [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>],
                [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Подраздел],
                Self_and_before    
            ),
            not [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember is [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Parent.DataMember and [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Name <> "Неуказанная функциональная статья" and [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Name <> "Неизвестные данные" and [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Name <> "Условно утвержденные расходы" and [РзПр__АС Бюджет].[РзПр__АС Бюджет].CurrentMember.Name <> "ФО\0001 АС Бюджет - УФиНП <%year%>"    
        )'    
    member [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Все разделы/подразделы]    
    as '   
        (
            [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>]    
        )'    
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]    
    }ON COLUMNS,
    (
        {
            [РзПр__АС Бюджет].[РзПр__АС Бюджет].[Все разделы/подразделы]   
        } + [РзПр]   
    ) ON ROWS   
FROM  [ФО_АС Бюджет_План расходов]       
 ]]>
</query>

<query id="NovosibCSRType">
<![CDATA[
-- FO_0005_0004_csrType 
with 
    set [КЦСР] 
    as ' Filter 
        (
            Descendants 
            (
                [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>],
                [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Целевая статья 1],
                self_and_after
            ),
			not ([КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember is [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Parent.DataMember)
            and
            [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Name <> "Неизвестные данные"
            and [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Name <> "Неуказанное наименование"
            and [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Name <> "Неуказанная целевая статья"
            and [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Name <> "ФО\0001 АС Бюджет - УФиНП <%year%>"
        )'
    member [Measures].[Уровень]
    as 'IIF
        (
            [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember is [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Все целевые статьи],
            0,
            (
             [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Properties("LEVEL_NUMBER")
            )-2
        )'
    member [Measures].[Уникальное имя]
    as 'IIF
        (
            [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember is [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Все целевые статьи],
            [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>],
            [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.UniqueName
        )'
		
    member [Measures].[Имя]   
    as 'IIF 
        (
            [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember is  [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Все целевые статьи],
            [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Name,
             " 
            (
                " +  [КЦСР__АС Бюджет].CurrentMember.Properties("Код") + " 
            )" + [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].CurrentMember.Name 
        ) '
		
    member [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Все целевые статьи]
    as '(
          [КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Данные всех источников].[ФО\0001 АС Бюджет - УФиНП <%year%>]
         )'
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень] 
    } ON COLUMNS,
    (
      {[КЦСР__АС Бюджет].[КЦСР__АС Бюджет].[Все целевые статьи]}
      +
       [КЦСР]
    ) ON ROWS
FROM  [ФО_АС Бюджет_План расходов] 
 ]]>
</query>

<query id="FO_0005_0004_vrType">
<![CDATA[
-- FO_0005_0004_vrType 
   with 
     member measures.[Код ] 
    as ' 
        (
            [КВР__АС Бюджет].CurrentMember.Properties("Код")
        )' 
    set [ВР]
    as ' Filter 
        (
            Descendants 
            (
                [КВР__АС Бюджет].[КВР__АС Бюджет].[Данные всех источников].[ФО АС Бюджет - УФиНП <%year%>],
                [КВР__АС Бюджет].[КВР__АС Бюджет].[Вид расходов],
                Self_and_after 
            ),
             [КВР__АС Бюджет].[КВР__АС Бюджет].CurrentMember.Name <> "Неизвестные данные"
             and
             [КВР__АС Бюджет].[КВР__АС Бюджет].CurrentMember.Name <> "Неуказанное наименование"
             and
             [КВР__АС Бюджет].[КВР__АС Бюджет].CurrentMember.Name <> "Неуказанный вид расходов"
        )' 
SELECT
    {
        measures.[Код ]
    } ON COLUMNS,
    NON EMPTY ([ВР] ) ON ROWS
FROM  [ФО_АС Бюджет_План расходов] 
 ]]>
</query>

<query id="FO_0005_0004_adminType">
<![CDATA[
-- FO_0005_0003_adminType
  with   
     member measures.[Код ]
    as '
        (
            [Администратор__АС Бюджет].CurrentMember.Properties("Код")
        )'
    set [Администратор]
    as ' Filter
        (
            Descendants  
            (
                [Администратор__АС Бюджет].[Администратор__АС Бюджет].[Данные всех источников].[ФО АС Бюджет - УФиНП <%year%>],
                [Администратор__АС Бюджет].[Администратор__АС Бюджет].[Администратор],
                Self_and_after 
            ),
            [Администратор__АС Бюджет].[Администратор__АС Бюджет].CurrentMember.Name <> "Неизвестные данные"
            and [Администратор__АС Бюджет].[Администратор__АС Бюджет].CurrentMember.Name <> "Неуказанное наименование"
			and [Администратор__АС Бюджет].[Администратор__АС Бюджет].CurrentMember.Name <> "Неуказанная ведомственная статья"
        )'  
SELECT
    {
      measures.[Код ]
    } ON COLUMNS,
    NON EMPTY ([Администратор]) ON ROWS  
    FROM  [ФО_АС Бюджет_План расходов] 
 ]]>
</query>
	
 

</root>