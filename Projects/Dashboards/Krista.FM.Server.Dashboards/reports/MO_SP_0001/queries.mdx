<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id = "ComboYear">
    <![CDATA[
    
    with
    member [UniqueName]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName'

    member [LevelNumber]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.level.name'
select
    {
        [UniqueName],
        [LevelNumber]
    }on columns,
    {
       filter
        (
            Descendants
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[(All)],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                SELF_AND_BEFORE
            ) ,
            right
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.uniquename,
                2
            )<>"er" and not isempty([Measures].[Значение])
        )
    } on rows
from [СТАТ_Паспорт МО_СП и ГП]

]]></query>
  <query id = "ComboField">
    <![CDATA[with
    member [ISDATAMEMBER]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.IS_DATAMEMBER'
    member [UniqueName]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.UniqueName'
    member [LevelNumber]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level_Number-1'
    member [reverce]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Примечание")'
    member [Unit]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Единица измерения")'
    member [Comporable]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Сопоставимость")'
select
    {
    [Comporable],
    [Unit],
    [reverce],
        [UniqueName],
        [LevelNumber]
    }on columns,
    {
        filter
        (
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].members,
            (
                not IsEmpty([Measures].[Значение])
                and [LevelNumber] >= 0
                and not [ISDATAMEMBER]
            )
        )
    } on rows
from [СТАТ_Паспорт МО_СП и ГП]
]]>
  </query>
  <query id = "ComboRegion">
    <![CDATA[
    --MO_SP_0001 ComboRegion
    with
    member [ISDataMember]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.IS_DATAMEMBER'
    member [UniqueName]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'
    member [LevelNumber]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Level_Number - 5'
select
    {
        [UniqueName],
        [LevelNumber]
    }on columns,
    {
     except
     (filter
        (
            [Территории__РФ].[Территории__РФ].members,
            (
                (
                    [Территории__РФ].[Территории__РФ].CurrentMember.parent.UniqueNAme = "[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра]"
                )and (not [ISDataMember])and
                [Территории__РФ].[Территории__РФ].CurrentMember.children.count>0
            )
        ),
        {
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Няксимволь],
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Кондинский муниципальный район].[Алтай],
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Белоярский муниципальный район].[Ванзеват],
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Ванзетур],
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Сосьва],
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Теги],
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Кондинский муниципальный район].[Алтай],
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Кондинский муниципальный район].[Ягодный]

            }
        )
    } on rows
from [СТАТ_Паспорт МО_СП и ГП]
]]>



  </query>
    <query id = "Grid">
    <![CDATA[with
    member [ISDataMember]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.IS_DATAMEMBER'

    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[ShortName]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Properties("Краткое наименование")'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Parent]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.parent.UniqueName'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Примечание]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Примечание")'
select
      {
        IIf 
        (
            <%Year-Quart%>.lag(1).IS_DATAMEMBER,
            IIf 
            (
                <%Year-Quart%>.lag(2).IS_DATAMEMBER,
                <%Year-Quart%>.lag(3),
                <%Year-Quart%>.lag(2) 
            ),
            <%Year-Quart%>.lag(1) 
        ),
        <%Year-Quart%>,
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[ShortName]  ,
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Parent],
        
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Примечание]
    }
    on columns,
  order(  {
      [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].datamember,
        filter
        (
            [Территории__РФ].[Территории__РФ].members,
            ( 
                (
                    [Территории__РФ].[Территории__РФ].CurrentMember.parent.parent.UniqueNAme = "[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра]"--"<%Region%>"--
                )and (not [ISDataMember])and
                [Территории__РФ].[Территории__РФ].CurrentMember.children.count=0 and not isempty(([Measures].[Значение],<%Year-Quart%>))
            )
        )


    }
    ,
    ([Measures].[Значение], <%Year-Quart%>)
    ,asc
    )on rows
from [СТАТ_Паспорт МО_СП и ГП]
where
    (
       <%Field%>
    )]]>
  </query>

  
</root>