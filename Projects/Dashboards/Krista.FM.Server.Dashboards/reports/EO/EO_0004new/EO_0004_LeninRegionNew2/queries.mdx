<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id="Years">
    <![CDATA[
    --years
select
    {      filter
            (
                [Период].[Год].Members,
                [Measures].[Оценка]>0
            ) } on columns,
    {
[КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].[Интегральный показатель],
            [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].[Интегральный показатель].children
    } on rows 
from  [ЭО_КЖН_Ленинградская область МО] 
where 
    (
        [Measures].[Оценка]
    )  ]]>
  </query>
  <query id="Areas">
    <![CDATA[
--Areas 
select
    { [Measures].[Значение] } on columns,
    {
       [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].[Интегральный показатель],
        filter
        (
            {
                [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].members
            },
            Right 
            (
                [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].Currentmember.UniqueName,
                10 
            ) <> "DATAMEMBER"  
        ) 
    } on rows  
from  [ЭО_КЖН_Ленинградская область МО]    ]]>
</query>
<query id="AreasChart">
    <![CDATA[
--AreasChart  
select
    { [Measures].[Значение] } on columns,
    {
       <%tableArea%>,
        filter
        (
            {
                <%tableArea%>.children
            },
            Right 
            (
                [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].Currentmember.UniqueName,
                10 
            ) <> "DATAMEMBER"  
        ) 
    } on rows  
from  [ЭО_КЖН_Ленинградская область МО]    ]]>
  </query>
  <query id="Grid">
    <![CDATA[
    --Grid  
with  
    set [Регионы]  
    as '  
        {
              filter  
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                ([Measures].[Значение]>0) and 
                (
                    Right 
                    (
                        [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"  
                ) 

            )
    }'  
    member [Measures].[Имя региона]  
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'  
select
    {
        {
            [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].[Интегральный показатель],
            [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].[Интегральный показатель].children
        }
        * 
        {
            [Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>]:[Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>].lag(1)
            
        } 
    } on columns,
    [Регионы] on rows  
from [ЭО_КЖН_Ленинградская область МО]  
where([Measures].[Оценка]) ]]>
  </query>
  <query id="Grid1">
    <![CDATA[
    --Grid1 
with   
    set [Регионы]   
    as '   
        {
            filter   
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                ([Measures].[Значение]>0) and 
                (
                    Right 
                    (
                        [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"  
                )    
            ) 
        }'   
    member [Measures].[Имя региона]   
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'   
select
    {
        {
            {
                <%tableArea%>
            }
            *{[Measures].[Оценка]},
            {
                filter
                (
                    {
                        <%tableArea%>.children
                    },
                    Right 
                    (
                        [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"
                )    
            }
            *{[Measures].[Значение]} 
        } 
        *  
        {
            [Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>]:[Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>].lag(1) 
        }  
    } on columns,
    [Регионы] on rows   
from [ЭО_КЖН_Ленинградская область МО]  ]]>
  </query>
    <query id="Grid_Prop">
    <![CDATA[
    --Grid_Prop 
with 
    set [Регионы] 
    as ' 
        {
            filter 
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                ([Measures].[Значение]>0) and 
                (
                    Right 
                    (
                        [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"  
                )   
            ) 
        }' 
    member [Measures].[Имя региона] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName' 
    MEMBER [Measures].[Test]
    As '[КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].CurrentMember.Properties("Флаг")'
select
    {
        {
            [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].[Интегральный показатель],
            [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].[Интегральный показатель].children 
        } 
        * 
        {
            [Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>]
            --:[Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>].lag(1)  
        } 
    } on columns,
    [Регионы] on rows 
from [ЭО_КЖН_Ленинградская область МО] where([Measures].[Test]) ]]>
  </query>

  <query id="Grid_Prop1">
    <![CDATA[
    --Grid_Prop1    
with  
    set [Регионы]  
    as '  
        {
            filter  
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                ([Measures].[Значение]>0) and 
                (
                    Right 
                    (
                        [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"  
                )  
            )  
        }'  
    member [Measures].[Имя региона]  
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'  
    MEMBER [Measures].[Test] 
    As '[КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].CurrentMember.Properties("Флаг")' 
select
    {
        {
            {
                <%tableArea%> 
            }  
            *{[Measures].[Test]},
            {
                filter  
                (
                    {
                        <%tableArea%> .children  
                    },
                    Right  
                    (
                        [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].Currentmember.UniqueName,
                        10  
                    ) <> "DATAMEMBER"  
                )  
            }  
            *{[Measures].[Test]} 
        }  
        *  
        {
            [Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>]
            
        }  
    } on columns,
    [Регионы] on rows  
from [ЭО_КЖН_Ленинградская область МО]    ]]>
  </query>
  <query id="Grid_Prop_ED">
    <![CDATA[
    --Grid_Prop_ED
with 
     MEMBER [Measures].[ED]
    As '[КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].CurrentMember.Properties("Единица измерения")'
    set [Регионы] 
    as ' 
        {
            filter 
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                ([Measures].[Значение]>0) and 
                (
                    Right 
                    (
                        [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"  
                )   
            ) 
        }' 
    member [Measures].[Имя региона] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName' 
    MEMBER [Measures].[Test]
    As '[КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].CurrentMember.Properties("Флаг")'
select
     {
        {
            {
                <%tableArea%> 
            }  
            *{[Measures].[ED]},
            {
                filter  
                (
                    {
                        <%tableArea%> .children  
                    },
                    Right  
                    (
                        [КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].Currentmember.UniqueName,
                        10  
                    ) <> "DATAMEMBER"  
                )  
            }  
            *{ [Measures].[ED]} 
        }  
        *  
        {
            [Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>]
            
        }  
    } on columns,
    [Регионы] on rows 
from [ЭО_КЖН_Ленинградская область МО]  ]]>
  </query>
  <query id="Chart">
    <![CDATA[
--Chart
with  
     MEMBER [Measures].[ED]
    As '[КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].CurrentMember.Properties("Единица измерения")'
    set [Регионы]  
    as '  
        {
            filter  
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                (<%chartMeasure%>>0) and 
                (
                    Right 
                    (
                        [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"  
                )  
            )  
        }'  
    member [Measures].[Имя региона]  
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'  
select
     {<%chartMeasure%>,[Measures].[ED]  } on columns,
   non empty  order([Регионы],<%chartMeasure%> ,asc) on rows  
from [ЭО_КЖН_Ленинградская область МО]  where
    (
        [Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>],
        <%chartArea%>
        
    )  ]]>
  </query>
  <query id="Map">
    <![CDATA[
--Map 
with 
    set [Регионы] 
    as ' 
        {
            filter 
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                (<%chartMeasure%>>0) and 
                (
                    Right 
                    (
                        [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                        10 
                    ) <> "DATAMEMBER"  
                ) 
            ) 
        }' 
    member [Measures].[Имя региона] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName' 
        MEMBER [Measures].[Test]
    As '[КЖН__Ленинградская область МО].[КЖН__Ленинградская область МО].CurrentMember.Properties("Флаг")'
select
    
    {
       
        <%chartMeasure%> ,[Measures].[Test]
    } on columns,
    non empty  order
    (
        [Регионы],
         <%chartMeasure%> ,
        asc
    ) on rows 
from [ЭО_КЖН_Ленинградская область МО]  
where 
    (
        [Период__Год].[Период__Год].[Данные всех периодов].[<%curYear%>],
        <%chartArea%>
    )   ]]>
  </query>
</root>