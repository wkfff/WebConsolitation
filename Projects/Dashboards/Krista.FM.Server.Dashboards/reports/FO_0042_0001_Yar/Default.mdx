<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0042_0001_Yar_date">
    <![CDATA[
-- FO_0042_0001_Yar_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов].[2009] : [Период__Период].[Период__Период].[Данные всех периодов].[2013],
                    [Период__Период].[Период__Период].[Год],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Measures].[Оценка показателя],
                        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей]
                    )
                ) and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_Оценка качества ФМ_Показатели]

]]>
</query>

<query id="FO_0042_0001_Yar_grid">
<![CDATA[
-- FO_0042_0001_Yar_grid
with    
    set [Администраторы]    
    as 'Descendants    
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
            SELF    
        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]'    
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Аггрегированные администраторы]  
    as 'Aggregate({ [Администраторы] })'   
    set [Показатели для оценки]    
    as 'Filter    
        (
            Descendants    
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 3],
                SELF_AND_BEFORE  
            ) -    
            {
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Несопоставленные данные],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Уровень качества финансового менеджмента ГРБС],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Интегральная оценка качества финансового менеджмента ГРБС],
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Рейтинговая оценка каждого ГРБС за качество финансового менеджмента]  
            },
            not    
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Parent.DataMember    
            )    
        ) '      
    member [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Аггрегированные показатели]    
    as 'Aggregate({ [Показатели для оценки] })'     
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Код]  
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Код") + "_"'   
    member  [Администратор__Сопоставим].[Администратор__Сопоставим].[Наименование]  
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Name'
    member [Measures].[Мера для показателя ]    
    as '
            IIF
            (
                (
                    [Measures].[Применим ли в оценке] = 0   
                ),
                -100500,
                [Measures].[Оценка показателя]   
            )
        '   
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Уровень]  
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].Level.Name'
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Пустая строка]   
    as 'IIF 
        (
            (
                (
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Level is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 1]  
                ) or   
                (
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Level is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 2]  
                )  
            ) and Count 
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Children 
            ) <> 0 ,
            "true",
            "false" 
        )'  
select
    {
        {
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Код],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Наименование] 
        } + Filter 
        (
            {  [Администраторы]  },
            not IsEmpty  
            (
                (
                  [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Максимально возможная оценка, которую может получить ГРБС за КФМ исходя из применимости показателей],
                  [Measures].[Оценка показателя]
                )
            )  
        ) +
        {
           [Администратор__Сопоставим].[Администратор__Сопоставим].[Уровень],
           [Администратор__Сопоставим].[Администратор__Сопоставим].[Пустая строка] 
        }   
    } on columns,
    non empty ( [Показатели для оценки] )  on rows
from [ФО_Оценка качества ФМ_Показатели]    
where    
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%selected_year%>],
        [Measures].[Мера для показателя ]    
    )         
  ]]>
</query>

  <query id="FO_0042_0001_Yar_adminstratorDescription">
    <![CDATA[
-- FO_0042_0001_Yar_adminstratorDescription
With
    set [Администраторы]
    as 'Descendants
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
            SELF
        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]'
    member [Measures].[Код]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")'
    member [Measures].[Краткое наименование]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Краткое наименование")'    
Select
    {
       [Measures].[Код],
       [Measures].[Краткое наименование]
    } on columns,
    { [Администраторы] } on rows
From [ФО_Оценка качества ФМ_Показатели]
  ]]>
  </query>

</root>