<?xml version="1.0" encoding="Windows-1251"?>
<root>


  <query id="years">
    <![CDATA[
    --SEP_0003_ComplexSahalin years
with 
    member [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Год] 
    as '[Период__Период].[Период__Период].currentmember.parent.parent.name' 
select
    non empty 
    {
        filter 
        (
            [Период__Период].[Период__Период].[Квартал].members,
            not isempty
            (
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Социальная сфера]
            ) and [Период__Период].[Период__Период].currentmember.name<>"Квартал 4" and [Период__Период].[Период__Период].currentmember.parent.parent.name<>"2008"
        ) 
    }on rows,
    NON EMPTY 
    {
        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Социальная сфера],
        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Базовые показатели].[Год] 
    } on columns 
from     [ЭО_СЭР_Комплексная оценка] 
where  
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.],
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР],
        [Measures].[Значение] 
    )  

]]>
  </query>

  <query id="pok">
    <![CDATA[
    --SEP_0003_ComplexSahalin pok
with
    member [Measures].[Код]
    as '[Показатели__Комплексная оценка].currentmember.properties("Код")'
    member [Measures].[Уровень]
    as '[Показатели__Комплексная оценка].currentmember.parent.name'
select 
    non empty
    {
        filter
        (
            Descendants
            (
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели],
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Сфера],
                SELF
            ),
            [Measures].[Код]<>"1019900" and [Measures].[Код]<>"1020400" and Right
            (
                [Показатели__Комплексная оценка].currentmember.uniquename,
                10
            )<>"DATAMEMBER"
        )
    }on rows,
    NON EMPTY
    {
        [Measures].[Код],
        [Measures].[Уровень]
    } on columns
from     [ЭО_СЭР_Комплексная оценка]
where
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.],
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]
    )
]]>
  </query>

  <query id="grid">
    <![CDATA[
    --SEP_0003_ComplexSahalin grid    
with      
    member [Measures].[Ед]      
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Единица измерения")'      
    member [Measures].[Вес] 
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("<%weightKoef%> коэффициент результата")' 
    member [Measures].[Обратный]   
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Показатель обратный")'   
  member [Measures].[Индикатор уровня]   
    as '   IIF 
        (
            not isempty 
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                    [Measures].[Значение] 
                ) 
            ) and (
                        Max   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        )-Min   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        )   
                    ) <>0,
            IIF   
            (
                [Measures].[Обратный]="0",
                (
                    (
                        (
                            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                            [Measures].[Значение]   
                        )-Min   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        )   
                    )/   
                    (
                        Max   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        )-Min   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        )   
                    )   
                ) ,
                (
                    (
                        Max   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        ) -   
                        (
                            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                            [Measures].[Значение]   
                        )   
                    )/   
                    (
                        Max   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        )-Min   
                        (
                            filter   
                            (
                                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                                right   
                                (
                                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                    10   
                                )<>"DATAMEMBER"   
                            ) ,
                            (
                                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                                [Measures].[Значение]  
                            )  
                        )   
                    )  
                ) 
            ),
            null
        ) ' 
   member [Measures].[динамика] 
    as 'IIF 
        (
            not isempty
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Период].[Период__Период].[Год],
                        1,
                        [Период__Период].[Период__Период].currentmember 
                    ),
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    ) 
                )
            ) and   
            (
                ParallelPeriod 
                (
                    [Период__Период].[Период__Период].[Год],
                    1,
                    [Период__Период].[Период__Период].currentmember 
                ),
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                    [Measures].[Значение] 
                ) 
            )<>0 and not isempty 
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                    [Measures].[Значение] 
                ) 
            ) and 
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                    [Measures].[Значение] 
                ) 
            )<>0,
            (
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                    [Measures].[Значение] 
                ) 
            )/ 
            (
                ParallelPeriod 
                (
                    [Период__Период].[Период__Период].[Год],
                    1,
                    [Период__Период].[Период__Период].currentmember 
                ),
                (
                    [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                    [Measures].[Значение] 
                ) 
            ) ,
            IIF   
            (
                (
                    ParallelPeriod  
                    (
                        [Период__Период].[Период__Период].[Год],
                        1,
                        [Период__Период].[Период__Период].currentmember  
                    ),
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    )
                )=0 and 
                (
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    )
                )=0 and not isempty
                    (
                         (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    )
                    ) and not isempty
                    (
                        (
                            ParallelPeriod
                            (
                                [Период__Период].[Период__Период].[Год],
                                1,
                                [Период__Период].[Период__Период].currentmember
                            ),
                           (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    )
                        )
                    ),
                [Measures].[Обратный]  
                *(-1),
            IIF 
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Период].[Период__Период].[Год],
                        1,
                        [Период__Период].[Период__Период].currentmember 
                    ),
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    ) 
                )>0 and 
                (
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    ) 
                )=0
                and not isempty((
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    )) 
                    and not isempty((
                    ParallelPeriod 
                    (
                        [Период__Период].[Период__Период].[Год],
                        1,
                        [Период__Период].[Период__Период].currentmember 
                    ),
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    ) 
                )),
                0,
                IIF 
                (
                    (
                        ParallelPeriod 
                        (
                            [Период__Период].[Период__Период].[Год],
                            1,
                            [Период__Период].[Период__Период].currentmember 
                        ),
                        (
                            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                            [Measures].[Значение] 
                        ) 
                    )=0 and 
                    (
                        (
                            [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                            [Measures].[Значение] 
                        ) 
                    )>0
                    and not isempty((
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    )) 
                    and not isempty((
                    ParallelPeriod 
                    (
                        [Период__Период].[Период__Период].[Год],
                        1,
                        [Период__Период].[Период__Период].currentmember 
                    ),
                    (
                        [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember,
                        [Measures].[Значение] 
                    ) 
                )),
                    1,
                    null
                ) 
            )  
            )
        ) '
    member [Measures].[Индикатор динамики]  
    as '
IIF
        (
            not isempty( [Measures].[динамика] )
            and (
                    Max   
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10    
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    )-Min   
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10   
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    )   
                )<>0,
            IIF   
            (
                [Measures].[Обратный]="0",
                (
                    ( [Measures].[динамика] )-Min   
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10   
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    )   
                )/   
                (
                    Max   
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10   
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    )-Min   
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10   
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    )   
                ),
                (
                    Max   
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10   
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    ) - ( [Measures].[динамика] )   
                )/   
                (
                    Max
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10   
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    )-Min   
                    (
                        filter   
                        (
                            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                            right   
                            (
                                [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                                10   
                            )<>"DATAMEMBER"   
                        ) ,
                        [Measures].[динамика]   
                    )   
                )   
            ),
            null  
        )'
select
  --  non empty      
    {
        {
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область]    
        }    
        * { [Measures].[Вес]},
        {
            filter  
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children       ,
                right  
                (
                    [Территории__РФ].[Территории__РФ].currentmember.uniquename,
                    10  
                )<>"DATAMEMBER"  
            )  
        }      
        *   
        {
            [Measures].[<%selectedIndicator%>]  
        }    
    }on rows,
    NON EMPTY      
    { 
        filter      
        (
            {
                [Показатели__Комплексная оценка].[Показатели__Комплексная оценка].[Все].[Комплексная оценка СЭР_Сахалин].[Исходные показатели].[<%selectedPok%>].children       
            },
            not isempty( [Measures].[<%selectedIndicator%>]   )      
        )      
    } on columns      
from     [ЭО_СЭР_Комплексная оценка]   
where      
    (
        <%selectedPeriod%>,
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]      
    )      
]]>
  </query>

  <query id="grid_Initial">
    <![CDATA[
    --SEP_0001_ComplexSahalin grid_Initial
 with   
    member [Measures].[Ед]   
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("Единица измерения")' 
    member [Measures].[Вес]
    as '[Показатели__Комплексная оценка].[Показатели__Комплексная оценка].currentmember.properties("<%weightKoef%> коэффициент результата")'
select
    non empty        
    {
        {
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область]  
        }  
        * {[Measures].[Ед],
        [Measures].[Вес]},
        {
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children   
        }  
        * {[Measures].[Значение]     }  
    }on rows,
    NON EMPTY       
    {
        filter 
        (
            {
                { 
                    <%selectedPok%>.children     
                }     
                *    
                {
                  <%selectedPeriod%>
                }
            },
            not isempty([Measures].[Значение] ) 
        ) 
    } on columns      
from     [ЭО_СЭР_Комплексная оценка]        
where        
    (
        --  [Период__Период].[Период__Период].[Данные всех периодов].[2008].[Полугодие 2].[Квартал 3],
        [Источники данных].[Источники данных].[Все источники данных].[ЭО СЭР]   
    )  
]]>
  </query>

</root>
