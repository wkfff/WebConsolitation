<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="MFRF_0004_0001_grid">
    <![CDATA[
-- MFRF_0004_0001_grid_appropriation
-- <#МФ РФ_Расходы ФБ]#>
WITH          
    member [Measures].[Код]
    as 'IIF
        (
            [МФ РФ].[ГРБС ФБ Сопоставимый].CurrentMember is [МФ РФ].[ГРБС ФБ Сопоставимый].[Всего по ГРБС],
            0,
            StrToValue([МФ РФ].[ГРБС ФБ Сопоставимый].CurrentMember.Properties("Код"))
        )'
    member [Measures].[Объем неисполненных бюджетных ассигнований]    
    as 'IIF    
        (
            not    
            (
                IsEmpty([Measures].[План]) or [Measures].[План] = 0   
            ) ,
            (
                [Measures].[План] - [Measures].[Факт]   
            ) / [Measures].[План],
            null  
        )'   
    member [Measures].[Критерий оценки - объем неисполненных ассигнований не более 0,5% (Приказ 123н)] 
    as 'IIF 
        (
            [Measures].[Объем неисполненных бюджетных ассигнований] < 0,
            "Исключение_",
            IIF 
            (
                [Measures].[Объем неисполненных бюджетных ассигнований] > 0.005,
                "Не соответствует",
                "Соответствует"
            ) 
        )' 
    member [Measures].[Критерий оценки - объем неисполненных ассигнований не более 0% (Приказ 34н)]
    as 'IIF
        (
            [Measures].[Объем неисполненных бюджетных ассигнований] < 0,
            "Исключение_",
            IIF
            (
                [Measures].[Объем неисполненных бюджетных ассигнований] > 0,
                "Не соответствует",
                "Соответствует"
            )
        )'
    member [МФ РФ].[ГРБС ФБ Сопоставимый].[Всего по ГРБС]      
    as '[МФ РФ].[ГРБС ФБ Сопоставимый].[Все]'      
SELECT
    {
        [Measures].[Код],
        [Measures].[План],
        [Measures].[Факт],
        [Measures].[Объем неисполненных бюджетных ассигнований],
        [Measures].[Критерий оценки - объем неисполненных ассигнований не более 0,5% (Приказ 123н)],
        [Measures].[Критерий оценки - объем неисполненных ассигнований не более 0% (Приказ 34н)]
    } on columns,
    Filter 
    (         
        {
            [МФ РФ].[ГРБС ФБ Сопоставимый].[Всего по ГРБС]      
        } + 
        [МФ РФ].[ГРБС ФБ Сопоставимый].[Все].Children -      
        {
            [МФ РФ].[ГРБС ФБ Сопоставимый].[Все].[Несопоставленные данные]         
        },
        [Measures].[План] <> 0 and [Measures].[Факт] <> 0  
    ) on rows  
FROM  [МФ РФ_Расходы ФБ]     
WHERE     
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [МФ РФ].[КОСГУ].[Все]    
    )     
  ]]>
</query>

<query id="MFRF_0004_0001_details">
<![CDATA[
-- MFRF_0004_0001_details_appropriation
-- <#МФ РФ_Расходы ФБ]#>
WITH     
    member [Measures].[Объем неисполненных бюджетных ассигнований]    
    as 'IIF    
        (
            not    
            (
                IsEmpty([Measures].[План]) or [Measures].[План] = 0    
            ) ,
            (
                [Measures].[План] - [Measures].[Факт]    
            ) / [Measures].[План],
            null    
        )'    
    member [Measures].[Количество нарушителей согласно Приказу 123н]    
    as 'Count    
        (
            Filter   
            (
                [Список ГРБС],
                [Measures].[Объем неисполненных бюджетных ассигнований] > 0.005   
            )   
        )'    
    member [Measures].[Количество нарушителей согласно Приказу 34н]   
    as 'Count   
        (
            Filter   
            (
                [Список ГРБС],
                [Measures].[Объем неисполненных бюджетных ассигнований] > 0   
            )   
        )'   
    member [Measures].[Средний объем неисполненных бюджетных ассигнований]  
    as 'AVG  
        (
            [Список ГРБС],
            [Measures].[Объем неисполненных бюджетных ассигнований]  
        )'  
    member [Measures].[Максимальный объем неиспользованных бюджетных ассигнований] 
    as 'MAX 
        (
            [Список ГРБС],
            [Measures].[Объем неисполненных бюджетных ассигнований] 
        )' 
    member [Measures].[ГРБС с максимальным объемом неиспользованных бюджетных ассигнований] 
    as 'Generate
        (
            HEAD
            (
                Order   
                (
                    [Список ГРБС],
                    [Measures].[Объем неисполненных бюджетных ассигнований],
                    BDESC  
                ),
                1  
            ),
            [МФ РФ].[ГРБС ФБ Сопоставимый].CurrentMember.Name,
            " "
        )'         
    set [Список ГРБС]
    as 'Filter     
        (
            [МФ РФ].[ГРБС ФБ Сопоставимый].[Все].Children -     
            {
                [МФ РФ].[ГРБС ФБ Сопоставимый].[Все].[Несопоставленные данные]     
            },
            not(            
                IsEmpty
                (
                  [Measures].[Объем неисполненных бюджетных ассигнований]
                ) or 
                (
                   [Measures].[Объем неисполненных бюджетных ассигнований] < 0
                )
               ) 
        )'
    member [Measures].[Количество оцененных]
    as 'Count
        (
            [Список ГРБС]
        )'         
SELECT
    {
        [Measures].[Количество нарушителей согласно Приказу 123н],
        [Measures].[Количество нарушителей согласно Приказу 34н],
        [Measures].[Средний объем неисполненных бюджетных ассигнований],
        [Measures].[Максимальный объем неиспользованных бюджетных ассигнований],
        [Measures].[ГРБС с максимальным объемом неиспользованных бюджетных ассигнований],
        [Measures].[Количество оцененных]
    } on columns   
FROM  [МФ РФ_Расходы ФБ]     
WHERE     
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [МФ РФ].[КОСГУ].[Все]     
    )     
  ]]>
</query>
</root>