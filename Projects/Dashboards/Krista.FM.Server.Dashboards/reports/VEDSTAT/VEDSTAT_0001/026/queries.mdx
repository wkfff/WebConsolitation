<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id="last_date">
    <![CDATA[ -- name: last_date 16   
SELECT
    { [Measures].[Значение]  } on columns,
    {
        Tail
        (
            Filter
            (
                [Период].[Год Квартал Месяц].[Год].Members,
                [Measures].[Значение] > 0
            )
        ).Item(0)
    } DIMENSION PROPERTIES MEMBER_UNIQUE_NAME on rows
FROM [ВЕДСТАТ_Свод]
where
    (
        <%baseRegion%>,
        [Источники данных].[Все источники данных],
        [Показатели].[ВедСтат_Свод].[Все показатели].[<%way_last_year%>]
    )  
	  ]]>
  </query>
  <query id="Grid">
    <![CDATA[select
    non empty   
    {
        <%grid1Marks%>
           
    } on rows,
    non empty   { [measures].[значение] }   on columns 
FROM [ВЕДСТАТ_Свод]   
where   
    (
        <%baseRegion%>,
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%lastdate%>]  
    ) 	   
	  ]]>
  </query>
   <query id="GE">
    <![CDATA[
    WITH
    MEMBER [Measures].[Единица измерения]
    AS  '[Показатели].[ВедСтат_Свод].CurrentMember.Properties("Единица измерения")'
    select
    non empty   
    {
        [Показатели].[ВедСтат_Свод].[Все показатели].[ОБЕСПЕЧЕНИЕ ПРОТИВОПОЖАРНОЙ БЕЗОПАСНОСТИ В МУНИЦИПАЛЬНОМ ОБРАЗОВАНИИ, ОРГАНИЗАЦИЯ МУНИЦИПАЛЬНОЙ ПОЖАРНОЙ СЛУЖБЫ].[Количество пожарных частей в муниципальном образовании],
        [Показатели].[ВедСтат_Свод].[Все показатели].[ОБЕСПЕЧЕНИЕ ПРОТИВОПОЖАРНОЙ БЕЗОПАСНОСТИ В МУНИЦИПАЛЬНОМ ОБРАЗОВАНИИ, ОРГАНИЗАЦИЯ МУНИЦИПАЛЬНОЙ ПОЖАРНОЙ СЛУЖБЫ].[Численность служащих],
        [Показатели].[ВедСтат_Свод].[Все показатели].[ОБЕСПЕЧЕНИЕ ПРОТИВОПОЖАРНОЙ БЕЗОПАСНОСТИ В МУНИЦИПАЛЬНОМ ОБРАЗОВАНИИ, ОРГАНИЗАЦИЯ МУНИЦИПАЛЬНОЙ ПОЖАРНОЙ СЛУЖБЫ].[Наличие специализированных транспортных средств],
        [Показатели].[ВедСтат_Свод].[Все показатели].[ОБЕСПЕЧЕНИЕ ПРОТИВОПОЖАРНОЙ БЕЗОПАСНОСТИ В МУНИЦИПАЛЬНОМ ОБРАЗОВАНИИ, ОРГАНИЗАЦИЯ МУНИЦИПАЛЬНОЙ ПОЖАРНОЙ СЛУЖБЫ].[Оснащенность спецоборудованием, спецодеждой и обувью (в % к установленной норме)],
        [Показатели].[ВедСтат_Свод].[Все показатели].[ОБЕСПЕЧЕНИЕ ПРОТИВОПОЖАРНОЙ БЕЗОПАСНОСТИ В МУНИЦИПАЛЬНОМ ОБРАЗОВАНИИ, ОРГАНИЗАЦИЯ МУНИЦИПАЛЬНОЙ ПОЖАРНОЙ СЛУЖБЫ].[Количество пожаров]   
    } on rows,
    non empty   { [Measures].[Единица измерения] }   on columns 
FROM [ВЕДСТАТ_Свод]   
where   
    (
        <%baseRegion%>,
        [Период].[Год Квартал Месяц].[Данные всех периодов].[<%lastdate%>]  
    ) 	   
	  ]]>
  </query> 
  <query id="Chart">
    <![CDATA[select
    non empty    
    {
        <%chart1Marks%>.[<%Pokaz%>]    
    } on rows,
    non empty   
    {
        [Период].[Год Квартал Месяц].[Данные всех периодов].[1998]:[Период].[Год Квартал Месяц].[Данные всех периодов].[<%lastdate%>]   
    }   on columns 
FROM [ВЕДСТАТ_Свод]    
where    
    (
        <%baseRegion%> 
    ) 	    	        
	  ]]>
  </query>
  <query id="GridSvod">
    <![CDATA[--GridSvod
with  
    MEMBER [Период].[Год Квартал Месяц].[ЕдИзм]  
    AS  '[Показатели].[ВедСтат_Свод].CurrentMember.Properties("Единица измерения")'  
select
    non empty  

        {
                       [Показатели].[ВедСтат_Свод].[Все показатели].[ОБЕСПЕЧЕНИЕ ПРОТИВОПОЖАРНОЙ БЕЗОПАСНОСТИ В МУНИЦИПАЛЬНОМ ОБРАЗОВАНИИ, ОРГАНИЗАЦИЯ МУНИЦИПАЛЬНОЙ ПОЖАРНОЙ СЛУЖБЫ].children 
        }  
     on rows,
    non empty  union 
    (
        {
            [Период].[Год Квартал Месяц].[ЕдИзм] 
        },
        {
             [Период].[Год Квартал Месяц].[Данные всех периодов].[<%lastdate%>]: [Период].[Год Квартал Месяц].[Данные всех периодов].[<%lastdate%>].Lag(9)
        } 
    ) on columns 
FROM [ВЕДСТАТ_Свод]   
where   
    (
        [Источники данных].[Все источники данных].[ВЕДСТАТ МО - Муниципальная статистика],
        <%baseRegion%>,
        [Measures].[Значение]   
    )          	        
	  ]]>
  </query>
</root>