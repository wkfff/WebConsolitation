<?xml version="1.0" encoding="Windows-1251"?>
<root>
<query id="STAT_0004_0001_data">
  <![CDATA[
  --STAT_0004_0001_data
     with          
    member [Measures].[Имя]          
    as 'IIF          
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + " год",
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name         
        )'          
    member [Measures].[Уникальное имя]          
    as '        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName  ' 	        
    member [Measures].[Уровень]          
    as 'IIF          
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level is         [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
            0,
            IIF          
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level is         [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                1,
                2          
            )          
        )'           
    set [Периоды]          
    as 'Generate          
        (
            {
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2008] :         [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2020]
            },
            {
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
            } + Filter          
            (
                Descendants          
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    SELF_AND_AFTER          
                ),
                not          
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is         [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember 
                )and          
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные года"  
                )and          
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные квартала"  
                )and          
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные полугодия"  
                )          
            )          
        )'           
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]          
    } on columns,
    Filter          
    (
        [Периоды],
        not IsEmpty([Measures].[За период])          
    ) on rows          
from  [СТАТ_Экология_Отходы производства]         
where          
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДепЭкологии ХМАО-Югры]         
    )          
   ]]>
</query>
	
<query id="STAT_0004_0001_grid">
 <![CDATA[
 --STAT_0004_0001_grid
with             
    member Measures.[Значение]             
    as '[Measures].[За период]'             
    member Measures.[Отклонение]             
    as '             
        (
            (
                [Measures].[За период],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember             
            )-             
            (
                ParallelPeriod             
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember             
                ),
                [Measures].[За период]             
            )             
        )'             
    member Measures.[Темп прироста]             
    as 'IIF  
        (
            IsEmpty  
            (
                (
                    ParallelPeriod  
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    ),
                    [Measures].[За период]  
                )  
            )or  
            (
                ParallelPeriod  
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                ),
                [Measures].[За период]  
            )=0,
            null,
            (
                (
                    [Measures].[За период],
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember       
                )/     
                (
                    ParallelPeriod      
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember      
                    ),
                    [Measures].[За период]      
                )    
                *100   
            )-100   
        )/100'   
    set [Предприятие, допустившее аварию]             
    as ' Descendants             
        (
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Предприятие],
            self             
        )'             
    set [Территория]             
    as ' Descendants             
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
            self             
        )'           
    member [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Группировка ]           
    as 'Aggregate          
        (
            {
                [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По городам и районам],
                [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По реестру предприятий]          
            }          
        )'
   member [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Сумма по району]
   as 'sum(
             {
               [Предприятие, допустившее аварию]
             },
             Measures.[Значение]
          )'
	member [Экология__Отходы производства].[Экология__Отходы производства].[Наименование]
    as 'IIF
        (
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember is  [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Сумма по району],
            [Территории__Сопоставимый].[Территории__Сопоставимый].Currentmember.Name,
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember.Name
        )' 
    member [Экология__Отходы производства].[Экология__Отходы производства].[Уровень]
    as 'IIF 
        (
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].CurrentMember is  [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Сумма по району],
            1,
            0  
        )' 
	member  [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Коррозия]   
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Коррозия]'   
    member [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Механические повреждения]  
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Механические повреждения]'  
    member [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Строительный брак]  
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Строительный брак]'  
    member [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Прочие]  
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Прочие]'  
    member [Экология__Отходы производства].[Экология__Отходы производства].[Масса, т;Масса загрязняющих веществ (нефть) в момент аварии]  
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) в момент аварии]'   
    member [Экология__Отходы производства].[Экология__Отходы производства].[Масса, т;Масса загрязняющих веществ (нефть) после ликвидации аварии]  
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) после ликвидации аварии]'  
    member [Экология__Отходы производства].[Экология__Отходы производства].[Площадь загрязнения;Площадь загрязнения]  
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Площадь загрязнения]' 
    member [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Локальная] 
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Локальная]' 
    member [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Муниципальная] 
    as ' [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Муниципальная]' 
    member [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Территориальная] 
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Территориальная]' 
    member [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Региональная] 
    as '[Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Региональная]' 
Select
    NON EMPTY {
        {
            [Экология__Отходы производства].[Экология__Отходы производства].[Наименование],
            [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Коррозия],
            [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Механические повреждения],
            [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Строительный брак],
            [Экология__Отходы производства].[Экология__Отходы производства].[Причины аварии;Прочие],
            [Экология__Отходы производства].[Экология__Отходы производства].[Масса, т;Масса загрязняющих веществ (нефть) в момент аварии],
            [Экология__Отходы производства].[Экология__Отходы производства].[Масса, т;Масса загрязняющих веществ (нефть) после ликвидации аварии],
            [Экология__Отходы производства].[Экология__Отходы производства].[Площадь загрязнения;Площадь загрязнения],
            [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Локальная],
            [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Муниципальная],
            [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Территориальная],
            [Экология__Отходы производства].[Экология__Отходы производства].[Катагория аварии;Региональная],
            [Экология__Отходы производства].[Экология__Отходы производства].[Уровень]
        }          
    } on columns,
    Filter           
    (
        {
            [Территория]           
            * 
            {
                [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Сумма по району],
                [Предприятие, допустившее аварию]
            } 
        }             
        *             
        {
            Measures.[Значение],
            Measures.[Отклонение],
            Measures.[Темп прироста]             
        },
        not IsEmpty ( Measures.[Значение] )           
    )  on rows            
FROM [СТАТ_Экология_Отходы производства]             
Where             
    (
        <%select_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДепЭкологии ХМАО-Югры],
        [Классы опасности].[Все классы опасности].[Значение не указано],
        [ОК__ОКВЭД].[ОК__ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [Экология__Место размещения].[Экология__Место размещения].[Все места размещения].[Значение не указано],
        [Экология__Цели использования].[Экология__Цели использования].[Все цели использования].[Значение не указано],
		 [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По городам и районам, по реестру предприятий]
    )               
 ]]>
</query>
  
<query id="STAT_0004_0001_chart1">
 <![CDATA[ 
 --STAT_0004_0001_chart1
 with     
    member Measures.[Значение]     
    as '[Measures].[За период]'     
    member Measures.[Отклонение]     
    as '     
        (
            (
                [Measures].[За период],
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember     
            )-     
            (
                ParallelPeriod     
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember     
                ),
                [Measures].[За период]     
            )     
        )'     
    member Measures.[Темп прироста]     
    as 'IIF     
        (
            IsEmpty     
            (
                (
                    ParallelPeriod     
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember     
                    ),
                    [Measures].[За период]     
                )     
            )or     
            (
                ParallelPeriod     
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember     
                ),
                [Measures].[За период]     
            )=0,
            null,
            (
                (
                    [Measures].[За период],
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember     
                )/     
                (
                    ParallelPeriod     
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember     
                    ),
                    [Measures].[За период]     
                )     
                *100     
            )-100     
        )'     
    set [Предприятие, допустившее аварию]     
    as ' Descendants     
        (
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия],
            [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Предприятие],
            self     
        )'     
    set [Территория]     
    as ' Descendants     
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
            self     
        )'     
    member [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Группировка ]     
    as 'Aggregate     
        (
            {
                [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По городам и районам],
                [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По реестру предприятий]     
            }     
        )'     
    member [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Сумма по району]     
    as 'sum    
        (
            {
                [Предприятие, допустившее аварию]     
            },
            Measures.[Значение]     
        )'     
Select
    {
        [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) в момент аварии],
        [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) после ликвидации аварии] 
    } on rows,
    Filter
    (
        [Территория] ,
        not IsEmpty ( Measures.[Значение] )     
    )on columns
FROM [СТАТ_Экология_Отходы производства]     
Where     
    (
	    Measures.[Значение],
        <%select_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДепЭкологии ХМАО-Югры],
        [Классы опасности].[Все классы опасности].[Значение не указано],
        [ОК__ОКВЭД].[ОК__ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [Экология__Место размещения].[Экология__Место размещения].[Все места размещения].[Значение не указано],
        [Экология__Цели использования].[Экология__Цели использования].[Все цели использования].[Значение не указано] ,
        [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия],
        [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По городам и районам, по реестру предприятий]
    )     
 ]]>
</query>

<query id="STAT_0004_0001_chart2">
<![CDATA[ 
 --STAT_0004_0001_chart2
 
 with 
    member Measures.[Значение] 
    as '[Measures].[За период]'   
    set [Территория] 
    as ' Descendants 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
            self 
        )'  
Select
    {
        [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Площадь загрязнения] 
        *{Measures.[Значение]} 
    } on columns,
    Filter 
    (
        [Территория] ,
        not IsEmpty 
        (
            (
                Measures.[Значение],
                [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Площадь загрязнения] 
            ) 
        ) 
    )  on rows 
FROM [СТАТ_Экология_Отходы производства] 
Where 
    (
        <%select_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДепЭкологии ХМАО-Югры],
        [Классы опасности].[Все классы опасности].[Значение не указано],
        [ОК__ОКВЭД].[ОК__ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [Экология__Место размещения].[Экология__Место размещения].[Все места размещения].[Значение не указано],
        [Экология__Цели использования].[Экология__Цели использования].[Все цели использования].[Значение не указано] ,
        [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия],
        [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По городам и районам, по реестру предприятий] 
    ) 
 ]]>
</query>

	<query id="STAT_0004_0001_map">
<![CDATA[ 
-- 	STAT_0004_0001_map
    with 
    member Measures.[Значение] 
    as '[Measures].[За период]' 
    set [Территория] 
    as ' Descendants 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
            self 
        )' 
    
   member Measures.[Площадь загрязнения]           
    as 'IIF          
        (
            IsEmpty       
            (
                (
                    [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Площадь загрязнения],
                    Measures.[Значение]          
                )         
            ),
            0,
            (
                [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Площадь загрязнения],
                Measures.[Значение]        
            )        
        )'           
		
    member Measures.[Масса ЗВ в момент аварии]             
    as 'IIF        
        (
            IsEmpty       
            (
                (
                    [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) в момент аварии],
                    Measures.[Значение]           
                ) - Measures.[Масса ЗВ после аварии] 
            ),
            0,
            (
                [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) в момент аварии],
                Measures.[Значение]      
            )-Measures.[Масса ЗВ после аварии] 
        )'            
		
    member Measures.[Масса ЗВ после аварии]           
    as 'IIF   
        (
            IsEmpty  
            (
                (
                    [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) после ликвидации аварии],
                    Measures.[Значение]         
                )  
            ) ,
            0,
            (
                [Экология__Отходы производства].[Экология__Отходы производства].[Все показатели].[Масса загрязняющих веществ (нефть) после ликвидации аварии],
                Measures.[Значение] 
            ) 
        )'
		
Select
    {
       Measures.[Площадь загрязнения],
       Measures.[Масса ЗВ в момент аварии],
        Measures.[Масса ЗВ после аварии]
    } on columns,
    Filter 
    (
        [Территория] ,
        not IsEmpty 
        (
          Measures.[Масса ЗВ после аварии]
        ) or
        not IsEmpty
        (
          Measures.[Масса ЗВ в момент аварии]
        ) or
        not IsEmpty
        (
          Measures.[Площадь загрязнения]
        )
    )  on rows 
FROM [СТАТ_Экология_Отходы производства] 
Where 
    (
        <%select_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДепЭкологии ХМАО-Югры],
        [Классы опасности].[Все классы опасности].[Значение не указано],
        [ОК__ОКВЭД].[ОК__ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [Экология__Место размещения].[Экология__Место размещения].[Все места размещения].[Значение не указано],
        [Экология__Цели использования].[Экология__Цели использования].[Все цели использования].[Значение не указано] ,
        [Организации__Реестр предприятий].[Организации__Реестр предприятий].[Все предприятия],
        [Группировки__Экология_Отходы производства].[Группировки__Экология_Отходы производства].[Все группировки].[По городам и районам, по реестру предприятий] 
    ) 
 ]]>
</query>
</root>

