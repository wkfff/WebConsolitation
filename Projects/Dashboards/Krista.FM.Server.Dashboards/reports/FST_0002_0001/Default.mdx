<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FST_0002_0001_grid">
    <![CDATA[
-- FST_0002_0001_grid
with  
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]  
    as 'IIF  
        (
            IsEmpty  
            (
                (
                    <%period_cur_date%>,
                    [Measures].[Тариф]  
                )  
            ) or IsEmpty  
            (
                (
                    <%period_last_date%>,
                    [Measures].[Тариф]  
                )  
            ) or  
            (
                <%period_cur_date%>,
                [Measures].[Тариф]  
            )=0 or  
            (
                <%period_last_date%>,
                [Measures].[Тариф]  
            )=0,
            null,
            (
                <%period_cur_date%>,
                [Measures].[Тариф]  
            ) -  
            (
                <%period_last_date%>,
                [Measures].[Тариф]  
            )  
        )'  
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Темп прироста] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    <%period_last_date%>,
                    [Measures].[Тариф] 
                ) 
            ) or 
            (
                <%period_last_date%>,
                [Measures].[Тариф] 
            )=0,
            null,
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение] / 
            (
                <%period_last_date%>,
                [Measures].[Тариф] 
            ) 
        )' 
        
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Детали учета] 
    as 'IIF
        (
            [ФСТ__Детали учета].[ФСТ__Детали учета].CurrentMember is [ФСТ__Детали учета].[ФСТ__Детали учета].[Все детали учета].[Не определено],
            " ",
             "(" +[ФСТ__Детали учета].[ФСТ__Детали учета].CurrentMember.Name + ")"
        )'   
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[МР] 
    as 'IIF
        (
            [Территории__РФ].[Территории__РФ].CurrentMember.Level is [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ],
            " (" + [Территории__РФ].[Территории__РФ].CurrentMember.Parent.Name + ")",
            " "
        )'         
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Наименование] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Name + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[МР] + ";" +
        [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].CurrentMember.Name + ";" +
        [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].CurrentMember.Name + ";" +
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Детали учета] '          
select
    {
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Наименование] ,
        <%period_cur_date%>,
        <%period_last_date%>,
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Темп прироста] 
    } on columns,
    Order  
    (
        filter  
        (
            {
                CROSSJOIN  
                (
                    filter  
                    (
                        CROSSJOIN  
                        (
                            {
                                filter  
                                (
                                    CROSSJOIN  
                                    (
                                        {
                                            filter  
                                            (
                                                Descendants  
                                                (
                                                    <%selected_subject%>,
                                                    [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ],
                                                    LEAVES  
                                                ),
                                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                                            )  
                                        },
                                        {
                                            filter  
                                            (
                                                Except  
                                                (
                                                    [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].Members,
                                                    [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].[Все организации]  
                                                ),
                                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                                            )  
                                        }  
                                    ),
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                                )  
                            },
                            {
                                filter  
                                (
                                    Except  
                                    (
                                        [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].Members,
                                        [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].[Все виды благоустройств]  
                                    ),
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                                )  
                            }  
                        ),
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                    ),
                    {
                        filter  
                        (
                            Except  
                            (
                                [ФСТ__Детали учета].[ФСТ__Детали учета].Members,
                                [ФСТ__Детали учета].[ФСТ__Детали учета].[Все детали учета]  
                            ),
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                        )  
                    }  
                )  
            },
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение] <%compare_operator%> 0 
            --and ABS([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Темп прироста]) < 0.2             
        ),
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение],
        BDESC  
    )        on rows  
from [ФСТ_ЖКХ по МО_Тарифы и нормативы]  
where  
    (
        [Measures].[Тариф],
        <%selected_service%>
    )         
  ]]>
  </query>

  <query id="FST_0002_0001_periodDigest">
    <![CDATA[
-- FST_0002_0001_periodDigest
with
    set [Непустые периоды]
    as 'Generate
        (
            Filter
            (
                Descendants
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов],
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц],
                    SELF
                ),
                not IsEmpty
                (
                    [Measures].[Тариф]
                ) and
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные года"
                ) and
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            {
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent
            } +
            {
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
            }
        ) '
    member [Measures].[Имя]
    as 'IIF
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + " " + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent.Name + " года",
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + " год"
        ) '
    member [Measures].[Уникальное имя]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName'
    member [Measures].[Уровень]
    as 'IIF
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц],
            1,
            0
        )'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]
    } on columns,
    { [Непустые периоды] } on rows
from [ФСТ_ЖКХ по МО_Тарифы и нормативы]
  ]]>
  </query>

  <query id="FST_0002_0001_subjectDigest">
    <![CDATA[
-- FST_0002_0001_subjectDigest
with   
    set [Субъекты ЦФО]  
    as '{[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Центральный федеральный округ]} +  
        {
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Центральный федеральный округ].Children 
        } - [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Центральный федеральный округ].DATAMEMBER' 
    member [Measures].[Имя]   
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Name '
    member [Measures].[Уникальное имя]   
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName' 
    member [Measures].[Уровень]   
    as 'IIF   
        (
            [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Центральный федеральный округ],
            0,
            1   
        )'   
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]   
    } on columns,
    { [Субъекты ЦФО] } on rows 
from [ФСТ_ЖКХ по МО_Тарифы и нормативы]   
  ]]>
  </query>

  <query id="FST_0002_0001_serviceDigest">
    <![CDATA[
-- FST_0002_0001_serviceDigest
with
    set [Услуги]
    as '
        {
            [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[Водоснабжение],
            [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[Водоотведение],
            [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[Горячее водоснабжение],
            [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[Электроснабжение],
            [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[Отопление],
            [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[Газоснабжение],
            [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[Поставки твёрдого топлива при наличии печного отопления]
        }'
    member [Measures].[Имя]
    as 'UCase(Mid([ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].CurrentMember.Name, 0, 1)) + Mid([ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].CurrentMember.Name, 2, Len([ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].CurrentMember.Name))'
    member [Measures].[Уникальное имя]
    as '[ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].CurrentMember.UniqueName'
    member [Measures].[Уровень]
    as '0'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]
    } on columns,
    { [Услуги] } on rows
from [ФСТ_ЖКХ по МО_Тарифы и нормативы] 
  ]]>
  </query>

</root>