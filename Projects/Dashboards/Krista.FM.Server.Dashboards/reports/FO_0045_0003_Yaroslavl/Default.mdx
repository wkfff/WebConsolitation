<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0045_0003_Sakhalin_date">
    <![CDATA[
-- FO_0045_0003_Sakhalin_date
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период].[Период].[Данные всех периодов],
                    [Период].[Период].[Месяц],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Measures].[Факт]
                    )
                ) and
                (
                   [Период].[Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                   [Период].[Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                   [Период].[Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                   [Период].[Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                   [Период].[Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                   [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_МесОтч_СпрВнутрДолг]
]]>
  </query>

  <query id="FO_0045_0003_Sakhalin_grid">
    <![CDATA[
-- FO_0045_0003_Sakhalin_grid
with 
    set [Районы] 
    as 'Filter 
        (
            Descendants 
            (
                [Районы].[Сопоставимый].[Все районы],
                [Районы].[Сопоставимый].[Уровень 04],
                SELF 
            ),
            not 
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember 
            ) and 
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО" 
            ) 
        )' 
    member [Районы].[Сопоставимый].[Бюджет субъекта ] 
    as 'Aggregate({ [Районы] } )' 
    member [Measures].[Объем долга] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Бюджет субъекта ],
            (
                [Measures].[Факт],
                [Районы].[Сопоставимый].[Все районы].[Консолидированный бюджет Ярославской области].[Собственный бюджет Ярославской области],
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
				[Показатели].[СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего] 
            ) / 1000,
            (
                [Measures].[Факт],
                [Районы].[Сопоставимый].CurrentMember,
                [Показатели].[СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего] 
            ) / 1000 
        ) ' 
    member [Measures].[Выбран район] 
    as ' [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" ' 
    member [Measures].[Доходы бюджета итого] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Бюджет субъекта ],
            LookupCube 
            (
                "[ФО_МесОтч_Доходы]",
                " 
                (
                    [Measures].[Годовые назначения],
                    [КД].[Сопоставимый].[Все коды доходов].[Доходы бюджета - Всего],
                    [Районы].[Сопоставимый].[Все районы].[Консолидированный бюджет Ярославской области],
                    [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                    [Уровни бюджета].[СКИФ].[Конс.бюджет субъекта],
                    " + MemberToStr 
                    (
                        [Период].[Период].CurrentMember 
                    ) + " 
                ) " 
            ),
            IIF 
            (
                [Measures].[Выбран район],
                LookupCube 
                (
                    "[ФО_МесОтч_Доходы]",
                    " 
                    (
                        [Measures].[Годовые назначения],
                        [КД].[Сопоставимый].[Все коды доходов].[Доходы бюджета - Всего],
                        [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                        " + MemberToStr 
                        (
                            [Период].[Период].CurrentMember 
                        ) + ",
                        " + MemberToStr 
                        (
                            [Районы].[Сопоставимый].CurrentMember 
                        ) + " 
                    ) + 
                    (
                        [Measures].[Годовые назначения],
                        [КД].[Сопоставимый].[Все коды доходов].[Доходы бюджета - Всего],
                        [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                        " + MemberToStr 
                        (
                            [Период].[Период].CurrentMember 
                        ) + ",
                        " + MemberToStr 
                        (
                            [Районы].[Сопоставимый].CurrentMember 
                        ) + " 
                    ) " 
                ),
                LookupCube 
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum 
                    (
                        {
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
                        },
                        (
                            [Measures].[Годовые назначения],
                            [КД].[Сопоставимый].[Все коды доходов].[Доходы бюджета - Всего],
                            [Уровни бюджета].[СКИФ].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr 
                            (
                                [Период].[Период].CurrentMember 
                            ) + ",
                            " + MemberToStr 
                            (
                                [Районы].[Сопоставимый].CurrentMember 
                            ) + " 
                        ) 
                    ) " 
                ) 
            ) 
        ) ' 
    member [Measures].[Доходы бюджета безвозмездные поступления] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Бюджет субъекта ],
            0,
            IIF 
            (
                [Measures].[Выбран район],
                LookupCube 
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum 
                    (
                        {
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет района] 
                        },
                        (
                            [Measures].[Годовые назначения],
                            [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Иные межбюджетные трансферты].[Межбюджетные трансферты, передаваемые бюджетам на переселение граждан из закрытых административно-территориальных образований].[Межбюджетные трансферты, передаваемые бюджетам городских округов на переселение граждан из закрытых административно-территориальных образований],
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                            [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr 
                            (
                                [Период].[Период].CurrentMember 
                            ) + ",
                            " + MemberToStr 
                            (
                                [Районы].[Сопоставимый].CurrentMember 
                            ) + " 
                        ) 
                    ) " 
                ) + LookupCube 
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum 
                    (
                        {
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения] 
                        },
                        (
                            [Measures].[Годовые назначения],
                            [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                            [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr 
                            (
                                [Период].[Период].CurrentMember 
                            ) + ",
                            " + MemberToStr 
                            (
                                [Районы].[Сопоставимый].CurrentMember 
                            ) + " 
                        ) 
                    ) " 
                ),
                0 
            ) 
        ) ' 
    member [Measures].[Доходы бюджета, cубвенции бюджетам субъектов] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Бюджет субъекта ],
            LookupCube 
            (
                "[ФО_МесОтч_Доходы]",
                " 
                (
                    [Measures].[Годовые назначения],
                    [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                    [Районы].[Сопоставимый].[Все районы].[Консолидированный бюджет Ярославской области],
                    [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                    [Уровни бюджета].[СКИФ].[Бюджет субъекта],
                    " + MemberToStr 
                    (
                        [Период].[Период].CurrentMember 
                    ) + " 
                ) " 
            ),
            IIF 
            (
                [Measures].[Выбран район],
                IIF 
                (
                    [Период].[Период].CurrentMember.Properties("PKID") >= [Период].[Период].[Данные всех периодов].[2011].[Полугодие 1].[Квартал 1].[Январь].Properties("PKID"),
                    LookupCube 
                    (
                        "[ФО_МесОтч_Доходы]",
                        "Sum 
                        (
                            {
                                [Уровни бюджета].[СКИФ].[Все].[Бюджет района] 
                            },
                            (
                                [Measures].[Годовые назначения],
                                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                                [Уровни бюджета].[СКИФ].CurrentMember,
                                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                                " + MemberToStr 
                                (
                                    [Период].[Период].CurrentMember 
                                ) + ",
                                " + MemberToStr 
                                (
                                    [Районы].[Сопоставимый].CurrentMember 
                                ) + " 
                            ) 
                        ) " 
                    ),
                    LookupCube 
                    (
                        "[ФО_МесОтч_Доходы]",
                        "Sum 
                        (
                            {
                                [Уровни бюджета].[СКИФ].[Все].[Бюджет района] 
                            },
                            (
                                [Measures].[Годовые назначения],
                                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                                [Уровни бюджета].[СКИФ].CurrentMember,
                                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                                " + MemberToStr 
                                (
                                    [Период].[Период].CurrentMember 
                                ) + ",
                                " + MemberToStr 
                                (
                                    [Районы].[Сопоставимый].CurrentMember 
                                ) + " 
                            ) 
                        ) " 
                    ) + LookupCube 
                    (
                        "[ФО_МесОтч_Доходы]",
                        "Sum 
                        (
                            {
                                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения] 
                            },
                            (
                                [Measures].[Годовые назначения],
                                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                                [Уровни бюджета].[СКИФ].CurrentMember,
                                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                                " + MemberToStr 
                                (
                                    [Период].[Период].CurrentMember 
                                ) + ",
                                " + MemberToStr 
                                (
                                    [Районы].[Сопоставимый].CurrentMember 
                                ) + " 
                            ) 
                        ) " 
                    ) 
                ),
                LookupCube 
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum 
                    (
                        {
                            [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
                        },
                        (
                            [Measures].[Годовые назначения],
                            [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                            [Уровни бюджета].[СКИФ].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr 
                            (
                                [Период].[Период].CurrentMember 
                            ) + ",
                            " + MemberToStr 
                            (
                                [Районы].[Сопоставимый].CurrentMember 
                            ) + " 
                        ) 
                    ) " 
                ) 
            ) 
        ) ' 
    member [Measures].[Доходы бюджета] 
    as 'IIF 
        (
            (
                [Период].[Период].CurrentMember.Properties("PKID") >= [Период].[Период].[Данные всех периодов].[2011].[Полугодие 1].[Квартал 1].[Январь].Properties("PKID") 
            ),
            [Measures].[Доходы бюджета итого] / 1000 - [Measures].[Доходы бюджета безвозмездные поступления] / 1000 - [Measures].[Доходы бюджета, cубвенции бюджетам субъектов] / 1000,
            [Measures].[Доходы бюджета итого] / 1000 - [Measures].[Доходы бюджета, cубвенции бюджетам субъектов] / 1000 
        )' 
    member [Measures].[Уровень долговой нагрузки] 
    as 'IIF 
        (
            IsEmpty([Measures].[Доходы бюджета]) or [Measures].[Доходы бюджета] = 0,
            null,
            [Measures].[Объем долга] / [Measures].[Доходы бюджета] 
        )' 
    member [Measures].[Уровень долговой нагрузки прошлый год] 
    as ' 
        (
            [Measures].[Уровень долговой нагрузки],
            ParallelPeriod 
            (
                [Период].[Период].[Год],
                1,
                [Период].[Период].CurrentMember 
            ) 
        )' 
     member Measures.[Ранг]  
    as 'IIF  
        (
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Бюджет субъекта ]  
            ) or IsEmpty  
            (
                (
                    [Measures].[Уровень долговой нагрузки],
                    [Уровни бюджета].[СКИФ].[Все].[Все уровни],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                ) 
            ),
            null,
            Rank  
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order  
                (
                    Filter  
                    (
                        [Районы],
                        not IsEmpty  
                        (
                            (
                                [Measures].[Уровень долговой нагрузки],
                                [Уровни бюджета].[СКИФ].[Все].[Все уровни],
                                [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                            ) 
                        )  
                    ),
                    (
                        [Measures].[Уровень долговой нагрузки],
                        [Уровни бюджета].[СКИФ].[Все].[Все уровни],
                        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                    ),
                    BASC 
                ),
                (
                    [Measures].[Уровень долговой нагрузки],
                    [Уровни бюджета].[СКИФ].[Все].[Все уровни],
                   [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
                ) 
            ) 
        )/6' 
    member Measures.[Худший ранг] 
    as 'max 
        (
            [Районы],
            Measures.[Ранг] 
        )' 
    member Measures.[Темп роста] 
    as 'IIF 
        (
            IsEmpty 
            (
                [Measures].[Уровень долговой нагрузки прошлый год] 
            ) or 
            (
                [Measures].[Уровень долговой нагрузки прошлый год] 
            )= 0,
            null,
            (
                [Measures].[Уровень долговой нагрузки] 
            ) / 
            (
                [Measures].[Уровень долговой нагрузки прошлый год] 
            ) 
        )' 
    member [Measures].[Просороченная задолженность по долговым обязательствам] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Бюджет субъекта ],
            (
                [Measures].[Факт],
                [Районы].[Сопоставимый].[Все районы].[Консолидированный бюджет Ярославской области].[Собственный бюджет Ярославской области],
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                [Показатели].[СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего].[объем просроченной задолженности по долговым обязательствам субъекта Российской Федерации, составляющим внутренний долг субъекта Российской Федерации]
            ) / 1000 + 
            (
                [Measures].[Факт],
                [Районы].[Сопоставимый].[Все районы].[Консолидированный бюджет Ярославской области].[Собственный бюджет Ярославской области],
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО],
                [Показатели].[СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего].[объем просроченной задолженности по долговым обязательствам субъекта Российской Федерации, составляющим внутренний долг субъекта Российской Федерации]
            ) / 1000,
            (
                [Measures].[Факт],
                [Районы].[Сопоставимый].CurrentMember,
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО],
                [Показатели].[СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего].[объем просроченной задолженности по муниципальным долговым обязательствам]
            ) / 1000
        )' 
    member Measures.[Удельный вес просроченной задолженности по долговым обязательствам] 
    as 'IIF 
        (
            IsEmpty ( [Measures].[Объем долга] ) or ( [Measures].[Объем долга] )= 0,
            null,
            (
                [Measures].[Просороченная задолженность по долговым обязательствам] 
            ) / ( [Measures].[Объем долга] ) 
        )' 
select
    {
        [Measures].[Объем долга],
        [Measures].[Доходы бюджета],
        [Measures].[Уровень долговой нагрузки],
        [Measures].[Ранг],
        [Measures].[Темп роста],
        [Measures].[Просороченная задолженность по долговым обязательствам],
        [Measures].[Удельный вес просроченной задолженности по долговым обязательствам],
        [Measures].[Худший ранг] 
    } on columns,
    {
        {
            [Районы].[Сопоставимый].[Бюджет субъекта ] 
        } + [Районы] 
    } on rows 
from [ФО_МесОтч_СпрВнутрДолг] 
where 
    (
	      [Уровни бюджета].[СКИФ].[Все].[Все уровни],
         [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]       
    )   
    ]]>
  </query>
  
</root>