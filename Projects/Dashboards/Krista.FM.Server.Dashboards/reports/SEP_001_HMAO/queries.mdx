<?xml version="1.0" encoding="windows-1251"?>
<root>

  <query id = "Direction">
    <![CDATA[--Direction
      with

      member [Measures].[reverce]
      as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'

      member [Measures].[UniqueName]
      as '[СЭП].[Годовой сборник].currentmember.UniqueName'

      member [Measures].[Unit]
      as '[СЭП].[Годовой сборник].CurrentMember.Properties("Единица измерения")'

      member [Measures].[comparable]
      as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")'
      member [Measures].[За период_]
      as '([Measures].[За период], [Период].[Год Квартал Месяц].CurrentMember.datamember)'

  select
      {
  [UniqueName],
  [reverce],
  [Measures].[Unit],
  [Measures].[comparable]

      } on columns,
      {
      except(
      Filter(
          [СЭП].[Годовой сборник].[Уровень 1].members
          ,
  Aggregate( [Период].[Год Квартал Месяц].[Год].members,[Measures].[За период_])>0
          ),
          {[СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Население].[Численность населения по основным возрастным группам],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Труд].[Уровень экономической активности населения (по полу)],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Труд].[Состав безработных (по полу)],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Уровень жизни населения].[Структура социальных выплат],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Уровень жизни населения].[Удельный вес общего объема денежных доходов, приходящихся на соответствующую группу населения, в общем объеме денежных доходов, процентов],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Уровень жизни населения].[Структура денежных доходов населения],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Число предприятий и организаций по ОКФС],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Строительство].[Распределение строительных организаций по ОКФС],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Связь].[Наличие квартирных телефонных аппаратов сети общего пользования на 1000 человек населения (по типу местности)],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Торговля и услуги населению].[Распределение оборота розничной торговли по ОКФС],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Наука].[Внутренние затраты на научные исследования и разработки (по видам)],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Финансы].[Доходы консолидированного бюджета],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Финансы].[Расходы консолидированного бюджета],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Финансы].[Расходы на реализацию мер по социальной поддержке отдельных категорий граждан],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Финансы].[Исполнение бюджета ФСС],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Финансы].[Исполнение бюджета ТФОМС],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Инвестиции].[Структура инвестиций в основной капитал по ОКФС],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Инвестиции].[Структура инвестиций в основной капитал по видам основных фондов],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Инвестиции].[Структура инвестиций в основной капитал по источникам],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Инвестиции].[Иностранные инвестиции],
          [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Отгружено товаров собственного производства, выполнено работ и услуг собственным силами по ОКВЭД]})
      }DIMENSION PROPERTIES PARENT_UNIQUE_NAME on rows
  FROM  [СТАТ_СЭП_Годовой сборник] 
  ]]>
  </query>
  
   <query id = "Period">
  <![CDATA[  --Period
  with
    member [Measures].[UniqueName]
    as '[Период].[Год Квартал Месяц].currentmember.UniqueName'
    member [Measures].[Mounth]
    as '[Период].[Год Квартал Месяц].currentmember.Name'
    member [Measures].[Year]
    as '[Период].[Год Квартал Месяц].currentmember.Name'
          member [Measures].[За период_]
      as '([Measures].[За период], [Период].[Год Квартал Месяц].CurrentMember.datamember)'

select
    {
[UniqueName],
[Measures].[Mounth],
[Measures].[Year]

    } on columns,
    {
    --bottomcount (, 20)
    Filter(
    [Период].[Год Квартал Месяц].[Год].members
        ,
        [Measures].[За период_]>0
        )
    }DIMENSION PROPERTIES PARENT_UNIQUE_NAME on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
(
[Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ]
)
  ]]>
  </query>

  <query id = "DefaultParam">
    <![CDATA[
    --DefaultParam
 with
    member [Measures].[reverce]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[UniqueName]
    as '[СЭП].[Годовой сборник].currentmember.UniqueName'
    member [Measures].[Unit]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Единица измерения")'
    member [Measures].[comparable]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")'
    member [Measures].[За период_]
    as '([Measures].[За период], [Период].[Год Квартал Месяц].CurrentMember.datamember)'
select
    {
        <%ChosenDate%>
    } on columns,
    {
    TopCount(
        filter
        (
            [СЭП].[Годовой сборник].[Уровень 1].members,
            not IsEmpty
            (
                (
                    [Measures].[За период_],
                    <%ChosenDate%>
                )
            )
        )
        ,
        1)
    }DIMENSION PROPERTIES PARENT_UNIQUE_NAME on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
    (
        --[Территории].[СЭП].[Территория].[Центральный федеральный округ]
        --<%RegionBaseDimention%>
        [Территории__СЭП].[Территории__СЭП].[Территория].[Уральский федеральный округ]
    )
  ]]>
  </query>
  
    <query id = "Region">
    <![CDATA[
--Region
with

                member [Measures].[UniqueName]
    as '[Территории].[СЭП].CurrentMember.UniqueName'
select
    {
		[Measures].[UniqueName]
    } on columns,
    non empty
    {
    Order(
        filter
        (
            [Территории].[СЭП].[Территория].members,

            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"
            )
        ),
        [Территории].[СЭП].CurrentMember.Name, desc)
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
]]></query>

  <query id = "Grid">
    <![CDATA[
    --Grid
    with
    member [Measures].[За период_]
    as '([Measures].[За период], [Период].[Год Квартал Месяц].CurrentMember.datamember)'
    member [Measures].[value]
    as '
        (
            [Measures].[За период_],
            <%ChosenDate%>
        )'
    member [Measures].[PrevValue]
    as '(
            [Measures].[За период_],
            <%ChosenDate%>.lag(1)
        )'
    member [Measures].[reverce]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[ShortName]
    as '[Территории].[СЭП].CurrentMember.Properties("Краткое наименование")'
    member [Measures].[accessory]
    as '[Территории].[СЭП].CurrentMember.Properties("Принадлежность")'
select
    {
    [Measures].[ShortName],
    [Measures].[reverce],
    [Measures].[PrevValue],
	  [Measures].[value],
    [Measures].[accessory]
        
    } on columns,
    non empty
    {
        [Территории].[СЭП].[Территория].[Российская Федерация].datamember,
        [Территории].[СЭП].[Территория].[<%ChosenRegion%>].datamember,
        filter
        (
            [Территории].[СЭП].[Территория].members,


            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") <> ""
            )
        )
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
(
<%ChosenSEP%>
)
]]>
  </query>
</root>