<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="MFRF_0003_0001_date">
    <![CDATA[
-- MFRF_0003_0001_date
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Объем долговых обязательств]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [МФ РФ_Долговые обязательства]
]]>
  </query>

  <query id="MFRF_0003_0001_grid">
    <![CDATA[
-- MFRF_0003_0001_grid
with        
    member [Measures].[ФО]        
    as 'IIF        
        (
            [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ],
            [Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование"),
            " "       
        )'  
    member [Measures].[Объем государственного долга субъектов Российской Федерации]     
    as 'IIF     
        (
            IsEmpty     
            (
                (
                    [Measures].[Объем долговых обязательств],
                    [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]     
                )     
            ),
            IIF    
            (
                IsEmpty    
                (
                    (
                        [Measures].[Объем долговых обязательств],
                        [МФ РФ].[Долговые обязательства_Сопоставимый].[Другой долг]
                    )    
                ),
                null,
                0   
            ),
            (
                [Measures].[Объем долговых обязательств],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]   
            ) / 1000  
        )' 
    member [Measures].[Объем государственного долга субъектов Российской Федерации, прошлый год]
    as '
        (
            [Measures].[Объем государственного долга субъектов Российской Федерации],
            ParallelPeriod
            (
                [Период].[Период].[Год],
                1,
                [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
            )
        )' 
    member [МФ РФ].[Долговые обязательства_Сопоставимый].[Другой долг] 
    as ' IIF 
        (
            [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>] is [МФ РФ].[Долговые обязательства_Сопоставимый].[Гос.долг],
            [МФ РФ].[Долговые обязательства_Сопоставимый].[Муниц.долг],
            [МФ РФ].[Долговые обязательства_Сопоставимый].[Гос.долг] 
        )' 

    member Measures.[Численность постоянного населения_Prev]
    as 'IIF   
        (
            not   
            (
                [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ]   
            ),
            Sum   
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                [Measures].[Численность постоянного населения_Prev]   
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
       )'
    member Measures.[Численность постоянного населения_This]
    as 'IIF   
        (
            not   
            (
                [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ]   
            ),
            Sum   
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                [Measures].[Численность постоянного населения_This]   
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
        )'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '        
    member [Measures].[Объем государственного долга в расчете на душу населения]  
    as 'IIF  
        (
            IsEmpty 
            (
                [Measures].[Численность постоянного населения] 
            ) or [Measures].[Численность постоянного населения] = 0,
            null,
            (
                [Measures].[Объем государственного долга субъектов Российской Федерации] / [Measures].[Численность постоянного населения]
            ) 
        )'  
    member [Measures].[Темп роста]  
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Объем государственного долга субъектов Российской Федерации, прошлый год]
            ) or 
            (
                [Measures].[Объем государственного долга субъектов Российской Федерации, прошлый год]
            ) = 0,
            null,
            [Measures].[Объем государственного долга субъектов Российской Федерации] / [Measures].[Объем государственного долга субъектов Российской Федерации, прошлый год] 
        )' 
    member [Measures].[Ранг ФО %]
    as 'IIF
        (
            IsEmpty
            (
                ([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
            ) 
            or
            ( [Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
             = 0 or not([Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ]),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            ([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
                        )
                    ),
                    ([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]),
                    DESC
                ),
                -([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
            )
        )'
    member [Measures].[Худший ранг ФО %]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            ([Measures].[Ранг ФО %], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
        )'
    member [Measures].[Ранг РФ %]
    as 'IIF
        (
            IsEmpty
            (
                ([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
            ) or
            (
                [Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
            = 0 or not ([Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ]),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].[Субъект РФ].Members,
                        not IsEmpty
                        (
                           ([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
                        )
                    ),
                    ([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]),
                    BDESC
                ),
                -([Measures].[Объем государственного долга в расчете на душу населения], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
            )
        )'
    member [Measures].[Худший ранг РФ %]
    as 'max
        (
            [Территории].[Сопоставимый].[Субъект РФ].Members,
            ([Measures].[Ранг РФ %], [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>])
        )'
    member [МФ РФ].[Долговые обязательства_Сопоставимый].[Гос.долг]
    as 'Aggregate
        (
            {
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Бюджетные кредиты от других бюджетов бюджетной системы],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Государственные гарантии субъектов],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Государственные ценные бумаги субъектов],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Займы субъектов],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Иные непогашенные долговые обязательства],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Кредиты от кредитных организаций, иностранных банков и международных финансовых организаций],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Несопоставленные данные],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Объем государственного долга субъектов Российской Федерации]
            }
        )' 
    member [МФ РФ].[Долговые обязательства_Сопоставимый].[Муниц.долг]
    as 'Aggregate
        (
            {
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Объем долга муниципальных образований]
            }
        )'         
select
    {
        [Measures].[ФО],
        [Measures].[Объем государственного долга субъектов Российской Федерации],
	      [Measures].[Объем государственного долга субъектов Российской Федерации, прошлый год],
        [Measures].[Численность постоянного населения],
        [Measures].[Объем государственного долга в расчете на душу населения],
        [Measures].[Темп роста],
        [Measures].[Ранг ФО %],
        [Measures].[Ранг РФ %],
        [Measures].[Худший ранг ФО %],        
        [Measures].[Худший ранг РФ %]
    } on columns,
    {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]         
        } + Filter         
        (
            Generate         
            (
                Descendants         
                (
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%selected_fo%>,
                    [Территории].[Сопоставимый].[Федеральный округ],
                    SELF         
                ),
                {
                    [Территории].[Сопоставимый].CurrentMember         
                } +  Descendants         
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF         
                )         
            ),
            not         
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember         
            ) and not IsEmpty
            (
                [Measures].[Численность постоянного населения]
            )
        )         
    } on rows         
from [МФ РФ_Долговые обязательства]      
where    
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]
    )    
	]]>
  </query>

  <query id="MFRF_0003_0001_map">
    <![CDATA[
-- MFRF_0003_0001_map
with        
    member [Measures].[Объем государственного долга субъектов Российской Федерации]     
    as 'IIF     
        (
            IsEmpty     
            (
                (
                    [Measures].[Объем долговых обязательств],
                    [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]  
                )     
            ),
            IIF    
            (
                IsEmpty    
                (
                    (
                        [Measures].[Объем долговых обязательств],
                        [МФ РФ].[Долговые обязательства_Сопоставимый].[Другой долг]
                    )    
                ),
                null,
                0   
            ),
            (
                [Measures].[Объем долговых обязательств],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]  
            ) / 1000  
        )' 
    member [МФ РФ].[Долговые обязательства_Сопоставимый].[Другой долг] 
    as ' IIF 
        (
            [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>] is [МФ РФ].[Долговые обязательства_Сопоставимый].[Гос.долг],
            [МФ РФ].[Долговые обязательства_Сопоставимый].[Муниц.долг],
            [МФ РФ].[Долговые обязательства_Сопоставимый].[Гос.долг] 
        )' 
    member Measures.[Численность постоянного населения_Prev]
    as 'IIF   
        (
            not   
            (
                [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ]   
            ),
            Sum   
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                [Measures].[Численность постоянного населения_Prev]   
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
       )'
    member Measures.[Численность постоянного населения_This]
    as 'IIF   
        (
            not   
            (
                [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ]   
            ),
            Sum   
            (
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF   
                ),
                [Measures].[Численность постоянного населения_This]   
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
        )'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '  
    member [Measures].[Объем государственного долга в расчете на душу населения]  
    as 'IIF  
        (
            IsEmpty 
            (
                [Measures].[Численность постоянного населения] 
            ) or [Measures].[Численность постоянного населения] = 0,
            null,
            (
                [Measures].[Объем государственного долга субъектов Российской Федерации] / [Measures].[Численность постоянного населения]
            ) 
        )' 
    member [Measures].[Уровень]
    as '[Территории].[Сопоставимый].CurrentMember.Level.Name' 
    member [МФ РФ].[Долговые обязательства_Сопоставимый].[Гос.долг]
    as 'Aggregate
        (
            {
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Бюджетные кредиты от других бюджетов бюджетной системы],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Государственные гарантии субъектов],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Государственные ценные бумаги субъектов],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Займы субъектов],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Иные непогашенные долговые обязательства],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Кредиты от кредитных организаций, иностранных банков и международных финансовых организаций],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Несопоставленные данные],
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Объем государственного долга субъектов Российской Федерации]
            }
        )'  
    member [МФ РФ].[Долговые обязательства_Сопоставимый].[Муниц.долг]
    as 'Aggregate
        (
            {
                [МФ РФ].[Долговые обязательства_Сопоставимый].[Все].[Объем долга муниципальных образований]
            }
        )'        
select
    {
        [Measures].[Объем государственного долга в расчете на душу населения],
        [Measures].[Уровень]
    } on columns,
    {
        {
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]         
        } + Filter         
        (
            Generate         
            (
                Descendants         
                (
                    [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]<%selected_fo%>,
                    [Территории].[Сопоставимый].[Федеральный округ],
                    SELF         
                ),
                {
                    [Территории].[Сопоставимый].CurrentMember         
                } +  Descendants         
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF         
                )         
            ),
            not         
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember         
            )
        )         
    } on rows         
from [МФ РФ_Долговые обязательства]      
where    
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [МФ РФ].[Долговые обязательства_Сопоставимый].[<%debt_kind%>]
    )    
	]]>
  </query>

</root>

