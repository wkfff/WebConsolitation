<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="IT_0004_0001_Grid">
    <![CDATA[
-- IT_0004_0001_Grid
with member [СвязьБезопасность].[Показатели].[Выручка от реализации услуг, тыс.руб.] 
    as 'Sum 
        (
            {
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого доходов].[Реализация услуг охранной деятельности] 
                ),
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого доходов].[Реализация услуг по договорам ТСО] 
                ) 
            } 
        ) / 1000' 
    member [СвязьБезопасность].[Показатели].[Прибыль (убыток) до налогообложения, тыс.руб.] 
    as ' 
        (
            [СвязьБезопасность].[Показатели].[Все].[Прибыль (убыток) до налогообложения]  
        ) / 1000' 
    member [СвязьБезопасность].[Показатели].[Рентабельность деятельности (к затратам), %] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого расходов] ) ) or ( [СвязьБезопасность].[Показатели].[Все].[Итого расходов]
                ) = 0,
                null,
                (
                    [СвязьБезопасность].[Показатели].[Все].[Прибыль (убыток) до налогообложения]  
                )/ 
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого расходов]  
                ) 
                * 100 
            )' 
    member [СвязьБезопасность].[Показатели].[Затраты на 100 рублей выручки, руб.] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого доходов]  
                ) 
            ) or 
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов]  
            ) = 0,
            null,
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов]  
            )/ 
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов]  
            ) 
            * 100 
        )' 
    member [СвязьБезопасность].[Показатели].[Соотношение ФОТ к доходам, %] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого доходов]  
                ) 
            ) or 
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов]  
            ) = 0,
            null,
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего]  
            )/ 
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов]  
            ) 
        ) 
        * 100' 
    member [СвязьБезопасность].[Показатели].[Темп роста к прошлому году]  
    as 'IIF     
        (
            IsEmpty     
            (
                (
                    [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                    [СвязьБезопасность].[Показатели].[<%assess_type%>],
                    [Measures].[Факт] 
                )     
            ) or     
            (
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [СвязьБезопасность].[Показатели].[<%assess_type%>],
                [Measures].[Факт] 
            ) = 0 ,
            null,
            (
                [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
                [СвязьБезопасность].[Показатели].[<%assess_type%>],
                [Measures].[Факт] 
            )/     
            (
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [СвязьБезопасность].[Показатели].[<%assess_type%>],
                [Measures].[Факт] 
            )     
        )'     
    member [СвязьБезопасность].[Показатели].[1 п/г 2009 года]   
    as '     
        (
            [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
            [СвязьБезопасность].[Показатели].[<%assess_type%>],
            [Measures].[Факт]  
        )'  
    member [СвязьБезопасность].[Показатели].[План на 1 п/г 2010 года]   
    as '     
        (
            [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
            [План],
            [СвязьБезопасность].[Показатели].[<%assess_type%>] 
        )'  
    member [СвязьБезопасность].[Показатели].[1 п/г 2010 года]   
    as '     
        (
            [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
            [СвязьБезопасность].[Показатели].[<%assess_type%>],
            [Measures].[Факт] 
        )'  
    member [СвязьБезопасность].[Показатели].[% исполнения ]   
    as '     
        (
            [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
            [СвязьБезопасность].[Показатели].[<%assess_type%>],
            [Measures].[% исполнения]     
        )' 
    set [Филиалы]    
    as '    
        {
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЦФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СЗФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЮФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ПФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[УФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ДФО]    
        }'    
    member [СвязьБезопасность].[Показатели].[Ранг ]   
    as 'IIF    
        (
            IsEmpty    
            (
                [СвязьБезопасность].[Показатели].[1 п/г 2010 года]  
            ),
            null,
            Rank    
            (
                [СвязьБезопасность].[Филиалы].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Филиалы] ,
                        not IsEmpty    
                        (
                            [СвязьБезопасность].[Показатели].[1 п/г 2010 года]  
                        )    
                    ),
                    [СвязьБезопасность].[Показатели].[1 п/г 2010 года],
                    <%direct_assess%>    
                ),
                [СвязьБезопасность].[Показатели].[1 п/г 2010 года]  
            )    
        )'    
    member [СвязьБезопасность].[Показатели].[Худший ранг ]   
    as 'max    
        (
            [Филиалы] ,
            [СвязьБезопасность].[Показатели].[Ранг ]  
        )'    
    member  [СвязьБезопасность].[Показатели].[Имя] 
    as '[СвязьБезопасность].[Филиалы].CurrentMember.Properties("Наименование")' 
    member  [СвязьБезопасность].[Показатели].[Сайт] 
    as '[СвязьБезопасность].[Филиалы].CurrentMember.Properties("Ссылка")' 
select
    {
        [СвязьБезопасность].[Показатели].[Имя],
        [СвязьБезопасность].[Показатели].[1 п/г 2009 года],
        [СвязьБезопасность].[Показатели].[План на 1 п/г 2010 года],
        [СвязьБезопасность].[Показатели].[1 п/г 2010 года],
        [СвязьБезопасность].[Показатели].[Ранг ],
        [СвязьБезопасность].[Показатели].[% исполнения ],
        [СвязьБезопасность].[Показатели].[Темп роста к прошлому году],        
        [СвязьБезопасность].[Показатели].[Худший ранг ],
        [СвязьБезопасность].[Показатели].[Сайт]  
    } on columns,
    {
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЦФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СЗФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЮФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ПФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[УФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ДФО]     
    }   on rows     
from  [СВЯЗЬБЕЗОП_БюджетДоходовРасходов] 
]]>
  </query>

  <query id="IT_0002_0004_map">
    <![CDATA[
-- IT_0004_0001_Map
with
    member [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2010]
    as 'IIF
        (
            IsEmpty
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
                    [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
                    [Measures].[Факт]
                )
            ) or
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
                [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            ) = 0 or
            (
                [СвязьБезопасность].[Филиалы].CurrentMember is [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[АУП]
            ),
            null,
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего].[ФОТ административно-управленческого персонала],
                [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            )/
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
                [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            )
        )'
    member [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2009]
    as 'IIF
        (
            IsEmpty
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
                    [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                    [Measures].[Факт]
                )
            ) or
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            ) = 0 or
            (
                [СвязьБезопасность].[Филиалы].CurrentMember is [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[АУП]
            ),
            null,
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего].[ФОТ административно-управленческого персонала],
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            )/
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            )
        )'
    member [СвязьБезопасность].[Показатели].[Темп роста ФОТ АУП]
    as 'IIF
        (
            IsEmpty
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего].[ФОТ административно-управленческого персонала],
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
                )
            ) or
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего].[ФОТ административно-управленческого персонала],
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            ) = 0,
            null,
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего].[ФОТ административно-управленческого персонала],
                [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            )/
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего].[ФОТ административно-управленческого персонала],
                [Период].[Период].[Данные всех периодов].[2009].[Полугодие 1].[Квартал 2].[Июнь],
                [Measures].[Факт]
            )
        )'
    member [СвязьБезопасность].[Показатели].[ФОТ АУП]
    as '
        (
            [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего].[ФОТ административно-управленческого персонала],
            [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь]
        )'
    member [СвязьБезопасность].[Показатели].[Заработная плата –всего ]
    as '
        (
            [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
            [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь]
        )'
    member [Measures].[Затраты на 100 рублей выручки, руб.]
    as 'IIF
        (
            IsEmpty
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого доходов],
                    [Measures].[Факт]
                )
            ) or
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов],
                [Measures].[Факт]
            ) = 0,
            null,
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов],
                [Measures].[Факт]
            )/
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов],
                [Measures].[Факт]
            )
            * 100
        )'
    member [Measures].[Соотношение ФОТ к доходам, %]
    as 'IIF
        (
            IsEmpty
            (
                (
                    [СвязьБезопасность].[Показатели].[Все].[Итого доходов],
                    [Measures].[Факт]
                )
            ) or
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов],
                [Measures].[Факт]
            ) = 0,
            null,
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого расходов].[Заработная плата –всего],
                [Measures].[Факт]
            )/
            (
                [СвязьБезопасность].[Показатели].[Все].[Итого доходов],
                [Measures].[Факт]
            )
        )
        * 100'
    member [СвязьБезопасность].[Показатели].[Ранг ]
    as 'IIF
        (
            IsEmpty
            (
                [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2010]
            ),
            null,
            Rank
            (
                [СвязьБезопасность].[Филиалы].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Филиалы] ,
                        not IsEmpty
                        (
                            [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2010]
                        )
                    ),
                    [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2010],
                    BASC
                ),
                [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2010]
            )
        )'
    member [СвязьБезопасность].[Показатели].[Худший ранг ]
    as 'max
        (
            [Филиалы] ,
            [СвязьБезопасность].[Показатели].[Ранг ]
        )'
    set [Филиалы]
    as '
        {
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЦФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СЗФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЮФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ПФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[УФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СФО],
            [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ДФО]
        }'
select
    {
        [СвязьБезопасность].[Показатели].[Заработная плата –всего ],
        [СвязьБезопасность].[Показатели].[ФОТ АУП],
        [СвязьБезопасность].[Показатели].[Темп роста ФОТ АУП],
        [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2009],
        [СвязьБезопасность].[Показатели].[Доля<br/>1 п/г 2010],
        [СвязьБезопасность].[Показатели].[Ранг ],
        [СвязьБезопасность].[Показатели].[Худший ранг ]
    } on columns,
    {
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[АУП],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЦФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СЗФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ЮФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ПФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[УФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[СФО],
        [СвязьБезопасность].[Филиалы].[Все].[Консолидированный].[ДФО]
    } on rows
from  [СВЯЗЬБЕЗОП_БюджетДоходовРасходов]
]]>
  </query>
    
</root>