<?xml version="1.0" encoding="Windows-1251"?>
<root>

    <query id="Sport_0001_0002_staff_chart">
        <![CDATA[
-- Sport_0001_0002_staff_chart
with
    member [Measures].[Данные]     
    as '       
        (
            filter       
            (
                [1ФК_Строки_сопоставимые].members,
                [1ФК_Строки_сопоставимые].[Строки_сопоставимые].currentMember.properties("Код") = "<%param_row%>"       
            ).item(0),
            filter       
            (
                [1ФК_Столбцы_сопоставимые].members,
                [1ФК_Столбцы_сопоставимые].[Столбцы_сопоставимые].currentMember.properties("Код") = "<%param_column%>"       
            ).item(0),            
            [Measures].[Значение]       
        )' 
    set [Строки]
    as 'tail
        (
            filter
            (
                [Год].[Год].members,
                not isEmpty( [Measures].[Данные] )  
                AND [Год].[Год].currentMember.Name <= "<%param_year_last%>"
            ),
            3 
        ) ' 
select
    { [Measures].[Данные]  } on columns,
    { [Строки] } on rows
from [1-ФК]
where
    (
        [Территории_сопоставимый].[Территории_сопоставимый].[All].<%param_territory%>
    )
    ]]>
</query>

<!-- 
Федеральные данные
-->    
    <query id="Sport_0001_0002_population">
        <![CDATA[
-- Sport_0001_0002_population
with
    member [Measures].[Население]
    as '(
            [Measures].[Факт],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].<%param_territory%>
        )'
    member [Measures].[НаселениеФО]
    as '(
            [Measures].[Факт],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].<%param_territory%>.parent
        )'
    member [Measures].[НаселениеРФ]
    as '(
            [Measures].[Факт],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].<%param_territory%>.parent.parent
        )'
select
    { 
        [Measures].[Население],
        [Measures].[НаселениеФО],
        [Measures].[НаселениеРФ]
    } on columns 
from   [ФСГС_Численность населения]       
where 
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%param_year_last%>],
        [ФСГС__Численность населения].[ФСГС__Численность населения].[Все].[Все население],
        [Вариант__ФСГС Население].[Вариант__ФСГС Население].[Все].[Численность населения на 1 января]         
    )  
    ]]>
    </query>
    
<!-- 
данные по субъектам
-->
    <query id="Sport_0001_0002_MS_Subjects">
        <![CDATA[
-- Sport_0001_0002_MS_Subjects
with      
    member [Measures].[Данные]     
    as '       
        (
            filter       
            (
                [1ФК_Строки_сопоставимые].members,
                [1ФК_Строки_сопоставимые].[Строки_сопоставимые].currentMember.properties("Код") = "<%param_row%>"       
            ).item(0),
            filter       
            (
                [1ФК_Столбцы_сопоставимые].members,
                [1ФК_Столбцы_сопоставимые].[Столбцы_сопоставимые].currentMember.properties("Код") = "<%param_column%>"       
            ).item(0),            
            [Measures].[Значение]       
        )' 
    set [Субъекты]     
    as 'order     
        (
            filter     
            (
                descendants     
                (
                    [Территории_сопоставимый].[Территории_сопоставимый].[All].<%param_territory%>,
                    [Территории_сопоставимый].[Территории_сопоставимый].[Субъект РФ],
                    SELF      
                ),
                NOT [Территории_сопоставимый].[Территории_сопоставимый].currentmember.properties("IS_DATAMEMBER")     
            ),
            [Территории_сопоставимый].[Территории_сопоставимый].currentmember.name,
            BASC
        )' 
select
    { [Measures].[Данные]  } on columns,
    { [Субъекты] } on rows
from [1-ФК] 
where
    ( 
        [Год].[Год].[Все].[<%param_year_last%>] 
    )
    ]]>
    </query>
    
    <query id="Sport_0001_0002_FM_subjects_population">
        <![CDATA[
-- Sport_0001_0002_RF_subjects_population
with
    set [Субъекты]
    as 'order
        (
            filter
            (
                descendants
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].<%param_territory%>,
                    [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                    SELF
                ),
                NOT [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.properties("IS_DATAMEMBER")
            ),
            [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.name,
            BASC
        )'
select
    {
        [Measures].[Факт]
    } on columns,
    {
        [Субъекты]
    } on rows
from   [ФСГС_Численность населения]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%param_year_last%>],
        [ФСГС__Численность населения].[ФСГС__Численность населения].[Все].[Все население],
        [Вариант__ФСГС Население].[Вариант__ФСГС Население].[Все].[Численность населения на 1 января]
    ) 
    ]]>
    </query>
    
</root>
