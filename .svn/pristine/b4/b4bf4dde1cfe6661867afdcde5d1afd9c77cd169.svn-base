<?xml version="1.0" encoding="windows-1251"?>
<root>  
<query id="FO_0002_0005_Omsk_date">
    <![CDATA[
-- FO_0002_0005_Omsk_compare_date
with
    member [Measures].[ДанныеНа]
    as '<%period_dimension%>.CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                <%period_dimension%>.Members,
                not IsEmpty([Measures].[Факт])
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_МесОтч_Доходы]
  ]]>
  </query>

  <query id="FO_0002_0005_Omsk_compare_Grid">
    <![CDATA[
-- FO_0002_0005_Omsk_compare_Grid 
with 
--------- Полный список доходов 
    member <%incomes_kd_dimension%>.[Доходы от оказания платных услуг  ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА]'
    member <%incomes_kd_dimension%>.[Административные платежи и сборы ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ]'
    member <%incomes_kd_dimension%>.[Прочие ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ]'
    member <%incomes_kd_dimension%>.[Доходы бюджетов от возврата остатков МБТ прошлых лет ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ]'
    member <%incomes_kd_dimension%>.[Возврат остатков МБТ прошлых лет ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ]'
    member <%incomes_kd_dimension%>.[Налог на имущество физ.лиц ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц]'
    member <%incomes_kd_dimension%>.[Транспортный налог с физ.лиц ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог].[Транспортный налог с физических лиц]'

    member <%incomes_kd_dimension%>.[Транспортный налог с организаций ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог].[Транспортный налог с организаций]'

    member <%incomes_kd_dimension%>.[Платежи при пользовании недрами ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Платежи при пользовании недрами]'

    member <%incomes_kd_dimension%>.[Налоговые доходы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_social_needs_tax%>],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_10800000000000000%>] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Налог на прибыль ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]' 
    member <%incomes_kd_dimension%>.[НДФЛ ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]' 
    member <%incomes_kd_dimension%>.[Налоги на имущество ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО]' 

    member <%incomes_kd_dimension%>.[Налог на имущество организаций ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество организаций]' 
    member <%incomes_kd_dimension%>.[Транспортный налог ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог]' 
    member <%incomes_kd_dimension%>.[Земельный налог ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог]' 
    member <%incomes_kd_dimension%>.[Акцизы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Акцизы на нефтепродукты ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на бензин, производимый на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на автомобильный бензин, дизельное топливо, моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, производимые на территории Российской Федерации (в части погашения задолженности прошлых лет, образовавшейся до 1 января 2003 г],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на дизельное топливо, производимое на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, производимые на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на дизельное топливо, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на автомобильный бензин, производимый на территории Российской Федерации, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на прямогонный бензин, производимый на территории Российской Федерации, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на автомобильный бензин, ввозимый на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на дизельное топливо, ввозимое на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, ввозимые на территорию Российской Федерации] 
            } 
        )'  
    member <%incomes_kd_dimension%>.[Акцизы на алкогольную продукцию ]   
    as 'Aggregate   
        (
            {
              Filter
              (
                Descendants
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>],
                    <%incomes_kd_dimension%>.[Подстатья],
                    SELF
                ),
                not
                (
                    <%incomes_kd_dimension%>.CurrentMember is<%incomes_kd_dimension%>.CurrentMember.Parent.DataMember 
                ) and
               (
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302010010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302020010000110") or 
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302090010000110") or 
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302100010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302110010000110") or 
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302120010000110") or 
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302130010000110") or 
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302140010000110") or 
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302190010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302200010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402010010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402020010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402090010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402100010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402110010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402120010000110") or  
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402130010000110"))
              )  
            }   
        )'  
    member <%incomes_kd_dimension%>.[НДПИ ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]' 
    member <%incomes_kd_dimension%>.[Налоги на совокупный доход ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД]' 
    member <%incomes_kd_dimension%>.[УСН ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Налог, взимаемый в связи с применением упрощенной системы налогообложения]' 
    member <%incomes_kd_dimension%>.[ЕНВД ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Единый налог на вмененный доход для отдельных видов деятельности]' 
    member <%incomes_kd_dimension%>.[ЕСХН ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Единый сельскохозяйственный налог]' 
    member <%incomes_kd_dimension%>.[Гос.пошлина ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_10800000000000000%>]' 
    member <%incomes_kd_dimension%>.[Задолженность по отмененным налогам ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ]' 
    member <%incomes_kd_dimension%>.[Неналоговые доходы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ВНЕШНЕЭКОНОМИЧЕСКОЙ ДЕЯТЕЛЬНОСТИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_11700000000000000%>],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_11800000000000000%>],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_return_of_remains%>]  
            }
        )' 
    member <%incomes_kd_dimension%>.[Доходы от использования имущества ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ]' 
    member <%incomes_kd_dimension%>.[Дивиденды по акциям ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы в виде прибыли, приходящейся на доли в уставных (складочных) капиталах хозяйственных товариществ и обществ, или дивидендов по акциям, принадлежащим Российской Федерации, субъектам Российской Федерации или муниципальным образованиям]' 

        
         member <%incomes_kd_dimension%>.[Арендная плата за земли ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы, получаемые в виде арендной платы за земельные участки, государственная собственность на которые не разграничена, а также средства от продажи права на заключение договоров аренды указанных земельных участков],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы, получаемые в виде арендной платы за земли после разграничения государственной собственности на землю, а также средства от продажи права на заключение договоров аренды указанных земельных участков (за исключением земельных участков бюджетных и авто] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Доходы от сдачи в аренду имущества ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от сдачи в аренду имущества, находящегося в оперативном управлении органов государственной власти, органов местного самоуправления, государственных внебюджетных фондов и созданных ими учреждений (за исключением имущества бюджетных и автономных учре],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от использования федерального имущества, расположенного за пределами территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от использования федерального имущества, расположенного за пределами территории Российской Федерации, получаемые за рубежом]
            } 
        )'
        
    member <%incomes_kd_dimension%>.[Платежи от ГУПов и МУПов ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Платежи от государственных и муниципальных унитарных предприятий]' 
    member <%incomes_kd_dimension%>.[Платежи при пользовании природными ресурсами ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ]' 
    member <%incomes_kd_dimension%>.[Плата за негативное воздействие на окруж.среду ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Плата за негативное воздействие на окружающую среду]' 
    member <%incomes_kd_dimension%>.[Платежи за пользование лесным фондом ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Плата за использование лесов]' 
    member <%incomes_kd_dimension%>.[Доходы от оказания платных услуг ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА]' 
    member <%incomes_kd_dimension%>.[Доходы от продажи активов ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ]' 

    member <%incomes_kd_dimension%>.[Доходы от продажи активов (кроме зем.участков) ]  
    as 'Aggregate  
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи квартир],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от реализации имущества, находящегося в государственной и муниципальной собственности (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных предприятий, в том числе казенных)],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Средства от распоряжения и реализации конфискованного и иного имущества, обращенного в доход государства (в части реализации основных средств по указанному имуществу)] ,
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Средства от распоряжения и реализации конфискованного и иного имущества, обращенного в доход государства (в части реализации материальных запасов по указанному имуществу)],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи нематериальных активов],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы в виде доли прибыльной продукции государства при выполнении соглашений о разделе продукции]  
            }  
        )'  
    member <%incomes_kd_dimension%>.[Доходы от продажи зем. участков ]  
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи земельных участков, находящихся в государственной и муниципальной собственности (за исключением земельных участков бюджетных и автономных учреждений)]' 
    member <%incomes_kd_dimension%>.[Доходы от приносящей доход деятельности ] 
    as '<%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]' 
    
    member <%incomes_kd_dimension%>.[Штрафы ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА]' 
    member <%incomes_kd_dimension%>.[Налоговые и неналоговые доходы ] 
    as '<%incomes_kd_dimension%>.[Налоговые доходы ] + <%incomes_kd_dimension%>.[Неналоговые доходы ]' 
    member <%incomes_kd_dimension%>.[Безвозмездные поступления ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ]' 
    
    member <%incomes_kd_dimension%>.[Доходы бюджета - Итого ] 
    as '<%incomes_total%>'
    
    member <%incomes_kd_dimension%>.[Невыясненные поступления ] 
    as '<%incomes_kd_dimension%>.[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Невыясненные поступления]'

    member <%incomes_kd_dimension%>.[Прочие неналоговые доходы ] 
    as '<%incomes_kd_dimension%>.[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ].[Прочие неналоговые доходы]'

----------------------------

    member Measures.[isMRGO] 
    as 'not( 
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта] or
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>] or
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты] or
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Муниципальные районы, всего] or
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Северная зона ] or
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Северная лесостепная зона ] or
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Южная лесостепная зона ] or
               [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Степная зона ]
           )'    
    member Measures.[isMR]
    as ' Measures.[isMRGO] and not ([Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО") '
    
    member Measures.[isNonRanking] 
    as ' [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта] or
    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Бюджет субъекта] or
    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты] or
    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Муниципальные районы, всего] or
    [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"'

    member Measures.[isClimaticZone] 
    as ' [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Северная зона ] or  [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Северная лесостепная зона ] or  [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Южная лесостепная зона ] or  [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Степная зона ] '  
    
    member Measures.[Численность постоянного населения]
    as '0'      
         
    member Measures.[Среднедушевые доходы] 
    as ' Measures.[Факт] ' 
    member Measures.[Ранг среднедуш МО]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Среднедушевые доходы]    
            ) or not (Measures.[isMRGO]),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Города и районы],
                        not IsEmpty    
                        (
                            Measures.[Среднедушевые доходы]    
                        )    
                    ),
                    Measures.[Среднедушевые доходы],
                    BDESC    
                ),
                Measures.[Среднедушевые доходы]    
            )    
        )'    
    member Measures.[Худший ранг среднедуш МО]    
    as 'IIF   
        (
            IsEmpty   
            (
                 Measures.[Ранг среднедуш МО]
            ) or not (Measures.[isMRGO]),
            null,
            max  
            (
                [Города и районы],
                Measures.[Ранг среднедуш МО]    
            )  
        )'   

    member Measures.[Доля в КБ] 
    as 'IIF 
         (  
            IsEmpty
            (
             (
                Measures.[Факт],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                <%regions_consolidate_level%>
             )
            ) or
            (
                Measures.[Факт],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                <%regions_consolidate_level%>
            ) = 0, 
            null,
            100 *
            (
                Measures.[Факт],
                [Районы].[Сопоставимый].CurrentMember 
            )/ 
            (
                Measures.[Факт],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                <%regions_consolidate_level%>
            )
         ) '         
    set [Города]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            )
        )'
    set [Районы]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"
            )
        )'
    set [Города и районы]
    as '[Районы] + [Города]'        
    member [Районы].[Сопоставимый].[Консолидированный бюджет субъекта]
    as '<%regions_consolidate_level%>'         
    member [Районы].[Сопоставимый].[<%own_subject_budget_name%>]
    as '<%regions_consolidate_level%>'  
    member [Районы].[Сопоставимый].[Местные бюджеты] 
    as '<%regions_consolidate_level%>'  
    member [Районы].[Сопоставимый].[Муниципальные районы, всего]    
    as 'Aggregate({[Районы]})'      
    member [ТипДокумента].[СКИФ].[Тип документа] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is <%regions_consolidate_level%> or 
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>] or 
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты] or
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Муниципальные районы, всего], 
            <%consolidate_document_skif_type%>,
            <%region_document_skif_type%>
        ) '  
    member [Уровни бюджета].[СКИФ].[Уровень бюджета ] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            IIF 
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                IIF 
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО],
                    IIF
                    (
                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Муниципальные районы, всего],
                        [Уровни бюджета].[СКИФ].[Бюджет гор.округа, мун.района и поселения],
                        <%region_budget_skif_level%>
                    )
                ) 
            ) 
        ) ' 
    member [Уровни бюджета].[СКИФ].[Бюджет гор.округа, мун.района и поселения] 
    as 'Aggregate
        (
          {
            [Уровни бюджета].[СКИФ].[Бюджет поселения],
            [Уровни бюджета].[СКИФ].[Бюджет гор.округа],
            [Уровни бюджета].[СКИФ].[Бюджет района]
          }
        )'  
        
   member Measures.[Ранг по исполнению МР]
    as 'IIF 
        (
            not (Measures.[isClimaticZone]) and
            (
             IsEmpty 
             (
                 [Measures].[% выполнения годовых назначений] 
             ) or Measures.[isNonRanking]
            ),
            null,
            IIF 
            (
                Measures.[isClimaticZone],
                Rank 
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    Order 
                    (
                        [Климатические зоны без районов],
                        [Measures].[Факт] ,
                        BDESC 
                    ),
                    [Measures].[Факт] 
                ),
            IIF 
            (
                "<%region_set%>" = "Климатические зоны",
                IIF 
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
                    Rank 
                    (
                        [Районы].[Сопоставимый].CurrentMember,
                        Order 
                        (
                            Filter 
                            (
                                [Субъекты северной зоны],
                                not IsEmpty 
                                (
                                    [Measures].[Факт] 
                                ) 
                            ),
                            [Measures].[Факт] ,
                            BDESC 
                        ),
                        [Measures].[Факт] 
                    ),
                    IIF 
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                        Rank 
                        (
                            [Районы].[Сопоставимый].CurrentMember,
                            Order 
                            (
                                Filter 
                                (
                                    [Субъекты северной лесостепной зоны],
                                    not IsEmpty 
                                    (
                                        [Measures].[Факт] 
                                    ) 
                                ),
                                [Measures].[Факт] ,
                                BDESC 
                            ),
                            [Measures].[Факт] 
                        ),
                        IIF 
                        (
                            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                            Rank 
                            (
                                [Районы].[Сопоставимый].CurrentMember,
                                Order 
                                (
                                    Filter 
                                    (
                                        [Субъекты южной лесостепной зоны],
                                        not IsEmpty 
                                        (
                                           [Measures].[Факт] 
                                        ) 
                                    ),
                                    [Measures].[Факт] ,
                                    BDESC 
                                ),
                                [Measures].[Факт] 
                            ),
                            IIF 
                            (
                                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                                Rank 
                                (
                                    [Районы].[Сопоставимый].CurrentMember,
                                    Order 
                                    (
                                        Filter 
                                        (
                                            [Субъекты степной зоны],
                                            not IsEmpty 
                                            (
                                               [Measures].[Факт] 
                                            ) 
                                        ),
                                        [Measures].[Факт] ,
                                        BDESC 
                                    ),
                                    [Measures].[Факт] 
                                ),
                                null 
                            ) 
                        ) 
                    ) 
                ),
                Rank 
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    Order 
                    (
                        [Районы],
                        [Measures].[Факт] ,
                        BDESC 
                    ),
                    [Measures].[Факт] 
                ) 
             ) 
            )
        )'
    member Measures.[Худший ранг по исполнению МР]
    as 'IIF   
        (
            IsEmpty  ( Measures.[Ранг процент МР] ) or not (Measures.[isMRGO]),
            null,
            IIF   
            (
                "<%region_set%>" = "Климатические зоны",
                IIF   
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
                    max   
                    (
                        [Субъекты северной зоны],
                        Measures.[Ранг по исполнению МР]
                    ),
                    IIF   
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                        max   
                        (
                            [Субъекты северной лесостепной зоны],
                            Measures.[Ранг по исполнению МР]
                        ),
                        IIF   
                        (
                            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                            max   
                            (
                                [Субъекты южной лесостепной зоны],
                                Measures.[Ранг по исполнению МР]
                            ),
                            IIF   
                            (
                                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                                max   
                                (
                                    [Субъекты степной зоны],
                                    Measures.[Ранг по исполнению МР]
                                ),
                                null   
                            )   
                        )   
                    )   
                ),
                max  
                (
                    [Районы],
                    Measures.[Ранг по исполнению МР]
                )  
            )   
        )'

    member Measures.[Ранг среднедуш МР]
    as 'IIF
        (
            not (Measures.[isClimaticZone]) and
            (
                 IsEmpty
                 (
                     Measures.[Среднедушевые доходы]
                 ) or Measures.[isNonRanking]
            ),
            null,
            IIF
            (
                Measures.[isClimaticZone],
                Rank
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    Order
                    (
                        [Климатические зоны без районов],
                        Measures.[Среднедушевые доходы],
                        BDESC
                    ),
                    Measures.[Среднедушевые доходы]
                ),
                IIF
                (
                "<%region_set%>" = "Климатические зоны",
                IIF
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
                    Rank
                    (
                        [Районы].[Сопоставимый].CurrentMember,
                        Order
                        (
                            Filter
                            (
                                [Субъекты северной зоны],
                                not IsEmpty
                                (
                                    Measures.[Среднедушевые доходы]
                                )
                            ),
                            Measures.[Среднедушевые доходы],
                            BDESC
                        ),
                        Measures.[Среднедушевые доходы]
                    ),
                    IIF
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                        Rank
                        (
                            [Районы].[Сопоставимый].CurrentMember,
                            Order
                            (
                                Filter
                                (
                                    [Субъекты северной лесостепной зоны],
                                    not IsEmpty
                                    (
                                        Measures.[Среднедушевые доходы]
                                    )
                                ),
                                Measures.[Среднедушевые доходы],
                                BDESC
                            ),
                            Measures.[Среднедушевые доходы]
                        ),
                        IIF
                        (
                            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                            Rank
                            (
                                [Районы].[Сопоставимый].CurrentMember,
                                Order
                                (
                                    Filter
                                    (
                                        [Субъекты южной лесостепной зоны],
                                        not IsEmpty
                                        (
                                           Measures.[Среднедушевые доходы]
                                        )
                                    ),
                                    Measures.[Среднедушевые доходы],
                                    BDESC
                                ),
                                Measures.[Среднедушевые доходы]
                            ),
                            IIF
                            (
                                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                                Rank
                                (
                                    [Районы].[Сопоставимый].CurrentMember,
                                    Order
                                    (
                                        Filter
                                        (
                                            [Субъекты степной зоны],
                                            not IsEmpty
                                            (
                                               Measures.[Среднедушевые доходы]
                                            )
                                        ),
                                        Measures.[Среднедушевые доходы],
                                        BDESC
                                    ),
                                    Measures.[Среднедушевые доходы]
                                ),
                                null
                            )
                        )
                    )
                ),
                Rank
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    Order
                    (
                        [Районы],
                        Measures.[Среднедушевые доходы],
                        BDESC
                    ),
                    Measures.[Среднедушевые доходы]
                )
              )
            )
        )'
    member Measures.[Худший ранг среднедуш МР]
    as 'IIF
        (
            IsEmpty  ( Measures.[Ранг среднедуш МР] ) or not (Measures.[isMRGO]),
            null,
            IIF
            (
                "<%region_set%>" = "Климатические зоны",
                IIF
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
                    max
                    (
                        [Субъекты северной зоны],
                        Measures.[Ранг среднедуш МР]
                    ),
                    IIF
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                        max
                        (
                            [Субъекты северной лесостепной зоны],
                           Measures.[Ранг среднедуш МР]
                        ),
                        IIF
                        (
                            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                            max
                            (
                                [Субъекты южной лесостепной зоны],
                                Measures.[Ранг среднедуш МР]
                            ),
                            IIF
                            (
                                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                                max
                                (
                                    [Субъекты степной зоны],
                                    Measures.[Ранг среднедуш МР]
                                ),
                                null
                            )
                        )
                    )
                ),
                max
                (
                    [Районы],
                    Measures.[Ранг среднедуш МР]
                )
            )
        )'
     
    member Measures.[Доля в МР]
    as 'IIF
        (
            not Measures.[isMR] or
            IsEmpty
            (
              Sum
              (
                  [Районы],
                  Measures.[Факт]
              )
            ) or
            Sum
            (
                [Районы],
                Measures.[Факт]
            ) = 0,
            null,
            100 *
            (
                Measures.[Факт],
                [Районы].[Сопоставимый].CurrentMember
            )/ Sum
            (
                [Районы],
                Measures.[Факт]
            )
        )'  

    set [Климатические зоны без районов]
    as '
        
        {
            [Районы].[Сопоставимый].[Северная зона ]
        } +
        {
            [Районы].[Сопоставимый].[Северная лесостепная зона ]
        } +
        {
            [Районы].[Сопоставимый].[Южная лесостепная зона ]
        } +
        {
            [Районы].[Сопоставимый].[Степная зона ]
        }  '

    member Measures.[Ранг процент МР]    
    as 'IIF 
        (
            not (Measures.[isClimaticZone]) and
            (
                 IsEmpty 
                 (
                     [Measures].[% выполнения годовых назначений] 
                 ) or Measures.[isNonRanking]
            ),
            null,
            IIF 
            (
                Measures.[isClimaticZone],
                Rank 
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    Order 
                    (
                        [Климатические зоны без районов],
                        [Measures].[% выполнения годовых назначений],
                        BDESC 
                    ),
                    [Measures].[% выполнения годовых назначений] 
                ),
                IIF
                (
                "<%region_set%>" = "Климатические зоны",
                IIF 
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
                    Rank 
                    (
                        [Районы].[Сопоставимый].CurrentMember,
                        Order 
                        (
                            Filter 
                            (
                                [Субъекты северной зоны],
                                not IsEmpty 
                                (
                                    [Measures].[% выполнения годовых назначений]
                                ) 
                            ),
                            [Measures].[% выполнения годовых назначений],
                            BDESC 
                        ),
                        [Measures].[% выполнения годовых назначений]
                    ),
                    IIF 
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                        Rank 
                        (
                            [Районы].[Сопоставимый].CurrentMember,
                            Order 
                            (
                                Filter 
                                (
                                    [Субъекты северной лесостепной зоны],
                                    not IsEmpty 
                                    (
                                        [Measures].[% выполнения годовых назначений]
                                    ) 
                                ),
                                [Measures].[% выполнения годовых назначений],
                                BDESC 
                            ),
                            [Measures].[% выполнения годовых назначений]
                        ),
                        IIF 
                        (
                            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                            Rank 
                            (
                                [Районы].[Сопоставимый].CurrentMember,
                                Order 
                                (
                                    Filter 
                                    (
                                        [Субъекты южной лесостепной зоны],
                                        not IsEmpty 
                                        (
                                           [Measures].[% выполнения годовых назначений]
                                        ) 
                                    ),
                                    [Measures].[% выполнения годовых назначений],
                                    BDESC 
                                ),
                                [Measures].[% выполнения годовых назначений]
                            ),
                            IIF 
                            (
                                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                                Rank 
                                (
                                    [Районы].[Сопоставимый].CurrentMember,
                                    Order 
                                    (
                                        Filter 
                                        (
                                            [Субъекты степной зоны],
                                            not IsEmpty 
                                            (
                                               [Measures].[% выполнения годовых назначений]
                                            ) 
                                        ),
                                        [Measures].[% выполнения годовых назначений],
                                        BDESC 
                                    ),
                                    [Measures].[% выполнения годовых назначений]
                                ),
                                null 
                            ) 
                        ) 
                    ) 
                ),
                Rank 
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    Order 
                    (
                        [Районы],
                        [Measures].[% выполнения годовых назначений],
                        BDESC 
                    ),
                    [Measures].[% выполнения годовых назначений] 
                ) 
              )
            )
        ) '    
    member Measures.[Худший ранг процент МР]    
    as 'IIF   
        (
            IsEmpty  ( Measures.[Ранг процент МР] ) or not (Measures.[isMRGO]),
            null,
            IIF   
            (
                "<%region_set%>" = "Климатические зоны",
                IIF   
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
                    max   
                    (
                        [Субъекты северной зоны],
                         Measures.[Ранг процент МР]    
                    ),
                    IIF   
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                        max   
                        (
                            [Субъекты северной лесостепной зоны],
                             Measures.[Ранг процент МР]    
                        ),
                        IIF   
                        (
                            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                            max   
                            (
                                [Субъекты южной лесостепной зоны],
                                 Measures.[Ранг процент МР]    
                            ),
                            IIF   
                            (
                                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                                max   
                                (
                                    [Субъекты степной зоны],
                                     Measures.[Ранг процент МР]    
                                ),
                                null   
                            )   
                        )   
                    )   
                ),
                max  
                (
                    [Районы],
                     Measures.[Ранг процент МР]    
                )  
            )   
        )
        '          
    set [Субъекты северной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF        
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона"        
            )        
        )'        
    set [Субъекты северной лесостепной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF        
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона"        
            )        
        )'        
    set [Субъекты южной лесостепной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF        
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона"        
            )        
        )'        
    set [Субъекты степной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF        
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона"        
            )        
        )'         
    member [Районы].[Сопоставимый].[Северная зона ]        
    as 'Aggregate ( { [Субъекты северной зоны] } )'      
    member [Районы].[Сопоставимый].[Северная лесостепная зона ]        
    as 'Aggregate       
        (
            {
                [Субъекты северной лесостепной зоны]       
            }       
        )'        
    member [Районы].[Сопоставимый].[Южная лесостепная зона ]        
    as 'Aggregate       
        (
            {
                [Субъекты южной лесостепной зоны]       
            }       
        )'        
    member [Районы].[Сопоставимый].[Степная зона ]        
    as 'Aggregate ( { [Субъекты степной зоны] } )'       
    set [Климатические зоны]        
    as '{
            [Районы].[Сопоставимый].[Муниципальные районы, всего]   
        } +      
        {
            [Районы].[Сопоставимый].[Северная зона ]       
        } + [Субъекты северной зоны] +    
        {
            [Районы].[Сопоставимый].[Северная лесостепная зона ]      
        } + [Субъекты северной лесостепной зоны] +    
        {
            [Районы].[Сопоставимый].[Южная лесостепная зона ]      
        } + [Субъекты южной лесостепной зоны] +    
        {
            [Районы].[Сопоставимый].[Степная зона ]      
        } + [Субъекты степной зоны] '     
    set [Список МО]        
    as '[Города] + { [Районы].[Сопоставимый].[Муниципальные районы, всего] } + [Районы]'  
        
    member Measures.[% исполнения ПКЗ]       
    as 'IIF       
        (
            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
            100*
            (
                [Районы].[Сопоставимый].[Северная зона ],
                Measures.[% выполнения годовых назначений]   
            ),
            IIF       
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                100*
                (
                    [Районы].[Сопоставимый].[Северная лесостепная зона ],
                    Measures.[% выполнения годовых назначений]   
                ),
                IIF       
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                    100*
                    (
                        [Районы].[Сопоставимый].[Южная лесостепная зона ],
                        Measures.[% выполнения годовых назначений]  
                    ),
                    IIF       
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                        100*
                        (
                            [Районы].[Сопоставимый].[Степная зона ],
                            Measures.[% выполнения годовых назначений] 
                        ),
                        null
                    )      
                )     
            )    
        )'
    member Measures.[ПКЗ]
    as '[Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона")'     
    member Measures.[Список субъектов ПКЗ]       
    as 'IIF       
        (
            [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона",
            Generate
            (
                [Субъекты северной зоны],
                [Районы].[Сопоставимый].CurrentMember.Name,
                "br"
            ),
            IIF       
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона",
                Generate
                (
                    [Субъекты северной лесостепной зоны],
                    [Районы].[Сопоставимый].CurrentMember.Name,
                    "br"
                ),
                IIF       
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона",
                    Generate
                    (
                        [Субъекты южной лесостепной зоны],
                        [Районы].[Сопоставимый].CurrentMember.Name,
                        "br"
                    ),
                    IIF       
                    (
                        [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона",
                        Generate
                        (
                            [Субъекты степной зоны],
                            [Районы].[Сопоставимый].CurrentMember.Name,
                            "br"
                        ),
                        " "
                    )      
                )     
            )    
        )' 
     member Measures.[Код территории]        
     as '[Районы].[Сопоставимый].CurrentMember.Properties("Код объекта карты")'
select
    {
       Measures.[Годовые назначения],
       Measures.[Факт],
       Measures.[% выполнения годовых назначений],
       Measures.[Ранг процент МР],
       Measures.[Худший ранг процент МР],
       Measures.[Ранг по исполнению МР],
       Measures.[Худший ранг по исполнению МР],    
       Measures.[Численность постоянного населения],
       Measures.[Среднедушевые доходы],
       Measures.[Ранг среднедуш МР],
       Measures.[Худший ранг среднедуш МР],
       Measures.[Доля в МР],
       Measures.[Доля в КБ],
       Measures.[% исполнения ПКЗ],
       Measures.[ПКЗ],
       Measures.[Список субъектов ПКЗ],
       Measures.[Код территории]
    } on columns,
    Non Empty
    {
        {
            [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Районы].[Сопоставимый].[<%own_subject_budget_name%>],
            [Районы].[Сопоставимый].[Местные бюджеты] 
        } + [<%region_set%>]   
    } on rows 
from [ФО_МесОтч_Доходы] 
where 
    (
        <%period_dimension%>.[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [ТипДокумента].[СКИФ].[Тип документа],
        [Уровни бюджета].[СКИФ].[Уровень бюджета ],
        [КД].[Сопоставимый].[<%kd_group_name%>]
    ) 
  ]]>
</query>

  <query id="FO_0002_0005_omsk_compare_population">
    <![CDATA[
-- FO_0002_0005_omsk_compare_population 
with
    member Measures.[isMRGO]
    as 'not( [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта] or
         [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>] or
         [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты]) '

    member Measures.[Численность постоянного населения по МО]    
    as 'IIF    
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Муниципальные районы, всего],
            Sum    
            (
                [Районы],
                Measures.[Численность постоянного населения по МО]    
            ),
            IIF   
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Северная зона ],
                Sum    
                (
                    [Субъекты северной зоны],
                    Measures.[Численность постоянного населения по МО]    
                ),
                IIF   
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Северная лесостепная зона ],
                    Sum   
                    (
                        [Субъекты северной лесостепной зоны],
                        Measures.[Численность постоянного населения по МО]   
                    ),
                    IIF  
                    (
                        [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Южная лесостепная зона ],
                        Sum  
                        (
                            [Субъекты южной лесостепной зоны],
                            Measures.[Численность постоянного населения по МО]  
                        ),
                        IIF 
                        (
                            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Степная зона ],
                            Sum 
                            (
                                [Субъекты степной зоны],
                                Measures.[Численность постоянного населения по МО] 
                            ),
                            IIF    
                            (
                                not(Measures.[isMRGO]),
                                Sum    
                                (
                                    [Города и районы],
                                    Measures.[Численность постоянного населения по МО]    
                                ),
                                [Measures].[Факт]
                            )   
                        ) 
                    ) 
                )  
            )   
        )'    
        
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            not IsEmpty
            (
                (
                    Measures.[Численность постоянного населения по МО],
                    [Период].[Период].CurrentMember
                )
            ),
            (
                Measures.[Численность постоянного населения по МО],
                [Период].[Период].CurrentMember
            ),
            (
                Tail
                (
                    Filter
                    (
                        {
                            [Период].[Период].[Данные всех периодов].[2000] : [Период].[Период].CurrentMember.PrevMember
                        },
                        not IsEmpty
                        (
                            Measures.[Численность постоянного населения по МО]
                        )
                    )
                ).Item(0),
                Measures.[Численность постоянного населения по МО]
            )
        )'
        
    set [Города]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы].[Омская область],
                [Районы].[Сопоставимый].[Уровень 03],
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            )
        )'
    set [Районы]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы].[Омская область],
                [Районы].[Сопоставимый].[Уровень 03],
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"
            )
        )'
    set [Города и районы]
    as '[Города] + [Районы]'

    member [Районы].[Сопоставимый].[Муниципальные районы, всего]    
    as 'Aggregate({[Районы]})'   
    
    member [Районы].[Сопоставимый].[Городские округа]    
    as 'Aggregate({[Города]})' 

    member [Районы].[Сопоставимый].[Консолидированный бюджет субъекта]
    as '[Районы].[Сопоставимый].[Все районы].[Омская область]'
    member [Районы].[Сопоставимый].[<%own_subject_budget_name%>]
    as '[Районы].[Сопоставимый].[Все районы].[Омская область]'
    member [Районы].[Сопоставимый].[Местные бюджеты]
    as '[Районы].[Сопоставимый].[Все районы].[Омская область]'
    
    set [Субъекты северной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы].[Омская область],
                [Районы].[Сопоставимый].[Уровень 03],
                SELF 
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная зона"        
            )        
        )'        
    set [Субъекты северной лесостепной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы].[Омская область],
                [Районы].[Сопоставимый].[Уровень 03],
                SELF
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Северная лесостепная зона"        
            )        
        )'        
    set [Субъекты южной лесостепной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы].[Омская область],
                [Районы].[Сопоставимый].[Уровень 03],
                SELF   
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Южная лесостепная зона"        
            )        
        )'        
    set [Субъекты степной зоны]        
    as 'Filter        
        (
            Descendants        
            (
                [Районы].[Сопоставимый].[Все районы].[Омская область],
                [Районы].[Сопоставимый].[Уровень 03],
                SELF  
            ),
            not        
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember        
            ) and        
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Климатическая зона") = "Степная зона"        
            )        
        )'         
    member [Районы].[Сопоставимый].[Северная зона ]        
    as 'Aggregate ( { [Субъекты северной зоны] } )'      
    member [Районы].[Сопоставимый].[Северная лесостепная зона ]        
    as 'Aggregate       
        (
            {
                [Субъекты северной лесостепной зоны]       
            }       
        )'        
    member [Районы].[Сопоставимый].[Южная лесостепная зона ]        
    as 'Aggregate       
        (
            {
                [Субъекты южной лесостепной зоны]       
            }       
        )'        
    member [Районы].[Сопоставимый].[Степная зона ]        
    as 'Aggregate ( { [Субъекты степной зоны] } )'       
    set [Климатические зоны]        
    as '{
            [Районы].[Сопоставимый].[Муниципальные районы, всего]   
        } +      
        {
            [Районы].[Сопоставимый].[Северная зона ]       
        } + [Субъекты северной зоны] +    
        {
            [Районы].[Сопоставимый].[Северная лесостепная зона ]      
        } + [Субъекты северной лесостепной зоны] +    
        {
            [Районы].[Сопоставимый].[Южная лесостепная зона ]      
        } + [Субъекты южной лесостепной зоны] +    
        {
            [Районы].[Сопоставимый].[Степная зона ]      
        } + [Субъекты степной зоны] '         
select
    {
        Measures.[Численность постоянного населения]
    } on columns,
    {
        {
            [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Районы].[Сопоставимый].[<%own_subject_budget_name%>],
            [Районы].[Сопоставимый].[Местные бюджеты],
            [Районы].[Сопоставимый].[Городские округа],
            [Районы].[Сопоставимый].[Муниципальные районы, всего],
            [Районы].[Сопоставимый].[Северная зона ],
            [Районы].[Сопоставимый].[Южная лесостепная зона ],
            [Районы].[Сопоставимый].[Северная лесостепная зона ],
            [Районы].[Сопоставимый].[Степная зона ]
        } + [Города и районы]
    } on rows
from [ФСГС_Численность населения]
where
    (
        [ФСГС].[Численность населения].[Все].[Все население],
        [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
        [Период].[Период].[Данные всех периодов].[<%period_year%>]
    )
  ]]>
  </query>
  
</root>