<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="STAT_0023_0002_grid">
    <![CDATA[
-- STAT_0023_0002_grid
with      
    set [Показатели]      
    as '     
        {
            [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Среднемесячная численность работников],
            [Организации__Показатели работы].[Организации__Показатели работы].[Численность работников, находящихся в простое, длительных отпусках без сохранения, содержания, занятых неполный рабочий день],
            [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Численность работников, планируемых к высвобождению],
            [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Фонд оплаты труда],
            [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Задолженность по выплате заработной платы],
            [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Объем среднемесячных оборотов предприятия],
            [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Меры (объем) государственной поддержки, реализуемые на региональном уровне в отношении предприятия]     
        }'    
    member [Организации__Показатели работы].[Организации__Показатели работы].[Численность работников, находящихся в простое, длительных отпусках без сохранения, содержания, занятых неполный рабочий день]    
    as 'Aggregate    
        (
            {
                [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Численность работников, находящихся в простое],
                [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Численность работников, находящихся в длительных отпусках без сохранения содержания],
                [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Численность работников, занятых неполный рабочий день]    
            }    
        )'    
    member [Организации__Показатели работы].[Организации__Показатели работы].[Аггрегированные показатели]    
    as 'Aggregate({[Показатели]})'     
    set [Организации]      
    as 'Filter      
        (
            [Организации__Реестр организаций].[Организации__Реестр организаций].[Все организации].Children,
            [Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Properties("Тип организации") = "Предприятия регионального значения"      
        )'          
    member [Measures].[Значение текущий период]    
    as 'IIF   
        (
            [Организации__Показатели работы].[Организации__Показатели работы].CurrentMember is [Организации__Показатели работы].[Организации__Показатели работы].[Тип строки],
            "0",
            IIF
            (
               [Организации__Показатели работы].[Организации__Показатели работы].CurrentMember is [Организации__Показатели работы].[Организации__Показатели работы].[Наименование],
               [Measures].[Значение],
               (
                   [Measures].[Значение],
                   <%curr_period%>  
               )  
            )    
        )'   
    member [Measures].[Значение прошлый период]    
    as '      
        (
            [Measures].[Значение],
            <%prev_period%>  
        )'       
    member [Measures].[Прирост ]      
    as 'IIF 
        (
            [Организации__Показатели работы].[Организации__Показатели работы].CurrentMember is [Организации__Показатели работы].[Организации__Показатели работы].[Тип строки],
            "1",
            IIF
            (
               [Организации__Показатели работы].[Организации__Показатели работы].CurrentMember is [Организации__Показатели работы].[Организации__Показатели работы].[Наименование],
               [Measures].[Значение],
               IIF  
               (
                   IsEmpty      
                   (
                       [Measures].[Значение прошлый период]    
                   ) or
                    IsEmpty      
                   (
                       [Measures].[Значение текущий период]
                   ),
                   null,
                   [Measures].[Значение текущий период] - [Measures].[Значение прошлый период]    
               ) 
            )   
        )   '  
    member [Measures].[Темп прироста ]      
    as 'IIF 
        (
            [Организации__Показатели работы].[Организации__Показатели работы].CurrentMember is [Организации__Показатели работы].[Организации__Показатели работы].[Тип строки],
            "2",
            IIF
            (
               [Организации__Показатели работы].[Организации__Показатели работы].CurrentMember is [Организации__Показатели работы].[Организации__Показатели работы].[Наименование],
               [Measures].[Значение],
               IIF 
               (
                   IsEmpty      
                   (
                       [Measures].[Значение прошлый период]    
                   ) or      
                   (
                       [Measures].[Значение прошлый период]    
                   ) = 0 or
                   IsEmpty      
                   (
                       [Measures].[Значение текущий период]    
                   ),
                   null,
                   [Measures].[Значение текущий период] / [Measures].[Значение прошлый период] - 1    
               )
            )   
        )   ' 
    member [Measures].[Расчетные показатели]      
    as '      
        (
            [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Показатель]      
        ) or      
        (
            [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Тип строки]      
        ) or      
        (
            [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Единица измерения]      
        ) or      
        (
            [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].[Показатель с единицой измерения]      
        )'         
    member [Организации__Показатели работы].[Организации__Показатели работы].[Тип строки]    
    as 'IIF    
        (
            [Measures].CurrentMember is [Measures].[Значение текущий период],
            "0",
            IIF    
            (
                [Measures].CurrentMember is [Measures].[Прирост ],
                "1",
                "2"    
            )    
        )'   
    member [Организации__Показатели работы].[Организации__Показатели работы].[Наименование]    
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Name'  

select
    {
        {
            [Организации__Показатели работы].[Организации__Показатели работы].[Наименование]   
        } +
        [Показатели] +    
        {
            [Организации__Показатели работы].[Организации__Показатели работы].[Тип строки]   
        }    
    } on columns,
    Filter      
    (
        [Организации],
        not      
        (
            IsEmpty      
            (
                (
                    [Measures].[Значение текущий период],
                    [Организации__Показатели работы].[Организации__Показатели работы].[Аггрегированные показатели]    
                )      
            )      
        )      
    )      
    *      
    {
        [Measures].[Значение текущий период] ,
        [Measures].[Прирост ],
        [Measures].[Темп прироста ]      
    } on rows      
From [ОРГАНИЗАЦИИ_Характеристика деятельности]      
where      
    (
        <%selected_mo%>
    )          
  ]]>
  </query>

  <query id="STAT_0023_0002_moDigest">
    <![CDATA[
-- STAT_0023_0002_moDigest
with  
    set [МО] 
    as 'Filter  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].Children,
            not 
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember
            ) and not IsEmpty([Measures].[Значение])
        )'  
    member [Measures].[Имя]  
    as ' [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name '
    member [Measures].[Уникальное имя]  
    as ' [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.UniqueName '
    member [Measures].[Уровень]  
    as '0'  
    

select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]  
    } on columns,
    { [МО] }  on rows
from [ОРГАНИЗАЦИИ_Характеристика деятельности]  
]]>
  </query>

  <query id="STAT_0023_0002_periodDigest">
    <![CDATA[
-- STAT_0023_0002_periodDigest
with
    set [Непустые периоды]
    as 'Generate
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Месяц],
                    SELF
                ),
                not IsEmpty
                (
                   (
                          [Measures].[Значение],
                          [Организации__Реестр организаций].[Организации__Реестр организаций].[Организации ] 
                   )
                ) and
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            {
                [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Parent
            } +
            {
                [Период__Период].[Период__Период].CurrentMember
            }
        ) '
    member [Measures].[Имя]
    as 'IIF
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Месяц],
            [Период__Период].[Период__Период].CurrentMember.Name + " " + [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Parent.Name + " года",
            [Период__Период].[Период__Период].CurrentMember.Name + " год"
        ) '
    member [Measures].[Уникальное имя]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    member [Measures].[Уровень]
    as 'IIF
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Месяц],
            1,
            0
        )'
    member [Организации__Реестр организаций].[Организации__Реестр организаций].[Организации ]      
    as 'Aggregate
        (
         {
           Filter      
           (
               [Организации__Реестр организаций].[Организации__Реестр организаций].[Все организации].Children,
               [Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Properties("Тип организации") = "Предприятия регионального значения"      
           )
         }
        ) '         
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]
    } on columns,
    { [Непустые периоды] } on rows
from [ОРГАНИЗАЦИИ_Характеристика деятельности]

  ]]>
  </query>

  <query id="STAT_0023_0002_periodCompareDigest">
    <![CDATA[
-- STAT_0023_0002_periodCompareDigest
with 
    member [Территории__Сопоставимый].[Территории__Сопоставимый].[К предыдущей дате] 
    as 'null' 
    member [Территории__Сопоставимый].[Территории__Сопоставимый].[К началу года] 
    as 'null' 
    member [Территории__Сопоставимый].[Территории__Сопоставимый].[К аналогичному периоду предыдущего года] 
    as 'null'  
    member [Measures].[Имя] 
    as ' [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name ' 
    member [Measures].[Уникальное имя] 
    as ' [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.UniqueName ' 
    member [Measures].[Уровень] 
    as '0'   
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень] 
    } on columns,
    {
        [Территории__Сопоставимый].[Территории__Сопоставимый].[К предыдущей дате],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[К началу года],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[К аналогичному периоду предыдущего года]  
    }  on rows 
from [ОРГАНИЗАЦИИ_Характеристика деятельности]  
]]>
  </query>

  <query id="STAT_0023_0002_orgDigest">
    <![CDATA[
-- STAT_0023_0002_orgDigest
with 
    set [Организации] 
    as 'Filter 
        (
            [Организации__Реестр организаций].[Организации__Реестр организаций].[Все организации].Children,
            [Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Properties("Тип организации") = "Предприятия регионального значения"
        )' 
 
    member [Measures].[Имя]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Name' 
    member [Measures].[Уникальное имя]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.UniqueName'
    member [Measures].[Тип]
    as '"<b>Юридический адрес предприятия:</b> " + [Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Properties("Юридический адрес") + "<br/>" +
        "<b>Основной вид деятельности:</b> " + [Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Properties("Виды деятельности") + "<br/>" +
        "<b>Дата учреждения:</b> " + [Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Properties("Дата учреждения") + "<br/>" +
        "<b>Филиальная сеть и юридический адрес:</b> " + [Организации__Реестр организаций].[Организации__Реестр организаций].CurrentMember.Properties("Филиальная сеть")'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Тип]
    } on columns,
    {[Организации]} on rows
From [ОРГАНИЗАЦИИ_Характеристика деятельности] 
where 
    (
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ] 
    ) 
]]>
  </query>

</root>