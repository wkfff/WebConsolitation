using System;
using System.Collections.Generic;
using System.Linq;

using Krista.FM.Domain;

namespace Krista.FM.RIA.Extensions.E86N.Services.Pump.PumpWebCons
{
    public class FormNameFactory
    {
        private readonly List<FormNamesItems> formNameList;

        public FormNameFactory()
        {
            formNameList = new List<FormNamesItems>
                    {
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503130Type, 2011, F0503130PumpWebCons.F0503130ClassV1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503130Type, 2012, F0503130PumpWebCons.F0503130ClassV2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503130Type, 2013, F0503130PumpWebCons.F0503130ClassV3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503130Type, 2014, F0503130PumpWebCons.F0503130ClassV4),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503130Type, 2015, F0503130PumpWebCons.F0503130ClassV5),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503130Type, 2016, F0503130PumpWebCons.F0503130ClassV2016),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503121Type, 2012, F0503121PumpWebCons.F0503121ClassV1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503121Type, 2013, F0503121PumpWebCons.F0503121ClassV2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503121Type, 2014, F0503121PumpWebCons.F0503121ClassV3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503121Type, 2015, F0503121PumpWebCons.F0503121ClassV3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503121Type, 2016, F0503121PumpWebCons.F0503121ClassV3),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503127Type, 2012, F0503127PumpWebCons.F0503127V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503127Type, 2013, F0503127PumpWebCons.F0503127V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503127Type, 2014, F0503127PumpWebCons.F0503127V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503127Type, 2015, F0503127PumpWebCons.F0503127V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503127Type, 2016, F0503127PumpWebCons.F0503127V2016),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503721Type, 2012, F0503721PumpWebCons.F0503721V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503721Type, 2013, F0503721PumpWebCons.F0503721V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503721Type, 2014, F0503721PumpWebCons.F0503721V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503721Type, 2015, F0503721PumpWebCons.F0503721V3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503721Type, 2016, F0503721PumpWebCons.F0503721V3),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503730Type, 2011, F0503730PumpWebCons.F0503730V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503730Type, 2012, F0503730PumpWebCons.F0503730V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503730Type, 2013, F0503730PumpWebCons.F0503730V3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503730Type, 2014, F0503730PumpWebCons.F0503730V4),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503730Type, 2015, F0503730PumpWebCons.F0503730V5),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503730Type, 2016, F0503730PumpWebCons.F0503730V2016),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2011, F05037372PumpWebCons.F05037372V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2012, F05037372PumpWebCons.F05037372V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2013, F05037372PumpWebCons.F05037372V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2014, F05037372PumpWebCons.F05037372V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2015, F05037372PumpWebCons.F05037372V3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2016, F05037372PumpWebCons.F05037372V2016),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2011, F05037374PumpWebCons.F05037374V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2012, F05037374PumpWebCons.F05037374V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2013, F05037374PumpWebCons.F05037374V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2014, F05037374PumpWebCons.F05037374V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2015, F05037374PumpWebCons.F05037374V3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2016, F05037374PumpWebCons.F05037374V2016),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2011, F05037375PumpWebCons.F05037375V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2012, F05037375PumpWebCons.F05037375V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2013, F05037375PumpWebCons.F05037375V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2014, F05037375PumpWebCons.F05037375V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2015, F05037375PumpWebCons.F05037375V3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2016, F05037375PumpWebCons.F05037375V2016),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2011, F05037376PumpWebCons.F05037376V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2012, F05037376PumpWebCons.F05037376V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2013, F05037376PumpWebCons.F05037376V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2014, F05037376PumpWebCons.F05037376V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2015, F05037376PumpWebCons.F05037376V3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2016, F05037376PumpWebCons.F05037376V2016),

                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2011, F05037377PumpWebCons.F05037377V1),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2012, F05037377PumpWebCons.F05037377V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2013, F05037377PumpWebCons.F05037377V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2014, F05037377PumpWebCons.F05037377V2),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2015, F05037377PumpWebCons.F05037377V3),
                        new FormNamesItems(FX_FX_PartDoc.AnnualBalanceF0503737Type, 2016, F05037377PumpWebCons.F05037377V2016),
                    };
        }

        /// <summary>
        /// Получение классов форм по нашему документу
        /// </summary>
        public List<string> GetFormNames(F_F_ParameterDoc doc)
        {
            var result = formNameList.Where(x => x.PartDoc == doc.RefPartDoc.ID && x.Year == doc.RefYearForm.ID).Select(x => x.Name).ToList();

            if (!result.Any())
            {
                throw new Exception(string.Format("Класс формы для документа {0} за {1} год не поддерживается.", doc.RefPartDoc.Name, doc.RefYearForm.ID));
            }

            return result;
        }

        private struct FormNamesItems
        {
            public readonly int PartDoc;

            public readonly int Year;

            public readonly string Name;

            public FormNamesItems(int partDoc, int year, string name)
            {
                PartDoc = partDoc;
                Year = year;
                Name = name;
            }
        }
    }
}
