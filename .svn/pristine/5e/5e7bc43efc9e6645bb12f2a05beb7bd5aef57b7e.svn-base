<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0016_0003_date">
    <![CDATA[
    --FO_0016_0003_date
with                
    member [Measures].[ДанныеНа]  
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'      
    set [Показатели]      
    as 'Filter             
        (
            Descendants      
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF      
            ),
            not isEmpty 
            (
                [Measures].[Количество нарушений] 
            ) and not 
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]            
            ) and not  
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]  
            ) and 
            (
                [Период__Период].[Период__Период].CurrentMember 
            ) 
        )'          
    set [NonEmptySet]                
    as 'Tail                
        (
            Filter                
            (
                Descendants                
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF                
                ),
                not IsEmpty  ( Aggregate([Показатели]) ) and    
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"                
                )                
            ),
            1  
        )'                
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows  
from [ФО_БККУ_Показатели]             
    ]]>
  </query> 
  
  <query id="FO_0016_0003_grid">
    <![CDATA[
    --FO_0016_0003_grid
with  
    set [Районы] 
    as 'Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF 
            ),
            not 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
            ) and 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО" 
            ) 
        )' 
    member [Measures].[Количество нарушений ]  
    as '  
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]  
            )  
        )'  
    member [Measures].[Наименование]  
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'  
select
    {
        [Measures].[Наименование],
        [Measures].[Количество нарушений ] 
    } on columns,
    { [Районы] } on rows  
from  [ФО_БККУ_Показатели]  
where  
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>] 
    ) 
  ]]>
  </query>

  <query id="FO_0016_0003_gridTables">
    <![CDATA[
    --FO_0016_0003_gridTables
 with   
    set [Список районов]   
    as 'Filter   
        (
            Descendants   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER   
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"   
            ) or   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember   
            )   
        ) '   
    set [Список показателей]   
    as '   
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]   
        } '   
    member  [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование] 
    as ' [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'    
    member [Measures].[Нормативное значение]  
    as ' [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Условия проверки") + " " + [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Пороговое значение") '  
    member [Measures].[Значение ] 
    as 'IIF 
        (
            [Measures].[Количество нарушений] = 1,
            [Measures].[Значение],
            null 
        )' 

select
    {
        [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование] 
        *{[Measures].[Значение]} +  [Список показателей]
        * 
        {
            [Measures].[Значение ],
            [Measures].[Нормативное значение] 
        }     
    } on columns,
    { [Список районов] } on rows   
from  [ФО_БККУ_Показатели]   
where   
    (
      [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]
    )   
    ]]>
  </query>

  <query id="FO_0016_0003_indicators">
    <![CDATA[
    --FO_0016_0003_indicators
   with
    set [Показатели]
    as ' {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]
        } '
    member [Measures].[Наименование]
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Наименование")
    + ", " + [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Единицы измерения")'
select
    {
       [Показатели]
    } on columns,
    { [Measures].[Наименование]} on rows
from  [ФО_БККУ_Показатели]
where
    (
       [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]
    )
    ]]>
  </query>

  <query id="FO_0016_0003_MaxMinValue">
    <![CDATA[
    --FO_0016_0003_MaxMinValue
  with
   set [Районы]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF
            ),
            not
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            )
        )'
    set [Список показателей]
    as '
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]
        } '
    member [Measures].[Количество нарушений ]
    as '
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
            )
        )'
    member [Measures].[Максимальное количество нарушений]
    as ' Max
        (
            [Районы],
            [Measures].[Количество нарушений ]
        )'
    member [Measures].[Минимальное количество нарушений]
    as ' Min
        (
            [Районы],
            [Measures].[Количество нарушений ]
        )'
select
    {
        [Measures].[Максимальное количество нарушений],
        [Measures].[Минимальное количество нарушений]
    } on columns,
    { [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[г.Радужный] } on rows
from  [ФО_БККУ_Показатели]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]
    )
   ]]>
</query>

  <query id="FO_0016_0003_gridAvg">
    <![CDATA[
    --FO_0016_0004_gridAverage
with
    set [ГО]
    as ' Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            ) and not
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
        )'
    set [МР]
    as ' Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"
            ) and
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
        )'
    set [Показатели]
    as '
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]
        } '
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа]
    as 'Aggregate([ГО])'
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы]
    as 'Aggregate([МР])'
    member [Measures].[Количество нарушений ]
    as '
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
            )
        )'

    member [Measures].[Среднее количество нарушений]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа],
            [Measures].[Количество нарушений ]  / [ГО].Count,
            IIF
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы],
                [Measures].[Количество нарушений ]  / [МР].Count,
                null
            )
        )'
select
    {
        [Measures].[Количество нарушений ]
    } on columns,
    {
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа],
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы]
    } on rows
from  [ФО_БККУ_Показатели]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]
    )
   ]]>
  </query>

</root>
