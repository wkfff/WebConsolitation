<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="last_date">
    <![CDATA[ -- name: last_date   
      select
          { <%marks%> }on rows ,
          non empty { 
                  [Период].[Год Квартал Месяц].[Год].Members 
            
          }  on columns
      from  [МО_Паспорт МО] 
      where  
          (   [Measures].[Значение]
          ,<%CurrentRegion%>
           )           
	  ]]>
  </query>
    
  <query id="G">
    <![CDATA[--grid
    WITH 
    MEMBER [Measures].[Единица измерения] 
    AS  '[Паспорт МО].[Показатели].CurrentMember.Properties("Единица измерения")'  
select
    {
        [Measures].[Значение],
        [Measures].[Единица измерения] 
    } on columns,
    filter({ <%marks%> }, not IsEmpty([Measures].[Значение])) on rows
from [МО_Паспорт МО]  
where  
    (
        <%last_year%>,
        <%CurrentRegion%>
    )   ]]>
  </query>

  <query id="chart2_dinamic">
    <![CDATA[ -- name: chart_dinamic
     WITH 
    MEMBER [Паспорт МО].[Показатели].[Единица измерения]
    AS  '[Паспорт МО].[Показатели].CurrentMember.Properties("Единица измерения")'  
select
    { <%marks%> }DIMENSION PROPERTIES [Паспорт МО].[Показатели].[Единица измерения] on rows,
    non empty 
    {
        [Период].[Год Квартал Месяц].[Год].Members
    } on columns 
from  [МО_Паспорт МО] 
where 
    (
        <%CurrentRegion%>,
        [Measures].[Значение],
        [Источники данных].[Все источники данных].[МО Паспорт МО] 
    )       
    ]]>
  </query>

</root>