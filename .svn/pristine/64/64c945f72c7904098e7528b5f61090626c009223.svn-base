<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FSGS_0001_0002_list_of_dates">
    <![CDATA[ -- Query name: FSGS_0001_0002_list_of_dates
with
member [Measures].[Дата]
as '[Период].[Период].CurrentMember.UniqueName'
select
    {[Measures].[Дата]} on columns,
    {
        filter
        (
            [Период].[Период].[День].Members,
            ([Продукция].[Сопоставимый].[Все виды продукции].[Дизельное топливо], [Measures].[Цена]) > 0 or
            ([Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)], [Measures].[Цена]) > 0 or
            ([Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)], [Measures].[Цена]) > 0 or
            ([Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше], [Measures].[Цена]) > 0
        )
    } on rows
from [ФСГС_Цены РФ]
where
    (
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация],
        [Организации].[Тип цены].[Все типы цен].[Средняя розничная цена]
    )
    ]]>
  </query>

  <query id ="FSGS_0001_0002_list_of_regions">
    <![CDATA[ -- Query name: FSGS_0001_0002_list_of_regions
with
    member [Measures].[MDX имя]
    as '[Территории].[Сопоставимый].CurrentMember.UniqueName'
    member [Measures].[Имя]
    as '[Территории].[Сопоставимый].CurrentMember.Name'
    member [Measures].[Уровень]
    as '[Территории].[Сопоставимый].CurrentMember.Level.Name'
select
    {
        [Measures].[Имя],
        [Measures].[MDX имя],
        [Measures].[Уровень]
    } on columns,
    {
        filter
        (
            descendants
            (
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация],
                [Территории].[Сопоставимый].[Федеральный округ],
                SELF_AND_BEFORE
            ),
            not [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember and
            (([Продукция].[Сопоставимый].[Все виды продукции].[Дизельное топливо], [Measures].[Цена]) > 0 or
            ([Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)], [Measures].[Цена]) > 0 or
            ([Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)], [Measures].[Цена]) > 0 or
            ([Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше], [Measures].[Цена]) > 0)
        )
    } on rows
from [ФСГС_Цены РФ]
where
    (
        [Организации].[Тип цены].[Все типы цен].[Средняя розничная цена]
    )
    ]]>
  </query>

  <query id = "FSGS_0001_0002_grid">
    <![CDATA[ -- Query name: FSGS_0001_0002_grid
with
    member [Measures].[Текущее значение]
    as '
        (
            [Территории].[Сопоставимый].CurrentMember.DataMember,
            [Measures].[Цена]
        )'
    member [Measures].[Предыдущее значение]
    as '
        (
            [Measures].[Цена],
            [Территории].[Сопоставимый].CurrentMember.DataMember,
            Tail
            (
                filter
                (
                    {
                        [Период].[Период].[Данные всех периодов].[1998].[Полугодие 1].[Квартал 1].[Январь].[1] : [Период].[Период].CurrentMember
                    } -
                    {
                        [Период].[Период].CurrentMember
                    },
                    ( [Measures].[Цена] ) > 0
                )
            ).Item(0)
        )'
    member [Measures].[Отклонение]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Текущее значение]
            ) or
            (
                [Measures].[Текущее значение]
            ) = 0 or IsEmpty
            (
                [Measures].[Предыдущее значение]
            ) or
            (
                [Measures].[Предыдущее значение]
            ) = 0,
            null,
            [Measures].[Текущее значение] - [Measures].[Предыдущее значение]
        )'
    member [Measures].[Темп роста]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Текущее значение]
            ) or
            (
                [Measures].[Текущее значение]
            ) = 0 or IsEmpty
            (
                [Measures].[Предыдущее значение]
            ) or
            (
                [Measures].[Предыдущее значение]
            ) = 0,
            null,
            [Measures].[Текущее значение] / [Measures].[Предыдущее значение]  - 1
        )'
    set [Виды ГСМ]
    as '
        {
            [Продукция].[Сопоставимый].[Все виды продукции].[Дизельное топливо],
            [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)],
            [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)],
            [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше]
        }'
    set [Территории]
    as '
    {
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].datamember
        } +
    {<%selected_region%>} +
    {filter(<%selected_region%>.Children,
    [Measures].[Текущее значение] > 0 and
    not [Территории].[Сопоставимый].Currentmember is [Территории].[Сопоставимый].Currentmember.Parent.DataMember)}'
    set [Параметры]
    as '{[Measures].[Текущее значение], [Measures].[Отклонение], [Measures].[Темп роста]}'
    member [Measures].[Территория]
    as '[Территории].[Сопоставимый].CurrentMember.UniqueName'
select
    {{[Виды ГСМ] * [Параметры]} + {{[Продукция].[Сопоставимый].[Все виды продукции]} * {[Measures].[Территория]}}} on columns,
    [Территории] on rows
from [ФСГС_Цены РФ]
where
    (
        [Организации].[Тип цены].[Все типы цен].[Средняя розничная цена],
        <%selected_date%>
    )
    ]]>
  </query>

  <query id = "FSGS_0001_0002_chart1">
    <![CDATA[ -- Query name: FSGS_0001_0002_chart1
with
    set [Даты]
    as 'Tail
        (
            filter
            (
                {
                    [Период].[Период].[Данные всех периодов].[1998].[Полугодие 1].[Квартал 1].[Январь].[1] : <%selected_date%>
                },
                (
                    [Продукция].[Сопоставимый].[Все виды продукции],
                    [Measures].[Цена]
                ) > 0
                and
                [Период__Период].[Период__Период].currentmember.name <>"Данные месяца"
            ),
            36
        )'
    member [Продукция].[Сопоставимый].[Дата]
    as '[Период].[Период].CurrentMember.UniqueName'
select
    {
        {
            [Продукция].[Сопоставимый].[Дата]
        } +
        {
            [Продукция].[Сопоставимый].[Все виды продукции].[Дизельное топливо],
            [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)],
            [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)],
            [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше]
        }
    } on columns,
    [Даты] on rows
from [ФСГС_Цены РФ]
where
    (
        [Организации].[Тип цены].[Все типы цен].[Средняя розничная цена],
        <%selected_fo%>.DataMember,
        [Measures].[Цена]
    )
    ]]>
  </query>

  <query id = "FSGS_0001_0002_chart2">
    <![CDATA[ -- Query name: FSGS_0001_0002_chart2
with
    set [Территории]
    as 'filter
        (
            {
            
                {
                    [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация]
                } +
                {
                    <%selected_region%>
                } +
                {
                    <%selected_region%>.Children
                }
            },
            [Measures].[Средняя цена] > 0 and not [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember
        )'
    member [Measures].[Средняя цена]
    as '
        (
            [Территории].[Сопоставимый].CurrentMember.DataMember,
            [Measures].[Цена]
        )'
    member [Продукция].[Сопоставимый].[Все виды продукции].[Сокращенное наименование территории]
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Краткое наименование")'
select
    {
        [Продукция].[Сопоставимый].[Все виды продукции].[Сокращенное наименование территории],
        [Продукция].[Сопоставимый].[Все виды продукции].[Дизельное топливо],
        [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)],
        [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)],
        [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше]
    } on columns,
    [Территории] on rows
from [ФСГС_Цены РФ]
where
    (
        [Организации].[Тип цены].[Все типы цен].[Средняя розничная цена],
        <%selected_date%>,
        [Measures].[Средняя цена]
    )    
    ]]>
  </query>
  
</root>