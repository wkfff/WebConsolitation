<?xml version="1.0" encoding="windows-1251"?>
<root>

  <query id = "Direction">
  <![CDATA[--Direction
    with

    member [Measures].[reverce]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'

    member [Measures].[UniqueName]
    as '[СЭП].[Годовой сборник].currentmember.UniqueName'

    member [Measures].[Unit]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Единица измерения")'

    member [Measures].[comparable]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")'
    

select
    {
[UniqueName],
[reverce],
[Measures].[Unit],
[Measures].[comparable]

    } on columns,
    {
    except(
    Filter(
        [СЭП].[Годовой сборник].[Уровень 1].members
        ,        
Aggregate( [Период].[Год Квартал Месяц].[Месяц].members,[Measures].[За период])>0
and not([СЭП__Годовой сборник].[СЭП__Годовой сборник].currentmember.parent is[СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Население])
        ),
        {[СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Отгружено товаров собственного производства, выполнено работ и услуг собственным силами по ОКВЭД]})
    }DIMENSION PROPERTIES PARENT_UNIQUE_NAME on rows
FROM  [СТАТ_СЭП_Годовой сборник]
  ]]>
  </query>
  
   <query id = "Period">
  <![CDATA[  --Period
  with
    member [Measures].[UniqueName]
    as '[Период].[Год Квартал Месяц].currentmember.UniqueName'
    member [Measures].[Mounth]
    as '[Период].[Год Квартал Месяц].currentmember.Name'
    member [Measures].[Year]
    as '[Период].[Год Квартал Месяц].currentmember.parent.parent.parent.Name'
    --member [Measures].[IsDataMmeber]
    --as '[Период].[Год Квартал Месяц].currentmember.IS_DATAMEMBER'

select
    {
[UniqueName],
[Measures].[Mounth],
[Measures].[Year]

    } on columns,
    {
    Filter(
    [Период].[Год Квартал Месяц].[Месяц].members,
      --(
      [Measures].[За период]>0 
      --and not [Measures].[IsDataMmeber])
        )
    }DIMENSION PROPERTIES PARENT_UNIQUE_NAME on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
(
[Территории__СЭП].[Территории__СЭП].[Территория].[<%ChosenRegion%>]
)


  ]]>
  </query>

  <query id = "DefaultParam">
    <![CDATA[
    --DefaultParam
 with
    member [Measures].[reverce]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[UniqueName]
    as '[СЭП].[Годовой сборник].currentmember.UniqueName'
    member [Measures].[Unit]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Единица измерения")'
    member [Measures].[comparable]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")'
select
    {
        <%ChosenDate%>
    } on columns,
    {
    TopCount(
        filter
        (
            [СЭП].[Годовой сборник].[Уровень 1].members,
            not IsEmpty
            (
                (
                    [Measures].[За период],
                    <%ChosenDate%>
                )
            )
        )
        ,
        1)
    }DIMENSION PROPERTIES PARENT_UNIQUE_NAME on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
( 
[Территории__СЭП].[Территории__СЭП].[Территория].[<%ChosenRegion%>]
)
/*where 
    (
        [Территории].[СЭП].[Территория].[Центральный федеральный округ]
    )*/
  ]]>
  </query>
  
    <query id = "Region">
    <![CDATA[
--Region
with

                member [Measures].[UniqueName]
    as '[Территории].[СЭП].CurrentMember.UniqueName'
select
    {
		[Measures].[UniqueName]
    } on columns,
    non empty
    {
    Order(
        filter
        (
            [Территории].[СЭП].[Территория].members,

            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"
            )
        ),
        [Территории].[СЭП].CurrentMember.Name, desc)
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
]]></query>

  <query id = "Grid">
    <![CDATA[
    --Grid
    with
    member [Measures].[value]
    as '
        (
            [Measures].[За период],
            <%ChosenDate%>
        )'
    member [Measures].[PrevValue]
    as '(
            [Measures].[За период],
            <%ChosenDate%>.lag(16)
        )'
    member [Measures].[reverce]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[ShortName]
    as '[Территории].[СЭП].CurrentMember.Properties("Краткое наименование")'
    member [Measures].[accessory]
    as '[Территории].[СЭП].CurrentMember.Properties("Принадлежность")'
    
    member [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Индекс промышленного производства: добыча полезных ископаемых]
    as '([СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Индекс промышленного производства по ОКВЭД],
    [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД].[Добыча полезных ископаемых])'
    member [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Индекс промышленного производства: обрабатывающие производства]
    as '([СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Индекс промышленного производства по ОКВЭД],
    [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД].[Обрабатывающие производства])'
    member [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Индекс промышленного производства: производство и распределение электроэнергии, газа и воды]
    as '([СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Предприятия и организации].[Индекс промышленного производства по ОКВЭД],
    [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД].[Производство и распределение электроэнергии, газа и воды])'
    
select
    {
    [Measures].[ShortName],
    [Measures].[reverce],
    [Measures].[PrevValue],
	  [Measures].[value],
    [Measures].[accessory]
        
    } on columns,
    non empty
    {
        [Территории].[СЭП].[Территория].[Российская Федерация].datamember,
        [Территории].[СЭП].[Территория].[<%ChosenRegion%>].datamember,
        filter
        (
            [Территории].[СЭП].[Территория].members,
            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") <> ""
            )
        )
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
(
<%ChosenSEP%>
)
]]>
  </query>
  <query id = "G_lr">
    <![CDATA[with
    member [Measures].[за перила]
    as '
        (
            [Measures].[За период],
            --[Период].[Год Квартал Месяц].[Год].[2010].[Полугодие 1].[Квартал 1].[Январь]
            <%LD%>
        )'
    member [Measures].[АППГ]
    as '
        (
            [Measures].[За период],
            --[Период].[Год Квартал Месяц].[Год].[2010].[Полугодие 1].[Квартал 1].[Январь]
            <%LD%>            
        )-
        (
            [Measures].[За период],
            --[Период].[Год Квартал Месяц].[Год].[2009].[Полугодие 1].[Квартал 1].[Январь]
            <%LD_L%>
        )'
    member [Measures].[АППГ_2]
    as '
iif((
            [Measures].[За период],
            --[Период].[Год Квартал Месяц].[Год].[2009].[Полугодие 1].[Квартал 1].[Январь]
            <%LD_L%>
        )<>0,
    100
        *
        (
            [Measures].[За период],
            --[Период].[Год Квартал Месяц].[Год].[2010].[Полугодие 1].[Квартал 1].[Январь]
            <%LD%>
        )/
        (
            [Measures].[За период],
            --[Период].[Год Квартал Месяц].[Год].[2009].[Полугодие 1].[Квартал 1].[Январь]
            <%LD_L%>
        ),0 )'
    member [Measures].[pri]
    as '[Территории].[СЭП].CurrentMember.Properties("Принадлежность")'
    member [Measures].[pri2]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[pri3]
    as 'null'/**/
select
    {

[Measures].[за перила],[Measures].[pri3]

--        ,
--        [Measures].[pri2]/**/
    } on columns,
    non empty
    {[Территории].[СЭП].[Территория].[Российская Федерация].datamember,
    [Территории].[СЭП].[Территория].[Российская Федерация].datamember,
        filter
        (
            [Территории].[СЭП].[Территория].members,
            (
                ([Территории].[СЭП].CurrentMember.Properties("Принадлежность") <> "РФ")
                and
                ([Территории].[СЭП].CurrentMember.Properties("Принадлежность") <> "")
            )
        )
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
(
--[СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Труд]
--[Период].[Год Квартал Месяц].[Данные всех периодов].[2010].[Полугодие 2].[Квартал 4].[Октябрь]
<%SEP%>
)]]>
  </query>
    <query id = "FO">
    <![CDATA[
with

                member [Measures].[UniqueName]
    as '[Территории].[СЭП].CurrentMember.UniqueName'
select
    {
		[Measures].[UniqueName]
    } on columns,
    non empty
    {
        filter
        (
            [Территории].[СЭП].[Территория].members,

            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"
            )
        )
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
]]></query>
    <query id = "SN">
    <![CDATA[--shortName

with

    member [Measures].[pri6]
    as '[Территории].[СЭП].CurrentMember.Properties("Краткое наименование")'
select
    {
		[Measures].[pri6]
    } on columns,
    non empty
    {
        filter
        (
            [Территории].[СЭП].[Территория].members,

            (
                [Территории].[СЭП].CurrentMember.Properties("Принадлежность") = "РФ"
            )
        )
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
]]>
  </query>
<query id = "AllMount">
    <![CDATA[
select
    {
[Measures].[За период]
    } on columns,
    non empty
    {
[Период].[Год Квартал Месяц].[Месяц].Members
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]	
]]>
  </query>
  
  <query id = "AllSEP">
    <![CDATA[
with
    member [Measures].[pri4]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")'
    member [Measures].[pri2]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[pri3]
    as '[Период].[Год Квартал Месяц].[Месяц].Dimension'
select
    {

[Measures].[pri2],
            [Measures].[pri4]
--                        [Measures].[pri3]


    } on columns,
    non empty
    {
    filter
        (
        [СЭП].[Годовой сборник].[Уровень 1].members ,
          (not IsEmpty([Measures].[За период])and not isempty(<%LD%>))
        )
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]


]]></query>
<query id = "AllSEP2">
    <![CDATA[with
    member [Measures].[pri4]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")'
    member [Measures].[pri2]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[pri3]
    as '[Период].[Год Квартал Месяц].[Месяц].Dimension'
select
    {
[Период].[Год Квартал Месяц].[Месяц].members
    } on columns,
    non empty
    {
        [СЭП].[Годовой сборник].[Уровень 1].members
    } on rows
FROM  [СТАТ_СЭП_Годовой сборник]
]]>
  </query>
  <query id = "Compare_And_Reverce">
    <![CDATA[
with
    member [Measures].[pri4] 
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")' 
    member [Measures].[pri2]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[pri3]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Единица измерения")'
select
    {

			[Measures].[pri2],
            [Measures].[pri4],
            [Measures].[pri3]
          
    } on columns,
    non empty 
    {
<%SEP%>
    } on rows    
FROM  [СТАТ_СЭП_Годовой сборник] 
]]>
  </query>
</root>