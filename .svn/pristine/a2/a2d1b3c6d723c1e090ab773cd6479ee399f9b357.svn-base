<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="RG_0001_0001_date_nonEmptyCrossJoin">
    <![CDATA[
-- RG_0001_0001_date_nonEmptyCrossJoin 
with
    member Measures.[ДанныеНа]
    as '<%period_dimension%>.CurrentMember.UniqueName'
select
    {Measures.[ДанныеНа]} on columns,
    Tail
    (
        NonEmptyCrossjoin
        (
            OpeningPeriod
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2008]
            ) : ClosingPeriod
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2010]
            )
        )
    ) on rows
from [ФО_МесОтч_Доходы]
]]>
  </query>

  <query id="RG_0001_0001_Grid">
    <![CDATA[
-- RG_0001_0001_grid   
with
    member [Measures].[Код]
    as '[Показатели].[Оценка деятельности].Properties("Код")'
    member [Measures].[Название периода ]
    as '[Показатели].[Оценка деятельности].Properties("Период вывода данных")'
    member [Measures].[Обратный показатель ]
    as '[Показатели].[Оценка деятельности].Properties("Обратный показатель")'
    member [Measures].[Единицы измерения]
    as '[Показатели].[Оценка деятельности].Properties("Единица измерения")'
    member [Measures].[Направления оценки]
    as '[Показатели].[Оценка деятельности].Properties("Направления оценки")'
    member [Measures].[Вес]
    as '[Показатели].[Оценка деятельности].Properties("Весовой коэффициент")'

    member [Территории].[Сопоставимый].[Нулл]
    as 'Null'
    member [Территории].[Сопоставимый].[Уральский федеральный округ ]
    as '[Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember'
    set [Список все субъектов УрФО]
    as '
        {
            Filter
            (
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].Children,
                not
                (
                    [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        }+
        {
            [Территории].[Сопоставимый].[Уральский федеральный округ ]
        } '
    member [Measures].[Значение ]
    as '
        (
            [Measures].[Значение],
            [Показатели].[Оценка деятельности].CurrentMember
        )'
    member [Период].[Период].[Данные на]
    as 'StrToMember
        (
            [Показатели].[Оценка деятельности].CurrentMember.Properties("Период вывода данных")
        )'
    member Measures.[Ранг ]
    as 'IIF
        (
            IsEmpty ( [Measures].[Значение ] ),
            null,
            IIF
            (
                [Показатели].[Оценка деятельности].Properties("Обратный показатель") = "0",
                Rank
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    Order
                    (
                        Filter
                        (
                            [Территории].[Сопоставимый].CurrentMember.Siblings,
                            not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                            )
                        ),
                        [Measures].[Значение ],
                        DESC
                    ),
                    [Measures].[Значение ]
                ),
                Rank
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    Order
                    (
                        Filter
                        (
                            [Территории].[Сопоставимый].CurrentMember.Siblings,
                            not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                            )
                        ),
                        [Measures].[Значение ],
                        ASC
                    ),
                    [Measures].[Значение ]
                )
            )
        )'
    member [Measures].[Худший ранг ]
    as '    max
        (
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember.Siblings,
            Measures.[Ранг ]
        ) '
    member Measures.[Оценка ]
    as 'IIF
        (
             not isEmpty (Measures.[Делитель ]) and not (Measures.[Делитель ] = 0)and not isEmpty (Measures.[Значение ]) ,
            IIF
            (
                [Показатели].[Оценка деятельности].Properties("Обратный показатель") = "0",
                (
                    [Measures].[Значение ] - Measures.[Минимум ]
                ) / Measures.[Делитель ],
                (
                    Measures.[Максимум ] - [Measures].[Значение ]
                ) / Measures.[Делитель ]
            ),
            null
        )  '
    member Measures.[Делитель ]
    as 'Measures.[Максимум ] - Measures.[Минимум ]'
    member Measures.[Максимум ]
    as '
        (
            Tail
            (
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not
                        (
                            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                        )  and not IsEmpty ( [Measures].[Значение ] ) and not
                        (
                            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                        )
                    ),
                    [Measures].[Значение ],
                    ASC
                )
            ).Item(0),
            [Measures].[Значение ]
        )'
    member Measures.[Минимум ]
    as '
        (
            Tail
            (
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not
                        (
                            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                        )  and not IsEmpty ( [Measures].[Значение ] ) and not
                        (
                            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                        )
                    ),
                    [Measures].[Значение ],
                    DESC
                )
            ).Item(0),
            [Measures].[Значение ]
        )'
SELECT
    {
        {
            {[Список все субъектов УрФО]  }
            *
            {
                [Measures].[Значение ],
                Measures.[Ранг ],
                Measures.[Оценка ]
            }
        }+
        {
            {
                [Территории].[Сопоставимый].[Нулл]
            }
            *
            {
                [Measures].[Худший ранг ],
                [Measures].[Единицы измерения],
                [Measures].[Код],
                [Measures].[Обратный показатель ],
                [Measures].[Направления оценки],
                [Measures].[Вес],
                [Measures].[Название периода ]
            }
        }
    }   ON columns ,
    {
        [Показатели].[Оценка деятельности].[Все показатели].Children
    }  ON rows
FROM  [РЕГИОН_Оценка деятельности]
where
    (
        [Источники данных].[Все источники данных].[РЕГИОН Оценка деятельности - Оценка деятельности губернаторов],
        [Период].[Период].[Данные на]
    )
]]>
</query>

<query id="RG_0001_0001_map">
<![CDATA[
-- RG_0001_0002_map   
WITH
    member [Период].[Период].[Данные на]
    as 'StrToMember
        (
            [Показатели].[Оценка деятельности].CurrentMember.Properties("Период вывода данных")
        )'
        member Measures.[Единицы]
    as '
            [Показатели].[Оценка деятельности].CurrentMember.Properties("Примечание")
        '
    set [Список все субъектов УрФО]
    as 'Filter
        (
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].Children,
            not
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember
            )
        )'
    member Measures.[Ранг ]
    as 'IIF
        (
            IsEmpty ( [Measures].[Значение ] ),
            null,
            IIF
            (
                [Показатели].[Оценка деятельности].Properties("Обратный показатель") = "0",
                Rank
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    Order
                    (
                        Filter
                        (
                            [Территории].[Сопоставимый].CurrentMember.Siblings,
                            not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                            )
                        ),
                        [Measures].[Значение ],
                        DESC
                    ),
                    [Measures].[Значение ]
                ),
                Rank
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    Order
                    (
                        Filter
                        (
                            [Территории].[Сопоставимый].CurrentMember.Siblings,
                            not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                            )
                        ),
                        [Measures].[Значение ],
                        ASC
                    ),
                    [Measures].[Значение ]
                )
            )
        )'
    member [Measures].[Значение ]
    as '
        (
            [Measures].[Значение],
            [Показатели].[Оценка деятельности].CurrentMember
        )'
SELECT
    {
        [Measures].[Значение],
        Measures.[Ранг ],
        Measures.[Единицы]
    } ON COLUMNS ,
    {[Список все субъектов УрФО]} ON ROWS
FROM [РЕГИОН_Оценка деятельности] 
WHERE   
    (
        [Источники данных].[Все источники данных].[РЕГИОН Оценка деятельности - Оценка деятельности губернаторов],
        [Период].[Период].[Данные на],
        [Показатели].[Оценка деятельности].[Все показатели].[<%filter%>]  
    )
]]>
  </query>

  <query id="RG_0001_0002_Indicators">
    <![CDATA[
  with 
    member [Measures].[Название периода ] 
    as '[Показатели].[Оценка деятельности].Properties("Период вывода данных")' 
    member [Период].[Период].[Данные на] 
    as 'Tail 
        (
            Filter 
            (
                [Период].[Период].[День].Members,
                not IsEmpty([Measures].[Значение]) 
            ),
            1 
        ).Item(0)' 
    member [Measures].[Направление] 
    as '[Показатели].[Оценка деятельности].Properties("Направления оценки")' 
SELECT
    {
        [Measures].[Направление],
        [Measures].[Название периода ] 
    } on columns,
    Filter 
    (
        [Показатели].[Оценка деятельности].members,
        not isEmpty ([Measures].[Значение]) and not 
        (
            [Показатели].[Оценка деятельности].CurrentMember is [Показатели].[Оценка деятельности].[Все показатели] 
        ) and not isEmpty ([Measures].[Название периода ])
    )  ON rows 
FROM  [РЕГИОН_Оценка деятельности] 
where ([Период].[Период].[Данные на]) 
    ]]>
  </query>

  <query id="RG_0001_0002_measures">
    <![CDATA[
    WITH 
     member [Территории].[Сопоставимый].[Код]  
    as '[Показатели].[Оценка деятельности].Properties("Код")' 
    member [Территории].[Сопоставимый].[Единицы измерения] 
    as '[Показатели].[Оценка деятельности].Properties("Единица измерения")' 
    member [Территории].[Сопоставимый].[Название периода ] 
    as '[Показатели].[Оценка деятельности].Properties("Период вывода данных")' 
    member [Территории].[Сопоставимый].[Обратный показатель ] 
    as '[Показатели].[Оценка деятельности].Properties("Обратный показатель")' 
SELECT
    NON EMPTY 
    {
        [Территории].[Сопоставимый].[Единицы измерения],
        [Территории].[Сопоставимый].[Название периода ],
        [Территории].[Сопоставимый].[Обратный показатель ],
        [Территории].[Сопоставимый].[Код]
    } ON COLUMNS 
FROM [РЕГИОН_Оценка деятельности]  
WHERE 
    (
        [Источники данных].[Все источники данных].[РЕГИОН Оценка деятельности - Оценка деятельности губернаторов],
        [Показатели].[Оценка деятельности].[Все показатели].[<%filter%>]
    ) 
    ]]>
  </query>

</root>