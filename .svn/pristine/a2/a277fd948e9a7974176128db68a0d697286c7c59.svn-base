<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id = "STAT_0001_0021_Sakhalin_quarters">
    <![CDATA[ -- STAT_0001_0021_Sakhalin_quarters
with
    set [Кварталы]
    as 'filter
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
            [Measures].[Нарастающий итог] > 0
        )  '
    member [Measures].[Уникальное имя квартала]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName'
select
    [Measures].[Уникальное имя квартала] on columns,
    [Кварталы] on rows
from [СТАТ_Инвестиции_Финансовые вложения]
where
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].DataMember,
        {
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Долгострочные финансовые вложения],
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Краткосрочные финансовые вложения]
        },
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Статистический раздел]
    )
    ]]>
  </query>
  
  <query id = "STAT_0001_0021_Sakhalin_grid">
    <![CDATA[ -- STAT_0001_0021_Sakhalin_grid
with
    set [Кварталы]
    as '
        {
            filter
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал].Members,
                not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember and [Measures].[Нарастающий итог] > 0
            )
        }'
    member [Measures].[В этом году]
    as '
        (
            [Measures].[Нарастающий итог],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
        )'
    member [Measures].[В прошлом году]
    as '
        (
            [Measures].[Нарастающий итог],
            [Группировки__Инвестиции_Финансовые вложения].[Группировки__Инвестиции_Финансовые вложения].[Все группировки].[По видам финансовых вложений],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Lag(6)
        )'
    member [Measures].[В этом году всего]
    as '
        (
            [Measures].[Нарастающий итог],
            [Инвестиции__Финансовые вложения].[Инвестиции__Финансовые вложения].CurrentMember,
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
        )'
    member [Measures].[В прошлом году всего]
    as '
        (
            [Measures].[Нарастающий итог],
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].CurrentMember,
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Lag(6)
        )'
    member [Measures].[Прирост к АППГ]
    as 'iif
        (
            IsEmpty([Measures].[В этом году]) or IsEmpty([Measures].[В прошлом году]),
            null,
            [Measures].[В этом году] - [Measures].[В прошлом году]
        )'
    member [Measures].[Темп роста к АППГ]
    as 'iif
        (
            IsEmpty([Measures].[В этом году]) or IsEmpty([Measures].[В прошлом году]) or ([Measures].[В прошлом году]) = 0,
            null,
            [Measures].[В этом году] / [Measures].[В прошлом году]
        )'
    set [Виды вложений]
    as '
        {
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Долгострочные финансовые вложения],
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Краткосрочные финансовые вложения]
        }'
    set [Инвестиции]
    as '
        {
            except
            (
                [Инвестиции__Финансовые вложения].[Инвестиции__Финансовые вложения].[Все показатели].children,
                [Инвестиции__Финансовые вложения].[Инвестиции__Финансовые вложения].[Все показатели].[Значение не указано]
            )
        }'
    member [Инвестиции__Финансовые вложения].[Инвестиции__Финансовые вложения].[Все показатели].[Год]
    as '"Год " + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Name + + ";" + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name'
    set [Строки грида]
    as '
        {
            [Measures].[В этом году],
            [Measures].[Прирост к АППГ],
            [Measures].[Темп роста к АППГ]
        }'
select
    {
        [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды]
        *
        {
            [Инвестиции__Финансовые вложения].[Инвестиции__Финансовые вложения].[Все показатели].[Год]
        } + [Виды вложений]
        *
        {
            [Инвестиции]
        }
    } on columns,
    [Кварталы]
    * [Строки грида] on rows
from [СТАТ_Инвестиции_Финансовые вложения]
where
    (
        [ОК__ОКВЭД].[ОК__ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК__ОКФС].[ОК__ОКФС].[Все формы собственности].[Значение не указано],
        [Инвестиции__Источники финансирования].[Инвестиции__Источники финансирования].[Все источники финансирования].[Значение не указано],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].DataMember,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Статистический раздел]
    )
    ]]>
  </query>

  <query id = "STAT_0001_0021_Sakhalin_chart">
    <![CDATA[ -- STAT_0001_0021_Sakhalin_chart
with
    set [Кварталы]
    as '
        {
            filter
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал].Members,
                [Measures].[Нарастающий итог] > 0 and not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember
            )
        }'
    set [Инвестиции]
    as '
        {
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Долгострочные финансовые вложения],
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Краткосрочные финансовые вложения]
        }'
    member [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Год]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + ";" + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Name + " год"'
select
    {
        {
            [Инвестиции__Виды финансовых вложений].[Инвестиции__Виды финансовых вложений].[Все виды].[Год]
        } + [Инвестиции]
    } on columns,
    [Кварталы] on rows
from [СТАТ_Инвестиции_Финансовые вложения]
where
    (
        [Measures].[Нарастающий итог],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].DataMember,
        [Инвестиции__Источники финансирования].[Инвестиции__Источники финансирования].[Все источники финансирования].[Значение не указано],
        [Группировки__Инвестиции_Финансовые вложения].[Группировки__Инвестиции_Финансовые вложения].[Все группировки].[По видам финансовых вложений],
        [Инвестиции__Финансовые вложения].[Инвестиции__Финансовые вложения].[Все показатели].[Финансовые вложения],
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Статистический раздел],
        [ОК__ОКВЭД].[ОК__ОКВЭД].[Все виды экономической деятельности].[Значение не указано],
        [ОК__ОКФС].[ОК__ОКФС].[Все формы собственности].[Значение не указано]
    )
    ]]>
  </query>

</root>