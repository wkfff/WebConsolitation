<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="last_date">
    <![CDATA[ -- name: last_date   
      select
          { <%marks%> }  on rows,
          non empty{[Период].[Год Квартал Месяц].[Год].Members
               
          }   on columns
      from  [МО_Паспорт МО] 
      where  
          (   [Measures].[Значение],
              <%CurrentRegion%>
           )           
	  ]]>
  </query>
  
  <query id ="G">
    <![CDATA[     
    with
member  [Measures].[Единица измерения]
as  '[Паспорт МО].[Показатели].CurrentMember.Properties("Единица измерения")'
    select
          Filter  
          (
              <%marks%>.children,
              [Measures].[Значение] > 0 and not  
              (
                  [Паспорт МО].[Показатели].CurrentMember is [Паспорт МО].[Показатели].CurrentMember.Parent.DataMember  
              )  
          )  on rows,
          {
              [Measures].[Значение],[Measures].[Единица измерения]              
          } on columns 
      from [МО_Паспорт МО]  
      where  
          (
              <%CurrentRegion%>,              
              <%CurrentPeriod%>  
          ) ]]>
  </query>
  
  <query id="G2">
    <![CDATA[select
    { <%marks%> } on columns,
    non empty { [Период].[Год Квартал Месяц].[Год].Members }  on rows
from [МО_Паспорт МО]
where <%CurrentRegion%>
    ]]>    
  </query>
  
  <query id="chart_dinamic">
    <![CDATA[ -- name: chart_avg_count
select
    {<%marks%> 
     } on rows,
    non empty 
    {
        [Период].[Год Квартал Месяц].[Год].Members
    } on columns
from  [МО_Паспорт МО] 
where 
    (           
        <%CurrentRegion%>,
        [Measures].[Значение],
        [Источники данных].[Все источники данных].[МО Паспорт МО] 
    )       
    ]]>
  </query>
  
  <query id="chart_pie">
    <![CDATA[ -- name: chart_pie
select
    { Filter 
    (
        <%marks%>.children,
        [Measures].[Значение] > 0 and not 
        (
            [Паспорт МО].[Показатели].CurrentMember is [Паспорт МО].[Показатели].CurrentMember.Parent.DataMember 
        ) 
    )} on rows,
    { [Measures].[Значение] } on columns  
from [МО_Паспорт МО] 
where 
    (
        [Источники данных].[Все источники данных].[МО Паспорт МО],
        <%CurrentPeriod%>--,
        <%CurrentRegion%>
    )
  ]]>
</query>
    
</root>
