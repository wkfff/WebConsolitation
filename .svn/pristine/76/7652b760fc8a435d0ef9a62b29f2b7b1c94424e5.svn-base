<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FK_0001_0016_01_date">
    <![CDATA[
-- FK_0001_0016_01_date 
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                OpeningPeriod  
                (
                    [Период].[Период].[Месяц],
                    [Период].[Период].[Данные всех периодов].[2008] 
                ) : ClosingPeriod  
                (
                    [Период].[Период].[Месяц],
                    [Период].[Период].[Данные всех периодов].[2012] 
                ),
                not IsEmpty
                (
                   ([Measures].[Факт],[ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов])
                ) and
                not IsEmpty
                (
                   [Measures].[Объем неэффективных расходов в сфере ЖКХ]  
                ) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ]   
    as ' LookupCube   
        (
            "[ФК_МесОтч_Расходы]",
            "   
            (
                [Measures].[Исполнено],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                 " + MemberToStr
                (
                    [Период].[Период].CurrentMember   
                ) + "   
            )"   
        ) '         
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_МесОтч_СпрРасходыДоп]
]]>
  </query>

  <query id="FK_0001_0016_01_grid">
    <![CDATA[
-- FK_0001_0016_01_grid
with  
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'  
    member [Территории].[Сопоставимый].[Общие итоги]  
    as 'Sum  
        (
            [Субъекты],
            [Measures].CurrentMember  
        ) '  
    member [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
    as '  
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО]  
        ) / 1000'  
    member [Measures].[Общий объем расходов консолидированного бюджета]  
    as '  
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]  
        ) / 1000'  
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ]
    as 'IIF
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum
            (
                [Субъекты],
                [Measures].CurrentMember
            ),
            (
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка жилищного хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению жилищные услуги по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) + LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги электроснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги теплоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги водоснабжения и водоотведения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )+
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги газоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )
            ) / 1000
        )'    
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ полож]  
    as 'IIF  
        (
            [Measures].[Объем неэффективных расходов в сфере ЖКХ] < 0 
            or              IsEmpty
            (
                [Measures].[Объем неэффективных расходов в сфере ЖКХ]
            ),
            0,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ]  
        ) '  
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]  
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) or  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
        )'  
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ минимум/максимум]
    as 'IIF
        (
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на ЖКХ] = Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов на ЖКХ],
            "min",
            IIF
            (
                Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на ЖКХ] = 1,
                "max",
                ""
            )
        )'
    member Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на ЖКХ]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Субъекты],
                        not IsEmpty
                        (
                            [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
                        )
                    ),
                    (
                        [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
                    ),
                    BDESC
                ),
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
                )
            )
        )'
    member Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов на ЖКХ]
    as 'Max
        (
            Filter
            (
                [Субъекты],
                not IsEmpty
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
                )
            ),
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на ЖКХ]
        )'


    member [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]  
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) or  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета]  
        )'

    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Min]
    as 'Min
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
        )'
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max]
    as 'Max
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
        )'
        
    member [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта минимум/максимум]
    as 'IIF
        (
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов субъекта] = Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов субъекта],
            "min",
            IIF
            (
                Measures.[Ранг по доле неэффективных расходов в общей сумме расходов субъекта] = 1,
                "max",
                ""
            )
        )'
    member Measures.[Ранг по доле неэффективных расходов в общей сумме расходов субъекта]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Субъекты],
                        not IsEmpty
                        (
                            [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]
                        )
                    ),
                    (
                        [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]
                    ),
                    BDESC
                ),
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]
                )
            )
        )'
    member Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов субъекта]
    as 'Max
        (
            Filter
            (
                [Субъекты],
                not IsEmpty
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]
                )
            ),
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов субъекта]
        )'

    member [Measures].[Уровень эффективности бюджетных расходов]  
    as 'IIF  
        (
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Min]  
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]  
            ) /  
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Min]  
            )  
        )'
    member [Measures].[Уровень эффективности бюджетных расходов минимум/максимум]  
    as 'IIF  
        (
            Measures.[Ранг по уровню эффективности бюджетных расходов] = Measures.[Худший ранг по уровню эффективности бюджетных расходов],
            "min",
            IIF 
            (
                Measures.[Ранг по уровню эффективности бюджетных расходов] = 1,
                "max",
                ""  
            )
        )' 
    member Measures.[Ранг по уровню эффективности бюджетных расходов]  
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Уровень эффективности бюджетных расходов]  
            ) or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            Rank  
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order  
                (
                    Filter  
                    (
                        [Субъекты],
                        not IsEmpty  
                        (
                            [Measures].[Уровень эффективности бюджетных расходов]  
                        )  
                    ),
                    (
                        [Measures].[Уровень эффективности бюджетных расходов]  
                    ),
                    BDESC  
                ),
                (
                    [Measures].[Уровень эффективности бюджетных расходов]  
                )  
            )  
        )'  
    member Measures.[Худший ранг по уровню эффективности бюджетных расходов]  
    as 'Max  
        (
            Filter  
            (
                [Субъекты],
                not IsEmpty  
                (
                    [Measures].[Уровень эффективности бюджетных расходов]  
                )  
            ),
            Measures.[Ранг по уровню эффективности бюджетных расходов]  
        )'  
    member Measures.[RegionUniqueName]  
    as '[Территории].[Сопоставимый].CurrentMember.UniqueName'  
select
    {
        [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ],
        [Measures].[Общий объем расходов консолидированного бюджета],
        [Measures].[Объем неэффективных расходов в сфере ЖКХ полож],
        [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ],  
        [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта],
        [Measures].[Уровень эффективности бюджетных расходов],
        [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ минимум/максимум],
        [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта минимум/максимум],
        [Measures].[Уровень эффективности бюджетных расходов минимум/максимум],
        [Measures].[RegionUniqueName]  
    } on columns,
    Filter
    (
        {
            [Субъекты] +  
            {
                [Территории].[Сопоставимый].[Общие итоги]  
            }  
        },
        not IsEmpty([Measures].[Общий объем расходов консолидированного бюджета])
    ) on rows  
from [ФК_МесОтч_Расходы]  
where  
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
    )              
  ]]>
  </query>

  <query id="FK_0001_0016_01_chart">
    <![CDATA[
-- FK_0001_0016_01_chart
with  
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'    
    set [Периоды] 
    as 'Filter
        (
            Descendants 
            (
                [Период].[Период].[Данные всех периодов].[<%period_year%>],
                [Период].[Период].[Месяц],
                SELF 
            ) ,
            [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
            [Период].[Период].CurrentMember.Name <> "Данные квартала" and
            [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
            [Период].[Период].CurrentMember.Name <> "Данные года" and
            [Период].[Период].CurrentMember.Name <> "Данные месяца" and
            [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
        )' 
    member [Территории].[Сопоставимый].[Общие итоги]  
    as 'Sum  
        (
            [Субъекты],
            [Measures].CurrentMember  
        ) '  
    member [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
    as '  
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО]  
        ) / 1000'  
    member [Measures].[Общий объем расходов консолидированного бюджета]  
    as '  
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]  
        ) / 1000'  
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ]
    as 'IIF
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum
            (
                [Субъекты],
                [Measures].CurrentMember
            ),
            (
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка жилищного хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению жилищные услуги по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) + LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги электроснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги теплоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги водоснабжения и водоотведения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )+
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги газоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )
            ) / 1000
        )'
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ полож]  
    as 'IIF  
        (
            [Measures].[Объем неэффективных расходов в сфере ЖКХ] < 0 or              IsEmpty
            (
                [Measures].[Объем неэффективных расходов в сфере ЖКХ]
            ),
            0,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ]  
        )'  
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]  
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) or  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
        )'  
    member [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]  
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) or  
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]  
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета]  
        )'  
select
    {
        [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ],
        [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта] 
    } on columns,
    { [Периоды]  } on rows
from [ФК_МесОтч_Расходы]  
where  
    (
         <%selected_subject%>
    )   
  ]]>
  </query>

  <query id="FK_0001_0016_01_stackChart">
    <![CDATA[
-- FK_0001_0016_01_stackChart
with 
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'  
    member [Территории].[Сопоставимый].[Общие итоги]  
    as 'Sum  
        (
            [Субъекты],
            [Measures].CurrentMember  
        ) '  
    member [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ] 
    as ' 
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО] 
        ) / 1000' 
    member [Measures].[Общий объем расходов консолидированного бюджета] 
    as ' 
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО] 
        ) / 1000' 
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ]
    as 'IIF
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum
            (
                [Субъекты],
                [Measures].CurrentMember
            ),
            (
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка жилищного хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению жилищные услуги по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) + LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги электроснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги теплоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги водоснабжения и водоотведения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )+
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги газоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )
            ) / 1000
        )'   
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] 
    as 'IIF 
        (
            [Measures].[Объем неэффективных расходов в сфере ЖКХ] < 0 or              IsEmpty
            (
                [Measures].[Объем неэффективных расходов в сфере ЖКХ]
            ),
            0,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ] 
        ) ' 
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ] 
    as 'IIF 
        (
            IsEmpty 
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ] 
            ) or 
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ] 
            ) = 0,
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ] 
        )' 
    member [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта] 
    as 'IIF 
        (
            IsEmpty 
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ] 
            ) or 
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ] 
            ) = 0,
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета] 
        )' 
    member [Measures].[Эффективные расходы на ЖКХ]
    as '[Measures].[Общий объем расходов консолидированного бюджета на ЖКХ] - [Measures].[Объем неэффективных расходов в сфере ЖКХ полож]'
    member [Measures].[Неэффективные расходы на ЖКХ]
    as '[Measures].[Объем неэффективных расходов в сфере ЖКХ полож]'
select
    
    Filter     
    (
        {
            [Субъекты] -  
            {
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Дальневосточный федеральный округ].[Камчатская область],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Дальневосточный федеральный округ].[Корякский автономный округ]
            } 
        },
        not IsEmpty     
        (
            [Measures].[Эффективные расходы на ЖКХ]     
        )   
    )on columns,
    {
        [Measures].[Эффективные расходы на ЖКХ],
        [Measures].[Неэффективные расходы на ЖКХ]
    } on rows 
from [ФК_МесОтч_Расходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
    )  
  ]]>
  </query>

  <query id="FK_0001_0016_01_map">
    <![CDATA[
-- FK_0001_0016_01_map
with
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'  
    member [Территории].[Сопоставимый].[Общие итоги]
    as 'Sum
        (
            [Субъекты],
            [Measures].CurrentMember
        ) '
    member [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]
    as '
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО]
        ) / 1000'
    member [Measures].[Общий объем расходов консолидированного бюджета]
    as '
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]
        ) / 1000'
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ]
    as 'IIF
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum
            (
                [Субъекты],
                [Measures].CurrentMember
            ),
            (
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка жилищного хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению жилищные услуги по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) + LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги электроснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги теплоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги водоснабжения и водоотведения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )+
                LookupCube
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "
                    (
                        [Measures].[<%selected_fo_measure%>],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [Показатели].[СопМесОСпРасх].[Все показатели].[Поддержка коммунального хозяйства, всего].[компенсация выпадающих доходов организациям, предоставляющим населению услуги газоснабжения по тарифам, не обеспечивающим возмещение издержек],
                        [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                        " + MemberToStr
                        (
                            [Территории].[Сопоставимый].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Период].[Период].CurrentMember
                        ) + "
                    )"
                )
            ) / 1000
        )'
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ полож]
    as 'IIF
        (
            [Measures].[Объем неэффективных расходов в сфере ЖКХ] < 0 or              IsEmpty
            (
                [Measures].[Объем неэффективных расходов в сфере ЖКХ]
            ),
            0,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ]
        ) '
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]
            ) or
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]
        )'
    member [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]
            ) or
            (
                [Measures].[Общий объем расходов консолидированного бюджета на ЖКХ]
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            [Measures].[Объем неэффективных расходов в сфере ЖКХ полож] / [Measures].[Общий объем расходов консолидированного бюджета]
        )'
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Min]
    as 'Min
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
        )'
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max]
    as 'Max
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
        )'
    member [Measures].[Уровень эффективности бюджетных расходов]
    as 'IIF
        (
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Min]
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ]
            ) /
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов на ЖКХ Min]
            )
        )'
select
    {
        [Measures].[Уровень эффективности бюджетных расходов],
        [Measures].[Объем неэффективных расходов в сфере ЖКХ полож],
        [Measures].[Доля неэффективных расходов в общей сумме расходов субъекта]
    } on columns,
    {
       [Субъекты]
    } on rows
from [ФК_МесОтч_Расходы]
where
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
    )
  ]]>
  </query>

</root>