<?xml version="1.0" encoding="Windows-1251"?>
<root>
  
  <query id="Food_0005_0001_date">
    <![CDATA[ -- Food_0005_0001_date
with
    member [Measures].[Дата]
    as '[Период__День].[Период__День].CurrentMember.UniqueName'
    member [Measures].[Ключ]
    as '[Период__День].[Период__День].CurrentMember.Properties("MEMBER_KEY")'
    set [Даты]
    as 'order
        (
            tail
            (
                filter
                (
                    [Период__День].[Период__День].[День].Members,
                    [Measures].[Средняя цена] > 0 and not IsEmpty([Measures].[Средняя цена])
                ),
                2
            ),
            [Measures].[Ключ],
            desc
        )'
select
    [Measures].[Дата] on columns,
    [Даты] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Значение не указано],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Продовольственные товары],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].DataMember
    )
    ]]>
  </query>

  <query id="Food_0005_0001_data">
    <![CDATA[ -- Food_0005_0001_data
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Средняя цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Средняя цена],
            <%prev_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    set [Продукты]
    as 'filter
        (
            descendants
            (
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Продовольственные товары],
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Уровень 3],
                self
            ),
            not IsEmpty([Measures].[Темп прироста])
        )'
    set [Продукты с повышением]
    as 'head
        (
            order
            (
                filter
                (
                    [Продукты],
                    [Measures].[Темп прироста] > 0
                ),
                [Measures].[Темп прироста],
                BDESC
            ),
            3
        )'
    set [Продукты с понижением]
    as 'head
        (
            order
            (
                filter
                (
                    [Продукты],
                    [Measures].[Темп прироста] < 0
                ),
                [Measures].[Темп прироста],
                BASC
            ),
            3
        )'
    set [Продукты без изменений]
    as 'filter
        (
            [Продукты],
            [Measures].[Темп прироста] = 0
        )'
select
    {
        [Measures].[Темп прироста],
        [Measures].[Цена на последнюю дату],
        [Measures].[Цена на предыдущую дату]
    } on columns,
    non empty
    {
        [Продукты с повышением] + [Продукты с понижением] + [Продукты без изменений]
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].DataMember,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )
    ]]>
  </query>

  <query id="Food_0005_0001_v_text_hmao">
    <![CDATA[ -- Food_0005_0001_v_text_hmao
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Средняя цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Средняя цена],
            <%prev_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Темп роста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату],
            null
        )'
    member [Measures].[Уникальное имя]
    as '[Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember.UniqueName'
    member [Measures].[Единица измерения]
    as '[Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember.Properties("Единица измерения")'
    set [Продукты]
    as 'filter
        (
            descendants
            (
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Продовольственные товары],
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Уровень 3],
                self
            ),
            not IsEmpty([Measures].[Темп прироста])
        )'
select
    {
        [Measures].[Темп прироста],
        [Measures].[Темп роста],
        [Measures].[Уникальное имя],
        [Measures].[Единица измерения]
    } on columns,
    non empty
    {
        [Продукты]
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].DataMember,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )    
    ]]>
  </query>

  <query id="Food_0005_0001_v_one_food_stat_data">
    <![CDATA[ -- Food_0005_0001_v_one_food_stat_data
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Средняя цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Средняя цена],
            <%prev_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Темп роста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату],
            null
        )'
    set [МО]
    as '
        {
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Нижневартовск],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Сургут],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Ханты-Мансийск],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Белоярский муниципальный район].[гп Белоярский]
        }'
select
    { [Measures].[Темп прироста], [Measures].[Темп роста], [Measures].[Цена на последнюю дату], [Measures].[Цена на предыдущую дату] } on columns,
    { [МО] } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        <%food%>,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )    
    ]]>
  </query>
  
  <query id="Food_0005_0001_v_one_food_data">
    <![CDATA[ -- Food_0005_0001_v_one_food_data
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Цена],
            <%prev_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Темп роста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату],
            null
        )'
    set [МО]
    as '
        {
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Белоярский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Березовский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Когалым],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Лангепас],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Мегион],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Нефтеюганск],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Нягань],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Покачи],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Пыть-Ях],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Радужный],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Урай],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Город Югорск],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Кондинский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Нефтеюганский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Нижневартовский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Октябрьский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Советский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Сургутский муниципальный район],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].[Ханты-Мансийский муниципальный район]
        }'
    set [Организации]
    as '[Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children'
select
    [Организации] * {
        [Measures].[Цена на последнюю дату],
        [Measures].[Цена на предыдущую дату]
    } on columns,
    non empty { [МО] } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Департамент экономики],
        <%food%>,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )    
    ]]>
  </query>

  <query id="Food_0005_0001_v_grid_hmao">
    <![CDATA[ -- Food_0005_0001_v_grid_hmao
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Средняя цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Средняя цена],
            <%prev_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Прирост]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] - [Measures].[Цена на предыдущую дату],
            null
        )'
    set [Продукты]
    as 'filter
        (
            descendants
            (
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Продовольственные товары],
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Уровень 3],
                self
            ),
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            )
        )'
    member [Measures].[Единица измерения]
    as '[Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember.Properties("Единица измерения")'
select
    {
        [Measures].[Цена на последнюю дату],
        [Measures].[Цена на предыдущую дату],
        [Measures].[Прирост],
        [Measures].[Темп прироста],
        [Measures].[Единица измерения]
    } on columns,
    [Продукты] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].DataMember,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )    
    ]]>
  </query>

  <query id="Food_0005_0001_v_grid_rf">
    <![CDATA[ -- Food_0005_0001_v_grid_rf
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Цена],
            <%prev_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Прирост]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] - [Measures].[Цена на предыдущую дату],
            null
        )'
    set [Продукты]
    as 'filter
        (
            descendants
            (
                [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции],
                [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Продукция],
                self
            ),
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            )
        )'
    member [Measures].[Единица измерения]
    as '[Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember.Properties("Единица измерения")'
select
    {
        [Measures].[Цена на последнюю дату],
        [Measures].[Цена на предыдущую дату],
        [Measures].[Прирост],
        [Measures].[Темп прироста],
        [Measures].[Единица измерения]
    } on columns,
    [Продукты] on rows
from [ФСГС_Цены РФ]
where
    (
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена]
    )   
    ]]>
  </query>

  <query id="Food_0005_0001_h_year">
    <![CDATA[ -- Food_0005_0001_h_year
with
    member [Measures].[Дата]
    as '[Период__День].[Период__День].CurrentMember.UniqueName'
    set [Даты]
    as 'order
        (
            head
            (
                filter
                (
                    descendants
                    (
                        <%year%>,
                        [Период__День].[Период__День].[День]
                    ),
                    [Measures].[Средняя цена] > 0 and not IsEmpty([Measures].[Средняя цена])
                ),
                1
            ),
            [Measures].[Дата],
            asc
        )'
select
    [Measures].[Дата] on columns,
    [Даты] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Значение не указано],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Продовольственные товары],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].DataMember
    )    
    ]]>
  </query>

  <query id="Food_0005_0001_h_year_rf">
    <![CDATA[ -- Food_0005_0001_h_year_rf
with
    member [Measures].[Дата]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    member [Measures].[Ключ]
    as '[Период__День].[Период__День].CurrentMember.Properties("MEMBER_KEY")'
    set [Даты]
    as 'order
        (
            head
            (
                filter
                (
                    descendants
                    (
                        <%year%>,
                        [Период__Период].[Период__Период].[День]
                    ),
                    [Measures].[Цена] > 0 and not IsEmpty([Measures].[Цена]) and
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ),
                1
            ),
            [Measures].[Ключ],
            asc
        )'
select
    [Measures].[Дата] on columns,
    [Даты] on rows
from [ФСГС_Цены РФ]
where
    (
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember
    )    
    ]]>
  </query>

  <query id="Food_0005_0001_h_grid_hmao">
    <![CDATA[ -- Food_0005_0001_h_grid_hmao
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Средняя цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Средняя цена],
            <%prev_date%>
        )'
    member [Measures].[Цена на начало года]
    as '
        (
            [Measures].[Средняя цена],
            <%year_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Прирост]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] - [Measures].[Цена на предыдущую дату],
            null
        )'
    member [Measures].[Темп прироста к началу года]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на начало года]
            ) and
            (
                [Measures].[Цена на начало года] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на начало года] - 1,
            null
        )'
    member [Measures].[Прирост к началу года]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на начало года]
            ) and
            (
                [Measures].[Цена на начало года] > 0
            ),
            [Measures].[Цена на последнюю дату] - [Measures].[Цена на начало года],
            null
        )'
    set [Продукты]
    as 'filter
        (
            descendants
            (
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Продовольственные товары],
                [Организации__Товары и услуги].[Организации__Товары и услуги].[Уровень 3],
                self
            ),
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            )
        )'
    member [Measures].[Единица измерения]
    as '[Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember.Properties("Единица измерения")'
select
    {
        [Measures].[Цена на последнюю дату],
        [Measures].[Цена на предыдущую дату],
        [Measures].[Прирост],
        [Measures].[Темп прироста],
        [Measures].[Цена на начало года],
        [Measures].[Прирост к началу года],
        [Measures].[Темп прироста к началу года],
        [Measures].[Единица измерения]
    } on columns,
    [Продукты] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].DataMember,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )    
    ]]>
  </query>

  <query id="Food_0005_0001_h_grid_rf">
    <![CDATA[ -- Food_0005_0001_h_grid_rf
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Цена],
            <%prev_date%>
        )'
    member [Measures].[Цена на начало года]
    as '
        (
            [Measures].[Цена],
            <%year_date%>
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1,
            null
        )'
    member [Measures].[Прирост]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) and
            (
                [Measures].[Цена на предыдущую дату] > 0
            ),
            [Measures].[Цена на последнюю дату] - [Measures].[Цена на предыдущую дату],
            null
        )'
    member [Measures].[Темп прироста к началу года]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на начало года]
            ) and
            (
                [Measures].[Цена на начало года] > 0
            ),
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на начало года] - 1,
            null
        )'
    member [Measures].[Прирост к началу года]
    as 'iif
        (
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) and
            (
                [Measures].[Цена на последнюю дату] > 0
            ) and not IsEmpty
            (
                [Measures].[Цена на начало года]
            ) and
            (
                [Measures].[Цена на начало года] > 0
            ),
            [Measures].[Цена на последнюю дату] - [Measures].[Цена на начало года],
            null
        )'
    set [Продукты]
    as 'filter
        (
            descendants
            (
                [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции],
                [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Продукция],
                self
            ),
            not IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            )
        )'
    member [Measures].[Единица измерения]
    as '[Продукция__Сопоставимый].[Продукция__Сопоставимый].CurrentMember.Properties("Единица измерения")'
select
    {
        [Measures].[Цена на последнюю дату],
        [Measures].[Цена на предыдущую дату],
        [Measures].[Прирост],
        [Measures].[Темп прироста],
        [Measures].[Цена на начало года],
        [Measures].[Прирост к началу года],
        [Measures].[Темп прироста к началу года],
        [Measures].[Единица измерения]
    } on columns,
    [Продукты] on rows
from [ФСГС_Цены РФ]
where
    (
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember,
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена]
    )   
    ]]>
  </query>

</root>