<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0016_0004_date">
    <![CDATA[
-- FO_0016_0004_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
                    )
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_БККУ_Показатели]
]]>
  </query>


  <query id="FO_0016_0004_grid">
    <![CDATA[
-- FO_0016_0004_grid
with 
    set [Список районов] 
    as 'Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО" 
            ) or 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
            )  
        ) '  
    set [Список показателей] 
    as ' 
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6] 
        } ' 
    member  [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование района]
    as ' [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Группа] 
    as ' 
        (
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО],
            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>] 
        )' 
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Нормативное значение] 
    as '
       [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Пороговое значение") 
       ' 
    set [Непустые показатели] 
    as ' 
        {
            {
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование района] 
            } 
            *{[Measures].[Значение]} 
        } + 
        {
            {
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Группа] 
            } 
            *{[Measures].[Значение]} 
        }+ nonEmptyCrossJoin 
        (
            {
                [Список показателей] 
                * 
                {
                    [Measures].[Значение],
                    [Measures].[Количество нарушений]                   
                } 
            } 
        )'
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений] 
    as 'Sum
        (
            [Список показателей],
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
        )' 
select
    {
        [Непустые показатели] + 
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений]
        }*[Measures].[Количество нарушений]
    } on columns,
    {
        {
            [Районы__Сопоставимый].[Районы__Сопоставимый].[Нормативное значение] 
        }+[Список районов] 
    } on rows 
from  [ФО_БККУ_Показатели] 
where 
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]
    ) 
    ]]>
  </query>

  <query id="FO_0016_0004_indicatorDescription">
    <![CDATA[
-- FO_0016_0004_indicatorDescription
  with      
    set [Список районов]      
    as 'Filter      
        (
            Descendants      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF      
            ),
            not      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember      
            ) and not      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Несопоставленные данные]      
            ) and not      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Консолидированный бюджет - Ханты-Мансийский автономный округ]      
            ) and not      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Неуказанный территориальный признак]      
            ) and not      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Бюджет Субъекта - Ханты-Мансийский автономный округ]      
            )      
        )'      
    set [Список показателей]      
    as '      
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 1],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 2],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 3],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 4],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5],
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 6]      
        } '      
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Группа]      
    as '      
        (
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО],
            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>]      
        )'    
    set [Непустые показатели]  
    as '
        {
            [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Группа]
        } + nonEmptyCrossJoin ([Список показателей] )' 
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Имя] 
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Обозначение")' 
select
    {
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Имя]
    } on columns,
    { [Непустые показатели] } on rows      
from  [ФО_БККУ_Показатели]      
where      
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]     
    )       
    ]]>
  </query>
  
</root>
