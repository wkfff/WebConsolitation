<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="Grid_1">
    <![CDATA[with
    member [Measures].[calc1]
    as 'iif
        (
            [Measures].[План по начислению_ОП] <> 0,
            100
            *[Measures].[Начислено фактически_ОП]/[Measures].[План по начислению_ОП],
            null
        )'
    member [Measures].[calc2]
    as 'iif
        (
            [Measures].[План по сбору_ОП] <> 0,
            100
            *[Measures].[Оплачено фактически_ОП] / [Measures].[План по сбору_ОП] ,
            null
        )'
    member [Measures].[calc3]
    as 'iif
        (
            [Measures].[План по начислению_НИ] <> 0,
            100
            *[Measures].[Начислено фактически_НИ]/[Measures].[План по начислению_НИ] ,
            null
        )'
    member [Measures].[calc4]
    as 'iif
        (
            [Measures].[План по сбору_НИ] <> 0,
            100
            *[Measures].[Оплачено фактически_НИ]/[Measures].[План по сбору_НИ],
            null
        )'
    member [Measures].[За отчетный месяц_План_Начислений]
    as '[Measures].[План по начислению_ОП]'
    member [Measures].[За отчетный месяц_План_Оплаты]
    as '[Measures].[План по сбору_ОП]'
    member [Measures].[За отчетный месяц_Факт_Начислений]
    as '[Measures].[Начислено фактически_ОП]'
    member [Measures].[За отчетный месяц_Факт_Оплаты]
    as '[Measures].[Оплачено фактически_ОП]'
    member [Measures].[За отчетный месяц_% исполнения_Начислений]
    as '[Measures].[calc1]'
    member [Measures].[За отчетный месяц_% исполнения_Оплаты]
    as '[Measures].[calc2]'
    
    member [Measures].[Нарастающим итогом за год_План_Начислений]
    as '[Measures].[План по начислению_НИ]'
    member [Measures].[Нарастающим итогом за год_План_Оплаты]
    as '[Measures].[План по сбору_НИ]'
    member [Measures].[Нарастающим итогом за год_Факт_Начислений]
    as '[Measures].[Начислено фактически_НИ]'
    member [Measures].[Нарастающим итогом за год_Факт_Оплаты]
    as '[Measures].[Оплачено фактически_НИ]'
    member [Measures].[Нарастающим итогом за год_% исполнения_Начислений]
    as '[Measures].[calc3]'
    member [Measures].[Нарастающим итогом за год_% исполнения_Оплаты]
    as '[Measures].[calc4]'
    
    member [curorg]
    as '<%SelectRegion%>.unique_name'
    
        member [Организации__Реестр организаций].[Организации__Реестр организаций].[curorg]
as '    filter([Организации__Реестр организаций].[Организации__Реестр организаций].members,
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.unique_name = [curorg] and
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("инн") = "<%INN%>" and
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("REFREGIONAN") = "<%childreg%>").item(0)'
select
    {
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[от населения, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[от бюджетофинансируемых организаций, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[от прочих потребителей, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка (водоснабжение и канализование), тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Прочие доходы, тыс.руб.]
    } on columns,
    {
        [Measures].[План на год],
        [Measures].[За отчетный месяц_План_Начислений],
        [Measures].[За отчетный месяц_План_Оплаты],
        [Measures].[За отчетный месяц_Факт_Начислений],
        [Measures].[За отчетный месяц_Факт_Оплаты],
        [Measures].[За отчетный месяц_% исполнения_Начислений],
        [Measures].[За отчетный месяц_% исполнения_Оплаты],
        
        [Measures].[Нарастающим итогом за год_План_Начислений],
        [Measures].[Нарастающим итогом за год_План_Оплаты],
        [Measures].[Нарастающим итогом за год_Факт_Начислений],
        [Measures].[Нарастающим итогом за год_Факт_Оплаты],
        [Measures].[Нарастающим итогом за год_% исполнения_Начислений],
        [Measures].[Нарастающим итогом за год_% исполнения_Оплаты]
    } on rows
from [ОРГАНИЗАЦИИ_Сбор по ЖКХ]  
where([Организации__Реестр организаций].[Организации__Реестр организаций].[curorg],<%Date%>)
    ]]>
  </query>
  <query id="Grid_2">
    <![CDATA[with
    member [Measures].[calc1]
    as 'iif
        (
            [Measures].[План по начислению_ОП] <> 0,
            100
            *[Measures].[Начислено фактически_ОП]/[Measures].[План по начислению_ОП],
            null
        )'
    member [Measures].[calc2]
    as 'iif
        (
            [Measures].[План по сбору_ОП] <> 0,
            100
            *[Measures].[Оплачено фактически_ОП] / [Measures].[План по сбору_ОП] ,
            null
        )'
    member [Measures].[calc3]
    as 'iif
        (
            [Measures].[План по начислению_НИ] <> 0,
            100
            *[Measures].[Начислено фактически_НИ]/[Measures].[План по начислению_НИ] ,
            null
        )'
    member [Measures].[calc4]
    as 'iif
        (
            [Measures].[План по сбору_НИ] <> 0,
            100
            *[Measures].[Оплачено фактически_НИ]/[Measures].[План по сбору_НИ],
            null
        )'
    member [Measures].[За отчетный месяц_План_Начислений]
    as '[Measures].[План по начислению_ОП]'
    member [Measures].[За отчетный месяц_План_Оплаты]
    as '[Measures].[План по сбору_ОП]'
    member [Measures].[За отчетный месяц_Факт_Начислений]
    as '[Measures].[Начислено фактически_ОП]'
    member [Measures].[За отчетный месяц_Факт_Оплаты]
    as '[Measures].[Оплачено фактически_ОП]'
    member [Measures].[За отчетный месяц_% исполнения_Начислений]
    as '[Measures].[calc1]'
    member [Measures].[За отчетный месяц_% исполнения_Оплаты]
    as '[Measures].[calc2]'
    
    member [Measures].[Нарастающим итогом за год_План_Начислений]
    as '[Measures].[План по начислению_НИ]'
    member [Measures].[Нарастающим итогом за год_План_Оплаты]
    as '[Measures].[План по сбору_НИ]'
    member [Measures].[Нарастающим итогом за год_Факт_Начислений]
    as '[Measures].[Начислено фактически_НИ]'
    member [Measures].[Нарастающим итогом за год_Факт_Оплаты]
    as '[Measures].[Оплачено фактически_НИ]'
    member [Measures].[Нарастающим итогом за год_% исполнения_Начислений]
    as '[Measures].[calc3]'
    member [Measures].[Нарастающим итогом за год_% исполнения_Оплаты]
    as '[Measures].[calc4]'
    member [curorg]
    as '<%SelectRegion%>.unique_name'
    
    member [Организации__Реестр организаций].[Организации__Реестр организаций].[curorg]
as '    filter([Организации__Реестр организаций].[Организации__Реестр организаций].members,
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.unique_name = [curorg] and
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("инн") = "<%INN%>" and
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("REFREGIONAN") = "<%childreg%>").item(0)'
select
    {
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Расходы-всего (без НДС), тыс.руб., т.ч.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[уголь (с доставкой), тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[газ (с доставкой), тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[прочее, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Электроэнергия на хозяйственные нужды, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Оплата труда, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Ремонты, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Прочие расходы, тыс.руб.]
    } on columns,
    {
        [Measures].[План на год],
        [Measures].[За отчетный месяц_План_Начислений],
        [Measures].[За отчетный месяц_План_Оплаты],
        [Measures].[За отчетный месяц_Факт_Начислений],
        [Measures].[За отчетный месяц_Факт_Оплаты],
        [Measures].[За отчетный месяц_% исполнения_Начислений],
        [Measures].[За отчетный месяц_% исполнения_Оплаты],
        
        [Measures].[Нарастающим итогом за год_План_Начислений],
        [Measures].[Нарастающим итогом за год_План_Оплаты],
        [Measures].[Нарастающим итогом за год_Факт_Начислений],
        [Measures].[Нарастающим итогом за год_Факт_Оплаты],
        [Measures].[Нарастающим итогом за год_% исполнения_Начислений],
        [Measures].[Нарастающим итогом за год_% исполнения_Оплаты]
    } on rows
from [ОРГАНИЗАЦИИ_Сбор по ЖКХ]
where([Организации__Реестр организаций].[Организации__Реестр организаций].[curorg],<%Date%>)]]>
  </query>
  <query id="Grid_3">
    <![CDATA[with 
    member [Measures].[calc1] 
    as 'iif 
        (
            [Measures].[План по начислению_ОП] <> 0,
            100 
            *[Measures].[Начислено фактически_ОП]/[Measures].[План по начислению_ОП],
            null 
        )' 
    member [Measures].[calc2] 
    as 'iif 
        (
            [Measures].[План по сбору_ОП] <> 0,
            100 
            *[Measures].[Оплачено фактически_ОП] / [Measures].[План по сбору_ОП] ,
            null 
        )' 
    member [Measures].[calc3] 
    as 'iif 
        (
            [Measures].[План по начислению_НИ] <> 0,
            100 
            *[Measures].[Начислено фактически_НИ]/[Measures].[План по начислению_НИ] ,
            null 
        )' 
    member [Measures].[calc4] 
    as 'iif 
        (
            [Measures].[План по сбору_НИ] <> 0,
            100 
            *[Measures].[Оплачено фактически_НИ]/[Measures].[План по сбору_НИ],
            null 
        )' 
    member [Measures].[За отчетный месяц_План_Начислений] 
    as '[Measures].[План по начислению_ОП]' 
    member [Measures].[За отчетный месяц_План_Оплаты] 
    as '[Measures].[План по сбору_ОП]' 
    member [Measures].[За отчетный месяц_Факт_Начислений] 
    as '[Measures].[Начислено фактически_ОП]' 
    member [Measures].[За отчетный месяц_Факт_Оплаты] 
    as '[Measures].[Оплачено фактически_ОП]' 
    member [Measures].[За отчетный месяц_% исполнения_Начислений] 
    as '[Measures].[calc1]' 
    member [Measures].[За отчетный месяц_% исполнения_Оплаты] 
    as '[Measures].[calc2]'  
    member [Measures].[Нарастающим итогом за год_План_Начислений] 
    as '[Measures].[План по начислению_НИ]' 
    member [Measures].[Нарастающим итогом за год_План_Оплаты] 
    as '[Measures].[План по сбору_НИ]' 
    member [Measures].[Нарастающим итогом за год_Факт_Начислений] 
    as '[Measures].[Начислено фактически_НИ]' 
    member [Measures].[Нарастающим итогом за год_Факт_Оплаты] 
    as '[Measures].[Оплачено фактически_НИ]' 
    member [Measures].[% исполнения_Начислений] 
    as '[Measures].[calc3]' 
    member [Measures].[Нарастающим итогом за год_% исполнения_Оплаты] 
    as '[Measures].[calc4]' 
    member [Measures].[План]
    as '[Measures].[План по начислению_НИ]'
    member [Measures].[Факт]
    as '[Measures].[Начислено фактически_НИ]'
    member [Measures].[% исполнения]
    as '[Measures].[% исполнения_Начислений] '
    
    member [curorg]
    as '<%SelectRegion%>.unique_name'
    
    member [Организации__Реестр организаций].[Организации__Реестр организаций].[curorg]
as '    filter([Организации__Реестр организаций].[Организации__Реестр организаций].members,
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.unique_name =  [curorg] and
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("инн") = "<%INN%>" and
    [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("REFREGIONAN") = "<%childreg%>").item(0)'
select
    {
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Дебиторская задолженность на конец периода, тыс.руб., в т.ч.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[населения, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[бюджетофинансируемых организаций, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[прочих потребителей, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Дебиторская задолженность (водоснабжение и канализация), тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Прочая дебиторская задолженность, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Кредиторская задолженность на конец периода, тыс.руб., в т.ч.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[уголь (с доставкой), тыс. руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[газ (с доставкой), тыс. руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[прочее, тыс. руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Электроэнергия на хозяйственные нужды, тыс. руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Перед персоналом, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[По ремонтам, тыс.руб.],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Прочие кредиторы, тыс.руб.] 
    } on columns,
    {
        [Measures].[План],
        [Measures].[Факт],
        [Measures].[% исполнения]
    } on rows 
from [ОРГАНИЗАЦИИ_Сбор по ЖКХ]
where([Организации__Реестр организаций].[Организации__Реестр организаций].[curorg],<%Date%>)]]>
  </query>
  <query id = "ComboMounth">
    <![CDATA[with       
    member [Measures].[План - на год]     
    as ' ( [Measures].[План на год] )'        
    member [Measures].[План - на текущий месяц]     
    as '      
        (
            [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
            [Measures].[План по сбору_ОП]      
        )'       
    member [Measures].[Факт - с начала года]     
    as '      
        (
            [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
            [Measures].[Оплачено фактически_НИ]      
        )'        
    member [Measures].[Факт - % исполнения плана с начала года]     
    as ' IIf      
        (
            (
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
                [Measures].[План по сбору_ОП]      
            ) > 0,
            (
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
                [Measures].[Оплачено фактически_ОП]      
            ) /       
            (
                [Measures].[План по сбору_ОП],
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.]      
            )       
            * 100,
            null      
        )'      
    member  [Measures].[Факт - Темп роста к предыдущему месяцу]     
    as ' IIf      
        (
            (
                /*PrevDate*/ [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
                [Measures].[Оплачено фактически_ОП]      
            ) > 0,
            (
                /*CurDate*/ [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
                [Measures].[Оплачено фактически_ОП]      
            ) /      
            (
                /*PrevDate*/ [Measures].[План по сбору_ОП],
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.]      
            )      
            * 100,
            null      
        )'     
    member [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Доля расходов на топливо в общем объеме доходов нарастающим итогом за год]  
    as 'IIf  
        (
            [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.]>0,
            100  
            *[Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Топливо, тыс.руб., в т.ч.] /  [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
            null  
        )'   
    member [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[UnamePeriod]  
    as '[Период__Период].[Период__Период].currentmember.unique_name'  
    member [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Year] 
    as '[Период__Период].[Период__Период].currentmember.parent.parent.parent.name' 
    member [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Mounth] 
    as '[Период__Период].[Период__Период].currentmember.name' 
    member [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Sum] 
    as 'Aggregate
        (
            {
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.],
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Расходы-всего (без НДС), тыс.руб., т.ч.],
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Отпущено потребителям в натуральном выражении тепловой энергии, Гкал],
                [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Себестоимость (без НДС), рублей, 1 Гкал]
            },
            [Measures].[План на год]
        )'  
select
    {
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[UnamePeriod],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Year],
        [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Mounth] 
    } on columns,
    non empty        
    {
        Filter
        (
            [Период__Период].[Период__Период].[Месяц].Members ,
[Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Sum] >0
        ) 
    } on rows  
from [ОРГАНИЗАЦИИ_Сбор по ЖКХ]  
where        
    (
        [Measures].[План на год],
        [Источники данных].[Источники данных].[Источник].[ОРГАНИЗАЦИИ Сбор по ЖКХ],
        [Организации__Состояние данных].[Организации__Состояние данных].[Состояние].[Заблокирован],
        [Организации__Реестр организаций].[Организации__Реестр организаций].[Организация] 
    )   
    ]]>
  </query>
  <query id = "ComboRegion">
    <![CDATA[with
    member [Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Sum]
    as 'Aggregate
        (
            {
[Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Все показатели].[Выручка всего (с НДС), тыс.руб., в т.ч.]
            },
            [Measures].[План на год]
        )'
    member [UniqueName]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.unique_name'
    member [level]
    as 'iif([Организации__Реестр организаций].[Организации__Реестр организаций].currentmember is [Организации__Реестр организаций].[Организации__Реестр организаций].[Все организации],
    0,1)'
    member [DisplayName]
    as 'iif([Организации__Реестр организаций].[Организации__Реестр организаций].currentmember is [Организации__Реестр организаций].[Организации__Реестр организаций].[Все организации],
    [Районы__Анализ].[Районы__Анализ].currentmember.name,[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.Name)'
    member [Name]
    as 'iif([Организации__Реестр организаций].[Организации__Реестр организаций].currentmember is [Организации__Реестр организаций].[Организации__Реестр организаций].[Все организации],
    [Районы__Анализ].[Районы__Анализ].currentmember.name,[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.Name)'
    member [Measures].[RefRegionID]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("REFREGIONAN")'
member [Measures].[RefRegion]
    as '
        (
            filter
            (
                [Районы__Анализ].[Районы__Анализ].members,
                [Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("REFREGIONAN")   = [Районы__Анализ].[Районы__Анализ].currentmember.properties("member_key")
            ).item(0).name
        )'
    member [Measures].[иин]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.properties("ИНН")'
    
select
    {
    [Measures].[RefRegionID],
    [Name],
    [Measures].[RefRegion],
    [Measures].[иин],
    [UniqueName],
[Measures].[План на год],
[level],
[DisplayName]
    } on columns,
    non empty
    {

        Filter
        (
Crossjoin( [Районы__Анализ].[Районы__Анализ].[Уровень 3].members,

[Организации__Реестр организаций].[Организации__Реестр организаций].members
),
[Организации__Показатели ЖКХ].[Организации__Показатели ЖКХ].[Sum] >0)
    } on rows
from [ОРГАНИЗАЦИИ_Сбор по ЖКХ]
where
    (

        [Источники данных].[Источники данных].[Источник].[ОРГАНИЗАЦИИ Сбор по ЖКХ],
        [Организации__Состояние данных].[Организации__Состояние данных].[Состояние].[Заблокирован]
    )
    ]]>
  </query>

  <query id = "PeriodAlovalebleFirstGrid">
    <![CDATA[with
    
    set [set_test]
    as
    '
filter([Период__Период].[Период__Период].[День].members,
           [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)]>0)
    '
member [Период__Период].[Период__Период].[Last]
as '        Max([set_test])'
    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников организаций и предприятий, человек в % к трудовым ресурсам]  
    as '  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий]  
        )'  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[   в % к трудовым ресурсам]  
    as '   
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий] 
        ) / 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)] ,
            [Период__Период].[Период__Период].[Last]
        )  '  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников крупных и средних организаций, человек]  
    as '  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников крупных и средних организаций]  
        )'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_PP]
    as '[Период__Период].[Период__Период].currentmember.parent.parent.parent.parent.name'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_P]
    as '[Период__Период].[Период__Период].currentmember.parent.name'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_U]
    as '[Период__Период].[Период__Период].currentmember.unique_name'
    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[sumf]
    as 'Sum({<%Fields%>}, [Measures].[Значение])'
         
SELECT
    {
    [Показатели__Рынок труда].[Показатели__Рынок труда].[day_P],
    [Показатели__Рынок труда].[Показатели__Рынок труда].[day_U]

    }on rows  ,
   non empty {
   
   filter(
       [Период__Период].[Период__Период].[День].members,
       [Показатели__Рынок труда].[Показатели__Рынок труда].[sumf]>0and
       [Показатели__Рынок труда].[Показатели__Рынок труда].[day_PP]="2011")
           } on columns
FROM [СТАТ_Мониторинг ситуации на рынке труда]  
where  
    (
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область] 
    )
    ]]>
  </query>
  <query id = "PeriodAlovalebleSecondGrid">
    <![CDATA[   
    with
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников организаций и предприятий, человек в % к трудовым ресурсам]
    as '
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий]
        )'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[   в % к трудовым ресурсам]
    as '
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий]
        ) /
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)] ,
            [Период__Период].[Период__Период].[Last]
        )  '
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников крупных и средних организаций, человек]
    as '
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников крупных и средних организаций]
        )'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_PP]
    as '[Период__Период].[Период__Период].currentmember.parent.parent.parent.parent.name'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_P]
    as '[Период__Период].[Период__Период].currentmember.parent.name'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_U]
    as '[Период__Период].[Период__Период].currentmember.unique_name'

    member [Показатели__Рынок труда].[Показатели__Рынок труда].[sumf]
    as 'Sum({        [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность работающих в режиме неполного рабочего времени]}, [Measures].[Значение])'

SELECT
    {
    [Показатели__Рынок труда].[Показатели__Рынок труда].[day_P],
    [Показатели__Рынок труда].[Показатели__Рынок труда].[day_U]

    }on rows  ,
   non empty {

   filter(
       [Период__Период].[Период__Период].[День].members,
       [Показатели__Рынок труда].[Показатели__Рынок труда].[sumf]>0and
       [Показатели__Рынок труда].[Показатели__Рынок труда].[day_PP]="2011")
           } on columns
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where
    (
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область]
    )
    ]]>
  </query>

  <query id = "Grid">
    <![CDATA[
    --Grid
    with
    <%WithZoneDate%>
    
    
          set [set_test]
    as
    '
filter([Период__Период].[Период__Период].[День].members,
           [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)]>0)
    '
member [Период__Период].[Период__Период].[Last]
as '        Max([set_test])'
    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников организаций и предприятий, человек в % к трудовым ресурсам]  
    as '  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий]  
        )'  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[   в % к трудовым ресурсам]  
    as ' iif(  (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)] ,
            [Период__Период].[Период__Период].[Last]
        )  <>0,
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий] 
        ) / 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)] ,
            [Период__Период].[Период__Период].[Last]
        )  ,null)'  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников крупных и средних организаций, человек]  
    as '  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников крупных и средних организаций]  
        )'  
    SELECT
    {
     <%Fields%>
    }on rows  ,
    {
        <%Dates%>
    } on columns   
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where 
    (
        <%ActiveRegion%> --,[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО]
    ) 
    ]]>
  </query>
  <query id = "GridRang">
    <![CDATA[
with   
    <%WithZoneDate%>
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения ]
    as '(--<%ActiveRegion%>.datamember,
    [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения])'    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень трудоустройства ]
    as '(--<%ActiveRegion%>.datamember,
    [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень трудоустройства ищущих работу граждан])'
SELECT
    {
       [Показатели__Рынок труда].[Показатели__Рынок труда].[<%FieldForRang%>]
    } on columns,
    non empty
    {
        order
        (
        filter(<%ActiveRegion%>.parent.children,
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember),
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[<%FieldForRang%>]
        ) 
    }on rows 
FROM [СТАТ_Мониторинг ситуации на рынке труда]   
where   
    (
        [Период__Период].[Период__Период].[<%DateForRang%>],
        [Measures].[Значение]
    )]]>
  </query>
  <query id = "Chart">
    <![CDATA[
    with
    <%WithZoneDate%>
    SELECT
    {
           <%ActiveRegion%>.datamember ,
           <%ActiveRegion%>.parent.datamember
    }   on columns,
    non empty    
    {
        <%Dates%>
    }on rows
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where (<%ChangeNavigatorChart%>,
[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО])]]>
  </query>
  <query id = "Chart2">
    <![CDATA[
    with
    <%WithZoneDate%>
    SELECT
    {
    <%ChangeNavigatorChart%>
    } on rows ,
    non empty    
    {
        <%Dates%>
    } on columns
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where (<%ActiveRegion%>,
[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО])]]>
  </query>
  <query id = "Textovka">
    <![CDATA[
    with 
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения_s]
    as
    '([Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень регистрируемой безработицы, % от численности экономически активного населения]
    ,<%ActiveRegion%>.datamember)'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения_fo]
    as
    '([Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень регистрируемой безработицы, % от численности экономически активного населения]
    ,[Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].datamember)'
    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень трудоустройства ищущих работу граждан-s]
    as
    '([Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень трудоустройства ищущих работу граждан]
    ,<%ActiveRegion%>.datamember)'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень трудоустройства ищущих работу граждан-fo]
    as
    '([Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень трудоустройства ищущих работу граждан]
    ,[Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].datamember)'
    
SELECT
    {
        <%LastDate%>,
        <%LastDateCompare%>
    } on columns ,
    {
         [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения_s],
         [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения_fo],
         [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень трудоустройства ищущих работу граждан-s],
         [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень трудоустройства ищущих работу граждан-fo],
         [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность официально зарегистрированных безработных],
         [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете],
         [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий]
         
    }on rows
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where
(<%ActiveRegion%>
,[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО])
    ]]>
  </query>
  <query id = "STAT_0003_0001_chart_description">
    <![CDATA[ -- STAT_0003_0001_chart_description
with
    member [Measures].[День]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
select
    {
        tail
        (
            filter
            (
                [Период__Период].[Период__Период].[Данные всех периодов].[1998].[Полугодие 1].[Квартал 1].[Январь].[1]:<%selected_date%>,
                (
                    ([Measures].[Значение],
                    [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете]) > 0 and
                    ([Measures].[Значение],
                    [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий]) > 0
                )
            ),
            52
        )
    } on columns,
    { [Measures].[День] } on rows
from [СТАТ_Мониторинг ситуации на рынке труда]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская обл.].[Новосибирская область]--.datamember
    )    
    ]]>
  </query>
  
  <query id = "STAT_0003_0001_chart">
    <![CDATA[ -- STAT_0003_0001_chart
select
    {
        tail
        (
            filter
            (
                [Период__Период].[Период__Период].[Данные всех периодов].[1998].[Полугодие 1].[Квартал 1].[Январь].[1]:<%selected_date%>,
                (
                    ([Measures].[Значение],
                    [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете]) > 0 and
                    ([Measures].[Значение],
                    [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий]) > 0
                )
            ),
            52
        )
    } on columns,
    {
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете],
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий]
    } on rows
from [СТАТ_Мониторинг ситуации на рынке труда]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО],
        [Measures].[Значение],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская обл.].[Новосибирская область]--.datamember
    )
    ]]>
  </query>

  <query id = "STAT_0003_0001_map1">
    <![CDATA[  -- STAT_0003_0001_map1
with

member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудоспособного населения в трудоспособном возрасте, человек]
    as '[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудоспособного населения в трудоспособном возрасте]'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность официально зарегистрированных безработных, человек]
    as '[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность официально зарегистрированных безработных]'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень регистрируемой безработицы, % от численности трудоспособного населения в трудоспособном возрасте ]
    as '100*[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность официально зарегистрированных безработных, человек]/[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудоспособного населения в трудоспособном возрасте, человек]'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете, человек]
    as '[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете]'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий, единица]
    as '[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий]'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень напряжённости на рынке труда, единица]
    as '[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете, человек]/
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий, единица]'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Дефицит (-), профицит (+) рабочих мест]
    as '[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Число заявленных вакансий, единица] - [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность незанятых граждан, состоящих на учете, человек]'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень зарегистрированной безработицы, процент]
    as '
        (
            (
                [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность безработных граждан] / [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность экономически активного населения]
            )
            *100
        )'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Краткое наименование района]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Properties("Краткое наименование")'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Код объекта карты]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Properties("Код объекта карты")'
    set [Субъекты округа]
    as 'except
        (
            {
                <%ActiveRegion%>.children
            },
            {
                <%ActiveRegion%>.DataMember
            }
        )'
select
    [Субъекты округа] on rows ,
    non empty
    {
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Краткое наименование района],
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Код объекта карты],
[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность официально зарегистрированных безработных],
--[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень регистрируемой безработицы, % от численности трудоспособного населения в трудоспособном возрасте ]
[Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень регистрируемой безработицы, % от численности трудоспособного населения в трудоспособном возрасте]
    }  on columns
from [СТАТ_Мониторинг ситуации на рынке труда]
where
    (
        [Measures].[Значение],[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО],<%selected_date%>)]]></query>


  
</root>