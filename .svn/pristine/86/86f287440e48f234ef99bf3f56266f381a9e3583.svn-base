<?xml version="1.0" encoding="Windows-1251"?>
<root>
  
  <query id="Food_0006_0004_incomes_date">
    <![CDATA[ -- Food_0006_0004_incomes_date
with
    member [Measures].[ДанныеНа]
    as 'iif
        (
            [Период__День].[Период__День].CurrentMember is [Период__День].[Период__День].[Данные всех периодов].[Единица измерения],
            [Measures].[Единица измерения],
            [Период__День].[Период__День].CurrentMember.UniqueName
        )'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период__День].[Период__День].[День].Members,
                not IsEmpty([Measures].[Цена]) and [Measures].[Цена] > 0
            ),
            2
        )'
    member [Measures].[Текущий год]
    as 'Tail
        (
            Filter
            (
                [Период__День].[Период__День].[Год].Members,
                not IsEmpty([Measures].[Цена]) and [Measures].[Цена] > 0
            ),
            1
        ).Item(0).Name'
    set [Начало года]
    as 'head
        (
            filter
            (
                descendants
                (
                    StrToMember
                    (
                        "[Период__День].[Период__День].[Данные всех периодов].[" + [Measures].[Текущий год] + "]"
                    ),
                    [Период__День].[Период__День].[День],
                    self
                ),
                not IsEmpty([Measures].[Цена]) and [Measures].[Цена] > 0
            ),
            1
        )'
    member [Measures].[Единица измерения]
    as 'LCase
        (
            [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember.Properties("Единица измерения")
        )'
    member [Период__День].[Период__День].[Данные всех периодов].[Единица измерения]
    as 'null'
select
    { [Measures].[ДанныеНа] } on columns,
    {
        [Начало года] + [NonEmptySet] +
        {
            [Период__День].[Период__День].[Данные всех периодов].[Единица измерения]
        }
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[ОРГАНИЗАЦИИ Цены и тарифы],
        <%food%>,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ],
        [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )
    ]]>
  </query>

  <query id="Food_0006_0004_grid_stat">
    <![CDATA[ -- Food_0006_0004_grid_stat
with
    set [Даты]
    as '
        {
            <%period_first_year%>,
            <%period_last_date%>,
            <%period_cur_date%>
        }'
    set [Территории]
    as '
        {
            {
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[г.Губкинский],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[г.Лабытнанги],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[г.Муравленко],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[Надымский район],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[г.Новый Уренгой],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[г.Ноябрьск],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[г.Салехард],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[Красноселькупский район],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[Приуральский район],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[Пуровский район],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[Тазовский район],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[Шурышкарский район],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ].[Ямальский район]
            }
        }'
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Среднее по МО]
    as 'null'
    set [Организации]
    as 'filter(
      [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Среднее по МО] +
      [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children -
      [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Значение не указано],
      [Measures].[Цена] > 0 or
      [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember is [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Среднее по МО])'
    member [Measures].[Цена ЯНАО]
    as 'Avg
        (
            [Территории],
            [Measures].[Цена МО]
        )'
    member [Measures].[Цена МО]
    as 'Avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    set [ЯНАО]
    as '
        {
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ]
        }'
    set [Все организации]
    as '[Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации]'
    member [Measures].[Цена на дату]
    as 'iif
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].[Ямало-Ненецкий автономный округ],
            [Measures].[Цена ЯНАО],
            iif
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember is [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].[Среднее по МО],
                [Measures].[Цена МО],
                [Measures].[Цена]
            )
        )'
select
    [Даты] on columns,
    non empty
    {
        {[ЯНАО] * [Все организации]} + {[Территории] * [Организации]}
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        <%food%>,
        [Measures].[Цена на дату],
        [Источники данных].[Источники данных].[Все источники данных].[ОРГАНИЗАЦИИ Цены и тарифы],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )
    ]]>
  </query>
  
</root>