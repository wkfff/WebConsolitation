CALCULATE;

/* Данные пишутся на кварталы и одновременно на года */
/* Перекрываю агрегирование на уровне Полугодие (Нарастающий итог) */
([Measures].[Значение],
[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Полугодие].Members) = 
  IIF(IsEmpty(([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.DataMember)),
  IIF(IsEmpty(([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.LastChild)),
    ([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.LastChild.PrevMember),
    ([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.LastChild)),
  ([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.DataMember));

/* Перекрываю агрегирование на уровне Год (Нарастающий итог) */
([Measures].[Значение],
[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год].Members) = 
IIF(IsEmpty(([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.DataMember)),
  IIF(IsEmpty(([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.LastChild)),
    ([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.LastChild.PrevMember),
    ([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.LastChild)),
  ([Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.DataMember));