<?xml version="1.0" encoding="Windows-1251"?>
<root>
    <query id="FK_0004_0006_lastDate">
        <![CDATA[
-- FK_0004_0006_lastDate
with  
    set [Месяцы с данными]  
    as 'tail  
        (
            filter  
            (
                [Период__Период].[Период__Период].[Месяц].Members,
                not IsEmpty ( [Measures].[Факт] ) and not 
                (
                    [Measures].[Факт] = 0
                )  
            ),
            1  
        )'  
    member [Measures].[Месяц]  
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'  
    set [Программы] 
    as ' 
        {
            descendants 
            (
                [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы],
                [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Программа],
                SELF 
            ) 
        }' 
    member [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП] 
    as 'aggregate ([Программы])' 
select
    {[Measures].[Месяц]} on columns,
    {[Месяцы с данными]} on rows  
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП]  
where 
    (
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП] 
    ) 
  ]]>
    </query>

    <query id="EO_0002_0004_grid">
        <![CDATA[ -- EO_0002_0004_grid
  with          
    set [Показатели непосредственного результата]    
    as '        
        {
            Filter       
            (
                descendants        
                (
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Все показатели],
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель],
                    SELF        
                ),
                not isEmpty    
                (
                    (
                        [Measures].[План],
                        [Исполнение расходов__Типы показателей].[Исполнение расходов__Типы показателей].[Все типы показателей].[Показатель непосредственного результата]  
                    )   
                )    
            )        
        }'  
    set [Показатели конечного результата]  
    as '  
        {
            Filter  
            (
                descendants  
                (
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Все показатели],
                    [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель],
                    SELF  
                ),
                not isEmpty  
                (
                    (
                        [Measures].[План],
                        [Исполнение расходов__Типы показателей].[Исполнение расходов__Типы показателей].[Все типы показателей].[Показатель конечного результата]  
                    )  
                )  
            )  
        }'  
    Member [Measures].[Имя]      
    as '[Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].CurrentMember.name'      
    Member [Measures].[Базовый показатель на начало реализации программы]      
    as '     
        (
            measures.[Факт],
            [Период__Период].[Период__Период].[2010]     
        )'      
    Member [Measures].[Отчетная дата]      
    as '     
        (
            measures.[Факт],
             <%selected_period%>
        )'      
    Member [Measures].[Значение на год план]      
    as '     
        (
            measures.[План],
             <%selected_period%>.Parent.Parent.Parent       
        )'      
    Member [Measures].[Значение на год факт]     
    as '     
        (
            measures.[факт],
             <%selected_period%>.Parent.Parent.Parent     
        )' 
    Member [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель непосредственных результатов] 
    as 'null' 
    Member [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель конечных результатов] 
    as 'null' 
select
    {
        [Measures].[Базовый показатель на начало реализации программы],
        [Measures].[Отчетная дата],
        [Measures].[Значение на год факт],
        [Measures].[Значение на год план]    
    } on columns,
    {
        [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель непосредственных результатов],
        [Показатели непосредственного результата],
        [Исполнение расходов__Список показателей].[Исполнение расходов__Список показателей].[Показатель конечных результатов],
        [Показатели конечного результата]
    } on rows  
from  [ЭО_Сбор исполнения расходов_Целевые показатели ЦП]        
where        
    (
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Содействие занятости населения на 2011-2013 годы],
         <%selected_period%>.Parent.Parent.Parent        
    )
    ]]>
    </query>

</root>