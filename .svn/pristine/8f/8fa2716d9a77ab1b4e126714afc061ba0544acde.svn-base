CALCULATE;
/*SCOPE([Период__День ФК].[Период__День ФК].members);
this = CalculationPassValue(
  IIF(isEmpty([Период__День ФК].[Период__День ФК].CurrentMember.DataMember),
    [Период__День ФК].[Период__День ФК].CurrentMember,
    [Период__День ФК].[Период__День ФК].CurrentMember.DataMember),
0);
END SCOPE;
*/

//Уровни бюджетов 
([Уровни бюджетов].[Уровни бюджетов].&[6]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[4]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[14]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[7]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[2]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[0]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);
    
CREATE MEMBER CURRENTCUBE.Measures.[Сумма нарастающим итогом] AS /*CalculationPassValue(*/
IIF(
/*[Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[(All)] or
[Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год] or
([Период__Период].[Период__Период].CurrentMember Is OpeningPeriod([Период__Период].[Период__Период].CurrentMember.Level, Ancestor([Период__Период].[Период__Период].CurrentMember, [Период__Период].[Период__Период].[Год]))),
(Measures.[Сумма], [Период__Период].[Период__Период].CurrentMember),
*/
IsLeaf([Период__Период].[Период__Период].CurrentMember),
Sum({OpeningPeriod([Период__Период].[Период__Период].CurrentMember.Level, Ancestor([Период__Период].[Период__Период].CurrentMember, [Период__Период].[Период__Период].[Год])):
[Период__Период].[Период__Период].CurrentMember}, Measures.[Сумма]),
([Период__Период].[Период__Период].CurrentMember.LastChild, [Measures].[Сумма нарастающим итогом]))

/*CalculationPassValue(Tail(Filter([Период__Период].[Период__Период].CurrentMember.Children, not IsEmpty([Measures].[Сумма нарастающим итогом]) and ([Measures].[Сумма нарастающим итогом])<> 0)).Item(0), 1))*/

/*, 0)*/;
SCOPE(([Период__Период].[Период__Период].[Данные всех периодов], [Measures].[Сумма нарастающим итогом]));
this =  Sum([Период__Период].[Период__Период].CurrentMember.Children, [Measures].[Сумма нарастающим итогом]);
END SCOPE;

CREATE MEMBER CURRENTCUBE.Measures.[За аналогичный период прошлого года] AS ([Measures].[Сумма], ParallelPeriod([Период__Период].[Период__Период].[Год], 1, [Период__Период].[Период__Период].CurrentMember)), FORMAT_STRING = "Currency";
CREATE MEMBER CURRENTCUBE.Measures.[За аналогичный период прошлого года нараст итог] AS ([Measures].[Сумма нарастающим итогом], ParallelPeriod([Период__Период].[Период__Период].[Год], 1, [Период__Период].[Период__Период].CurrentMember));
CREATE MEMBER CURRENTCUBE.Measures.[Темп роста к прошлому году] AS IIF(IsEmpty([Measures].[За аналогичный период прошлого года]) or [Measures].[За аналогичный период прошлого года] = 0,
	null,
	Measures.[Сумма]/Measures.[За аналогичный период прошлого года]
), FORMAT_STRING = "Percent";
CREATE MEMBER CURRENTCUBE.Measures.[Темп роста к прошлому периоду] AS IIF(Isempty(([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)), null,

IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(1))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(1)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(1)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(2))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(2)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(2)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(3))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(3)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(3)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(4))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(4)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(4)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(5))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(5)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(5)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(6))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(6)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(6)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(7))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(7)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(7)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(8))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(8)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(8)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(9))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(9)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(9)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(10))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(10)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(10)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(11))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(11)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(11)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(12))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(12)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(12)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(13))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(13)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(13)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(14))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(14)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(14)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(15))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(15)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(15)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(16))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(16)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(16)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(17))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(17)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(17)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(18))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(18)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(18)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(19))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(19)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(19)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(20))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(20)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(20)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(21))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(21)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(21)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(22))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(22)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(22)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(23))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(23)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(23)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(24))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(24)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(24)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(25))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(25)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(25)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(26))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(26)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(26)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(27))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(27)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(27)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(28))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(28)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(28)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(29))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(29)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(29)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(30))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(30)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(30)),
IIF((not IsEmpty(([Measures].[Сумма], [Период__Период].[Период__Период].lag(31))) and ([Measures].[Сумма], [Период__Период].[Период__Период].lag(31)) <>0) , ([Measures].[Сумма], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Сумма], [Период__Период].[Период__Период].Lag(31)),
null
)))))))))))))))))))))))))))))))), FORMAT_STRING = "Percent";
