<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FK_0001_0016_02_date">
    <![CDATA[
-- FK_0001_0016_02_date 
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                OpeningPeriod  
                (
                    [Период].[Период].[Месяц],
                    [Период].[Период].[Данные всех периодов].[2008] 
                ) : ClosingPeriod  
                (
                    [Период].[Период].[Месяц],
                    [Период].[Период].[Данные всех периодов].[2012] 
                ),
                not IsEmpty
                (
                  ([Measures].[Факт],[ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов])
                ) and
                not IsEmpty
                (
                   [Measures].[Объем неэффективных расходов в сфере ЖКХ]  
                ) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
    member [Measures].[Объем неэффективных расходов в сфере ЖКХ]   
    as ' LookupCube   
        (
            "[ФК_МесОтч_Расходы]",
            "   
            (
                [Measures].[Исполнено],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                 " + MemberToStr
                (
                    [Период].[Период].CurrentMember   
                ) + "   
            )"   
        ) '        
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_МесОтч_СпрРасходыДоп]
]]>
  </query>

  <query id="FK_0001_0016_02_grid">
    <![CDATA[
-- FK_0001_0016_02_grid
with           
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'           
    member [Территории].[Сопоставимый].[Общие итоги]           
    as 'Sum           
        (
            [Субъекты],
            [Measures].CurrentMember           
        ) '   
            member Measures.[Кол-во субъектов]
    as '  Count
        (
            Filter 
            (
                {
                    [Субъекты]
                },
                not IsEmpty 
                (
                    [Measures].[Общий объем расходов консолидированного бюджета] 
                )  
            )
        )' 
member [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]     
    as 'IIF     
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum     
            (
                [Субъекты],
                [Measures].CurrentMember     
            ),
            (
                LookupCube     
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum    
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на начисления на выплаты по оплате труда]    
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        )   
                    )"    
                ) - LookupCube   
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum  
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда] 
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        ) 
                    )"  
                )     
            ) / 1000     
        )'            
    member [Measures].[Общий объем расходов консолидированного бюджета]           
    as '           
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]           
        ) / 1000'   
    member Measures.[Численность постоянного населения_Prev]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
        )'
    member Measures.[Численность постоянного населения_This]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
         )'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '        
 
    member [Measures].[Коэффициент масштаба]           
    as 'IIF        
        (
            IsEmpty        
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )        
            ) or         
            (
                [Measures].[Численность постоянного населения],
                [Территории].[Сопоставимый].CurrentMember       
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            0.7 + 0.05         
            *          
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].[Общие итоги]       
                ) /           
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )          
            ) / Measures.[Кол-во субъектов]     
        )'         
    member [Measures].[Объем неэффективных расходов]       
    as 'IIF    
        (
            IsEmpty    
            (
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]   
                )    
            ) or    
            (
                [Measures].[Общий объем расходов консолидированного бюджета],
                [Территории].[Сопоставимый].[Общие итоги]   
            ) = 0,
            null,
            [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ] -    
            (
                (
                    [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ],
                    [Территории].[Сопоставимый].[Общие итоги]      
                ) /      
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]     
                )    
            ) 
            *[Measures].[Общий объем расходов консолидированного бюджета]  
            *[Measures].[Коэффициент масштаба]   
        ) '    
    member [Measures].[Объем неэффективных расходов полож] 
    as 'IIF 
        (
            [Measures].[Объем неэффективных расходов] < 0,
            0,
            [Measures].[Объем неэффективных расходов] 
        ) ' 
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]   
    as 'IIF   
        (
            IsEmpty   
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]   
            ) or   
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]   
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Объем неэффективных расходов полож] 
            )/  
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]  
            )   
        ) '   

    member [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление минимум/максимум]
    as 'IIF
        (
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на государственное и муниципальное управление] =  Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов на государственное и муниципальное управление],
            "min",
            IIF
            (
                Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на государственное и муниципальное управление] = 1,
                "max",
                ""
            )
        )'
    member Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Субъекты],
                        not IsEmpty
                        (
                            [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
                        )
                    ),
                    (
                        [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
                    ),
                    BDESC
                ),
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
                )
            )
        )'
    member Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
    as 'Max
        (
            Filter
            (
                [Субъекты],
                not IsEmpty
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
                )
            ),
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]
        )'

    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            ) or  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Объем неэффективных расходов полож] 
            )/  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            )  
        ) '  
        
    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета минимум/максимум]
    as 'IIF
        (
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов бюджета] = Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов бюджета],
            "min",
            IIF
            (
                Measures.[Ранг по доле неэффективных расходов в общей сумме расходов бюджета] = 1,
                "max",
                ""
            )
        )'
    member Measures.[Ранг по доле неэффективных расходов в общей сумме расходов бюджета]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Субъекты],
                        not IsEmpty
                        (
                            [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
                        )
                    ),
                    (
                        [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
                    ),
                    BDESC
                ),
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
                )
            )
        )'
    member Measures.[Худший ранг по доле неэффективных расходов в общей сумме расходов бюджета]
    as 'Max
        (
            Filter
            (
                [Субъекты],
                not IsEmpty
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
                )
            ),
            Measures.[Ранг по доле неэффективных расходов в общей сумме расходов бюджета]
        )'

    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
    as 'Min 
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
        )' 
    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] 
    as 'Max 
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
        )' 
    member [Measures].[Уровень эффективности бюджетных расходов] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
                ) 
            ) or 
            (
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
                ) 
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
            )/ 
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
            ) 
        ) ' 
        
    member [Measures].[Уровень эффективности бюджетных расходов минимум/максимум]
    as 'IIF
        (
            Measures.[Ранг по уровню эффективности бюджетных расходов] = Measures.[Худший ранг по уровню эффективности бюджетных расходов],
            "min",
            IIF
            (
                Measures.[Ранг по уровню эффективности бюджетных расходов] = 1,
                "max",
                ""
            )
        )'
    member Measures.[Ранг по уровню эффективности бюджетных расходов]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Уровень эффективности бюджетных расходов] 
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Субъекты],
                        not IsEmpty
                        (
                            [Measures].[Уровень эффективности бюджетных расходов] 
                        )
                    ),
                    (
                        [Measures].[Уровень эффективности бюджетных расходов] 
                    ),
                    BDESC
                ),
                (
                    [Measures].[Уровень эффективности бюджетных расходов] 
                )
            )
        )'
    member Measures.[Худший ранг по уровню эффективности бюджетных расходов]
    as 'Max
        (
            Filter
            (
                [Субъекты],
                not IsEmpty
                (
                    [Measures].[Уровень эффективности бюджетных расходов] 
                )
            ),
            Measures.[Ранг по уровню эффективности бюджетных расходов]
        )'
        
    member Measures.[RegionUniqueName]           
    as '[Территории].[Сопоставимый].CurrentMember.UniqueName'           
select
    {
        [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ],
        [Measures].[Общий объем расходов консолидированного бюджета],
        [Measures].[Численность постоянного населения],
        [Measures].[Коэффициент масштаба],
        [Measures].[Объем неэффективных расходов полож],
        [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление],
        [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета],
        [Measures].[Уровень эффективности бюджетных расходов],
        [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление минимум/максимум],
        [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета минимум/максимум],
        [Measures].[Уровень эффективности бюджетных расходов минимум/максимум],
        [Measures].[RegionUniqueName]
    } on columns,
    Filter
    (
        {
            [Субъекты] +           
            {
                [Территории].[Сопоставимый].[Общие итоги]           
            }           
        },
        not IsEmpty([Measures].[Общий объем расходов консолидированного бюджета])
    ) on rows           
from [ФК_МесОтч_Расходы]           
where           
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]    
    )            
  ]]>
  </query>

  <query id="FK_0001_0016_02_chart">
    <![CDATA[
-- FK_0001_0016_02_chart
with           
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'        
    set [Периоды] 
    as 'Filter
        (
            Descendants 
            (
                [Период].[Период].[Данные всех периодов].[<%period_year%>],
                [Период].[Период].[Месяц],
                SELF 
            ) ,
            [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
            [Период].[Период].CurrentMember.Name <> "Данные квартала" and
            [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
            [Период].[Период].CurrentMember.Name <> "Данные года" and
            [Период].[Период].CurrentMember.Name <> "Данные месяца" and
            [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
        )' 
    member [Территории].[Сопоставимый].[Общие итоги]           
    as 'Sum           
        (
            [Субъекты],
            [Measures].CurrentMember           
        ) '           
member [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]     
    as 'IIF     
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum     
            (
                [Субъекты],
                [Measures].CurrentMember     
            ),
            (
                LookupCube     
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum    
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на начисления на выплаты по оплате труда]    
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        )   
                    )"    
                ) - LookupCube   
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum  
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда] 
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        ) 
                    )"  
                )     
            ) / 1000     
        )' 
    member [Measures].[Общий объем расходов консолидированного бюджета]           
    as '           
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]           
        ) / 1000'            
    member Measures.[Численность постоянного населения_Prev]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
        )'
    member Measures.[Численность постоянного населения_This]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
         )'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) ' 
    member [Measures].[Коэффициент масштаба]           
    as 'IIF        
        (
            IsEmpty        
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )        
            ) or         
            (
                [Measures].[Численность постоянного населения],
                [Территории].[Сопоставимый].CurrentMember       
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            0.7 + 0.05         
            *          
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].[Общие итоги]       
                ) /           
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )          
            ) / Measures.[Кол-во субъектов]     
        )'  
    member Measures.[Кол-во субъектов]
    as '  Count
        (
            Filter 
            (
                {
                    [Субъекты]
                },
                not IsEmpty 
                (
                    [Measures].[Общий объем расходов консолидированного бюджета] 
                )  
            )
        )'         
    member [Measures].[Объем неэффективных расходов]       
    as 'IIF    
        (
            IsEmpty    
            (
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]   
                )    
            ) or    
            (
                [Measures].[Общий объем расходов консолидированного бюджета],
                [Территории].[Сопоставимый].[Общие итоги]   
            ) = 0,
            null,
            [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ] -    
            (
                (
                    [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ],
                    [Территории].[Сопоставимый].[Общие итоги]      
                ) /      
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]     
                )    
            ) 
            *[Measures].[Общий объем расходов консолидированного бюджета]  
            *[Measures].[Коэффициент масштаба]   
        ) '    
    member [Measures].[Объем неэффективных расходов полож] 
    as 'IIF 
        (
            [Measures].[Объем неэффективных расходов] < 0,
            0,
            [Measures].[Объем неэффективных расходов] 
        ) ' 
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на гос. и муниц. управление]   
    as 'IIF   
        (
            IsEmpty   
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]   
            ) or   
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]   
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Объем неэффективных расходов полож] 
            )/  
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]  
            )   
        ) '   
    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            ) or  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Объем неэффективных расходов полож] 
            )/  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            )  
        ) '  
select
    {
        [Measures].[Доля неэффективных расходов в общей сумме расходов на гос. и муниц. управление],
        [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета]
    } on columns,
    { [Периоды]  } on rows
from [ФК_МесОтч_Расходы]  
where  
    (
         <%selected_subject%>
    )   
  ]]>
  </query>

  <query id="FK_0001_0016_02_stackChart">
    <![CDATA[
-- FK_0001_0016_02_stackChart
with 
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'        
    member [Территории].[Сопоставимый].[Общие итоги]           
    as 'Sum           
        (
            [Субъекты],
            [Measures].CurrentMember           
        ) '           
member [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]     
    as 'IIF     
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum     
            (
                [Субъекты],
                [Measures].CurrentMember     
            ),
            (
                LookupCube     
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum    
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на начисления на выплаты по оплате труда]    
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        )   
                    )"    
                ) - LookupCube   
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum  
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда] 
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        ) 
                    )"  
                )     
            ) / 1000     
        )' 
    member [Measures].[Общий объем расходов консолидированного бюджета]           
    as '           
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]           
        ) / 1000'            
    member Measures.[Численность постоянного населения_Prev]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
        )'
    member Measures.[Численность постоянного населения_This]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
         )'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) ' 
    member [Measures].[Коэффициент масштаба]           
    as 'IIF        
        (
            IsEmpty        
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )        
            ) or         
            (
                [Measures].[Численность постоянного населения],
                [Территории].[Сопоставимый].CurrentMember       
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            0.7 + 0.05         
            *          
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].[Общие итоги]       
                ) /           
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )          
            ) / Measures.[Кол-во субъектов]  
        )'         
    member Measures.[Кол-во субъектов]
    as '  Count
        (
            Filter 
            (
                {
                    [Субъекты]
                },
                not IsEmpty 
                (
                    [Measures].[Общий объем расходов консолидированного бюджета] 
                )  
            )
        )'             
    member [Measures].[Объем неэффективных расходов]       
    as 'IIF    
        (
            IsEmpty    
            (
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]   
                )    
            ) or    
            (
                [Measures].[Общий объем расходов консолидированного бюджета],
                [Территории].[Сопоставимый].[Общие итоги]   
            ) = 0,
            null,
            [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ] -    
            (
                (
                    [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ],
                    [Территории].[Сопоставимый].[Общие итоги]      
                ) /      
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]     
                )    
            ) 
            *[Measures].[Общий объем расходов консолидированного бюджета]  
            *[Measures].[Коэффициент масштаба]   
        ) '    
    member [Measures].[Объем неэффективных расходов полож] 
    as 'IIF 
        (
            [Measures].[Объем неэффективных расходов] < 0,
            0,
            [Measures].[Объем неэффективных расходов] 
        ) ' 
    member [Measures].[Эффективные расходы в сфере гос. и муниц. управления]
    as '[Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ] - [Measures].[Объем неэффективных расходов полож]'
    member [Measures].[Неэффективные расходы в сфере гос. и муниц. управления]
    as '[Measures].[Объем неэффективных расходов полож] '
select
    non empty{ [Субъекты] } on columns,
    {
        [Measures].[Эффективные расходы в сфере гос. и муниц. управления],
        [Measures].[Неэффективные расходы в сфере гос. и муниц. управления]
    } on rows 
from [ФК_МесОтч_Расходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
    )  
  ]]>
  </query>

  <query id="FK_0001_0016_02_map">
    <![CDATA[
-- FK_0001_0016_02_map
with           
    set [Субъекты]  
    as '  
        {
            Filter
            (
                 [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%current_fo%>].Children,
                 not ([Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember)
            )
        }'           
    member [Территории].[Сопоставимый].[Общие итоги]           
    as 'Sum           
        (
            [Субъекты],
            [Measures].CurrentMember           
        ) '           
member [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]     
    as 'IIF     
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum     
            (
                [Субъекты],
                [Measures].CurrentMember     
            ),
            (
                LookupCube     
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum    
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[на начисления на выплаты по оплате труда]    
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        )   
                    )"    
                ) - LookupCube   
                (
                    "[ФО_МесОтч_СпрРасходыДоп]",
                    "Sum  
                    (
                        {
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов государственной власти субъекта Российской Федерации, всего].[расходы по содержанию органов государственной власти субъекта Российской Федерации, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на заработную плату],
                            [Показатели].[СопМесОСпРасх].[Все показатели].[Расходы по содержанию органов местного самоуправления, всего].[расходы по содержанию органов местного самоуправления, направленные на выполнение полномочий Российской Федерации].[на начисления на выплаты по оплате труда] 
                        },
                        (
                            [Measures].[<%selected_fo_measure%>],
                            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                            [Показатели].[СопМесОСпРасх].CurrentMember,
                            [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                            " + MemberToStr     
                            (
                                [Территории].[Сопоставимый].CurrentMember     
                            ) + ",
                            " + MemberToStr     
                            (
                                [Период].[Период].CurrentMember     
                            ) + "     
                        ) 
                    )"  
                )     
            ) / 1000     
        )' 
    member [Measures].[Общий объем расходов консолидированного бюджета]           
    as '           
        (
            [Measures].[<%selected_fk_measure%>],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]           
        ) / 1000'            
    member Measures.[Численность постоянного населения_Prev]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
        )'
    member Measures.[Численность постоянного населения_This]
    as 'IIF           
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            Sum           
            (
                [Субъекты],
                [Measures].[Численность постоянного населения]           
            ),
            LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            )
         )'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) ' 
    member [Measures].[Коэффициент масштаба]           
    as 'IIF        
        (
            IsEmpty        
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )        
            ) or         
            (
                [Measures].[Численность постоянного населения],
                [Территории].[Сопоставимый].CurrentMember       
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            0.7 + 0.05         
            *          
            (
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].[Общие итоги]       
                ) /           
                (
                    [Measures].[Численность постоянного населения],
                    [Территории].[Сопоставимый].CurrentMember       
                )          
            ) / Measures.[Кол-во субъектов]      
        )'  
    member Measures.[Кол-во субъектов]
    as '  Count
        (
            Filter 
            (
                {
                    [Субъекты]
                },
                not IsEmpty 
                (
                    [Measures].[Общий объем расходов консолидированного бюджета] 
                )  
            )
        )'         
    member [Measures].[Объем неэффективных расходов]       
    as 'IIF    
        (
            IsEmpty    
            (
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]   
                )    
            ) or    
            (
                [Measures].[Общий объем расходов консолидированного бюджета],
                [Территории].[Сопоставимый].[Общие итоги]   
            ) = 0,
            null,
            [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ] -    
            (
                (
                    [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ],
                    [Территории].[Сопоставимый].[Общие итоги]      
                ) /      
                (
                    [Measures].[Общий объем расходов консолидированного бюджета],
                    [Территории].[Сопоставимый].[Общие итоги]     
                )    
            ) 
            *[Measures].[Общий объем расходов консолидированного бюджета]  
            *[Measures].[Коэффициент масштаба]   
        ) '    
    member [Measures].[Объем неэффективных расходов полож] 
    as 'IIF 
        (
            [Measures].[Объем неэффективных расходов] < 0,
            0,
            [Measures].[Объем неэффективных расходов] 
        ) ' 
    member [Measures].[Доля неэффективных расходов в общей сумме расходов на государственное и муниципальное управление]   
    as 'IIF   
        (
            IsEmpty   
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]   
            ) or   
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]   
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Объем неэффективных расходов полож] 
            )/  
            (
                [Measures].[Расходы консолидированного бюджета на содержание ОИВ и ОМСУ]  
            )   
        ) '   
    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            ) or  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Объем неэффективных расходов полож] 
            )/  
            (
                [Measures].[Общий объем расходов консолидированного бюджета] 
            )  
        ) '  
    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
    as 'Min 
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
        )' 
    member [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] 
    as 'Max 
        (
            [Субъекты],
            [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
        )' 
    member [Measures].[Уровень эффективности бюджетных расходов] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
                ) 
            ) or 
            (
                (
                    [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
                ) 
            ) = 0 or [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Общие итоги],
            null,
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
            )/ 
            (
                [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Max] - [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета Min] 
            ) 
        ) ' 
select
    {
        [Measures].[Уровень эффективности бюджетных расходов],
        [Measures].[Объем неэффективных расходов полож],
        [Measures].[Доля неэффективных расходов в общей сумме расходов бюджета] 
    } on columns,
    {
        [Субъекты]
    } on rows
from [ФК_МесОтч_Расходы]
where
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
    )
  ]]>
  </query>

</root>