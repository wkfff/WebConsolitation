<?xml version="1.0" encoding="Windows-1251"?>
<root>



  <query id="years">
    <![CDATA[
 /*   --SEP_0004 years
    select
    non empty
    {
       [СЭР__Показатели МО].[СЭР__Показатели МО].[Все показатели]
    }on columns,
    NON EMPTY
    {
    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц].members
    } on rows
from [ЭО_СЭР_МО Ленинградская область]
where ([Measures].[Значение],
<%baseRegion%>,
[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра])*/
--SEP_0003 years
with 
member [Measures].[Примечание]
    as ' [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание")'
 member [Measures].[Индикатор] 
    as ' IIF 
        (
            Right  
            (
                [Measures].[Примечание], 
                1 
            )<>"+" , 
            IIF 
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                )<>0  and Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                Round 
                (
                    (
                        [Measures].[Значение]/ 
                        (
                            ParallelPeriod 
                            (
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                1,
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                            ),
                            [Measures].[Значение] 
                        ) 
                    ),
                    2 
                ) ,
                IIF 
                (
                    (
                        ParallelPeriod 
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                            2,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                        ),
                        [Measures].[Значение] 
                    )<>0 and  Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                    Round 
                    (
                        (
                            [Measures].[Значение]/ 
                            (
                                ParallelPeriod 
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                    2,
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                                ),
                                [Measures].[Значение] 
                            ) 
                        ),
                        2 
                    ),
                    null 
                ) 
            )     ,
            IIF 
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                )<>0 and   Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                Round 
                (
                    (
                        (
                            ParallelPeriod 
                            (
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                1,
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                            ),
                            [Measures].[Значение] 
                        )/[Measures].[Значение] 
                    ),
                    2 
                ) ,
                IIF 
                (
                    (
                        ParallelPeriod 
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                            2,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                        ),
                        [Measures].[Значение] 
                    )<>0 and  Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                    Round 
                    (
                        (
                            (
                                ParallelPeriod 
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                    2,
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                                ),
                                [Measures].[Значение] 
                            )/[Measures].[Значение] 
                        ),
                        2 
                    ),
                    null 
                ) 
            ) 
        )  ' 
    set [Показатели социальной сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="1" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
    set [Показатели экономической сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="2" and Len
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код")
            )=3
        )  ' 
    set [Показатели финансовой сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="3" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
    member [Measures].[Кол-во пустых показателей в соц] 
    as ' Count 
        (
            Filter 
            (
                [Показатели социальной сферы],
                isempty 
                (
                    (
                       [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ) 
                ) 
            ) 
        ) ' 
    member [Measures].[Кол-во пустых показателей в фин] 
    as ' Count 
        (
            Filter 
            (
                [Показатели финансовой сферы]  ,
                isempty 
                (
                    (
                       [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ) 
                ) 
            ) 
        ) ' 
    member [Measures].[Кол-во пустых показателей в экон] 
    as ' Count 
        ( 
            Filter 
            (
                [Показатели экономической сферы]   ,
                isempty 
                (
                    (
                        [Measures].[Индикатор]
                    ) 
                ) 
            ) 
        ) ' 
    set [Года] 
    as ' Filter 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал].members ,
            [Measures].[Кол-во пустых показателей в соц]<=3 and
            [Measures].[Кол-во пустых показателей в экон]<=3 
        )   ' 
        member [Measures].[ParentYear]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.parent.parent.name'
select
    non empty  
    {
      [Measures].[Значение],
      [Measures].[ParentYear]
    }on columns,
    NON EMPTY
    {
     [Года] 

    } on rows  
from [ЭО_СЭР_МО Ленинградская область]  
where  
    (
       <%baseRegion%>,
       [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]
    )  
]]>
  </query>

  <query id="Pok_list">
    <![CDATA[
    --SEP_0004 Pok_list
with 
    member [Measures].[v] 
    as ' [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код")' 
select
      non empty { [Measures].[v]  }on columns,
    {

          filter
        (
            [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР].members,

            (not isempty([Measures].[Значение])
            or [Measures].[v]="100"
            or [Measures].[v]="200"
            or [Measures].[v]="300"

            )
            and Len([Measures].[v])=3
        ) 
    } on rows 
from [ЭО_СЭР_МО Ленинградская область] 
where 
    (
       [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]  ,
        <%baseRegion%>
    )  

]]>
  </query>


  <query id="Chart">
    <![CDATA[
--SEP_0004 Chart1 
with 
    member [Measures].[v] 
    as ' [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код")' 
    member [Measures].[Отклонение] 
    as '[Measures].[Значение] - 
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская обл.].[Новосибирская область].datamember,
            [Measures].[Значение] 
        )' 
    member [Measures].[Отклонение по РФ] 
    as '[Measures].[Значение] - 
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].datamember,
            [Measures].[Значение] 
        )' 
    member [Measures].[Примечание] 
    as ' [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание")' 
   member [Measures].[Индикатор] 
    as ' IIF 
        (
            Right 
            (
                [Measures].[Примечание],
                1 
            )<>"+" ,
            IIF 
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                )<>0  and Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                Round 
                (
                    (
                        [Measures].[Значение]/ 
                        (
                            ParallelPeriod 
                            (
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                1,
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                            ),
                            [Measures].[Значение] 
                        ) 
                    ),
                    2 
                ) ,
                IIF 
                (
                    (
                        ParallelPeriod 
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                            2,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                        ),
                        [Measures].[Значение] 
                    )<>0 and  Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                    Round 
                    (
                        (
                            [Measures].[Значение]/ 
                            (
                                ParallelPeriod 
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                    2,
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                                ),
                                [Measures].[Значение] 
                            ) 
                        ),
                        2 
                    ),
                    null 
                ) 
            )     ,
            IIF 
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                )<>0 and   Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                Round 
                (
                    (
                        (
                            ParallelPeriod 
                            (
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                1,
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                            ),
                            [Measures].[Значение] 
                        )/[Measures].[Значение] 
                    ),
                    2 
                ) ,
                IIF 
                (
                    (
                        ParallelPeriod 
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                            2,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                        ),
                        [Measures].[Значение] 
                    )<>0 and  Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                    Round 
                    (
                        (
                            (
                                ParallelPeriod 
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                    2,
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                                ),
                                [Measures].[Значение] 
                            )/[Measures].[Значение] 
                        ),
                        2 
                    ),
                    null 
                ) 
            ) 
        )  ' 
    member [Measures].[Весовой коэффициент] 
    as ' IIF 
        (
            Right 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание"),
                1 
            )="+",
            [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание"),
            [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание")+"+" 
        )    ' 
    member [Measures].[Код] 
    as '[СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код")' 
    member [Measures].[Ед] 
    as '[СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Единица измерения")' 
    set [Показатели социальной сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="1" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
    set [Показатели экономической сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="2" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
    set [Показатели финансовой сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="3" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
  member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель социальной сферы]  
    as 'Round  
        (
            Sum  
            (
                [Показатели социальной сферы],
                [Measures].[Индикатор]  
                * [Measures].[Весовой коэффициент]  
            ),
            2  
        ) 
         ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель финансовой сферы]  
    as 'Round  
        (
            Sum  
            (
                [Показатели финансовой сферы],
                [Measures].[Индикатор]  
                * [Measures].[Весовой коэффициент]  
            ),
            2  
        ) 
         ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель экономической сферы]  
    as 'Round  
        (
            Sum  
            (
                [Показатели экономической сферы],
                [Measures].[Индикатор]  
                * [Measures].[Весовой коэффициент]  
            ),
            2  
        ) 
         ' 
    member [Measures].[Индикатор1]  
    as ' IIF  
        (
            [Measures].[v]="100",
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель социальной сферы],
                [Measures].[Значение]  
            ),
            IIF  
            (
                [Measures].[v]="200",
                (
                    [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель экономической сферы],
                    [Measures].[Значение]  
                ),
                IIF  
                (
                    [Measures].[v]="300",
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель финансовой сферы],
                        [Measures].[Значение]  
                    ),
                    [Measures].[Индикатор]  
                )  
            )  
        )  '  
    member [Measures].[Кол-во пустых показателей в соц]  
    as ' Count  
        (
            Filter  
            (
                [Показатели социальной сферы],
                isempty  
                (
                    (
                        [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    )  
                )  
            )  
        ) '  
    member [Measures].[Кол-во пустых показателей в фин]  
    as ' Count  
        (
            Filter  
            (
                [Показатели финансовой сферы]  ,
                isempty  
                (
                    (
                        [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    )  
                )  
            )  
        ) '  
    member [Measures].[Кол-во пустых показателей в экон]  
    as ' Count  
        (
            Filter  
            (
                [Показатели экономической сферы]   ,
                isempty  
                (
                    (
                        [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    )  
                )  
            )  
        ) '  
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель]  
    as ' IIF  
        (
            [Measures].[Кол-во пустых показателей в экон]<=3 and [Measures].[Кол-во пустых показателей в фин]<=3 and [Measures].[Кол-во пустых показателей в соц]<=3,
            Round  
            (
                (
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель социальной сферы],
                        [Measures].[Значение]  
                    ) * [СЭР__Показатели МО].[СЭР__Показатели МО].[Социальная сфера].properties("Примечание") +  
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель экономической сферы],
                        [Measures].[Значение]  
                    ) * [СЭР__Показатели МО].[СЭР__Показатели МО].[Экономическая сфера].properties("Примечание")  +  
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель финансовой сферы],
                        [Measures].[Значение]  
                    )  * [СЭР__Показатели МО].[СЭР__Показатели МО].[Финансовая сфера].properties("Примечание")  
                ),
                2  
            ) ,
            null  
        ) ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Абсолютное отклонение] 
    as ' 
        (
            <%selectedPeriod%>,
            <%selectedPok%>
        )- 
        (
            <%prevPeriod%>,
           <%selectedPok%>
        ) ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Ранг] 
    as 'null' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Изменение по сравнению с предыдущим годом] 
    as '     IIF 
        (
            not isempty
            (
                (
                    <%selectedPok%>,
                    [Measures].[Значение]
                )
            ),
            <%selectedPok%>-1,
            null 
        )' 
  member [Measures].[Значение1]  
    as ' IIF  
        (
           
            Left([СЭР__Показатели МО].[СЭР__Показатели МО].currentmember.name,12)="Интегральный"
           ,
           [Measures].[Значение]-1,
            [Measures].[Индикатор]-1
        ) '  
select
    non empty 
    {
       
            {           
              <%selectedPeriod%>,
              <%prevPeriod%>
            }*
            {<%selectedPok%>}
   
    }on columns,
    NON EMPTY 
    {
           [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].datamember,
          <%baseRegion%>.datamember,
        filter 
        (
            <%baseRegion%>.children ,
            Right 
            (
                [Территории__РФ].[Территории__РФ].currentmember.UniqueName,
                10 
            )<>"DATAMEMBER" and [Measures].[Значение]<>0 
        ) 
    } on rows 
from [ЭО_СЭР_МО Ленинградская область] 
where 
    (
        [Measures].[Значение1],
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра] 
    ) 
]]>
  </query>
  
<query id="Grid">
    <![CDATA[
--SEP_0004 Grid
with
    member [Measures].[v]
    as ' [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код")'
    member [Measures].[Отклонение]
    as '[Measures].[Значение] -
        (
            <%baseRegion%>.datamember,
            [Measures].[Значение]
        )'
    member [Measures].[Отклонение по РФ]
    as '[Measures].[Значение] -
        (
            [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].datamember,
            [Measures].[Значение]
        )'
    member [Measures].[Примечание]
    as ' [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание")'
member [Measures].[Индикатор] 
    as ' IIF 
        (
            Right 
            (
                [Measures].[Примечание],
                1 
            )<>"+" ,
            IIF 
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                )<>0  and Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                Round 
                (
                    (
                        [Measures].[Значение]/ 
                        (
                            ParallelPeriod 
                            (
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                1,
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                            ),
                            [Measures].[Значение] 
                        ) 
                    ),
                    2 
                ) ,
                IIF 
                (
                    (
                        ParallelPeriod 
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                            2,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                        ),
                        [Measures].[Значение] 
                    )<>0 and  Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                    Round 
                    (
                        (
                            [Measures].[Значение]/ 
                            (
                                ParallelPeriod 
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                    2,
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                                ),
                                [Measures].[Значение] 
                            ) 
                        ),
                        2 
                    ),
                    null 
                ) 
            )     ,
            IIF 
            (
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        1,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                )<>0 and   Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                Round 
                (
                    (
                        (
                            ParallelPeriod 
                            (
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                1,
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                            ),
                            [Measures].[Значение] 
                        )/[Measures].[Значение] 
                    ),
                    2 
                ) ,
                IIF 
                (
                    (
                        ParallelPeriod 
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                            2,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                        ),
                        [Measures].[Значение] 
                    )<>0 and  Round([Measures].[Значение],2)<>0 and not isempty([Measures].[Значение]),
                    Round 
                    (
                        (
                            (
                                ParallelPeriod 
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                                    2,
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                                ),
                                [Measures].[Значение] 
                            )/[Measures].[Значение] 
                        ),
                        2 
                    ),
                    null 
                ) 
            ) 
        )  ' 
    member [Measures].[Весовой коэффициент]
    as ' IIF
        (
            Right
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание"),
                1
            )="+",
            [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание"),
            [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Примечание")+"+"
        )    '
    member [Measures].[Код]
    as '[СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код")'
    member [Measures].[Ед]
    as '[СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Единица измерения")'
    set [Показатели социальной сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="1" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
    set [Показатели экономической сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="2" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
    set [Показатели финансовой сферы] 
    as ' Filter 
        (
            Descendants 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО],
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Показатель СЭР],
                SELF 
            ),
            Left 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") ,
                1 
            )="3" and Len 
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].CurrentMember.properties("Код") 
            )=3 
        )  ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель социальной сферы]  
    as 'Round  
        (
            Sum  
            (
                [Показатели социальной сферы],
                [Measures].[Индикатор]  
                * [Measures].[Весовой коэффициент]  
            ),
            2  
        ) 
         ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель финансовой сферы]  
    as 'Round  
        (
            Sum  
            (
                [Показатели финансовой сферы],
                [Measures].[Индикатор]  
                * [Measures].[Весовой коэффициент]  
            ),
            2  
        ) 
         ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель экономической сферы]  
    as 'Round  
        (
            Sum  
            (
                [Показатели экономической сферы],
                [Measures].[Индикатор]  
                * [Measures].[Весовой коэффициент]  
            ),
            2  
        ) 
         ' 
    member [Measures].[Индикатор1]  
    as ' IIF  
        (
            [Measures].[v]="100",
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель социальной сферы],
                [Measures].[Значение]  
            ),
            IIF  
            (
                [Measures].[v]="200",
                (
                    [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель экономической сферы],
                    [Measures].[Значение]  
                ),
                IIF  
                (
                    [Measures].[v]="300",
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель финансовой сферы],
                        [Measures].[Значение]  
                    ),
                    [Measures].[Индикатор]  
                )  
            )  
        )  '  
    member [Measures].[Кол-во пустых показателей в соц]  
    as ' Count  
        (
            Filter  
            (
                [Показатели социальной сферы],
                isempty  
                (
                    (
                        [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    )  
                )  
            )  
        ) '  
    member [Measures].[Кол-во пустых показателей в фин]  
    as ' Count  
        (
            Filter  
            (
                [Показатели финансовой сферы]  ,
                isempty  
                (
                    (
                        [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    )  
                )  
            )  
        ) '  
    member [Measures].[Кол-во пустых показателей в экон]  
    as ' Count  
        (
            Filter  
            (
                [Показатели экономической сферы]   ,
                isempty  
                (
                    (
                        [Measures].[Индикатор],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    )  
                )  
            )  
        ) '  
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель]  
    as ' IIF  
        (
            [Measures].[Кол-во пустых показателей в экон]<=3 and [Measures].[Кол-во пустых показателей в фин]<=3 and [Measures].[Кол-во пустых показателей в соц]<=3,
            Round  
            (
                (
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель социальной сферы],
                        [Measures].[Значение]  
                    ) * [СЭР__Показатели МО].[СЭР__Показатели МО].[Социальная сфера].properties("Примечание") +  
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель экономической сферы],
                        [Measures].[Значение]  
                    ) * [СЭР__Показатели МО].[СЭР__Показатели МО].[Экономическая сфера].properties("Примечание")  +  
                    (
                        [СЭР__Показатели МО].[СЭР__Показатели МО].[Интегральный показатель финансовой сферы],
                        [Measures].[Значение]  
                    )  * [СЭР__Показатели МО].[СЭР__Показатели МО].[Финансовая сфера].properties("Примечание")  
                ),
                2  
            ) ,
            null  
        ) '  
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Абсолютное отклонение] 
    as ' 
        (
           <%selectedPeriod%>,
            <%selectedPok%> 
        )- 
        (
            <%prevPeriod%>,
            <%selectedPok%> 
        ) ' 
    member [СЭР__Показатели МО].[СЭР__Показатели МО].[Ранг] 
    as 'null' 
        member [Measures].[Значение1]   
    as ' IIF   
        (
            Left  
            (
                [СЭР__Показатели МО].[СЭР__Показатели МО].currentmember.name,
                12  
            )="Интегральный" ,
            [Measures].[Значение],
            IIF  
            (
                Left  
                (
                    [СЭР__Показатели МО].[СЭР__Показатели МО].currentmember.name,
                    9  
                )="Изменение",
                [Measures].[Значение],
                
                [Measures].[Индикатор] 
            )   
        ) '  
member [СЭР__Показатели МО].[СЭР__Показатели МО].[Изменение по сравнению с предыдущим годом] 
    as '  IIF 
        (
            (
                <%selectedPok%> ,
                [Measures].[Значение1] 
            )<>0 ,
            (
               <%selectedPok%> ,
                [Measures].[Значение1]  
            )-1,
            null 
        )' 
select
   -- non empty
    {
       { <%prevPeriod%> ,
            <%selectedPeriod%>
          
        } 
        *  
        {
            <%selectedPok%> ,
            [СЭР__Показатели МО].[СЭР__Показатели МО].[Изменение по сравнению с предыдущим годом] ,
            [СЭР__Показатели МО].[СЭР__Показатели МО].[Ранг]
        }
    }on columns,
    NON EMPTY
    {
    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].datamember,
   <%baseRegion%>.datamember,
filter
(
        <%baseRegion%>.children ,
       Right( [Территории__РФ].[Территории__РФ].currentmember.UniqueName,10)<>"DATAMEMBER"
        and ([Measures].[Значение])<>0
        and not isempty([Measures].[Значение])
        )
    } on rows
from [ЭО_СЭР_МО Ленинградская область]
where
    (
        [Measures].[Значение1],
      [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]
    )
]]>
</query>
    
</root>
  