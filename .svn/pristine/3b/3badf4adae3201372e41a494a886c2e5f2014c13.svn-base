<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FST_0002_0001_chart_Increase">
    <![CDATA[
    --FST_0002_0001_chart_Increase
with  
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]  
    as 'IIF  
        (
            IsEmpty  
            (
                (
                    <%period_cur_date%>,
                    [Measures].[Тариф]  
                )  
            ) or IsEmpty  
            (
                (
                    <%period_last_date%>,
                    [Measures].[Тариф]  
                )  
            ) or  
            (
                <%period_cur_date%>,
                [Measures].[Тариф]  
            )=0 or  
            (
                <%period_last_date%>,
                [Measures].[Тариф]  
            )=0,
            0,
            (
                <%period_cur_date%>,
                [Measures].[Тариф]  
            ) -  
            (
                <%period_last_date%>,
                [Measures].[Тариф]  
            )  
        )'  
        
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Детали учета] 
    as 'IIF
        (
            [ФСТ__Детали учета].[ФСТ__Детали учета].CurrentMember is [ФСТ__Детали учета].[ФСТ__Детали учета].[Все детали учета].[Не определено],
            " ",
             "(" +[ФСТ__Детали учета].[ФСТ__Детали учета].CurrentMember.Name + ")"
        )'   
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[МР] 
    as 'IIF
        (
            [Территории__РФ].[Территории__РФ].CurrentMember.Level is [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ],
            " (" + [Территории__РФ].[Территории__РФ].CurrentMember.Parent.Name + ")",
            " "
        )'         
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Наименование] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Name + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[МР] + ";" +
        [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].CurrentMember.Name + ";" +
        [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].CurrentMember.Name + ";" +
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Детали учета] '       
select
    {
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Наименование],
        <%period_last_date%>,
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]  
    } on columns,
    Order
    (
            filter 
            (
                {
                    CROSSJOIN  
                    (
                        filter  
                        (
                            CROSSJOIN  
                            (
                                {
                                    filter  
                                    (
                                        CROSSJOIN  
                                        (
                                            {
                                                filter  
                                                (
                                                    Descendants  
                                                    (
                                                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[<%region%>].[<%state_area%>],
                                                        [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ],
                                                        LEAVES  
                                                    ),
                                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0 and
                                                    not ([Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember)
                                                )  
                                            },
                                            {
                                                filter  
                                                (
                                                    Except  
                                                    (
                                                        [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].Members,
                                                        [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].[Все организации]  
                                                    ),
                                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  and
                                                    not ([ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].CurrentMember is [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].CurrentMember.Parent.DataMember)
                                                )  
                                            }  
                                        ),
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                                    )  
                                },
                                {
                                    filter  
                                    (
                                        Except  
                                        (
                                            [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].Members,
                                            [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].[Все виды благоустройств]  
                                        ),
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  and
                                        not ([ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].CurrentMember is [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].CurrentMember.Parent.DataMember)
                                    )  
                                }  
                            ),
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                        ),
                        {
                            filter  
                            (
                                Except  
                                (
                                    [ФСТ__Детали учета].[ФСТ__Детали учета].Members,
                                    [ФСТ__Детали учета].[ФСТ__Детали учета].[Все детали учета]  
                                ),
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                            )  
                        }  
                    )  
                },
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение] > 0
            ),
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение],
            BDESC
    )      on rows
        from [ФСТ_ЖКХ по МО_Тарифы и нормативы]
where  
    (
        [Measures].[Тариф],
        [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[<%service_name%>] 
    )      
  ]]>
  </query>

  <query id="FST_0002_0001_chart_Decrease">
    <![CDATA[
    --FST_0002_0001_chart_Decrease
with  
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]  
    as 'IIF  
        (
            IsEmpty  
            (
                (
                    <%period_cur_date%>,
                    [Measures].[Тариф]  
                )  
            ) or IsEmpty  
            (
                (
                    <%period_last_date%>,
                    [Measures].[Тариф]  
                )  
            ) or  
            (
                <%period_cur_date%>,
                [Measures].[Тариф]  
            )=0 or  
            (
                <%period_last_date%>,
                [Measures].[Тариф]  
            )=0,
            0,
            (
                <%period_cur_date%>,
                [Measures].[Тариф]  
            ) -  
            (
                <%period_last_date%>,
                [Measures].[Тариф]  
            )  
        )'  
        
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[На начало периода]
    as '(
                <%period_last_date%>,
                [Measures].[Тариф]  
        ) +
        ( 
           [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение],
           [Measures].[Тариф]  
        )  '
        
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение ]
    as '- 
        ( 
           [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение],
           [Measures].[Тариф]  
        )'        
        
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Детали учета] 
    as 'IIF
        (
            [ФСТ__Детали учета].[ФСТ__Детали учета].CurrentMember is [ФСТ__Детали учета].[ФСТ__Детали учета].[Все детали учета].[Не определено],
            " ",
             "(" +[ФСТ__Детали учета].[ФСТ__Детали учета].CurrentMember.Name + ")"
        )'   
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[МР] 
    as 'IIF
        (
            [Территории__РФ].[Территории__РФ].CurrentMember.Level is [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ],
            " (" + [Территории__РФ].[Территории__РФ].CurrentMember.Parent.Name + ")",
            " "
        )'         
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Наименование] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Name + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[МР] + ";" +
        [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].CurrentMember.Name + ";" +
        [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].CurrentMember.Name + ";" +
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Детали учета] '           
select
    {
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Наименование],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[На начало периода],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение ]  
    } on columns,

        Order
        (
            filter 
            (
                {
                    CROSSJOIN  
                    (
                        filter  
                        (
                            CROSSJOIN  
                            (
                                {
                                    filter  
                                    (
                                        CROSSJOIN  
                                        (
                                            {
                                                filter  
                                                (
                                                    Descendants  
                                                    (
                                                        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[<%region%>].[<%state_area%>],
                                                        [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ],
                                                        LEAVES  
                                                    ),
                                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0   and
                                                     not ([Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember)
                                                )  
                                            },
                                            {
                                                filter  
                                                (
                                                    Except  
                                                    (
                                                        [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].Members,
                                                        [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].[Все организации]  
                                                    ),
                                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  and
                                                     not ([ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].CurrentMember is [ФСТ__Организации ЖКХ].[ФСТ__Организации ЖКХ].CurrentMember.Parent.DataMember)
                                                )  
                                            }  
                                        ),
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                                    )  
                                },
                                {
                                    filter  
                                    (
                                        Except  
                                        (
                                            [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].Members,
                                            [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].[Все виды благоустройств]  
                                        ),
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0 and
                                        not ([ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].CurrentMember is [ФСТ__Виды благоустройств].[ФСТ__Виды благоустройств].CurrentMember.Parent.DataMember)
                                    )  
                                }  
                            ),
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                        ),
                        {
                            filter  
                            (
                                Except  
                                (
                                    [ФСТ__Детали учета].[ФСТ__Детали учета].Members,
                                    [ФСТ__Детали учета].[ФСТ__Детали учета].[Все детали учета]  
                                ),
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение]<>0  
                            )  
                        }  
                    )  
                },
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение] < 0
            ),
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Отклонение], BASC) on rows
        from [ФСТ_ЖКХ по МО_Тарифы и нормативы]
where  
    (
        [Measures].[Тариф],
        [ФСТ__Услуги ЖКХ].[ФСТ__Услуги ЖКХ].[Все услуги].[<%service_name%>] 
    )      
  ]]>
  </query>
</root>