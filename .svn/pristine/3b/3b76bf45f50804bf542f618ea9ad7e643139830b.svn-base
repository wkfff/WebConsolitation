<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FK_0001_0005_date_budget">
    <![CDATA[
-- FK_0001_0005_detail_date  _budget
-- <#[ФК_МесОтч_Доходы]#>
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФК_МесОтч_Доходы]
  ]]>
  </query>

  <query id="FK_0001_0005_grid_budget">
    <![CDATA[
-- FK_0001_0005_detail_grid_budget
-- <#[ФК_МесОтч_Доходы]#>
with  
    MEMBER [КД].[Сопоставимый].[Собственные доходы, млн.руб.]     
    AS 'AGGREGATE     
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от нерезидентов],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Межбюджетные трансферты, передаваемые бюджетам государственных внебюджетных фондов],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Прочие безвозмездные неденежные поступления в порядке безвозмездной передачи нефинансовых и финансовых активов от бюджетов бюджетной системы Российской Федерации],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Прочие безвозмездные поступления от местных бюджетов],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Прочие безвозмездные поступления от других бюджетов бюджетной системы],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ГОСУДАРСТВЕННЫХ (МУНИЦИПАЛЬНЫХ) ОРГАНИЗАЦИЙ],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ НЕГОСУДАРСТВЕННЫХ ОРГАНИЗАЦИЙ],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ НАДНАЦИОНАЛЬНЫХ ОРГАНИЗАЦИЙ],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[ПРОЧИЕ БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Перечисления для осуществления возврата (зачета) излишне уплаченных или излишне взысканных сумм налогов, сборов и иных платежей, а также сумм процентов за несвоевременное осуществление такого возврата и процентов, начисленных на излишне взысканные суммы],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА БЮДЖЕТАМИ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ И ОРГАНИЗАЦИЯМИ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                [КД].[Сопоставимый].[Все коды доходов].[ДОХОДЫ ОТ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]  
            }   
        )'     
    MEMBER [КД].[Сопоставимый].[Межбюджетные трансферты ФБ (за исключением субвенций), млн.руб.]     
    AS 'AGGREGATE     
        (
            {
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Межбюджетные трансферты, передаваемые бюджетам государственных внебюджетных фондов],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Прочие безвозмездные неденежные поступления в порядке безвозмездной передачи нефинансовых и финансовых активов от бюджетов бюджетной системы Российской Федерации],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Прочие безвозмездные поступления от местных бюджетов],
                [КД].[Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Прочие безвозмездные поступления от других бюджетов бюджетной системы] 
            }   
        )'  
    Member [КД].[Сопоставимый].[Доля]  
    AS 'IIF  
        (
            IsEmpty  
            (
                (
                    [КД].[Сопоставимый].[Собственные доходы, млн.руб.],
                    [Период].[Период].CurrentMember  
                ) 
            ) or 
            (
                [КД].[Сопоставимый].[Собственные доходы, млн.руб.],
                [Период].[Период].CurrentMember  
            ) = 0  ,
            null,
            (
                [КД].[Сопоставимый].[Межбюджетные трансферты ФБ (за исключением субвенций), млн.руб.],
                [Период].[Период].CurrentMember  
            ) /  
            (
                [КД].[Сопоставимый].[Собственные доходы, млн.руб.],
                [Период].[Период].CurrentMember  
            )  
        )'  
    Member [КД].[Сопоставимый].[Сложившаяся группа]    
    AS 'IIF    
        (
            not 
            (
                [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ]
            ),
            null,
            0
        )'    
    member [Период].[Период].[Данные всех периодов].[<%period_end_year%> план] 
    as ' 
        (
            [Период].[Период].[Данные всех периодов].[<%period_end_year%>],
            [Measures].[Назначено] 
        )'  
    member [Период].[Период].[Данные всех периодов].[Федер. округ]    
    as 'IIF  
        (
            [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Субъект РФ],
            [Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование"),
            [Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование") 
        )'  
select
    {
        {
            [КД].[Сопоставимый].[Все коды доходов].[Несопоставленные данные]
        }
        *
        {
            [Период].[Период].[Данные всех периодов].[Федер. округ]
        }+
        {
            {
                [КД].[Сопоставимый].[Собственные доходы, млн.руб.],
                [КД].[Сопоставимый].[Межбюджетные трансферты ФБ (за исключением субвенций), млн.руб.],
                [КД].[Сопоставимый].[Доля],
                [КД].[Сопоставимый].[Сложившаяся группа]
            }  
            *  
            {
                {
                    [Период].[Период].[Данные всех периодов].[<%period_first_year%>]:[Период].[Период].[Данные всех периодов].[<%period_end_year%>] 
                } +  
                {
                    [Период].[Период].[Данные всех периодов].[<%period_end_year%> план] 
                }  
            } 
        } 
    } on columns,
    non empty Filter    
    (
        Generate   
        (
            [Территории].[Сопоставимый].[Федеральный округ].Members,
            Descendants    
            (
                [Территории].[Сопоставимый].CurrentMember,
                [Территории].[Сопоставимый].[Субъект РФ],
                SELF_AND_BEFORE    
            )    
        ),
        not    
        (
            [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember    
        ) and    
        (
            (
                Measures.[Исполнено] +  Measures.[Исполнено прошлый год]    
            ) <> 0    
        )     
    ) on rows 
from [ФК_МесОтч_Доходы]       
where ([Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта])
  ]]>
  </query>

</root>