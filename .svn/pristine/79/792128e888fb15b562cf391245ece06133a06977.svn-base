<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0002_0015_date">
    <![CDATA[
-- FO_0002_0015_detail_date 
with 
    member [Measures].[ДанныеНа] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName' 
select
    { [Measures].[ДанныеНа] } on columns,
    {
        Tail 
        (
            Filter 
            (
                [Период__Период].[Период__Период].[Месяц].Members,
                not IsEmpty([Measures].[Факт]) 
            ) 
        ) 
    } on rows 
from [ФО_МесОтч_СпрВнутрДолг] 
]]>
  </query>


  <query id="FO_0002_0015_level_budget">
    <![CDATA[
-- FO_0002_0015_level_budget 
with 
    member [Measures].[Уровень] 
    as '0' 
    member [Measures].[Уникальное имя] 
    as ' [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember.UniqueName ' 
    member [Measures].[Имя] 
    as ' [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember.Name ' 
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень] 
    }ON COLUMNS,
    {
        {
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта],
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет субъекта],
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет МО] 
        } 
    } ON ROWS 
FROM [ФО_МесОтч_СпрВнутрДолг] ]]>
  </query>
  <query id="FO_0002_0015_grid">
    <![CDATA[ 
    -- FO_0002_0015_grid 
    with 
        set [Районы]       
    as 'IIF 
        (
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember is  [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта],
           Filter     
                        (
                            Descendants     
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                                SELF     
                            ),
                            not     
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
                            )     
                        ),
            IIF 
        (
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember is [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет субъекта],
            Filter 
            (
                Descendants 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                    SELF 
                ),
                not 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
                ) and not 
                (
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО" 
                    ) or 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" 
                    ) or 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" 
                    ) 
                ) 
            ) ,
            IIF 
            (
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember is [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                Filter       
                (
                    Descendants       
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                        [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                        SELF       
                    ),
                    not       
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember       
                    ) and       
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"       
                    )       
                ),
                IIF 
                (
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember is [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    Filter 
                    (
                        Descendants 
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                            [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                            SELF 
                        ),
                        not 
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района] 
                        ) and 
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" 
                        ) 
                    ),
                    IIF 
                    (
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember is [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
                        Filter 
                        (
                            Descendants 
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                                SELF 
                            ),
                            not 
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района] 
                            ) and 
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" 
                            ) 
                        ),
                        Filter     
                        (
                            Descendants     
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                                SELF     
                            ),
                            not     
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
                            )     
                        )    
                    )
                )
            )
        )
        )' 
    member [Measures].[Факт ] 
    as 'IIF(((
            [Measures].[Факт],
            [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего] 
        ) + 
        (
            [Measures].[Факт],
            [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего] 
        )) = null, 0, 
        (
            [Measures].[Факт],
            [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего] 
        ) + 
        (
            [Measures].[Факт],
            [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего] 
        ))' 
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого] 
    as ' Aggregate( [Районы] )' 
    member [Measures].[Долг МО] 
    as 'IIF 
        (
            (
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
                    [Measures].[Факт ] 
                ) = 0 or 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
                    [Measures].[Факт ] 
                ) = null or 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)] 
                ) 
            ),
            null,
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Measures].[Факт ] 
            ) / 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
                [Measures].[Факт ] 
            ) 
        ) ' 
    member [Measures].[Доходы] 
    as ' LookupCube 
        (
            "[ФО_МесОтч_Доходы]",
            " 
            (
                [Measures].[Факт],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[Доходы бюджета - Всего],
                " + MemberToStr 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Период__Период].[Период__Период].CurrentMember 
                ) + " 
            )" 
        ) ' 
    member [Measures].[Безвозм поступления] 
    as ' LookupCube 
        (
            "[ФО_МесОтч_Доходы]",
            " 
            (
                [Measures].[Факт],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ],
                " + MemberToStr 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Период__Период].[Период__Период].CurrentMember 
                ) + " 
            )" 
        ) ' 
    member [Measures].[Доходы без безвозм поступлений] 
    as ' [Measures].[Доходы] - [Measures].[Безвозм поступления]' 
    member [Measures].[Отношение долга к доходам] 
    as 'IIF 
        (
            [Measures].[Доходы без безвозм поступлений] <> 0 and [Measures].[Доходы без безвозм поступлений] <> null,
            [Measures].[Факт ] / [Measures].[Доходы без безвозм поступлений],
            0 
        )' 
    member [Measures].[Ранг] 
    as 'IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого] OR [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)],
            null,
            
                Rank 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                    Order 
                    (
                        Filter 
                        (
                            { [Районы] },
                           not 
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого] 
                            ) 
                        ),
                       [Measures].[Объем долга на душу населения со множителем],
                        basc
                    ),
                    -[Measures].[Объем долга на душу населения со множителем] 
                ) 
            ) 
        ' 
    member [Measures].[Худший ранг] 
    as '
       
            max 
            (
                Filter 
                (
                    {
                        [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)] + [Районы] 
                    },
                    [Measures].[Факт ] 
                ),
                [Measures].[Ранг] 
            ) 
        ' 
    member [Measures].[Долг за предыдущий год] 
    as ' 
        (
            [Measures].[Факт ],
            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_prev_year%>].[<%period_halfyear%>].[<%period_quater%>].[<%period_month%>] 
        )' 
    member [Measures].[Изменение за год] 
    as '
        (
            [Measures].[Факт ] - [Measures].[Долг за предыдущий год]
        )' 
    member [Measures].[Долг к началу года] 
    as 'IIF(
    (
            [Measures].[Факт ],
            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_prev_year%>].[Полугодие 2].[Квартал 4].[Декабрь] 
        ) = null, 0,
        (
            [Measures].[Факт ],
            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_prev_year%>].[Полугодие 2].[Квартал 4].[Декабрь] 
        )
        )' 
    member [Measures].[Изменение к началу года] 
    as '
        (
            [Measures].[Факт ] - [Measures].[Долг к началу года]
        )' 
    member [Measures].[Численность населения] 
    as 'IIF( IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
            sum 
            (
                Filter 
                (
                    { [Районы]   },
                    not IsEmpty
                    (
                        [Measures].[Долг к началу года со множителем]
                    ) OR not IsEmpty
                    (
                        [Measures].[Факт со множителем]
                    ) 
                ),
                [Measures].[Численность населения] 
            ),
            IIF 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)],
                sum 
                (
                    [Районы],
                    [Measures].[Численность населения]   
                ),
                LookupCube 
                (
                    "[СТАТ_Население_Численность и состав]",
                    " 
                    (
                        [Measures].[За период],
                        [Группировки__Население_Численность и состав].[Все группировки].[По городам и районам],
                        [Население__Численность и состав].[Все показатели].[Численность населения на начало года],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[<%period_year%>],
                        " + MemberToStr 
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                        ) + " 
                    )" 
                ) 
            )
        ) = null, 0,
    IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
            sum 
            (
                Filter 
                (
                    { [Районы]   },
                    not IsEmpty
                    (
                        [Measures].[Долг к началу года со множителем]
                    ) OR not IsEmpty
                    (
                        [Measures].[Факт со множителем]
                    ) 
                ),
                [Measures].[Численность населения] 
            ),
            IIF 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)],
                sum 
                (
                    [Районы],
                    [Measures].[Численность населения]   
                ),
                LookupCube 
                (
                    "[СТАТ_Население_Численность и состав]",
                    " 
                    (
                        [Measures].[За период],
                        [Группировки__Население_Численность и состав].[Все группировки].[По городам и районам],
                        [Население__Численность и состав].[Все показатели].[Численность населения на начало года],
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[<%period_year%>],
                        " + MemberToStr 
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                        ) + " 
                    )" 
                ) 
            )
        ))' 
    member [Measures].[Объем долга на душу населения со множителем] 
    as 'IIF(IIF 
        (
            [Measures].[Численность населения] = null OR [Measures].[Численность населения] = 0,
            null,
            (
                [Measures].[Факт со множителем]/[Measures].[Численность населения] 
            )
        ) = null, 0,
        IIF 
        (
            [Measures].[Численность населения] = null OR [Measures].[Численность населения] = 0,
            null,
            (
                [Measures].[Факт со множителем]/[Measures].[Численность населения] 
            )
        ))' 
    member [Measures].[Факт со множителем] 
    as '[Measures].[Факт ] / <%rubMultiplier%>' 
    member [Measures].[Долг к началу года со множителем] 
    as '[Measures].[Долг к началу года] / <%rubMultiplier%>' 
    member [Measures].[Доходы со множителем] 
    as '[Measures].[Доходы] / <%rubMultiplier%>' 
    member [Measures].[Безвозм поступления со множителем] 
    as '[Measures].[Безвозм поступления] / <%rubMultiplier%>' 
    member [Measures].[Доходы без безвозм поступлений со множителем] 
    as '[Measures].[Доходы без безвозм поступлений] / <%rubMultiplier%>' 
    member [Measures].[Изменение за год со множителем] 
    as '[Measures].[Изменение за год] / <%rubMultiplier%>' 
    member [Measures].[Изменение к началу года со множителем] 
    as '[Measures].[Изменение к началу года] / <%rubMultiplier%>'  
select
    {
        [Measures].[Долг к началу года со множителем],
        [Measures].[Факт со множителем],
        [Measures].[Изменение к началу года со множителем],
        [Measures].[Численность населения],
        [Measures].[Объем долга на душу населения со множителем],
        [Measures].[Ранг]
    } on columns,
    {
        --Filter 
        --(
            --{
                [Районы] + 
                {
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)]
                } 
            --},
            --not IsEmpty
            --(
              --  [Measures].[Долг к началу года со множителем]
            --) OR not IsEmpty
            --(
              --  [Measures].[Факт со множителем]
            --) 
        --) 
    } on rows 
from [ФО_МесОтч_СпрВнутрДолг] 
where 
    (
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[<%level_budget%>],
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_halfyear%>].[<%period_quater%>].[<%period_month%>] 
    ) 
]]>
  </query>

</root>