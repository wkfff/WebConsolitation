<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="STAT_0002_0008_Date">
    <![CDATA[
-- STAT_0002_0008_Date  
with  
    member [Measures].[Имя]  
    as 'IIF  
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            [Период__Период].[Период__Период].CurrentMember.Name + " год",
            [Период__Период].[Период__Период].CurrentMember.Name  
        )'  
    member [Measures].[Уникальное имя]  
    as 'IIF  
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            Tail  
            (
                Filter  
                (
                    Descendants  
                    (
                        [Период__Период].[Период__Период].CurrentMember,
                        [Период__Период].[Период__Период].[Месяц],
                        SELF  
                    ),
                    not  
                    (
                        [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].CurrentMember.Parent.DataMember  
                    ) and  not IsEmpty( [Measures].[Факт] )  
                )  
            ).Item(0).UniqueName,
            [Период__Период].[Период__Период].CurrentMember.UniqueName  
        )'  
    member [Measures].[Уровень]  
    as 'IIF  
        (
            [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год],
            0,
            IIF
            (
                [Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Месяц],
                1,
                2 
            )
        )' 
    set [Периоды]  
    as 'Generate  
        (
            {
                [Период__Период].[Период__Период].[Данные всех периодов].[2011] : [Период__Период].[Период__Период].[Данные всех периодов].[2020]  
            },
            {
                [Период__Период].[Период__Период].CurrentMember  
            } + Filter  
            (
                Descendants  
                (
                    [Период__Период].[Период__Период].CurrentMember,
                    [Период__Период].[Период__Период].[Месяц],
                    SELF_AND_AFTER 
                ),
                not  
                (
                    [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].CurrentMember.Parent.DataMember  
                )  
            )  
        )'  
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]  
    } on columns,
    Filter  
    (
        [Периоды],
        not IsEmpty([Measures].[Значение])  
    ) on rows  
from  [ЭО_Банки]  
where  
    (
        [Источники данных].[Источники данных].[Все источники данных].[ЭО Банки - ДЭ Ежемесячная отч],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ]  
    )  
	]]>
  </query>

  <query id="STAT_0002_0008_list_of_dates">
    <![CDATA[ -- name: ORG_0001_0004_list_of_dates
select
    {[Measures].[Значение]} on columns,
    {
        filter
        (
            [Период__Период].[Период__Период].[День].members,
            [Measures].[Значение] > 0
        )
    } on rows
from [ЭО_Банки] 
where
    (
       [Источники данных].[Источники данных].[Все источники данных].[ЭО Банки - ДЭ Ежемесячная отч],
       [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ]  
    )
    ]]>
  </query>
  
  <query id="STAT_0002_0008_grid">
    <![CDATA[
-- STAT_0002_0008_grid
WITH   
    member [Measures].[Значение ]   
    as '   
        (
            [Measures].[Значение],
            <%current_period%>  
        )'   
    member [Measures].[Отклонение]   
    as ' IIF    
        (
            isempty   
            (
                (
                    [Measures].[Значение],
                    <%current_period%>    
                )  
            ) OR 
            isempty   
            (
                (
                    [Measures].[Значение]
                    <%last_period%>   
                )  
            ) OR 
            (
                    [Measures].[Значение],
                    <%current_period%>  
                ) = 0,
            null,
            IIF([Банки__Типы банковских услуг].[Банки__Типы банковских услуг].CurrentMember is [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Наименование],
    [Банки__Реестр банков].[Банки__Реестр банков].CurrentMember.Name,
        (
            [Measures].[Значение],
            <%current_period%>  
        )-   
        (
            [Measures].[Значение]
            <%last_period%>   
        )
     )
  )'   
    member [Measures].[Прирост]    
    as 'IIF    
        (
            isempty( [Measures].[Значение ]) OR [Measures].[Значение ] = 0,
            null,
            IIF   
        (
            [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].CurrentMember is [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Наименование],
            [Банки__Реестр банков].[Банки__Реестр банков].CurrentMember.Name,
            IIF 
            (
                [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].CurrentMember is [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Тип строки],
                1,
                IIF    
                (
                    (
                        [Measures].[Значение]
                        <%last_period%>     
                    ) = 0,
                    null,
                    (
                        (
                            (
                                [Measures].[Значение],
                                <%current_period%>
                            )/    
                            (
                                [Measures].[Значение]
                                <%last_period%> 
                            )   
                        ) - 1 
                    )  
                )    
            )
        )
     )'   
    member [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Тип строки]   
    as 'IIF   
        (
            [Measures].CurrentMember is [Measures].[Значение ],
            "0",
            IIF   
            (
                [Measures].CurrentMember is [Measures].[Прирост],
                "1",
                "2"   
            )   
        )'  
    member [Банки__Основные показатели].[Банки__Основные показатели].[Тип строки]  
    as 'IIF  
        (
            [Measures].CurrentMember is [Measures].[Значение ],
            "0",
            IIF  
            (
                [Measures].CurrentMember is [Measures].[Прирост],
                "1",
                "2"  
            )  
        )'  
      member [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все ]
      as 'Aggregate ({
              [Банки__Реестр банков].[Банки__Реестр банков].[Все банки].[Значение не указано]
      })'
    member [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Наименование] 
    as '[Банки__Реестр банков].[Банки__Реестр банков].CurrentMember.Name' 
SELECT
    {
        {
            [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Наименование]
        }
        *
        {
            [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели]
        },
        {
            {
                {
                  [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Значение не указано]  
                }   
                *   
                {
                    [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели].[Объем выданных кредитов]
                 
                }
                +
                {
                                        [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Значение не указано]
                }   
                *   
                {
                    [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели].[Доля отказов по кредитным продуктам от общего числа заявок на кредиты]   
                } 
            } +   
            {
                {
                    [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Потребительские кредиты],
                    [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Ипотечные кредиты]   
                }   
                *   
                {
                    [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели].[Объем выданных кредитов],
                    [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели].[Количество выданных кредитов],
                    [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели].[Процентная ставка],
                    [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели].[Сроки кредитования]   
                }   
            }+   
            {
                {
                    [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Тип строки]   
                }   
                *   
                {
                    [Банки__Основные показатели].[Банки__Основные показатели].[Тип строки]  
                }   
            }   
        }   
    }on columns,
    non empty   
    {
        {
            filter
            (
                [Банки__Реестр банков].[Банки__Реестр банков].[Все банки].Children -[Банки__Реестр банков].[Банки__Реестр банков].[Все банки].[Значение не указано],
                not isempty (Measures.CurrentMember)
            ) 
        }    
        *   
        {
            [Measures].[Значение ],
            [Measures].[Отклонение],
            [Measures].[Прирост]   
        }   
    } on rows   
FROM  [ЭО_Банки]   
WHERE   
    (
        [Источники данных].[Источники данных].[Все источники данных].[ЭО Банки - ДЭ Ежемесячная отч],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ]   
    )           
  ]]>
  </query>

  <query id="STAT_0002_0008_chart">
    <![CDATA[
-- STAT_0002_0008_chart
With
member [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Объём потребительских кредитов]
as 'IIF(
[Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Потребительские кредиты] = 0,
null, [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Потребительские кредиты])'
member [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Объём ипотечных кредитов]
as 'IIF([Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Ипотечные кредиты] = 0,
null, [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Все].[Ипотечные кредиты])'
SELECT
    {
        [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Объём потребительских кредитов],
        [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Объём ипотечных кредитов]      
    }      on columns,
    non empty 
    {
        Order({[Банки__Реестр банков].[Банки__Реестр банков].[Все банки].Children -[Банки__Реестр банков].[Банки__Реестр банков].[Все банки].[Значение не указано]}, Aggregate({[Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Объём потребительских кредитов],
        [Банки__Типы банковских услуг].[Банки__Типы банковских услуг].[Объём ипотечных кредитов]}), BASC)
    } on rows      
FROM  [ЭО_Банки]      
WHERE      
    (
        [Measures].[Значение],
        <%current_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[ЭО Банки - ДЭ Ежемесячная отч],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
        [Банки__Основные показатели].[Банки__Основные показатели].[Все показатели].[Объем выданных кредитов]    
    )             
  ]]>
  </query>

</root>