<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0535_0015_incomes_date">
    <![CDATA[
    --FO_0535_0015_incomes_date
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Факт]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_МесОтч_Доходы]
  ]]>
  </query>

    <query id="FO_0535_0015_population">
        <![CDATA[
--FO_0535_0015_population    
with member [Measures].[За период ]
as '[Measures].[За период] * 1000'
select
    {  [Measures].[За период ] } on columns 
from [СТАТ_Население_Численность и состав] 
where    
    (
        [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Численность населения на начало года],
        [Группировки__Население_Численность и состав].[Группировки__Население_Численность и состав].[Все группировки].[По городам и районам],
        <%filter%>,
        <%population_date%>
    ) 
    ]]>
    </query>

    <query id="FO_0535_0015_population_date">
        <![CDATA[
--FO_0535_0015_population_date   
with  
    member [Measures].[ДанныеНа]  
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName'  
    set [NonEmptySet]  
    as 'Tail  
        (
            Filter  
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].Members,
                

                    (
                        [Measures].[За период],
                        [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Численность населения на начало года],
                        [Группировки__Население_Численность и состав].[Группировки__Население_Численность и состав].[Все группировки].[По городам и районам]
                    ) > 0
                 and [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Остатки на начало года" and 
                 [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные квартала" and 
                 [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные полугодия" and 
                 [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные года" and 
                 [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name <> "Данные месяца"
            ),
            1  
        )'  
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows  
from [СТАТ_Население_Численность и состав] 
    ]]>
    </query>

  <query id="FO_0535_0015_population_allMO">
    <![CDATA[
--FO_0535_0015_population_allMO

  with member [Measures].[За период ]
as '[Measures].[За период]'
set [Все районы] 
    as '{
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        }' 
    select
    {  [Measures].[За период ] } on columns,
    {[Все районы]}  on rows
from [СТАТ_Население_Численность и состав]    
where    
    (
        [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Численность населения на начало года],
        [Группировки__Население_Численность и состав].[Группировки__Население_Численность и состав].[Все группировки].[По городам и районам],
        <%population_date%>
    )    
    ]]>
  </query>

  <query id="FO_0535_0015_outcomes_date">
    <![CDATA[
    --FO_0535_0015_outcomes_date
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Факт]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_МесОтч_Расходы]
  ]]>
  </query>

  <query id="FO_0535_0015_Incomes_allMO">
    <![CDATA[
--FO_0535_0015_Incomes_allMO  
   with set [Все районы] 
    as '{
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        }' 
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ]   
    as '  
        (
            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты].[Средства бюджетов, передаваемые бюджетам на переселение граждан из закрытых административно-территориальных образований].[Средства бюджетов, передаваемые бюджетам муниципальных образований на осуществление части полномочий по решению вопросов местного значения в соответствии с заключенными соглашениями],
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]   
        )'   
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]   
    as '  
        (
            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации],
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]   
        )'   
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[Доходы бюджета - ИТОГО ]    
    as '<%income_total%> - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ] - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]' 
select
    {        
        [Measures].[Факт]  
    } on columns,
    {[Все районы] } on rows
from [ФО_МесОтч_Доходы]         
where         
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [КД__Сопоставимый План].[КД__Сопоставимый План].[Доходы бюджета - ИТОГО ],
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]          
    )         
  ]]>
  </query>
  
  <query id="FO_0535_0015_Incomes">
    <![CDATA[
--FO_0535_0015_Incomes
with         
    member Measures.[Численность постоянного населения]         
    as '<%population_value%>'         
    member Measures.[Среднедушевые доходы]         
    as 'IIF         
        (
            IsEmpty         
            (
                Measures.[Численность постоянного населения]         
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            [Measures].[Факт]/         
            (
                Measures.[Численность постоянного населения]         
            )         
        )'         
    member Measures.[Ранг процент]         
    as 'IIF         
        (
            IsEmpty         
            (
                [Measures].[% выполнения годовых назначений]         
            ),
            null,
            Rank         
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order         
                (
                    Filter         
                    (
                        [Все районы],
                        not IsEmpty         
                        (
                            [Measures].[% выполнения годовых назначений]         
                        )         
                    ),
                    [Measures].[% выполнения годовых назначений],
                    BDESC      
                ),
                [Measures].[% выполнения годовых назначений]         
            )         
        )'         
    member Measures.[Худший ранг процент]         
    as 'max         
        (
            [Все районы]   ,
            Measures.[Ранг процент]         
        )'         
    member Measures.[Ранг среднедуш]         
    as 'IIF         
        (
            IsEmpty         
            (
                Measures.[Среднедушевые доходы]         
            ),
            null,
            Rank         
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order         
                (
                    Filter         
                    (
                        [Все районы],
                        not IsEmpty         
                        (
                            Measures.[Среднедушевые доходы]         
                        )         
                    ),
                    Measures.[Среднедушевые доходы],
                    BDESC      
                ),
                Measures.[Среднедушевые доходы]         
            )         
        )'         
    member Measures.[Худший ранг среднедуш]         
    as 'max 
        (
            [Все районы]  ,
            Measures.[Ранг среднедуш]         
        )'     
    set [Все районы] 
    as '{
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        }' 
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
         member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ]   
    as '  
        (
            	[КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты].[Средства бюджетов, передаваемые бюджетам на переселение граждан из закрытых административно-территориальных образований].[Средства бюджетов, передаваемые бюджетам муниципальных образований на осуществление части полномочий по решению вопросов местного значения в соответствии с заключенными соглашениями],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]   
        )'   
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]   
    as '  
        (
            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]   
        )'   
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[Доходы бюджета - ИТОГО ]    
    as '<%income_total%> - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ] - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]' 
     member [Measures].[% выполнения годовых назначений ]
         as 'IIF 
         (
            not isEmpty ([Measures].[Годовые назначения]) and 
            not ([Measures].[Годовые назначения] = 0),
            [Measures].[Факт] /[Measures].[Годовые назначения], null
         )' 
select
    {
        [Measures].[Годовые назначения],
        [Measures].[Факт],
        [Measures].[% выполнения годовых назначений ],
        Measures.[Ранг процент],
        Measures.[Худший ранг процент],
        Measures.[Численность постоянного населения],
        Measures.[Среднедушевые доходы],
        Measures.[Ранг среднедуш],
        Measures.[Худший ранг среднедуш]        
    } on columns,
    {<%filter%>  } on rows
from [ФО_МесОтч_Доходы]         
where         
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [КД__Сопоставимый План].[КД__Сопоставимый План].[Доходы бюджета - ИТОГО ],
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]          
    )         
  ]]>
  </query>

  <query id="FO_0535_0015_Outcomes_allMO">
    <![CDATA[
--FO_0535_0015_Outcomes_allMO
    with    
   member [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Фильтр]     
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО] -
    [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Перечисления другим бюджетам бюджетной системы Российской Федерации ]'
    member [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Перечисления другим бюджетам бюджетной системы Российской Федерации ]    
    as 'LookupCube    
        (
            "[ФО_МесОтч_Расходы]",
            "Sum    
            (
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]   
                }  ,
                (
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам].[Перечисления другим бюджетам бюджетной системы Российской Федерации],
                    [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                    " + MemberToStr    
                    (
                        [Период__Период].[Период__Период].CurrentMember    
                    ) + ",
                             " + MemberToStr    
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].CurrentMember    
                    ) + ",
                    " + MemberToStr ( [Measures].CurrentMember ) + ",
                    " + MemberToStr    
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember    
                    ) + "    
                )    
            ) "
        ) '
    set [Все районы] 
    as ' 
        {
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        }'
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
select
    {
        
        [Measures].[Факт]
    } on columns ,  
    {[Все районы] } on rows
from [ФО_МесОтч_Расходы]   
where   
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        [РзПр].[Сопоставимый].[Фильтр]        
    )   
  ]]>
  </query>
  
  <query id="FO_0535_0015_Outcomes">
    <![CDATA[
    --FO_0535_0015_Outcomes
with    
   member [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Фильтр]     
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета – Всего (без внутренних оборотов]'
    member [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Перечисления другим бюджетам бюджетной системы Российской Федерации ]    
    as 'LookupCube    
        (
            "[ФО_МесОтч_Расходы]",
            "Sum    
            (
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]   
                }  ,
                (
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам].[Перечисления другим бюджетам бюджетной системы Российской Федерации],
                    [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                    " + MemberToStr    
                    (
                        [Период__Период].[Период__Период].CurrentMember    
                    ) + ",
                             " + MemberToStr    
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].CurrentMember    
                    ) + ",
                    " + MemberToStr ( [Measures].CurrentMember ) + ",
                    " + MemberToStr    
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember    
                    ) + "    
                )    
            ) "
        ) '
    member Measures.[Ранг процент]   
    as 'IIF   
        (
            IsEmpty   
            (
                [Measures].[% выполнения годовых назначений] 
            ),
            null,
            Rank   
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order   
                (
                    Filter   
                    (
                        [Все районы],
                        not IsEmpty   
                        (
                            [Measures].[% выполнения годовых назначений] 
                        )   
                    ),
                    [Measures].[% выполнения годовых назначений],
                    DESC   
                ),
                [Measures].[% выполнения годовых назначений] 
            )   
        )'   
    member Measures.[Худший ранг процент]   
    as 'max   
        (
            [Все районы],
            Measures.[Ранг процент]   
        )' 
    member Measures.[Ранг бюджетной обеспеченности]   
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Коэффициент бюджетной обеспеченности населения]   
            ),
            null,
            Rank   
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order   
                (
                    Filter   
                    (
                        [Все районы],
                        not IsEmpty   
                        (
                            Measures.[Коэффициент бюджетной обеспеченности населения]   
                        )   
                    ),
                    Measures.[Коэффициент бюджетной обеспеченности населения],
                    DESC   
                ),
                Measures.[Коэффициент бюджетной обеспеченности населения]   
            )   
        )'   
    member Measures.[Худший ранг бюджетной обеспеченности]   
    as 'max   
        (
            [Все районы] ,
            Measures.[Ранг бюджетной обеспеченности]   
        )'     
    member Measures.[Численность постоянного населения]   
    as '<%population_value%>'   
    member Measures.[Коэффициент бюджетной обеспеченности населения]   
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Численность постоянного населения]   
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            [Measures].[Факт]/
            (
                Measures.[Численность постоянного населения]  
            )   
        )'  
set [Все районы] 
    as ' 
        {
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        }'
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
         member [Measures].[% выполнения годовых назначений ]
         as 'IIF 
         (
            not isEmpty ([Measures].[Годовые назначения]) and 
            not ([Measures].[Годовые назначения] = 0),
            [Measures].[Факт] /[Measures].[Годовые назначения], null
         )' 
select
    {
        [Measures].[Годовые назначения],
        [Measures].[Факт],
        [Measures].[% выполнения годовых назначений ],
        Measures.[Ранг процент],
        Measures.[Худший ранг процент],       
        Measures.[Численность постоянного населения],
        Measures.[Коэффициент бюджетной обеспеченности населения],
        Measures.[Ранг бюджетной обеспеченности],
        Measures.[Худший ранг бюджетной обеспеченности] 
    } on columns ,  
    {<%filter%> } on rows
from [ФО_МесОтч_Расходы]   
where   
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        [РзПр].[Сопоставимый].[Фильтр]        
    )   
  ]]>
  </query>

  <query id="FO_0535_0015_Inner_Debt">
    <![CDATA[  
    --FO_0535_0015_Inner_Debt
    with
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
    select
    { [Measures].[Факт] } on columns,
    { [Показатели].[СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего] } on rows
from  [ФО_МесОтч_СпрВнутрДолг] 
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
        <%filter%>,  
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    )
     ]]>
  </query>

  <query id="FO_0535_0015_Incomes_without_BP">
    <![CDATA[
--FO_0535_0015_Incomes_without_BP    
with
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[БП]
    as '
        (
            [Measures].[Годовые назначения],
            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ]
        )'
     member [КД__Сопоставимый План].[КД__Сопоставимый План].[НДФЛ]
    as '
        (
            [Measures].[Годовые назначения],
           [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]
        ) * [КД__Сопоставимый План].[КД__Сопоставимый План].[Делитель]'
     member [КД__Сопоставимый План].[КД__Сопоставимый План].[Доходы без БП ]
    as '[КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[Доходы бюджета – Всего (без внутренних оборотов)] - [КД__Сопоставимый План].[КД__Сопоставимый План].[БП] -
        [КД__Сопоставимый План].[КД__Сопоставимый План].[Доп норматив]'
         member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ]
    as '
        (
            	[КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты].[Средства бюджетов, передаваемые бюджетам на переселение граждан из закрытых административно-территориальных образований].[Средства бюджетов, передаваемые бюджетам муниципальных образований на осуществление части полномочий по решению вопросов местного значения в соответствии с заключенными соглашениями],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]
        )'
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]
    as '
        (
            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]
        )'
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[Доходы бюджета - ИТОГО ]
    as '[КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[Доходы бюджета - ИТОГО] - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ] - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]'
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[Доп норматив]
    as 'LookupCube
        (
            "[ФО_БККУ_Исходные данные]",
            "
            (
                [Показатели__БККУ_Исходные данные].[Показатели__БККУ_Исходные данные].[Все показатели].[Первоначально утвержденная сумма дополнительного норматива],
                [Период__Период].[Период__Период].[Данные всех периодов].[2011],
                " + MemberToStr
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                ) + "
            )"
        )'
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[Делитель]
    as '
        (
            10 + [КД__Сопоставимый План].[КД__Сопоставимый План].[Доп норматив]
        ) /
        (
            40 + [КД__Сопоставимый План].[КД__Сопоставимый План].[Доп норматив]
        )'
select
    {
        [КД__Сопоставимый План].[КД__Сопоставимый План].[Доходы без БП ],
        [КД__Сопоставимый План].[КД__Сопоставимый План].[БП],
        [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований]
    }   on columns,
    {
        [Measures].[Годовые назначения]
    }  on rows
from   [ФО_МесОтч_Доходы]
where  
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>, 
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
        <%filter%>
    )  ]]>
  </query>

  <query id="FO_0535_0015_inner_fin_source">
    <![CDATA[
    --FO_0535_0015_inner_fin_source
   with
     member [Measures].[Факт ]
    as '
        (
            [Measures].[Факт],
            [КИФ__Сопоставимый].[КИФ__Сопоставимый].[Все источники финансирования].[ИСТОЧНИКИ ВНУТРЕННЕГО ФИНАНСИРОВАНИЯ ДЕФИЦИТОВ БЮДЖЕТОВ].[Бюджетные кредиты от других бюджетов бюджетной системы Российской Федерации]
        )'
   member [Measures].[Изменение остатков план ]  
    as '  
        (
            [Measures].[Годовые назначения],
            [КИФ__Сопоставимый].[КИФ__Сопоставимый].[Все источники финансирования].[ИСТОЧНИКИ ВНУТРЕННЕГО ФИНАНСИРОВАНИЯ ДЕФИЦИТОВ БЮДЖЕТОВ].[Изменение остатков средств на счетах по учету средств бюджета]
        )'  
    member [Measures].[Продажа акций план ]  
    as '  
        (
            [Measures].[Годовые назначения],
            [КИФ__Сопоставимый].[КИФ__Сопоставимый].[Все источники финансирования].[ИСТОЧНИКИ ВНУТРЕННЕГО ФИНАНСИРОВАНИЯ ДЕФИЦИТОВ БЮДЖЕТОВ].[Иные источники внутреннего финансирования дефицитов бюджетов].[Акции и иные формы участия в капитале, находящиеся в государственной и муниципальной собственности].[Средства от продажи акций и иных форм участия в капитале, находящихся в государственной и муниципальной собственности] 
        )'  
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
member [Measures].[План ] 
    as ' 
        (
            [Measures].[Годовые назначения],
            [КИФ__Сопоставимый].[КИФ__Сопоставимый].[Все источники финансирования].[ИСТОЧНИКИ ВНУТРЕННЕГО ФИНАНСИРОВАНИЯ ДЕФИЦИТОВ БЮДЖЕТОВ].[Бюджетные кредиты от других бюджетов бюджетной системы Российской Федерации] 
        )' 
select
    {
        [Measures].[Факт ],
        [Measures].[Изменение остатков план ],
        [Measures].[Продажа акций план ],
        [Measures].[План ] }
 on columns,
    {
        <%filter%>
    }  on rows
from   [ФО_МесОтч_ИсточникВнутрФинансирования]
where
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)]
    )
    ]]>
  </query>

  <query id="FO_0535_0015_Deficite">
    <![CDATA[  
    --FO_0535_0015_Deficite
  with      
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]      
    as 'Aggregate      
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]   
            }      
        )'      
select
    {
        [Measures].[Годовые назначения]
    }   on columns,
    {
<%filter%>
    }  on rows        
from    [ФО_МесОтч_Дефицит Профицит]
where        
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)]       
    )  ]]>
  </query>

  <query id="FO_0535_0015_Outcomes_debt">
    <![CDATA[
   --FO_0535_0015_Outcomes_debt
with
    member [РзПр].[Сопоставимый].[Slicer]
    as ' Aggregate
        (
            {
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОБЩЕГОСУДАРСТВЕННЫЕ ВОПРОСЫ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ОБОРОНА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ БЕЗОПАСНОСТЬ И ПРАВООХРАНИТЕЛЬНАЯ ДЕЯТЕЛЬНОСТЬ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ЭКОНОМИКА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОХРАНА ОКРУЖАЮЩЕЙ СРЕДЫ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОБРАЗОВАНИЕ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[КУЛЬТУРА, КИНЕМАТОГРАФИЯ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[СРЕДСТВА МАССОВОЙ ИНФОРМАЦИИ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ЗДРАВООХРАНЕНИЕ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Физическая культура и спорт],
                [РзПр].[Сопоставимый].[Все коды ФКР].[СОЦИАЛЬНАЯ ПОЛИТИКА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ]
            }
        )'
    member Measures.[Расходы на обслуживание долга]
    as '
        (
            [Measures].[Годовые назначения],
            [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Обслуживание государственного (муниципального) долга]
        )'
        member Measures.[Расходы итого]
    as '
        (
            [Measures].[Годовые назначения],
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета – Всего (без внутренних оборотов]
        )'
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
select
    {
        Measures.[Расходы на обслуживание долга],
        Measures.[Расходы итого]
    }   on columns,
    {
        <%filter%>     
    }  on rows      
from    [ФО_МесОтч_Расходы]  
where      
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)] 
    ) 
]]>
  </query>

  <query id="FO_0535_0015_credit_debts">
    <![CDATA[
with    
    member [Measures].[Факт ]    
    as 'IIF    
        (
            IsEmpty ([Measures].[Факт]),
            0,
            [Measures].[Факт] / 1000   
        )'    
    member [Показатели].[СопМесОСпЗадо].[Оплата труда]    
    as 'Aggregate    
        (
            {
                [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего].[по заработной плате],
                [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего].[по начислениям на выплаты по  оплате труда]    
            }    
        )'    
    member Measures.[Задолженность на начало года]  
    as '    
        (
            [Measures].[Факт ],
            [Период].[Период].[Данные всех периодов].<%period_last_year%>
        )'  
    member Measures.[Прирост ]  
    as '  
        (
            [Measures].[Факт ] - Measures.[Задолженность на начало года] 
        )'  
   member [Показатели].[СопМесОСпЗадо].[прочая] 
    as '[Показатели].[СопМесОСпЗадо].[Всего ] -
       [Показатели].[СопМесОСпЗадо].[по оплате труда с начислениями ] -
       [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего].[по коммунальным услугам]'
member [Показатели].[СопМесОСпЗадо].[Всего ] 
    as ' 
        (
            [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего] 
        )' 
    member [Показатели].[СопМесОСпЗадо].[по оплате труда с начислениями ] 
    as 'Aggregate 
        (
            {
                [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего].[по заработной плате],
                [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего].[по начислениям на выплаты по  оплате труда] 
            } 
        )' 
select
    {
        Measures.[Задолженность на начало года],
        [Measures].[Факт ],
        Measures.[Прирост ] 
    }   on columns,
    {
        [Показатели].[СопМесОСпЗадо].[Всего ],
        [Показатели].[СопМесОСпЗадо].[по оплате труда с начислениями ],
        [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего].[по коммунальным услугам],
        [Показатели].[СопМесОСпЗадо].[прочая] 
    }  on rows 
from   [ФО_МесОтч_СпрЗадолженность]    
where  
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%> 
    )
  ]]>
  </query>

  <query id="FO_0535_0015_MoGroup">
    <![CDATA[  
    --FO_0535_0015_MoGroup
  WITH 
    SET [NonFilterColumnSet] 
    AS ' {[Measures].[Значение]}' 
SELECT
    [NonFilterColumnSet] ON COLUMNS 
FROM [ФО_БККУ_Показатели] 
WHERE 
    (
        [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО] ,
        <%filter%>,
        [Период__Период].[Период__Период].[Данные всех периодов].[2011] 
    ) 
    ]]>
  </query>

  <query id="FO_0535_0015_budget_outcomes">
    <![CDATA[
    --FO_0535_0015_budget_outcomes
   with       
    member [КОСГУ].[Сопоставимый].[Оплата труда с начислениями ]    
    as ' [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Заработная плата] + [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Начисления на выплаты по оплате труда] ' 
    member [КОСГУ].[Сопоставимый].[Капитальные вложения ]    
    as '
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости основных средств] +
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости нематериальных активов]    
            '
    member [КОСГУ].[Сопоставимый].[Иные расходы ]    
    as ' 
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Прочие выплаты]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Обслуживание государственного (муниципального) долга]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления организациям]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Прочие расходы]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости непроизведенных активов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости материальных запасов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление финансовых активов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Выбытие финансовых активов]    
            '
    member [РзПр].[Сопоставимый].[FKRSlicer]    
    as ' Aggregate    
        (
            Filter 
            (
                [РзПр].[Сопоставимый].[Все коды ФКР].Children,
                [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9700" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9701" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9702" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9703" 
            ) 
        )' 
    member Measures.[Исполнено тыс]    
    as '[Measures].[Факт] / 1000'    
    member Measures.[Исполнено прошлый год ]    
    as '[Measures].[Факт_прошлый год] / 1000'    
    member [Measures].[Темп роста ]   
    as ' IIF  
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] * 100 / [Measures].[Факт_прошлый год] 
        )'  
    member Measures.[Ранг ]    
    as 'null'    
    member Measures.[Худший ранг ]    
    as 'null'
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[Исполнено тыс],
        Measures.[Ранг ],
        Measures.[Темп роста ],
        Measures.[Худший ранг ]
    }  on columns,
    {
        [КОСГУ].[Сопоставимый].[Оплата труда с начислениями ],
        [КОСГУ].[Сопоставимый].[Капитальные вложения ],
        [КОСГУ].[Сопоставимый].[Иные расходы ]        
    } on rows             
from [ФО_МесОтч_Расходы]             
where             
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>,
        [РзПр].[Сопоставимый].[FKRSlicer]
    )  
    ]]>
  </query>

  <query id="FO_0535_0015_budget_outcomes_all">
    <![CDATA[
    --FO_0535_0015_budget_outcomes_all
   with    
    member [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ]  
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета – Всего (без внутренних оборотов]'
    member [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Перечисления другим бюджетам бюджетной системы Российской Федерации ]    
    as 'LookupCube    
        (
            "[ФО_МесОтч_Расходы]",
            "Sum    
            (
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]   
                }  ,
                (
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам].[Перечисления другим бюджетам бюджетной системы Российской Федерации],
                    [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                    " + MemberToStr    
                    (
                        [Период__Период].[Период__Период].CurrentMember    
                    ) + ",
                             " + MemberToStr    
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].CurrentMember    
                    ) + ",
                    " + MemberToStr ( [Measures].CurrentMember ) + ",
                    " + MemberToStr    
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember    
                    ) + "    
                )    
            ) "
        ) '
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000'    
    member Measures.[Темп роста ]
    as ' IIF
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] * 100 / [Measures].[Факт_прошлый год]
        )'
   
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as '[Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО]'
member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null'    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[Исполнено тыс],
        Measures.[Ранг ],
        Measures.[Темп роста ],
        Measures.[Худший ранг ]
    }  on columns,
    {
        [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ] 
    }  on rows 
from [ФО_МесОтч_Расходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>
    )
    ]]>
  </query>

  <query id="FO_0535_0015_budget_deficite">
    <![CDATA[
with     
    member [Районы].[Сопоставимый].[Профицит(+)/ Дефицит(-) ]
    as '<%filter%>' 
    member Measures.[Исполнено тыс]    
    as '[Measures].[Факт] / 1000'    
    member Measures.[Исполнено прошлый год ]    
    as '[Measures].[Факт_прошлый год] / 1000'    
    member [Measures].[Темп роста ]    
    as 'null'    
member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null'    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[Исполнено тыс],
        Measures.[Ранг ],
        Measures.[Темп роста ],
        Measures.[Худший ранг ]
    }  on columns,
    {
        [Районы].[Сопоставимый].[Профицит(+)/ Дефицит(-) ]  
    } on rows     
from [ФО_МесОтч_Дефицит Профицит]    
where    
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]    
    )
    ]]>
  </query>

  <query id="FO_0535_0015_budget_incomes">
    <![CDATA[
   with    
     member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ]   
    as '  
        (
            	[КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты].[Средства бюджетов, передаваемые бюджетам на переселение граждан из закрытых административно-территориальных образований].[Средства бюджетов, передаваемые бюджетам муниципальных образований на осуществление части полномочий по решению вопросов местного значения в соответствии с заключенными соглашениями],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]   
        )'   
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]   
    as '  
        (
            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]   
        )'   
    member <%incomes_KD_classifier%>.[ИТОГО ДОХОДОВ ] 
    as '<%income_total%> - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ] - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]' 
    member <%incomes_KD_classifier%>.[Налоговые и неналог. доходы ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]' 
    member <%incomes_KD_classifier%>.[Налог на прибыль организаций ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]' 
    member <%incomes_KD_classifier%>.[НДФЛ ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]' 
    member <%incomes_KD_classifier%>.[Акцизы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Налоги на имущ.орг. ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество организаций]' 
    member <%incomes_KD_classifier%>.[Налог на имущество физ.лиц ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц]' 
    member <%incomes_KD_classifier%>.[НДПИ ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]' 
    member <%incomes_KD_classifier%>.[Земельный налог ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог]' 
    member <%incomes_KD_classifier%>.[Оплата труда с начислениями ] 
    as 'Measures.CurrentMember' 
    member <%incomes_KD_classifier%>.[Капитальные вложения ] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Дефицит / профицит] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Материальные затраты ] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Дотация на выравн. бюдж.обеспеч. ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований].[Дотации на выравнивание бюджетной обеспеченности]' 
    member <%incomes_KD_classifier%>.[Прочие налоговые доходы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[СТРАХОВЫЕ ВЗНОСЫ НА ОБЯЗАТЕЛЬНОЕ СОЦИАЛЬНОЕ СТРАХОВАНИЕ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары (работы, услуги), реализуемые на территории Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары, ввозимые на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на игорный бизнес],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на недвижимость, взимаемый с объектов недвижимого имущества, расположенных в границах городов Великий Новгород и Тверь],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Регулярные платежи за добычу полезных ископаемых (роялти) при выполнении соглашений о разделе продукции],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Водный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Сборы за пользование объектами животного мира и за пользование объектами водных биологических ресурсов],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ГОСУДАРСТВЕННАЯ ПОШЛИНА],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ] 
            } - 
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на прибыль, доходы].[Налог на доходы физических лиц],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на совокупный доход],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на имущество].[Земельный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на имущество].[Налог на имущество физических лиц] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Неналоговые доходы ] 
    as '
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ВНЕШНЕЭКОНОМИЧЕСКОЙ ДЕЯТЕЛЬНОСТИ]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ]+
           <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ]
       '
        member <%incomes_KD_classifier%>.[Налоги на совокупный доход ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на совокупный доход]' 
      member [КД__Сопоставимый].[КД__Сопоставимый].[Субсидии ]  
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии от других бюджетов бюджетной системы Российской Федерации]'  
    member [КД__Сопоставимый].[КД__Сопоставимый].[Субвенции ]  
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции от других бюджетов бюджетной системы Российской Федерации]'  
    member <%incomes_KD_classifier%>.[Доходы от предпринимательской деятельности ] 
    as '<%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРЕДПРИНИМАТЕЛЬСКОЙ И ИНОЙ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]' 
    member <%incomes_KD_classifier%>.[Безвозмездные перечисл.от др.бюдж] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации]' 
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000' 
    member [Measures].[Темп роста]
    as ' IIF
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год]
        )'
    member [Measures].[Темп роста ] 
    as ' ( [Темп роста] * 100)' 
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null'    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[Исполнено тыс],
        Measures.[Ранг ],
        Measures.[Темп роста ],
        Measures.[Худший ранг ]
    }  on columns,
    non empty 
    {
        <%incomes_KD_classifier%>.[ИТОГО ДОХОДОВ ],
        <%incomes_KD_classifier%>.[Налоговые и неналог. доходы ],        
        <%incomes_KD_classifier%>.[НДФЛ ],
        <%incomes_KD_classifier%>.[Налоги на совокупный доход ],
        <%incomes_KD_classifier%>.[Земельный налог ],
        <%incomes_KD_classifier%>.[Налог на имущество физ.лиц ],
        <%incomes_KD_classifier%>.[Прочие налоговые доходы ],
        <%incomes_KD_classifier%>.[Неналоговые доходы ],
        <%incomes_KD_classifier%>.[Безвозмездные перечисл.от др.бюдж],
        <%incomes_KD_classifier%>.[Дотация на выравн. бюдж.обеспеч. ],
        <%incomes_KD_classifier%>.[Субсидии ],
        <%incomes_KD_classifier%>.[Субвенции ]
    }  on rows 
from [ФО_МесОтч_Доходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Конс.бюджет МО ],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>
    ) 
    ]]>
  </query>

  
  <query id="FNS_0001_0001_date">
    <![CDATA[
  with
member Measures.[ДанныеНа] as '<%period_dimension%>.CurrentMember.UniqueName'
select
    {Measures.[ДанныеНа]} on columns,
    Tail      
    (
        NonEmptyCrossjoin
        (
            OpeningPeriod    
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2010]
            ) : ClosingPeriod    
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2012]
            )
        )
    ) on rows
from [<%cube_name%>]
  ]]>
  </query>

  <query id="FNS_0001_0001">
    <![CDATA[
-- FNS_0002_0001_iphone
with
     member Measures.[Поступило итого]
    as '
        (
            [Measures].[С начала года],
            [ФНС_65н_Показатели].[Все].[Поступило - итого],
            [Период].[Период].[Данные всех периодов].<%period_year%>
        )/ 1000'
    member Measures.[Отношение недоимки* к поступлен.]
    as 'IIF
        (
            IsEmpty ([Поступило итого]) or [Поступило итого] = 0,
            null,
            Measures.[Недоимка на текущий месяц] / [Поступило итого]
        )'
    member [Measures].[Недоимка c начала года, тыс.руб.]
    as '
        (
            [Measures].[С начала года] / 1000
        )'
    member Measures.[Недоимка на начало года]
    as '
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_last_year%>
        )'
    member Measures.[Недоимка на текущий месяц]
    as '
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_year%>
        )'
    member Measures.[Прирост недоимки*]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Недоимка на текущий месяц]
            ),
            null,
            Measures.[Недоимка на текущий месяц] - Measures.[Недоимка на начало года]
        )'
    member Measures.[Прирост недоимки %]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Недоимка на начало года]
            ),
            null,
            (
                Measures.[Прирост недоимки*]/Measures.[Недоимка на начало года]
            )
        )'
    set [Все районы]
    as '
        Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ) '
    member Measures.[Ранг МО ]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Отношение недоимки* к поступлен.]
            ),
            null,
            Rank
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Все районы],
                        not IsEmpty
                        (
                            Measures.[Отношение недоимки* к поступлен.]
                        )
                    ),
                   Measures.[Отношение недоимки* к поступлен.],
                    ASC
                ),
                Measures.[Отношение недоимки* к поступлен.]
            )
        )'
    member Measures.[Худший ранг недоимка ]
    as 'max
        (
            [Все районы],
            Measures.[Ранг МО ]
        )'
	member [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ]      
    as 'Aggregate     
        (
            {
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Недоимка по налогу],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по пени],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по налоговым санкциям]    
            }     
        )'
select
    {{ 
        Measures.[Недоимка на текущий месяц],
        Measures.[Прирост недоимки*],
        Measures.[Прирост недоимки %],
        Measures.[Отношение недоимки* к поступлен.],
        Measures.[Ранг МО ],
        Measures.[Поступило итого],
        Measures.[Худший ранг недоимка ]
    }* {<%filter%>}} on columns
from [ФНС_28н_без расщепления] 
Where  
    (
        [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ],
        [ФНС_28н_Коды налогоплательщиков].[Все налогоплательщики]   
    ) 
]]>
  </query>

  <query id="FNS_0001_0001_v_incomes_debt">
    <![CDATA[
--FNS_0001_0001_v_incomes_debt
with    
    member Measures.[Поступило итого]
    as '
        (
            [Measures].[С начала года],
            [ФНС_65н_Показатели].[Все].[Поступило - итого],
            [Период].[Период].[Данные всех периодов].<%period_year%>
        )/ 1000'
    member Measures.[Отношение недоимки* к поступлен.]
    as 'IIF
        (
            IsEmpty ([Поступило итого]) or [Поступило итого] = 0,
            null,
            Measures.[Недоимка на текущий месяц] / [Поступило итого]
        )'
    member [Measures].[Недоимка c начала года, тыс.руб.]    
    as '    
        (
            [Measures].[С начала года] / 1000    
        )'    
    member Measures.[Недоимка на начало года]    
    as '    
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_last_year%>    
        )'    
    member Measures.[Недоимка на текущий месяц]    
    as '    
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_year%>    
        )'    
    member Measures.[Прирост недоимки]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Недоимка на текущий месяц]    
            ),
            null,
            Measures.[Недоимка на текущий месяц] - Measures.[Недоимка на начало года]    
        )'    
    member Measures.[Прирост недоимки* %]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Недоимка на начало года]    
            ),
            null,
            (
                Measures.[Прирост недоимки]/Measures.[Недоимка на начало года]    
            )    
        )'    
   
    member Measures.[Ранг МО ]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Отношение недоимки* к поступлен.]
            ),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ),
                        not IsEmpty    
                        (
                            Measures.[Отношение недоимки* к поступлен.]
                        )    
                    ),
                    Measures.[Отношение недоимки* к поступлен.],
                    ASC    
                ),
                Measures.[Отношение недоимки* к поступлен.]
            )    
        )'    
    member Measures.[Худший ранг недоимка ]
    as 'max    
        (
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )  ,
            Measures.[Ранг МО ]    
        )'  
    set [Недоимка топ ]    
    as 'TopCount    
        (
            filter    
            (
                Descendants    
                (
                    <%incomes_kd_all_level%>,
                    <%incomes_KD_classifier%>.[Статья],
                    SELF    
                ),
                not isEmpty    
                (
                    Measures.[Недоимка на текущий месяц]    
                )    
            ),
            5,
            Measures.[Недоимка на текущий месяц]    
        )  '   
	member [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ]      
    as 'Aggregate     
        (
            {
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Недоимка по налогу],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по пени],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по налоговым санкциям]    
            }     
        )'
select
    {
        Measures.[Недоимка на начало года],
        Measures.[Недоимка на текущий месяц],
        Measures.[Прирост недоимки],
        Measures.[Прирост недоимки* %],
        Measures.[Отношение недоимки* к поступлен.],
        Measures.[Ранг МО ],
        Measures.[Поступило итого],
        Measures.[Худший ранг недоимка ]
    } on columns,
    {        
        [Недоимка топ ]
    } on rows    
from [ФНС_28н_без расщепления]  
where    
    (
	    [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ],
        [ФНС_28н_Коды налогоплательщиков].[Все налогоплательщики],
        <%filter%>
    )
    ]]>
  </query>

  <query id="FNS_0001_0001_settlement">
    <![CDATA[
    --FNS_0001_0001_settlement
    with 
    member [Measures].[Недоимка c начала года, тыс.руб.] 
    as ' 
        (
            [Measures].[С начала года] / 1000 
        )' 
    member Measures.[Недоимка на текущий месяц]   
    as '   
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            [ФНС_65н_Показатели].[Все].[Недоимка по налогу],
            [Период].[Период].[Данные всех периодов].<%period_year%>
        )'    
select
    {
        Measures.[Недоимка на текущий месяц]  
    } on columns 
from [ФНС_28н_без расщепления] 
where   
    (
        <%filter%>
    ) 
  ]]>
  </query>

  <query id="FNS_0001_0001_debt_settlement">
    <![CDATA[
    with 
    member [Measures].[Факт ] 
    as 'IIF 
        (
            IsEmpty ([Measures].[Факт]),
            0,
            [Measures].[Факт] 
        )' 
select
    {  [Measures].[Факт ] }   on columns
from   [ФО_МесОтч_СпрЗадолженность] 
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>,
        [Показатели].[СопМесОСпЗадо].[Все показатели].[ПРОСРОЧЕННАЯ КРЕДИТОРСКАЯ  ЗАДОЛЖЕННОСТЬ, всего] 
    )
  ]]>
  </query>

  <query id="FNS_0001_0001_v_incomes_okved">
    <![CDATA[
with    
    member Measures.[Поступило итого]
    as '
        (
            [Measures].[С начала года],
            [ФНС_65н_Показатели].[Все].[Поступило - итого],
            [Период].[Период].[Данные всех периодов].<%period_year%>
        )/ 1000'
    member Measures.[Отношение недоимки* к поступлен.]
    as 'IIF
        (
            IsEmpty ([Поступило итого]) or [Поступило итого] = 0,
            null,
            Measures.[Недоимка на текущий месяц] / [Поступило итого]
        )'
    member [Measures].[Недоимка c начала года, тыс.руб.]    
    as '    
        (
            [Measures].[С начала года] / 1000    
        )'    
    member Measures.[Недоимка на начало года]    
    as '    
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_last_year%>    
        )'    
    member Measures.[Недоимка на текущий месяц]    
    as '    
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_year%>    
        )'    
    member Measures.[Прирост недоимки]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Недоимка на текущий месяц]    
            ),
            null,
            Measures.[Недоимка на текущий месяц] - Measures.[Недоимка на начало года]    
        )'    
    member Measures.[Прирост недоимки* %]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Недоимка на начало года]    
            ),
            null,
            (
                Measures.[Прирост недоимки]/Measures.[Недоимка на начало года]    
            )    
        )'    
   
    member Measures.[Ранг МО ]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Отношение недоимки* к поступлен.]
            ),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ),
                        not IsEmpty    
                        (
                            Measures.[Отношение недоимки* к поступлен.]
                        )    
                    ),
                    Measures.[Отношение недоимки* к поступлен.],
                    ASC    
                ),
               Measures.[Отношение недоимки* к поступлен.]
            )    
        )'    
    member Measures.[Худший ранг недоимка ]    
    as 'max    
        (
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )  ,
            Measures.[Ранг МО ]    
        )'   
    set [Недоимка топ ]    
    as 'TopCount    
        (
            filter 
            (
                Descendants 
                (
                    [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД],
                    [ОКВЭД].[Сопоставимый].[Раздел],
                    SELF 
                ),
                not isEmpty 
                (
                    Measures.[Недоимка на текущий месяц] 
                ) and not 
                (
                    [ОКВЭД].[Сопоставимый].CurrentMember is [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД].[Нет кода ОКВЭД]
                ) 
            ),
            5,
            Measures.[Недоимка на текущий месяц]    
        )  '   
		member [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ]      
    as 'Aggregate     
        (
            {
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Недоимка по налогу],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по пени],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по налоговым санкциям]    
            }     
        )'
select
    {
    Measures.[Недоимка на начало года],
        Measures.[Недоимка на текущий месяц],
        Measures.[Прирост недоимки],
        Measures.[Прирост недоимки* %],
        Measures.[Отношение недоимки* к поступлен.],
        Measures.[Ранг МО ],
        Measures.[Поступило итого],
        Measures.[Худший ранг недоимка ]
    } on columns,
    {        
        [Недоимка топ ]
    } on rows    
from [ФНС_28н_без расщепления]  
where    
    (
	    [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ],
        [ФНС_28н_Коды налогоплательщиков].[Все налогоплательщики] ,
        <%filter%>
    ) 
    ]]>
  </query>

  <query id="FNS_0001_0001_v">
    <![CDATA[
-- FNS_0001_0001_v
with    
    member Measures.[Поступило итого]
    as '
        (
            [Measures].[С начала года],
            [ФНС_65н_Показатели].[Все].[Поступило - итого],
            [Период].[Период].[Данные всех периодов].<%period_year%>
        )/ 1000'
    member Measures.[Отношение недоимки* к поступлен.]
    as 'IIF
        (
            IsEmpty ([Поступило итого]) or [Поступило итого] = 0,
            null,
            Measures.[Недоимка на текущий месяц] / [Поступило итого]
        )'
    member [Measures].[Недоимка c начала года, тыс.руб.]    
    as '    
        (
            [Measures].[С начала года] / 1000    
        )'    
    member Measures.[Недоимка на начало года]    
    as '    
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_last_year%>    
        )'    
    member Measures.[Недоимка на текущий месяц]    
    as '    
        (
            [Measures].[Недоимка c начала года, тыс.руб.],
            
            [Период].[Период].[Данные всех периодов].<%period_year%>    
        )'    
    member Measures.[Прирост недоимки]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Недоимка на текущий месяц]    
            ),
            null,
            Measures.[Недоимка на текущий месяц] - Measures.[Недоимка на начало года]    
        )'    
    member Measures.[Прирост недоимки* %]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Недоимка на начало года]    
            ),
            null,
            (
                Measures.[Прирост недоимки]/Measures.[Недоимка на начало года]    
            )    
        )'    
   
    member Measures.[Ранг МО ]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Отношение недоимки* к поступлен.]
            ),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        ,
                        not IsEmpty    
                        (
                            Measures.[Отношение недоимки* к поступлен.]
                        )    
                    ),
                    Measures.[Отношение недоимки* к поступлен.],
                    ASC    
                ),
               Measures.[Отношение недоимки* к поступлен.]
            )    
        )'    
    member Measures.[Худший ранг недоимка ]    
    as 'max    
        (
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
          ,
            Measures.[Ранг МО ]    
        )'   
    set [Недоимка топ ]    
    as 'TopCount    
        (
            filter 
            (
                Descendants 
                (
                    [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД],
                    [ОКВЭД].[Сопоставимый].[Раздел],
                    SELF 
                ),
                not isEmpty 
                (
                    Measures.[Недоимка на текущий месяц] 
                ) and not 
                (
                    [ОКВЭД].[Сопоставимый].CurrentMember is [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД].[Нет кода ОКВЭД]
                ) 
            ),
            5,
            Measures.[Недоимка на текущий месяц]    
        )'   
        member <%incomes_KD_classifier%>.[Итого недоимка по налоговым и неналоговым доходам ]
        as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]'
		
	member [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ]      
    as 'Aggregate     
        (
            {
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Недоимка по налогу],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по пени],
                [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Все].[Неурегулированная задолженность по налоговым санкциям]    
            }     
        )'
select
    {
        Measures.[Недоимка на начало года],
        Measures.[Недоимка на текущий месяц],
        Measures.[Прирост недоимки],
        Measures.[Прирост недоимки* %],
        Measures.[Отношение недоимки* к поступлен.],
        Measures.[Ранг МО ],
        Measures.[Поступило итого],
        Measures.[Худший ранг недоимка ]
    } on columns,
    {
        <%incomes_KD_classifier%>.[Итого недоимка по налоговым и неналоговым доходам ]
    } on rows    
from [ФНС_28н_без расщепления]  
where    
    (
	    [ФНС_65н_Показатели].[ФНС_65н_Показатели].[Недоимка ],
        [ФНС_28н_Коды налогоплательщиков].[Все налогоплательщики] ,
        <%filter%>
    ) 
]]>
  </query>

  <query id="FNS_0001_0001_top5">
    <![CDATA[
-- FNS_0002_0001_iphone_top5   
select
    {[Measures].[С начала года] } on columns,
    non empty TopCount 
    (
        Descendants 
        (
          [Районы].[Сопоставимый].[Все районы],
          <%regions_level%>,
          SELF
        ),
        <%top_regions_count%>,
        [Measures].[С начала года]   
    ) on rows
from [ФНС_28н_без расщепления]    
where    
    (
        [ФНС_65н_Показатели].[Все].[Недоимка по налогу],
        <%period_dimension%>.[Данные всех периодов].<%period_year%>  
    )
]]>
  </query>

  
  <query id="FO_0535_0015_mo_list">
    <![CDATA[
    with     
    member Measures.[Имя] 
    as '[Районы].[Сопоставимый].CurrentMember.UniqueName'
    set [Все районы]  
    as '{
            Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            )
        }'  
select
    { Measures.[Имя] } on columns,
    { [Все районы] } on rows 
from [ФО_МесОтч_Доходы]
    ]]>
  </query>

  <query id="FO_0535_0015_Incomes_settlement">
    <![CDATA[
--FO_0535_0015_Incomes_settlement
with    
    member Measures.[Исполнено тыс]  
    as '[Measures].[Факт] / 1000'  
    member Measures.[Исполнено прошлый год ]  
    as '[Measures].[Факт_прошлый год] / 1000'   
    member Measures.[Темп роста]  
    as '[Measures].[Темп роста к аналогичному периоду предыдущего года_Факт] * 100'   
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[Исполнено тыс],
        Measures.[Темп роста]  
    }  on columns
from [ФО_МесОтч_Доходы]         
where         
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        <%income_total%>,
        [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>    
    )         
  ]]>
  </query>

  <query id="FO_0535_0015_Outcomes_settlement">
    <![CDATA[
    --FO_0535_0015_Outcomes_settlement
with 
    member [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ] 
    as 'Aggregate 
        (
            {
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОБЩЕГОСУДАРСТВЕННЫЕ ВОПРОСЫ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ОБОРОНА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ БЕЗОПАСНОСТЬ И ПРАВООХРАНИТЕЛЬНАЯ ДЕЯТЕЛЬНОСТЬ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ЭКОНОМИКА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОХРАНА ОКРУЖАЮЩЕЙ СРЕДЫ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОБРАЗОВАНИЕ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[КУЛЬТУРА, КИНЕМАТОГРАФИЯ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[СРЕДСТВА МАССОВОЙ ИНФОРМАЦИИ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ЗДРАВООХРАНЕНИЕ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Физическая культура и спорт],
                [РзПр].[Сопоставимый].[Все коды ФКР].[СОЦИАЛЬНАЯ ПОЛИТИКА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ]
            }
        )'  
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000' 
    member [Measures].[Темп роста ] 
    as ' 
        (
            [Measures].[Темп роста к прошлому году] * 100
        )'  
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[Исполнено тыс],
        Measures.[Темп роста ] 
    }  on columns  
from [ФО_МесОтч_Расходы]   
where   
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ],
        <%filter%>
        
    )   
  ]]>
  </query>

  <query id="FO_0535_0015_settlement_outcomes">
    <![CDATA[
    --FO_0535_0015_settlement_outcomes
    with
    member [КОСГУ].[Сопоставимый].[Оплата труда с начислениями ]    
    as ' [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Заработная плата] + [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Начисления на выплаты по оплате труда] ' 
    member [КОСГУ].[Сопоставимый].[Капитальные вложения ]    
    as '
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости основных средств] +
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости нематериальных активов]    
            '
    member [КОСГУ].[Сопоставимый].[Иные расходы ]    
    as ' 
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Прочие выплаты]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Обслуживание государственного (муниципального) долга]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления организациям]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Прочие расходы]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости непроизведенных активов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости материальных запасов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление финансовых активов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Выбытие финансовых активов]    
            '
    member [РзПр].[Сопоставимый].[FKRSlicer]    
    as ' Aggregate    
        (
            Filter 
            (
                [РзПр].[Сопоставимый].[Все коды ФКР].Children,
                [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9700" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9701" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9702" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9703" 
            ) 
        )' 
       member Measures.[Исполнено тыс]
    as '[Measures].[Факт] / 1000'
    member Measures.[Исполнено прошлый год ]
    as '[Measures].[Факт_прошлый год] / 1000'
     member [Measures].[Темп роста ]   
    as ' IIF  
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год] 
        )' 
    member Measures.[План ]
    as '[Measures].[Годовые назначения] / 1000'
    member Measures.[% исполнения ] 
    as 'IIF  
        (
            IsEmpty ([Measures].[Годовые назначения]) or [Measures].[Годовые назначения] = 0,
            null,
            [Measures].[Факт] / [Measures].[Годовые назначения]
        )' 
     member [Measures].[Темп роста]   
    as ' IIF  
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год] 
        )' 
    member [Measures].[Темп роста по округу]
    as '
        (
            [Темп роста],
            [Районы].[Сопоставимый].[Все районы]
        )'
        member [Measures].[Факт по области прошлый год ]  
    as 'null'  
    member [Measures].[Факт по области этот год ]  
    as 'null'  
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null'   
    member [Районы].[Сопоставимый].[Все районы ]   
    as 'Aggregate (Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ))'
    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ]
    }  on columns,
    {
        [КОСГУ].[Сопоставимый].[Оплата труда с начислениями ],
        [КОСГУ].[Сопоставимый].[Капитальные вложения ],
        [КОСГУ].[Сопоставимый].[Иные расходы ]        
    } on rows             
from [ФО_МесОтч_Расходы]             
where             
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
         [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>,
        [РзПр].[Сопоставимый].[FKRSlicer]                
    )  
    ]]>
  </query>

  <query id="FO_0535_0015_settlement_outcomes_all">
    <![CDATA[
    --FO_0535_0015_settlement_outcomes_all
   with 
    member [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ] 
    as 'Sum
        (
           {
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОБЩЕГОСУДАРСТВЕННЫЕ ВОПРОСЫ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ОБОРОНА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ БЕЗОПАСНОСТЬ И ПРАВООХРАНИТЕЛЬНАЯ ДЕЯТЕЛЬНОСТЬ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[НАЦИОНАЛЬНАЯ ЭКОНОМИКА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ЖИЛИЩНО-КОММУНАЛЬНОЕ ХОЗЯЙСТВО],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОХРАНА ОКРУЖАЮЩЕЙ СРЕДЫ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ОБРАЗОВАНИЕ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[КУЛЬТУРА, КИНЕМАТОГРАФИЯ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[СРЕДСТВА МАССОВОЙ ИНФОРМАЦИИ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[ЗДРАВООХРАНЕНИЕ],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Физическая культура и спорт],
                [РзПр].[Сопоставимый].[Все коды ФКР].[СОЦИАЛЬНАЯ ПОЛИТИКА],
                [РзПр].[Сопоставимый].[Все коды ФКР].[МЕЖБЮДЖЕТНЫЕ ТРАНСФЕРТЫ]
            }
        )'
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null' 
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000'    
    member Measures.[План ] 
    as '[Measures].[Годовые назначения] / 1000' 
    member Measures.[% исполнения ]
    as 'IIF
        (
            IsEmpty ([Measures].[Годовые назначения]) or [Measures].[Годовые назначения] = 0,
            null,
            [Measures].[Факт] / [Measures].[Годовые назначения]
        )'
    member Measures.[Темп роста ]
    as ' IIF
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год]
        )'
    member [Measures].[Темп роста по округу]  
    as 'IIF  
        (
            not IsEmpty  
            (
                [Measures].[Факт по области прошлый год ]  
            ),
            (
                [Measures].[Факт по области этот год ] /[Measures].[Факт по области прошлый год ]  
                * 100  
            ),
            0  
        )'  
        member [Measures].[Факт по области прошлый год ]  
    as 'null'  
    member [Measures].[Факт по области этот год ]  
    as 'null' 
    member [Районы].[Сопоставимый].[Все районы ]   
    as 'Aggregate (Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ))'
   
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ]
    }  on columns,
    {
        [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ] 
    }  on rows 
from [ФО_МесОтч_Расходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
         [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>
    )
    ]]>
  </query>

  <query id="FO_0535_0015_settlement_deficite">
    <![CDATA[
    --FO_0535_0015_settlement_deficite
with     
    member [Районы].[Сопоставимый].[Профицит(+)/ Дефицит(-) ]
    as '<%filter%>' 
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000' 
    member [Measures].[Темп роста ] 
    as 'null'  
    member Measures.[План ] 
    as '[Measures].[Годовые назначения] / 1000' 
    member Measures.[% исполнения ] 
    as 'null'  
    member [Measures].[Темп роста по округу] 
    as 'null' 
    member [Measures].[Факт по области прошлый год ]  
    as 'null'  
    member [Measures].[Факт по области этот год ]  
    as 'null'  
member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null'    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ]
    }  on columns,
    {
        [Районы].[Сопоставимый].[Профицит(+)/ Дефицит(-) ]  
    } on rows     
from [ФО_МесОтч_Дефицит Профицит]    
where    
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]    
    )
    ]]>
  </query>

  <query id="FO_0535_0015_settlement_incomes">
    <![CDATA[
    --FO_0535_0015_settlement_incomes
   with 
    member <%incomes_KD_classifier%>.[ИТОГО ДОХОДОВ ] 
    as '<%income_total%>' 
    member <%incomes_KD_classifier%>.[Налоговые и неналог. доходы ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]' 
    member <%incomes_KD_classifier%>.[Налог на прибыль организаций ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]' 
    member <%incomes_KD_classifier%>.[НДФЛ ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]' 
    member <%incomes_KD_classifier%>.[Акцизы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Налоги на имущ.орг. ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество организаций]' 
    member <%incomes_KD_classifier%>.[Налог на имущество физ.лиц ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц]' 
    member <%incomes_KD_classifier%>.[НДПИ ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]' 
    member <%incomes_KD_classifier%>.[Земельный налог ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог]' 
    member <%incomes_KD_classifier%>.[Оплата труда с начислениями ] 
    as 'Measures.CurrentMember' 
    member <%incomes_KD_classifier%>.[Капитальные вложения ] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Дефицит / профицит] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Материальные затраты ] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Дотация на выравн. бюдж.обеспеч. ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований].[Дотации на выравнивание бюджетной обеспеченности]' 
    member <%incomes_KD_classifier%>.[Прочие налоговые доходы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[СТРАХОВЫЕ ВЗНОСЫ НА ОБЯЗАТЕЛЬНОЕ СОЦИАЛЬНОЕ СТРАХОВАНИЕ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары (работы, услуги), реализуемые на территории Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары, ввозимые на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на игорный бизнес],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на недвижимость, взимаемый с объектов недвижимого имущества, расположенных в границах городов Великий Новгород и Тверь],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Регулярные платежи за добычу полезных ископаемых (роялти) при выполнении соглашений о разделе продукции],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Водный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Сборы за пользование объектами животного мира и за пользование объектами водных биологических ресурсов],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ГОСУДАРСТВЕННАЯ ПОШЛИНА],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ] 
            } - 
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на прибыль, доходы].[Налог на доходы физических лиц],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на совокупный доход],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на имущество].[Земельный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на имущество].[Налог на имущество физических лиц] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Неналоговые доходы ] 
    as 'sum 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ВНЕШНЕЭКОНОМИЧЕСКОЙ ДЕЯТЕЛЬНОСТИ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] 
            } 
        )' 
        member [КД__Сопоставимый].[КД__Сопоставимый].[Субсидии ]  
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии от других бюджетов бюджетной системы Российской Федерации]'  
    member [КД__Сопоставимый].[КД__Сопоставимый].[Субвенции ]  
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции от других бюджетов бюджетной системы Российской Федерации]'  
    
    member <%incomes_KD_classifier%>.[Доходы от предпринимательской деятельности ] 
    as '<%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРЕДПРИНИМАТЕЛЬСКОЙ И ИНОЙ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]' 
    member <%incomes_KD_classifier%>.[Безвозмездные перечисл. от др.бюдж. ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации]'    
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ]
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа]
            }
        )'
member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null' 
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000' 
    member Measures.[План ] 
    as '[Measures].[Годовые назначения] / 1000'     
    member Measures.[% исполнения ] 
    as ' IIF
        (
            IsEmpty ([Measures].[Годовые назначения]) or [Measures].[Годовые назначения] = 0,
            null,
            [Measures].[Факт] / [Measures].[Годовые назначения]
        )'
    member [Measures].[Темп роста]
    as ' IIF
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год]
        )'
    member [Measures].[Темп роста ] 
    as ' ( [Темп роста])' 
    member [Measures].[Темп роста по округу] 
    as ' 
        (
            [Темп роста],
            [Районы].[Сопоставимый].[Все районы]
        )' 
        member [Measures].[Факт по области прошлый год ]  
    as 'null'  
    member [Measures].[Факт по области этот год ]  
    as 'null'     
select
    {
       Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ]
    }  on columns,
    non empty 
    {
        <%incomes_KD_classifier%>.[ИТОГО ДОХОДОВ ],
        <%incomes_KD_classifier%>.[Налоговые и неналог. доходы ],
        <%incomes_KD_classifier%>.[НДФЛ ],
        <%incomes_KD_classifier%>.[Акцизы ],
        <%incomes_KD_classifier%>.[Налоги на имущ.орг. ],
        <%incomes_KD_classifier%>.[Налог на имущество физ.лиц ],
        <%incomes_KD_classifier%>.[НДПИ ],
        <%incomes_KD_classifier%>.[Земельный налог ],
        <%incomes_KD_classifier%>.[Прочие налоговые доходы ],
        <%incomes_KD_classifier%>.[Неналоговые доходы ],
        <%incomes_KD_classifier%>.[Безвозмездные перечисл. от др.бюдж. ],
        <%incomes_KD_classifier%>.[Дотация на выравн. бюдж.обеспеч. ],
        <%incomes_KD_classifier%>.[Субсидии ],
        <%incomes_KD_classifier%>.[Субвенции ] 
    }  on rows 
from [ФО_МесОтч_Доходы] 
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>
    ) 
    ]]>
  </query>

  <query id="FO_0535_0015_budget_incomes_v">
    <![CDATA[
    --FO_0535_0015_budget_incomes_v
   with    
     member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ]   
    as '  
        (
            	[КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты].[Средства бюджетов, передаваемые бюджетам на переселение граждан из закрытых административно-территориальных образований].[Средства бюджетов, передаваемые бюджетам муниципальных образований на осуществление части полномочий по решению вопросов местного значения в соответствии с заключенными соглашениями],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]   
        )'   
    member [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]   
    as '  
        (
            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации],
            	[Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]   
        )'   
    member <%incomes_KD_classifier%>.[ИТОГО ДОХОДОВ ]
    as '<%income_total%> - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ район ] - [КД__Сопоставимый План].[КД__Сопоставимый План].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ поселение ]' 
    member <%incomes_KD_classifier%>.[Налоговые и неналоговые доходы ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]' 
    member <%incomes_KD_classifier%>.[Налог на прибыль организаций ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]' 
    member <%incomes_KD_classifier%>.[НДФЛ ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]' 
    member <%incomes_KD_classifier%>.[Акцизы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Налоги на имущ.орг. ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество организаций]' 
    member <%incomes_KD_classifier%>.[Налог на имущество физ.лиц ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц]' 
    member <%incomes_KD_classifier%>.[НДПИ ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]' 
    member <%incomes_KD_classifier%>.[Земельный налог ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог]' 
    member <%incomes_KD_classifier%>.[Оплата труда с начислениями ] 
    as 'Measures.CurrentMember' 
    member <%incomes_KD_classifier%>.[Капитальные вложения ] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Дефицит / профицит] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Материальные затраты ] 
    as ' Measures.CurrentMember ' 
    member <%incomes_KD_classifier%>.[Дотация на выравн. бюдж.обеспеч. ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований].[Дотации на выравнивание бюджетной обеспеченности]' 
    member <%incomes_KD_classifier%>.[Прочие налоговые доходы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[СТРАХОВЫЕ ВЗНОСЫ НА ОБЯЗАТЕЛЬНОЕ СОЦИАЛЬНОЕ СТРАХОВАНИЕ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары (работы, услуги), реализуемые на территории Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ]. [Налог на добавленную стоимость на товары, ввозимые на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на игорный бизнес],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на недвижимость, взимаемый с объектов недвижимого имущества, расположенных в границах городов Великий Новгород и Тверь],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Регулярные платежи за добычу полезных ископаемых (роялти) при выполнении соглашений о разделе продукции],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Водный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Сборы за пользование объектами животного мира и за пользование объектами водных биологических ресурсов],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ГОСУДАРСТВЕННАЯ ПОШЛИНА],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ] 
            } - 
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на прибыль, доходы].[Налог на доходы физических лиц],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на совокупный доход],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на имущество].[Земельный налог],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на имущество].[Налог на имущество физических лиц] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Неналоговые доходы ] 
    as 'sum 
        (
            {
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ВНЕШНЕЭКОНОМИЧЕСКОЙ ДЕЯТЕЛЬНОСТИ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ОКАЗАНИЯ ПЛАТНЫХ УСЛУГ И КОМПЕНСАЦИИ ЗАТРАТ ГОСУДАРСТВА],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                <%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Налоги на совокупный доход ] 
    as '<%incomes_kd_all_level%>.[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[Налоги на совокупный доход]' 
    member <%incomes_KD_classifier%>.[Субсидии ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Субвенции ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований] 
            } 
        )' 
    member <%incomes_KD_classifier%>.[Доходы от предпринимательской деятельности ] 
    as '<%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРЕДПРИНИМАТЕЛЬСКОЙ И ИНОЙ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]' 
    member <%incomes_KD_classifier%>.[Безвозмездные перечисл. от др.бюдж. ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации]' 
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000' 
    member Measures.[План ] 
    as '[Measures].[Годовые назначения] / 1000' 
     member Measures.[% исполнения ] 
    as ' IIF
        (
            IsEmpty ([Measures].[Годовые назначения]) or [Measures].[Годовые назначения] = 0,
            null,
            [Measures].[Факт] / [Measures].[Годовые назначения]
        )'
     member [Measures].[Темп роста]
    as ' IIF
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год]
        )'
    member [Measures].[Темп роста ] 
    as ' ( [Темп роста])' 
    member [Measures].[Темп роста по округу]   
    as 'IIF 
        (
            not IsEmpty 
            (
                [Measures].[Факт по области прошлый год ]
            ),
            (
                [Measures].[Факт по области этот год ] /[Measures].[Факт по области прошлый год ] * 100
            ),
            0
        )' 
    member [Measures].[Факт по области прошлый год ]  
    as '  
        (
            Measures.[Исполнено прошлый год ],
            [Районы].[Сопоставимый].[Все районы ]  
        )'  
    member [Measures].[Факт по области этот год ]  
    as '  
        (
            Measures.[Исполнено тыс],
            [Районы].[Сопоставимый].[Все районы ]  
        )'  
    member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member [Уровни бюджета].[СКИФ].[Собств.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],                
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null'    
    member [Районы].[Сопоставимый].[Все районы ]   
    as 'Aggregate (Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ))'
    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ] 
    }  on columns,
    non empty 
    {
        <%incomes_KD_classifier%>.[ИТОГО ДОХОДОВ ],
        <%incomes_KD_classifier%>.[Налоговые и неналоговые доходы ],        
        <%incomes_KD_classifier%>.[НДФЛ ],
        <%incomes_KD_classifier%>.[Налоги на совокупный доход ],
        <%incomes_KD_classifier%>.[Земельный налог ],
        <%incomes_KD_classifier%>.[Налог на имущество физ.лиц ],
        <%incomes_KD_classifier%>.[Прочие налоговые доходы ],
        <%incomes_KD_classifier%>.[Неналоговые доходы ],
        <%incomes_KD_classifier%>.[Безвозмездные перечисл. от др.бюдж. ],
        <%incomes_KD_classifier%>.[Дотация на выравн. бюдж.обеспеч. ],
        <%incomes_KD_classifier%>.[Субсидии ],
        <%incomes_KD_classifier%>.[Субвенции ] 
    }  on rows 
from [ФО_МесОтч_Доходы]
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        <%budget_level_enum%>,
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>
    ) 
    ]]>
  </query>

  <query id="FO_0535_0015_budget_outcomes_v">
    <![CDATA[
    --FO_0535_0015_budget_outcomes_v
    with
    member [КОСГУ].[Сопоставимый].[Оплата труда с начислениями ]    
    as ' [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Заработная плата] + [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Начисления на выплаты по оплате труда] ' 
    member [КОСГУ].[Сопоставимый].[Капитальные вложения ]    
    as '
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости основных средств] +
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости нематериальных активов]    
            '
    member [КОСГУ].[Сопоставимый].[Иные расходы ]    
    as ' 
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Прочие выплаты]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата работ, услуг]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Обслуживание государственного (муниципального) долга]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления организациям]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Социальное обеспечение]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Расходы].[Прочие расходы]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости непроизведенных активов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости материальных запасов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Поступление финансовых активов]+
                [КОСГУ].[Сопоставимый].[Все коды ЭКР].[Выбытие финансовых активов]    
            '
    member [РзПр].[Сопоставимый].[FKRSlicer]    
    as ' Aggregate    
        (
            Filter 
            (
                [РзПр].[Сопоставимый].[Все коды ФКР].Children,
                [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9700" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9701" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9702" and [РзПр].[Сопоставимый].CurrentMember.Properties("Код") <> "9703" 
            ) 
        )' 
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000' 
   member [Measures].[Темп роста ]   
    as ' IIF  
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год] 
        )'  
    member Measures.[План ] 
    as '[Measures].[Годовые назначения] / 1000' 
    member Measures.[% исполнения ] 
    as 'IIF  
        (
            IsEmpty ([Measures].[Годовые назначения]) or [Measures].[Годовые назначения] = 0,
            null,
            [Measures].[Факт] / [Measures].[Годовые назначения]
        )' 
   member [Measures].[Темп роста]   
    as ' IIF  
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год] 
        )'  
   member [Measures].[Темп роста по округу]   
    as 'IIF 
        (
            not IsEmpty 
            (
                [Measures].[Факт по области прошлый год ]
            ),
            (
                [Measures].[Факт по области этот год ] /[Measures].[Факт по области прошлый год ] * 100
            ),
            0
        )' 
    member [Measures].[Факт по области прошлый год ]  
    as '  
        (
            Measures.[Исполнено прошлый год ],
            [Районы].[Сопоставимый].[Все районы ]  
        )'  
    member [Measures].[Факт по области этот год ]  
    as '  
        (
            Measures.[Исполнено тыс],
            [Районы].[Сопоставимый].[Все районы ]  
        )'  
     member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member [Уровни бюджета].[СКИФ].[Собств.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],                
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null' 
    member [Районы].[Сопоставимый].[Все районы ]   
    as 'Aggregate (Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ))'
    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ] 
    }  on columns,
    {
        [КОСГУ].[Сопоставимый].[Оплата труда с начислениями ],
        [КОСГУ].[Сопоставимый].[Капитальные вложения ],
        [КОСГУ].[Сопоставимый].[Иные расходы ] 
    } on rows 
from [ФО_МесОтч_Расходы] 
where             
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        <%budget_level_enum%>,
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>,
        [РзПр].[Сопоставимый].[FKRSlicer]                
    )  
    ]]>
  </query>

  <query id="FO_0535_0015_budget_outcomes_all_v">
    <![CDATA[
    --FO_0535_0015_budget_outcomes_all_v
   with 
    member [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ]  
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета – Всего (без внутренних оборотов]'
    member [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Перечисления другим бюджетам бюджетной системы Российской Федерации ]    
    as 'LookupCube    
        (
            "[ФО_МесОтч_Расходы]",
            "Sum    
            (
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]   
                }  ,
                (
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Безвозмездные перечисления бюджетам].[Перечисления другим бюджетам бюджетной системы Российской Федерации],
                    [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                    " + MemberToStr    
                    (
                        [Период__Период].[Период__Период].CurrentMember    
                    ) + ",
                             " + MemberToStr    
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].CurrentMember    
                    ) + ",
                    " + MemberToStr ( [Measures].CurrentMember ) + ",
                    " + MemberToStr    
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember    
                    ) + "    
                )    
            ) "
        ) '
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000'     
    member Measures.[План ] 
    as '[Measures].[Годовые назначения] / 1000' 
   member Measures.[% исполнения ]
    as 'IIF
        (
            IsEmpty ([Measures].[Годовые назначения]) or [Measures].[Годовые назначения] = 0,
            null,
            [Measures].[Факт] / [Measures].[Годовые назначения]
        )'
    member Measures.[Темп роста ]
    as ' IIF
        (
            IsEmpty ([Measures].[Факт_прошлый год]) or [Measures].[Факт_прошлый год] = 0,
            null,
            [Measures].[Факт] / [Measures].[Факт_прошлый год]
        )'
    member [Measures].[Темп роста по округу]  
    as 'IIF  
        (
            not IsEmpty  
            (
                [Measures].[Факт по области прошлый год ]  
            ),
            (
                [Measures].[Факт по области этот год ] /[Measures].[Факт по области прошлый год ]  
                * 100  
            ),
            0  
        )'  
    member [Measures].[Факт по области прошлый год ]  
    as '  
        (
            Measures.[Исполнено прошлый год ],
            [Районы].[Сопоставимый].[Все районы ]  
        )'  
    member [Measures].[Факт по области этот год ]  
    as '  
        (
            Measures.[Исполнено тыс],
            [Районы].[Сопоставимый].[Все районы ]  
        )'  
     member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member [Уровни бюджета].[СКИФ].[Собств.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],                
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null'
    member [Районы].[Сопоставимый].[Все районы ]   
    as 'Aggregate (Filter
            (
                Descendants
                (
                     [Районы].[Сопоставимый].[Все районы],
                     <%regions_level%>,
                    SELF
                ),
                not
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
                )
            ))'
    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ] 
    }  on columns,
    {
        [РзПр].[Сопоставимый].[ИТОГО РАСХОДОВ ] 
    }  on rows 
from [ФО_МесОтч_Расходы]
where 
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        <%budget_level_enum%>,
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
        <%filter%>
    )
    ]]>
  </query>

  <query id="FO_0535_0015_budget_deficite_v">
    <![CDATA[
    --FO_0535_0015_budget_deficite_v
with     
    member [Районы].[Сопоставимый].[Профицит(+)/ Дефицит(-) ]
    as '<%filter%>' 
    member Measures.[Исполнено тыс] 
    as '[Measures].[Факт] / 1000' 
    member Measures.[Исполнено прошлый год ] 
    as '[Measures].[Факт_прошлый год] / 1000' 
    member [Measures].[Темп роста ] 
    as 'null'  
    member Measures.[План ] 
    as '[Measures].[Годовые назначения] / 1000' 
    member Measures.[% исполнения ] 
    as 'null'  
    member [Measures].[Темп роста по округу]   
    as 'null' 
    member [Measures].[Факт по области прошлый год ]  
    as 'null'  
    member [Measures].[Факт по области этот год ]  
    as 'null'  
    member Measures.[Ранг ] 
    as 'null' 
    member Measures.[Худший ранг ] 
    as 'null' 
     member [Уровни бюджета].[СКИФ].[Конс.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет поселения],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )' 
    member [Уровни бюджета].[СКИФ].[Собств.бюджет МО ] 
    as 'Aggregate 
        (
            {
                [Уровни бюджета].[СКИФ].[Все].[Бюджет района],                
                [Уровни бюджета].[СКИФ].[Все].[Бюджет гор.округа] 
            } 
        )'    
select
    {
        Measures.[Исполнено прошлый год ],
        Measures.[План ],
        Measures.[Исполнено тыс],
        Measures.[% исполнения ],
        Measures.[Темп роста ],
        [Measures].[Темп роста по округу],
        Measures.[Ранг ],
        Measures.[Худший ранг ],
        [Measures].[Факт по области прошлый год ],
        [Measures].[Факт по области этот год ] 
    }  on columns,
    {
        [Районы].[Сопоставимый].[Профицит(+)/ Дефицит(-) ] 
    } on rows 
from [ФО_МесОтч_Дефицит Профицит] 
where    
    (
        [Период].[Период].[Данные всех периодов].<%period_year%>,
        <%budget_level_enum%>,
        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]    
    )
    ]]>
  </query>

  <query id="FO_0535_0015_settlements_count">
    <![CDATA[
    --FO_0535_0015_settlements_count
    with  
    member measures.[Количество послений]  
    as 'Count ([Поселения ])'   
    set [Поселения ]   
    as '
        {
            Filter
            (
                Descendants 
                (
                    <%filter%>,
                    <%settlement_level%>,
                    SELF_AND_BEFORE 
                ),
                not 
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember 
                ) and 
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"                      
                ) 
            ) 
        }' 
select
    {
        measures.[Количество послений]  
    } on columns 
from   [ФНС_28н_без расщепления] 
where 
    (
        [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь] 
    )
        ]]>
  </query>

  <query id="FO_0535_0015_settlements_list">
    <![CDATA[
    --FO_0535_0015_settlements_list
    with 
    member measures.[Количество послений] 
    as 'Count ([Поселения ])' 
    set [Поселения ] 
    as ' 
        {
            Filter 
            (
                Descendants 
                (
                    <%filter%>,
                    <%settlement_level%>,
                    SELF_AND_BEFORE 
                ),
                not 
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember 
                ) and 
                (
                    [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"  
                ) 
            ) 
        }' 
select
    {[Measures].[С начала года]} on columns,
    { [Поселения ] } on rows 
from   [ФНС_28н_без расщепления] 
where 
    (
        [Период].[Период].[Данные всех периодов].[2010].[Полугодие 1].[Квартал 2].[Июнь] 
    )
      ]]>
  </query>
</root>
