<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="BOR_0001_0001_date_nonEmptyCrossJoin">
    <![CDATA[
-- BOR_0001_0001_date_nonEmptyCrossJoin 
with
    member Measures.[ДанныеНа]
    as '<%period_dimension%>.CurrentMember.UniqueName'
select
    {Measures.[ДанныеНа]} on columns,
    Tail
    (
        NonEmptyCrossjoin
        (
            OpeningPeriod
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2008]
            ) : ClosingPeriod
            (
                <%period_dimension%>.[Месяц],
                <%period_dimension%>.[Данные всех периодов].[2012]
            )
        )
    ) on rows
from [ФО_МесОтч_Доходы]
]]>
  </query>

  <query id="BOR_0001_0001_Grid">
    <![CDATA[
-- BOR_0001_0001_grid   
with             
    member [Measures].[Код]             
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Код")'             
    member [Measures].[Название периода ]             
    as 'IIF    
        (
            isEmpty    
            (
                (
                    [Территории].[РФ].[Все территории УРФО],
                    [Measures].[Значение ]    
                )    
            ),
            null,
            1    
        ) '    
    member [Measures].[Обратный показатель ]             
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Обратный показатель")'             
    member [Measures].[Единицы измерения]             
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Единица измерения")'             
    member [Measures].[Направления оценки]    
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Направления оценки")'    
    member [Measures].[Уровень]      
    as 'IIF  
        (
            [Measures].[ис Дадамембер],
            IIF 
            (
                [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Level.Name = "Уровень 2",
                "Уровень 1",
                "Уровень 2" 
            ),
             [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Level.Name
            
        )'  
    member [Measures].[Показатель]   
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Name'   
    member [Measures].[ис Дадамембер]  
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember is [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Parent.Datamember'
    member [Measures].[Вес]             
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Весовой коэффициент")'              
    member [Территории].[РФ].[Нулл]             
    as 'Null'             
    member [Территории].[РФ].[Уральский федеральный округ ]             
    as '[Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].DataMember'             
    set [Список все субъектов УрФО]             
    as '             
        {
            Filter             
            (
                [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].Children,
                not             
                (
                    [Территории].[РФ].CurrentMember is [Территории].[РФ].CurrentMember.Parent.DataMember             
                )             
            )             
        }+             
        {
            [Территории].[РФ].[Уральский федеральный округ ]             
        } '      
    member [Территории].[РФ].[Все территории УРФО]      
    as 'aggregate ([Список все субъектов УрФО])'      
    member [Measures].[Значение ]             
    as '             
        (
            [Measures].[Значение],
            [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember             
        )'             
    member [Период].[Год Квартал Месяц].[Данные на]             
    as '[Период].[Год Квартал Месяц].[Данные всех периодов].[<%period_year%>]'    
    member Measures.[Ранг ]             
    as 'IIF             
        (
            IsEmpty ( [Measures].[Значение ] ),
            null,
            IIF             
            (
                [БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Обратный показатель") = "0",
                Rank             
                (
                    [Территории].[РФ].CurrentMember,
                    Order             
                    (
                        Filter             
                        (
                            [Территории].[РФ].CurrentMember.Siblings,
                            not             
                            (
                                [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].DataMember             
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not             
                            (
                                [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ]             
                            )             
                        ),
                        [Measures].[Значение ],
                        DESC             
                    ),
                    [Measures].[Значение ]             
                ),
                Rank             
                (
                    [Территории].[РФ].CurrentMember,
                    Order             
                    (
                        Filter             
                        (
                            [Территории].[РФ].CurrentMember.Siblings,
                            not             
                            (
                                [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].DataMember             
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not             
                            (
                                [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ]             
                            )             
                        ),
                        [Measures].[Значение ],
                        ASC             
                    ),
                    [Measures].[Значение ]             
                )             
            )             
        )'             
    member [Measures].[Худший ранг ]             
    as '    max             
        (
            [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].DataMember.Siblings,
            Measures.[Ранг ]             
        ) '             
    member Measures.[Оценка ]
    as ' IIF
        (
            [БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Примечание") = "=1" and not isEmpty([Measures].[Значение ]),
            IIF
            (
                [Measures].[Значение ] = 1,
                1,
                0
            ),
            IIF
            (
                not isEmpty (Measures.[Делитель ]) and not (Measures.[Делитель ] = 0) and not isEmpty (Measures.[Значение ]) ,
                IIF
                (
                    [БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Обратный показатель") = "0",
                    (
                        [Measures].[Значение ] - Measures.[Минимум ]
                    ) / Measures.[Делитель ],
                    (
                        Measures.[Максимум ] - [Measures].[Значение ]
                    ) / Measures.[Делитель ]
                ),
                IIF
                (
                    (Measures.[Делитель ] = 0) and not isEmpty (Measures.[Значение ]),
                    IIF
                    (
                        [БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Обратный показатель") = "0" and not isEmpty (Measures.[Значение ]),
                        IIF
                        (
                            Measures.[Значение ] > 0,
                            1,
                            0
                        ),
                        IIF
                        (
                            Measures.[Значение ] > 0,
                            0,
                            1
                        )
                    ),
                    null
                )
            )
        )'
    member Measures.[Делитель ]             
    as 'Measures.[Максимум ] - Measures.[Минимум ]'             
    member Measures.[Максимум ]             
    as '             
        (
            Tail             
            (
                Order             
                (
                    Filter             
                    (
                        [Территории].[РФ].CurrentMember.Siblings,
                        not             
                        (
                            [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].DataMember             
                        )  and not IsEmpty ( [Measures].[Значение ] ) and not             
                        (
                            [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ]             
                        )             
                    ),
                    [Measures].[Значение ],
                    ASC             
                )             
            ).Item(0),
            [Measures].[Значение ]             
        )'             
    member Measures.[Минимум ]             
    as '             
        (
            Tail             
            (
                Order             
                (
                    Filter             
                    (
                        [Территории].[РФ].CurrentMember.Siblings,
                        not             
                        (
                            [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].DataMember             
                        )  and not IsEmpty ( [Measures].[Значение ] ) and not             
                        (
                            [Территории].[РФ].CurrentMember is [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ]             
                        )             
                    ),
                    [Measures].[Значение ],
                    DESC             
                )             
            ).Item(0),
            [Measures].[Значение ]             
        )'             
    set [Показатели]             
    as ' filter  
        (
            Descendants            
            (
                [БОР].[Показатели внедрения БОР и 83ФЗ].[Все показатели],
                [БОР].[Показатели внедрения БОР и 83ФЗ].[Уровень 3],
                SELF_AND_BEFORE             
            ),
            not  
            (
                [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Level.Name = "Уровень 3" and not  
                (
                    [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember is [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Parent.DataMember 
                ) 
            ) and not  
            (
                Count
                (
                    [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Children
                ) > 0
            ) 
        ) '           
SELECT
    {
        { [Территории].[РФ].[Нулл] } 
        * { [Measures].[Показатель]}+ 
        {
            {[Список все субъектов УрФО]  }             
            *             
            {
                [Measures].[Значение ],
                Measures.[Ранг ],
                Measures.[Оценка ]             
            }             
        }+             
        {
            { [Территории].[РФ].[Нулл] }             
            *             
            {
                [Measures].[Худший ранг ],
                [Measures].[Единицы измерения],
                [Measures].[Код],
                [Measures].[Обратный показатель ],
                [Measures].[Направления оценки],
                [Measures].[Вес],
                [Measures].[Название периода ],
                [Measures].[Уровень]    
            }             
        }             
    }   ON columns ,
    { [Показатели] }  ON rows    
FROM   [РЕГИОН_Оценка внедрения БОР и 83ФЗ]             
where             
    (
        [Источники данных].[Все источники данных].[РЕГИОН Оценка внедрения БОР и 83ФЗ],
        [Период].[Год Квартал Месяц].[Данные на]             
    )             
]]>
</query>

<query id="BOR_0001_0001_map">
<![CDATA[
-- RG_0001_0002_map   
WITH
    member [Период].[Период].[Данные на]
    as 'StrToMember
        (
            [Показатели].[Оценка деятельности].CurrentMember.Properties("Период вывода данных")
        )'
        member Measures.[Единицы]
    as '
            [Показатели].[Оценка деятельности].CurrentMember.Properties("Примечание")
        '
    set [Список все субъектов УрФО]
    as 'Filter
        (
            [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].Children,
            not
            (
                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].CurrentMember.Parent.DataMember
            )
        )'
    member Measures.[Ранг ]
    as 'IIF
        (
            IsEmpty ( [Measures].[Значение ] ),
            null,
            IIF
            (
                [Показатели].[Оценка деятельности].Properties("Обратный показатель") = "0",
                Rank
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    Order
                    (
                        Filter
                        (
                            [Территории].[Сопоставимый].CurrentMember.Siblings,
                            not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                            )
                        ),
                        [Measures].[Значение ],
                        DESC
                    ),
                    [Measures].[Значение ]
                ),
                Rank
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    Order
                    (
                        Filter
                        (
                            [Территории].[Сопоставимый].CurrentMember.Siblings,
                            not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember
                            )  and not IsEmpty ( [Measures].[Значение ] ) and not
                            (
                                [Территории].[Сопоставимый].CurrentMember is [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ]
                            )
                        ),
                        [Measures].[Значение ],
                        ASC
                    ),
                    [Measures].[Значение ]
                )
            )
        )'
    member [Measures].[Значение ]
    as '
        (
            [Measures].[Значение],
            [Показатели].[Оценка деятельности].CurrentMember
        )'
SELECT
    {
        [Measures].[Значение],
        Measures.[Ранг ],
        Measures.[Единицы]
    } ON COLUMNS ,
    {[Список все субъектов УрФО]} ON ROWS
FROM [РЕГИОН_Оценка деятельности] 
WHERE   
    (
        [Источники данных].[Все источники данных].[РЕГИОН Оценка деятельности - Оценка деятельности губернаторов],
        [Период].[Период].[Данные на],
        [Показатели].[Оценка деятельности].[Все показатели].[<%filter%>]  
    )
]]>
  </query>

  <query id="RG_0001_0002_Indicators">
    <![CDATA[
  with    
    member [Measures].[Код] 
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Код")' 
    member [Measures].[Название периода ]    
    as 'IIF    
        (
            isEmpty    
            (
                (
                    [Территории].[РФ].[Все территории УРФО],
                    [Measures].[Значение ]    
                )    
            ),
            null,
            1    
        ) '     
    member [Measures].[Уровень]    
    as 'IIF    
        (
            [Measures].[ис Дадамембер],
            IIF    
            (
                [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Level.Name = "Уровень 2",
                "Уровень 1",
                "Уровень 2"    
            ),
            [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Level.Name     
        )'    
    member [Measures].[Показатель]    
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Name'    
    member [Measures].[ис Дадамембер]    
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember is [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Parent.Datamember'    
    member [Measures].[Вес] 
    as '[БОР].[Показатели внедрения БОР и 83ФЗ].Properties("Весовой коэффициент")' 
    member [Территории].[РФ].[Нулл] 
    as 'Null' 
    member [Территории].[РФ].[Уральский федеральный округ ] 
    as '[Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].DataMember' 
    set [Список все субъектов УрФО] 
    as ' 
        {
            Filter 
            (
                [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].Children,
                not 
                (
                    [Территории].[РФ].CurrentMember is [Территории].[РФ].CurrentMember.Parent.DataMember 
                ) 
            ) 
        }+ 
        {
            [Территории].[РФ].[Уральский федеральный округ ] 
        } ' 
    member [Территории].[РФ].[Все территории УРФО]    
    as 'aggregate ([Список все субъектов УрФО])'    
    member [Measures].[Значение ]    
    as '    
        (
            [Measures].[Значение],
            [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember    
        )'    
    member [Период].[Год Квартал Месяц].[Данные на]    
    as '[Период].[Год Квартал Месяц].[Данные всех периодов].[<%period_year%>]'     
    set [Показатели] 
    as ' filter 
        (
            Descendants 
            (
                [БОР].[Показатели внедрения БОР и 83ФЗ].[Все показатели],
                [БОР].[Показатели внедрения БОР и 83ФЗ].[Уровень 3],
                SELF_AND_BEFORE 
            ),
            not 
            (
                [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Level.Name = "Уровень 3" and not 
                (
                    [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember is [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Parent.DataMember 
                ) 
            ) and not 
            (
                Count 
                (
                    [БОР].[Показатели внедрения БОР и 83ФЗ].CurrentMember.Children 
                ) > 0 
            ) 
        ) ' 
SELECT
    {
        [Measures].[Показатель],
        [Measures].[Код],
        [Measures].[Название периода ],
        [Measures].[Уровень]     
    }   ON columns ,
    { [Показатели] }  ON rows    
FROM   [РЕГИОН_Оценка внедрения БОР и 83ФЗ]    
where    
    (
        [Источники данных].[Все источники данных].[РЕГИОН Оценка внедрения БОР и 83ФЗ],
        [Период].[Год Квартал Месяц].[Данные на]    
    )    
    ]]>
  </query>

  <query id="RG_0001_0002_measures">
    <![CDATA[
    WITH 
     member [Территории].[Сопоставимый].[Код]  
    as '[Показатели].[Оценка деятельности].Properties("Код")' 
    member [Территории].[Сопоставимый].[Единицы измерения] 
    as '[Показатели].[Оценка деятельности].Properties("Единица измерения")' 
    member [Территории].[Сопоставимый].[Название периода ] 
    as '[Показатели].[Оценка деятельности].Properties("Период вывода данных")' 
    member [Территории].[Сопоставимый].[Обратный показатель ] 
    as '[Показатели].[Оценка деятельности].Properties("Обратный показатель")' 
SELECT
    NON EMPTY 
    {
        [Территории].[Сопоставимый].[Единицы измерения],
        [Территории].[Сопоставимый].[Название периода ],
        [Территории].[Сопоставимый].[Обратный показатель ],
        [Территории].[Сопоставимый].[Код]
    } ON COLUMNS 
FROM [РЕГИОН_Оценка деятельности]  
WHERE 
    (
        [Источники данных].[Все источники данных].[РЕГИОН Оценка деятельности - Оценка деятельности губернаторов],
        [Показатели].[Оценка деятельности].[Все показатели].[<%filter%>]
    ) 
    ]]>
  </query>

</root>