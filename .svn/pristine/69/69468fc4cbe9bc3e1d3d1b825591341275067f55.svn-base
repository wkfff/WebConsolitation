<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="MO_0003_0001_date">
    <![CDATA[
-- MO_0003_0001_date 
with 
    member Measures.[ДанныеНа] 
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName' 
select
    {Measures.[ДанныеНа]} on columns,
    Filter 
    (
        OpeningPeriod 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2001] 
        ) : ClosingPeriod 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2012] 
        ),
        not IsEmpty( [Measures].[Значение] ) 
    )  on rows 
from [СТАТ_Паспорт МО_СП и ГП]
]]>
</query>

<query id="MO_0003_0001_grid">
    <![CDATA[
-- MO_0003_0001_grid 
with
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл]
    as 'null'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл1]
    as 'null'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл2]
    as 'null'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл3]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.children.count'
    member [Measures].[Отклонение]
    as ' IIF
        (
            (
                ParallelPeriod
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
                ),
                [Measures].[Значение]
            ) <>0 and [Measures].[Значение]<>0 and not isempty([Measures].[Значение]),
            [Measures].[Значение]-
            (
                ParallelPeriod
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
                ),
                [Measures].[Значение]
            ) ,
            IIF  
            (
                Right  
                (
                    (
                        ParallelPeriod  
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                            1,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                        )  
                    ).uniquename ,
                    2  
                ) ="er" and [Measures].[Значение]<>0 and not isempty([Measures].[Значение]) and 
                (
                    ParallelPeriod 
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        2,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember 
                    ),
                    [Measures].[Значение] 
                ) <>0,
                [Measures].[Значение]-  
                (
                    ParallelPeriod  
                    (
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                        2,
                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                    ),
                    [Measures].[Значение]  
                ) ,
                null  
            )
        ) '
        member [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Года]
        as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.parent.name'
    member measures.[Уровень]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name'
    member measures.[Имя]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level.Name'
    member measures.[Примечание]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Примечание")'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды]
    as 'aggregate
        (
            {
                <%period_year%>  
            }
        )'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды1]
    as 'sum
        (
            {
                <%period_year%>  
            }
        )'
    member [Measures].[Единица измерения]
    as 'IIF
        (
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Единица измерения") = "Неизвестные данные",
            null,
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Единица измерения")
        )'
    member [Measures].[Значение1]
    as ' IIF
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл" ,
            measures.[Уровень],
            IIF
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл1",
                measures.[Примечание] ,
                IIF
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл2",
                    [Measures].[Единица измерения],
                    [Measures].[Значение]
                )
            )
        ) ' 
SELECT
    {
              
         [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл3],
            <%period_year%>,  
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл1],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл2]
    }   ON columns ,
 Distinct(   {
    
  filter  ({ filter  
        (
            {<%parent_indicators%>
          Except(  Descendants
                        (
                          {  <%indicators%>
                            },
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Уровень 3],
                            SELF_BEFORE_AFTER
                        ),
                        [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Среднемесячная заработная плата  местной администрации (исполнительно-распорядительные органы муниципальных образований)]
                        
                        )},
        not   
        (
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember is [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].Parent.DataMember   
        ) and [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды1]
        and [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды1] > 0
        and   
        (
            IIF  
                    (
                        [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 2",
                        true,
                        IIF 
                        (
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 1",
                            true,
                            IIF
                            (
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 3",
                            true,
                            IIF
                            (
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 4",
                            true,
                             not isEmpty
                            (
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды],
                                    [Measures].[Значение] 
                                ) 
                            )
                            )
                           
                            )
                             
                        )  
                    )   
        )
    )}*
    { [Measures].[Значение1],
             [Measures].[Темп роста цепной],
             [Measures].[Отклонение]}
             ,not isempty   
            (
                (
                    [Measures].[Значение1]/*,
                     <%period_year%>*/
                )
            ) 
             )
             
             ,
        {
         [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Года]}
        *{[Measures].[Значение]}
    }  ) ON rows     
FROM   [СТАТ_Паспорт МО_СП и ГП]
where    
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        <%filter%>
    )  

  ]]>
</query>

  <query id="MO_0003_0001_grid1">
    <![CDATA[
-- MO_0003_0001_grid1
with
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл]
    as 'null'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл1]
    as 'null'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл2]
    as 'null'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл3]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.children.count'
    member [Measures].[Отклонение]
    as ' IIF
        (
            (
                ParallelPeriod
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
                ),
                [Measures].[Значение]
            ) <>0 and [Measures].[Значение]<>0 and not isempty([Measures].[Значение]),
            [Measures].[Значение]-
            (
                ParallelPeriod
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
                    1,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
                ),
                [Measures].[Значение]
            ) ,
            null
        ) '
    member measures.[Уровень]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name'
    member measures.[Имя]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Level.Name'
    member measures.[Примечание]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Примечание")'
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды]
    as 'aggregate
        (
            {
                <%period_year_quater%>  
            }
        )'
     member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды1]
    as 'sum
        (
            {
                <%period_year_quater%>  
            }
        )'
    member [Measures].[Единица измерения]
    as 'IIF
        (
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Единица измерения") = "Неизвестные данные",
            null,
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Properties("Единица измерения")
        )'
    member [Measures].[Значение1]
    as ' IIF
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл" ,
            measures.[Уровень],
            IIF
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл1",
                measures.[Примечание] ,
                IIF
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name="Нулл2",
                    [Measures].[Единица измерения],
                    [Measures].[Значение]
                )
            )
        ) ' 
SELECT
    {
              
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл3],
        <%period_year_quater%>,  
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл1],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Нулл2]
    }   ON columns ,
  Distinct(  {
    
    filter ({ 
    
    filter  
        (
            {
            <%parent_indicators%>
         Except(   Descendants
                        (
                          {  <%indicators%>
                            },
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Уровень 3],
                            SELF_BEFORE_AFTER
                        )
                        ,
                        {
                                    [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Фонд заработной платы всех работников организаций],
                                    [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Среднемесячная заработная плата работников организаций],
                                    [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Численность работников органов местного самоуправления на конец отчетного периода].[Численность работников местных администраций (исполнительно-распорядительных органов муниципальных образований) на конец отчетного периода],
                                   [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Официально зарегистрированные безработные, получающие пособие по безработице],
                                     [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Сельское хозяйство].[Поголовье скота и птицы в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)].[Поголовье крупного рогатого скота в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)],
                                   [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Сельское хозяйство].[Поголовье скота и птицы в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)].[Поголовье крупного рогатого скота в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)].[Поголовье коров в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)],
                                   [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Сельское хозяйство].[Поголовье скота и птицы в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)].[Поголовье свиней в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)],
                                   [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Сельское хозяйство].[Поголовье скота и птицы в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)].[Поголовье лошадей в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)],
                                   [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Сельское хозяйство].[Поголовье скота и птицы в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)].[Поголовье птиц в сельскохозяйственных организациях (без субъектов малого предпринимательства с численностью до 60 человек)] ,
                                     [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Среднемесячная заработная плата работников органов местного самоуправления].[Среднемесячная заработная плата работников представительных органов местного самоуправления],
                                    [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Среднемесячная заработная плата работников органов местного самоуправления].[Среднемесячная заработная плата работников местных администраций (исполнительно-распорядительных органов муниципальных образований)],
                                    [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели].[Занятость и заработная плата].[Среднемесячная заработная плата  местной администрации (исполнительно-распорядительные органы муниципальных образований)]
                                }
                        )
           
            },
        not    
        (
            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember is [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].Parent.DataMember   
        )
        and [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды1] >0
         and   
        (
            IIF  
                    (
                        [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 2",
                        true,
                        IIF 
                        (
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 1",
                            true,
                            IIF
                            (
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 3",
                            true,
                            IIF(
                            [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name = "Уровень 4",
                            true,
                            not isEmpty
                            (
                                (
                                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды],
                                    [Measures].[Значение] 
                                ) 
                            ) 
                            )
                            
                            )
                            
                        )  
                    )   
        ) 
    )}*
    { [Measures].[Значение1],
             [Measures].[Темп роста цепной],
             [Measures].[Отклонение]},
             
             not isempty   
            (true/* 
                (
                    [Measures].[Значение1],
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Все периоды] 
                )*/
            ) 
             )
    }   
    )
    ON rows     
FROM   [СТАТ_Паспорт МО_СП и ГП]
where    
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        
         <%filter%>
    )  

  ]]>
  </query>

<query id="MO_0003_0001_indicators">
<![CDATA[
-- MO_0003_0001_indicators
with

    member [Measures].[Уровень]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Level.Name '
    member [Measures].[Юник нейм]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.UniqueName'
    member [Measures].[Юник нейм родителя]
    as '[Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Parent.UniqueName'
    set [Показатели]
    as ' filter
        (
            Descendants
            (
                [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели],
                [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Уровень 4],
                SELF_AND_BEFORE
            ),
            not
            (
               [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember is [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember.Parent.DataMember
            ) and not ([Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].CurrentMember is [Паспорт МО__СП и ГП].[Паспорт МО__СП и ГП].[Все показатели])
        ) '
SELECT
    {

        [Measures].[Уровень],
        [Measures].[Юник нейм],
        [Measures].[Юник нейм родителя]
    }   ON columns ,
    { [Показатели] }  ON rows
FROM   [СТАТ_Паспорт МО_СП и ГП]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра]
    )
  ]]>
</query>

  <query id="MO_0003_0001_mo">
    <![CDATA[
-- MO_0002_0001_mo

    with 
    member [ISDataMember] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.IS_DATAMEMBER' 
    member [UniqueName] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName' 
    member [ParentName]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.parent.Name'
    member [LevelNumber] 
    as '[Территории__РФ].[Территории__РФ].CurrentMember.Level_Number - 5' 
select
    {
        [UniqueName],
        [LevelNumber] ,
        [ParentName]
    }on columns,
    {
     order 
        (
            Except 
            (
                filter  
                (
                    [Территории__РФ].[Территории__РФ].members,
                    (
                        (
                            [Территории__РФ].[Территории__РФ].CurrentMember.parent.parent.UniqueNAme = "[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра]"  
                        )and (not [ISDataMember])and [Территории__РФ].[Территории__РФ].CurrentMember.children.count=0  
                    )   
                ) ,
                {
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Няксимволь],
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Кондинский муниципальный район].[Алтай],
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Белоярский муниципальный район].[Ванзеват],
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Ванзетур],
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Сосьва],
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Березовский муниципальный район].[Теги],
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Кондинский муниципальный район].[Алтай],
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].[Кондинский муниципальный район].[Ягодный]   
                }  
            ),
            [ParentName],
            desc
        ) 
    } on rows 
from [СТАТ_Паспорт МО_СП и ГП] 
  ]]>
  </query>

</root>