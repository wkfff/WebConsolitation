CALCULATE;

//Уровни бюджетов 
([Уровни бюджетов].[Уровни бюджетов].&[6]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[4]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[14]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[7]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);

([Уровни бюджетов].[Уровни бюджетов].&[2]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);
([Уровни бюджетов].[Уровни бюджетов].&[0]) = 
IIF(isEmpty([Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember),
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember,
    [Уровни бюджетов].[Уровни бюджетов].CurrentMember.DataMember);


[Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[4] = 
[Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[1] - 
[Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[2] + 
[Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[3] +
[Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[0];


/*SCOPE [Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[4];
   this = [Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[1] - [Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[2] + [Фиксированный__Вид поступлений].[Фиксированный__Вид поступлений].[Вид поступлений].&[3];
END SCOPE;
*/

//Вычислимые меры
CREATE MEMBER CURRENTCUBE.Measures.[С начала года] AS
IIF([Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[(All)] or
[Период__Период].[Период__Период].CurrentMember.Level is [Период__Период].[Период__Период].[Год] or
([Период__Период].[Период__Период].CurrentMember Is OpeningPeriod([Период__Период].[Период__Период].CurrentMember.Level, Ancestor([Период__Период].[Период__Период].CurrentMember, [Период__Период].[Период__Период].[Год]))),
(Measures.[За период], [Период__Период].[Период__Период].CurrentMember),
Sum({OpeningPeriod([Период__Период].[Период__Период].CurrentMember.Level, Ancestor([Период__Период].[Период__Период].CurrentMember, [Период__Период].[Период__Период].[Год])):
[Период__Период].[Период__Период].CurrentMember}, Measures.[За период])),
FORMAT_STRING = "Currency";


