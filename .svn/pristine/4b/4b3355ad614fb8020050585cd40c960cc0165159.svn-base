<?xml version="1.0" encoding="Windows-1251"?>
<root>

    <query id="RG_0017_0004_last_period">
        <![CDATA[
-- RG_0017_0004_last_period
with 
    member [Measures].[ДанныеНа] 
    as 'tail 
        (
            filter 
            (
                descendants 
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов],
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц],
                    SELF 
                ),
                not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия политикам],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Электоральные предпочтения],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия институтам власти],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс восприятия уровня распространенности коррупции],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия главам],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия Думе],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия председателю Думы],
                        [Measures].[Значение]
                    ) 
                ) 
            ),
            1 
        ).item(0).uniqueName'
select
    { [Measures].[ДанныеНа] } on columns 
from  [РЕГИОН_Данные опросов] 
where 
    (
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        <%param_territory%>.DATAMEMBER        
    )  
    ]]>
    </query>

    <query id="RG_0017_0004_power">
        <![CDATA[
-- RG_0017_0004_power
with  
    set [Территории] 
    as 'descendants 
        (
            <%param_territory%>,
            [Территории__РФ].[Территории__РФ].[МР ГО],
            SELF 
        )' 
    set [Строки] 
    as 'filter 
        (
            [СоцОпрос__Институты власти].[СоцОпрос__Институты власти].[Институт власти].members,
            not [СоцОпрос__Институты власти].[СоцОпрос__Институты власти].currentMember is [СоцОпрос__Институты власти].[СоцОпрос__Институты власти].[Все институты власти].[Значение не указано] 
        )' 
select
    { [Территории] } on columns,
    { [Строки] } on rows 
from  [РЕГИОН_Данные опросов] 
where 
    (
        <%param_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия институтам власти],
        [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Индекс]
    )
    ]]>
    </query>
        
</root>
