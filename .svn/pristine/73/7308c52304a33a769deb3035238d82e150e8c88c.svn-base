<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="tableAvgInc">
    <![CDATA[
with  
    member Measures.[Код]  
    as '[Районы].[Сопоставимый].CurrentMember.Properties("Код")'  
    member Measures.[Уровень]  
    as '[Районы].[Сопоставимый].CurrentMember.Level.Name'  
    member Measures.[Налог на доходы физических лиц]  
    as ' 
        (
            [Measures].[С начала года],
            [Доходы].[Группы КД].[Все группы КД].[Итого доходов].[Налог на доходы физических лиц] 
        )'  
    member Measures.[Налог на имущество физических лиц]  
    as ' 
        (
            [Measures].[С начала года],
            [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц] 
        )'  
    member Measures.[Земельный налог]  
    as ' 
        (
            [Measures].[С начала года],
            [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог] 
        )'  
    member Measures.[Итого по налоговым доходам, подлежащим зачислению в бюджеты поселений]  
    as 'Measures.[Налог на доходы физических лиц] + Measures.[Налог на имущество физических лиц] + Measures.[Земельный налог]'  
    member Measures.[Удельный вес доходов в итоге по поселениям]  
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember.Level.Name <> "Поселения",
            null,
            (
                Measures.[Итого по налоговым доходам, подлежащим зачислению в бюджеты поселений],
                [Районы].[Сопоставимый].CurrentMember 
            )/  
            (
                Measures.[Итого по налоговым доходам, подлежащим зачислению в бюджеты поселений],
                [Районы].[Сопоставимый].CurrentMember.Parent 
            ) 
        )'  
    member Measures.[Численность населения]  
    as 'LookupCube  
        (
            "[ФО_Показатели для планирования]",
            "  
            (
                <%period_year%>,
                [Measures].[Факт],
                " + MemberToStr  
                (
                    [Районы].[Сопоставимый].CurrentMember  
                ) + "  
            )"  
        )'  
    member Measures.[Удельный вес населения в итоге по поселениям]  
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember.Level.Name <> "Поселения",
            null,
            (
                Measures.[Численность населения],
                [Районы].[Сопоставимый].CurrentMember 
            )/  
            (
                Measures.[Численность населения],
                [Районы].[Сопоставимый].CurrentMember.Parent 
            ) 
        )'  
    member Measures.[Среднедушевые доходы]  
    as 'IIF 
        (
            IsEmpty 
            (
                Measures.[Численность населения] 
            ),
            null,
            Measures.[Итого по налоговым доходам, подлежащим зачислению в бюджеты поселений]/Measures.[Численность населения] 
        )'  
    member Measures.[Ранг поселения]
    as 'IIF
        (
            [Районы].[Сопоставимый].CurrentMember.Level.Name <> "Поселения",
            null,
            Rank
            (
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    Measures.[Среднедушевые доходы]
                ),
                Order
                (
                    StrToSet
                    (
                        "
                        {
                            " + Generate
                            (
                                Except
                                (
                                    [Районы].[Сопоставимый].CurrentMember.Siblings,
                                    {
                                        [Районы].[Сопоставимый].CurrentMember.Parent.Datamember
                                    }
                                ),
                                "
                                (
                                    " + [Районы].[Сопоставимый].CurrentMember.UniqueName + ",
                                    Measures.[Среднедушевые доходы]
                                )",
                                ",
                                "
                            ) + "
                        }"
                    ),
                    Measures.[Среднедушевые доходы],
                    DESC
                ) ,
                Measures.[Среднедушевые доходы]
            )
        )'
select
    {
        Measures.[Код],
        Measures.[Уровень],
        Measures.[Налог на доходы физических лиц],
        Measures.[Налог на имущество физических лиц],
        Measures.[Земельный налог],
        Measures.[Итого по налоговым доходам, подлежащим зачислению в бюджеты поселений],
        Measures.[Удельный вес доходов в итоге по поселениям],
        Measures.[Численность населения],
        Measures.[Удельный вес населения в итоге по поселениям],
        Measures.[Среднедушевые доходы],
        Measures.[Ранг поселения]  
    } on columns,
    Filter  
    (
        [Районы].[Сопоставимый].Members,
        (
            [Районы].[Сопоставимый].CurrentMember <> [Районы].[Сопоставимый].CurrentMember.Parent.DataMember  
        ) and not IsEmpty([Measures].[С начала года])  
    ) on rows  
FROM [ФНС_28н_с расщеплением]  
WHERE  
    (
        <%period_month%>,
        [Уровни бюджетов].[Все уровни].[Конс.бюджет субъекта].[Конс.бюджет МО].[Конс.бюджет МР].[Бюджет поселения],
        [ФНС_28н_Показатели].[Все показатели].[Поступило всего (2.10.0 + 2.11.0 + 2.12.0 - 2.13.0)]  
    )   
	]]>
</query>
<query id="tableOKVD">
    <![CDATA[
    with   
    member Measures.[Код]   
    as '[ОКВЭД].[Сопоставимый].CurrentMember.Properties("Код")'  
    member Measures.[Уровень]   
    as '[ОКВЭД].[Сопоставимый].CurrentMember.Level.Name'  
    member Measures.[Начало года]  
    as ' 
        (
            [Measures].[С начала года],
            [Период].[Месяц].[Данные всех периодов].[2007].[Полугодие 2].[Квартал 4].[Декабрь] 
        )'  
    member Measures.[Отклонение] 
    as 'Measures.[Начало года] - [Measures].[С начала года]' 
    member Measures.[Темп роста] 
    as 'IIF
        (
            IsEmpty(Measures.[Начало года]),
            null,
            [Measures].[С начала года]/Measures.[Начало года]
        )' 
    member Measures.[По всем ОКВЭД на начало года] 
    as '
        (
            Measures.[Начало года],
            [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД]
        )' 
    member Measures.[По всем ОКВЭД текущее] 
    as '
        (
            [Measures].[С начала года],
            [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД]
        )' 
    member Measures.[Удельный вес на начало года] 
    as 'IIF
        (
            IsEmpty
            (
                Measures.[По всем ОКВЭД на начало года]
            ),
            null,
            Measures.[Начало года]/Measures.[По всем ОКВЭД на начало года]
        )' 
    member Measures.[Удельный вес текущий] 
    as 'IIF
        (
            IsEmpty
            (
                Measures.[По всем ОКВЭД текущее]
            ),
            null,
            Measures.[С начала года]/Measures.[По всем ОКВЭД текущее]
        )' 
select
    {
        Measures.[Код],
        Measures.[Уровень],
        Measures.[Начало года],
        Measures.[С начала года],
        Measures.[Отклонение],
        Measures.[Темп роста],
                Measures.[Удельный вес на начало года],
        Measures.[Удельный вес текущий] 
    } on columns,
    Filter   
    (
        [ОКВЭД].[Сопоставимый].Members,
        (
            [ОКВЭД].[Сопоставимый].CurrentMember <> [ОКВЭД].[Сопоставимый].CurrentMember.Parent.DataMember  
        ) and not IsEmpty([Measures].[С начала года])   
    ) on rows   
FROM [ФНС_28н_с расщеплением]   
WHERE   
    (
        [Период].[Месяц].[Данные всех периодов].[2008].[Полугодие 1].[Квартал 2].[Май],
        [Уровни бюджетов].[Все уровни].[Конс.бюджет субъекта].[Конс.бюджет МО],
        [Районы].[Сопоставимый].[Все районы].[Баганский район],
        [ФНС_28н_Показатели].[Все показатели].[Недоимка_Сальдо расчетов],
        [КД].[Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ]  
    )      
    	]]>
  </query>
  
</root>