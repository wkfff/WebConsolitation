<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="Oil_0003_0001_date">
    <![CDATA[
    --Oil_0003_0001_date
with  
    member [Measures].[Дата]  
    as '[Период].[Период].CurrentMember.UniqueName'  
select
    {[Measures].[Дата]} on columns,
    {
        tail
        (
            filter 
            (
                [Период].[Период].[День].Members,
                (
                    [Продукция].[Сопоставимый].[Все виды продукции].[Дизельное топливо],
                    [Measures].[Цена] 
                ) > 0 or  
                (
                    [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)],
                    [Measures].[Цена] 
                ) > 0 or  
                (
                    [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)],
                    [Measures].[Цена] 
                ) > 0 or  
                (
                    [Продукция].[Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше],
                    [Measures].[Цена] 
                ) > 0  
            ),
            1
        ) 
    } on rows  
from [ФСГС_Цены РФ]  
where  
    (
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация],
        [Организации].[Тип цены].[Все типы цен].[Средняя розничная цена]  
    )  
  ]]>
  </query>

 

  <query id="Oil_0003_0001_table1">
    <![CDATA[
    --Oil_0003_0001_table1
WITH  
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[sumregion]  
    as 'Aggregate  
        (
            Filter  
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Организация].members,
                not isempty  
                (
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember  
                ) and [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember > 0  
            )  
        )/ Filter  
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Организация].members,
            not isempty  
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember  
            ) and [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember > 0  
        ).count '  
    member measures.[Цена ]  
    as '  
        (
            measures.[Цена],
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[sumregion]  
        )'  
    member measures.[Текущая цена]  
    as ' IIF  
        (
            (
                <%period_cur_date%>,
                [Measures].[Цена ]  
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Measures].[Цена ]  
            )  
        ) '  
    member measures.[Прошлая цена]  
    as ' IIF  
        (
            (
                <%period_last_date%>,
                [Measures].[Средняя цена ] 
            ) = 0,
            null,
            (
                <%period_last_date%>,
                [Measures].[Средняя цена ] 
            )  
        ) '  
    member measures.[Начало года цена]  
    as ' IIF  
        (
            (
                <%period_first_year%>,
                [Measures].[Средняя цена ] 
            ) = 0,
            null,
            (
                <%period_first_year%>,
                [Measures].[Средняя цена ] 
            )  
        ) '  
    member measures.[Абсолютное отклонение к прошлой дате]  
    as '[Measures].[Текущая средняя цена ]  - measures.[Прошлая цена]'  
    member measures.[Темп прироста (динамика к предыдущему периоду)]  
    as 'IIF  
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                [Measures].[Текущая средняя цена ] / measures.[Прошлая цена] - 1  
            )  
            * 100,
            null  
        )'  
    member measures.[Темп прироста (динамика за период с начала года) ]  
    as 'IIF  
        (
            not IsEmpty(measures.[Начало года цена]) and not  
            (
                measures.[Начало года цена] = 0  
            ),
            (
                [Measures].[Текущая средняя цена ] / measures.[Начало года цена] - 1  
            )  
            * 100,
            null  
        )'  
    member measures.[Абсолютное отклонение к началу года]  
    as 'IIF  
        (
            isEmpty(measures.[Начало года цена]),
            null,
            [Measures].[Текущая средняя цена ]  - measures.[Начало года цена]  
        )' 	  
    set [Территории]  
    as 'filter  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].children ,
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена]) 
        )'  
    member measures.[Территория ]  
    as 'Tail  
        (
            Order  
            (
                [Территории],
                measures.[Текущая цена],
                BASC  
            )  
        ).Item(0).Name'  
    member [Measures].[Максимум ]  
    as '  
        (
            Tail  
            (
                Order  
                (
                    [Территории],
                    measures.[Текущая цена],
                    BASC  
                )  
            ).Item(0),
            measures.[Текущая цена]  
        )'  
    member [Measures].[Минимум ]  
    as '  
        (
            Tail  
            (
                Order  
                (
                    [Территории],
                    measures.[Текущая цена],
                    BDESC  
                )  
            ).Item(0),
            measures.[Текущая цена]  
        ) '  
    member [Measures].[Минимум город]  
    as ' Tail  
        (
            Order  
            (
                [Территории],
                measures.[Текущая цена],
                BDESC  
            )  
        ).Item(0).Properties("Name") '  
    member [Measures].[Максимум город]  
    as ' Tail  
        (
            Order  
            (
                [Территории],
                measures.[Текущая цена],
                BASC  
            )  
        ).Item(0).Properties("Name")'  
    member [Территории__Сопоставимый].[Территории__Сопоставимый].[Аггрегированные территории]  
    as 'aggregate ([Территории])'  
    member [Measures].[Средняя цена ]  
    as '  
        (
            [Measures].[Цена ],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Аггрегированные территории]  
        ) / [Территории].Count'  
    member [Measures].[Текущая средняя цена ] 
    as ' IIF 
        (
            (
                <%period_cur_date%>,
                [Measures].[Средняя цена ] 
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Measures].[Средняя цена ] 
            ) 
        ) ' 
SELECT
    {
        [Measures].[Текущая средняя цена ],       
        measures.[Абсолютное отклонение к прошлой дате],
        measures.[Темп прироста (динамика к предыдущему периоду)],
        measures.[Абсолютное отклонение к началу года],
        measures.[Темп прироста (динамика за период с начала года) ],
        [Measures].[Минимум ],
        [Measures].[Минимум город],
        [Measures].[Максимум ],
        [Measures].[Максимум город]  
    } on columns,
    {        
        [Организации__Тип цены].[Организации__Тип цены].[Тип цены].[Розничная цена]
    } on rows  
FROM [ОРГАНИЗАЦИИ_Цены и тарифы]  
where  
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная],
     [Организации__Товары и услуги].[Организации__Товары и услуги].[(All)].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]      
    )   
  ]]>
  </query>

  <query id="Oil_0003_0001_table2">
        <![CDATA[
    --Oil_0003_0001_table2
WITH      
 member [Measures].[Текущая средняя цена ]
 as 'measures.[Текущая цена]'
    member measures.[Текущая цена]          
    as ' IIF          
        (
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            ) = 0,
            null,
            (
                <%period_cur_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]       
            )          
        ) '          
    member measures.[Прошлая цена]          
    as ' IIF          
        (
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            ) = 0,
            null,
            (
                <%period_last_date%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            )          
        ) '          
    member measures.[Начало года цена]          
    as ' IIF          
        (
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            ) = 0,
            null,
            (
                <%period_first_year%>,
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Measures].[Цена]        
            )          
        ) '          
    member measures.[Абсолютное отклонение к прошлой дате]          
    as 'measures.[Текущая цена]  - measures.[Прошлая цена]'          
    member measures.[Темп прироста (динамика к предыдущему периоду)]          
    as 'IIF          
        (
            not IsEmpty(measures.[Прошлая цена]) and not (measures.[Прошлая цена] = 0),
            (
                measures.[Текущая цена] / measures.[Прошлая цена] - 1          
            )          
            * 100,
            null          
        )'          
    member measures.[Темп прироста (динамика за период с начала года) ]          
    as 'IIF          
        (
            not IsEmpty(measures.[Начало года цена]) and not          
            (
                measures.[Начало года цена] = 0          
            ),
            (
                measures.[Текущая цена] / measures.[Начало года цена] - 1          
            )          
            * 100,
            null          
        )'          
    member measures.[Абсолютное отклонение к началу года]          
    as 'IIF          
        (
            isEmpty(measures.[Начало года цена]),
            null,
            measures.[Текущая цена]  - measures.[Начало года цена]          
        )'     
    set [Территории]     
    as 'filter     
        (
            Descendants    
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember,
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                LEAVES    
            ),
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Цена])   
        )'     
    member measures.[Территория ]          
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name'     
      member [Measures].[Максимум ] 
    as '
        (
            IIF 
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BASC 
                    ) 
                ).Item(0),
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BASC 
                    ) 
                ).Item(0) 
            ),
            measures.[Текущая цена] 
        ) ' 
    member [Measures].[Минимум ] 
    as ' 
        (
            IIF 
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BDESC 
                    ) 
                ).Item(0),
                Tail 
                (
                    Order 
                    (
                        filter 
                        (
                            Descendants 
                            (
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                                [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                                LEAVES 
                            ),
                            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                        ),
                        measures.[Текущая цена],
                        BDESC 
                    ) 
                ).Item(0) 
            ),
            measures.[Текущая цена] 
        ) ' 
    member [Measures].[Минимум город] 
    as 'IIF 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BDESC 
                ) 
            ).Item(0).Properties("Name"),
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BDESC 
                ) 
            ).Item(0).Properties("Name") 
        ) ' 
    member [Measures].[Максимум город] 
    as ' IIF 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember ,
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BASC 
                ) 
            ).Item(0).Properties("Name"),
            Tail 
            (
                Order 
                (
                    filter 
                    (
                        Descendants 
                        (
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация],
                            [Территории__Сопоставимый].[Территории__Сопоставимый].[Субъект РФ],
                            LEAVES 
                        ),
                        not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty (measures.[Текущая цена])
                    ),
                    measures.[Текущая цена],
                    BASC 
                ) 
            ).Item(0).Properties("Name") 
        )' 
SELECT
    {
       [Measures].[Текущая средняя цена ],       
        measures.[Абсолютное отклонение к прошлой дате],
        measures.[Темп прироста (динамика к предыдущему периоду)],
        measures.[Абсолютное отклонение к началу года],
        measures.[Темп прироста (динамика за период с начала года) ],
        [Measures].[Минимум ],
        [Measures].[Минимум город],
        [Measures].[Максимум ],
        [Measures].[Максимум город]
    } on columns,
    {
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Уральский федеральный округ].DataMember,
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember    
    } on rows          
from   [ФСГС_Цены РФ]        
where        
    (
        [Источники данных].[Источники данных].[Все источники данных],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[<%oil_federal%>]        
    ) 
  ]]>
    </query> 

  <query id="Oil_0003_0001_chart">
    <![CDATA[
    --Oil_0003_0001_chart
with     
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[sumregion]       
    as 'Aggregate       
        (
            Filter       
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Организация].members,
                not isempty       
                (
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember       
                ) and [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember > 0     
            )       
        )/ Filter       
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Организация].members,
            not isempty       
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember       
            ) and [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember > 0     
        ).count '     

    member [Measures].[Цена ]  
    as '  IIF 
        (
            isEmpty  
            (
                (
                    [Measures].[Цена],
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].[sumregion] 
                ) 
            ),
            null,
            (
                [Measures].[Цена],
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].[sumregion]  
            )  
        )'   
    set [Территории]    
    as 'filter    
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].children ,
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not isEmpty([Measures].[Цена ])
        )'    
    member [Территории__Сопоставимый].[Территории__Сопоставимый].[Аггрегированные территории]  
    as 'aggregate ([Территории])'
    member measures.[Период ] 
    as '[Период__День].[Период__День].CurrentMember.UniqueName' 
    member measures.[Имя ]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Name'
select
    {
     measures.[Имя ],
       [Measures].[Цена ]
    }  on columns,
    { Order ([Территории],[Measures].[Цена ], BASC) }on rows
from  [Организации_Цены и тарифы]       
where       
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная],
        [Организации__Тип цены].[Организации__Тип цены].[Тип цены].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[(All)].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>],
        <%period_cur_date%>
    )       
  ]]>
      </query>

  <query id="Oil_0003_0001_chart1">
    <![CDATA[
    --Oil_0003_0001_chart1
with     
    member [Организации__Предприятия торговли].[Организации__Предприятия торговли].[sumregion]       
    as 'Aggregate       
        (
            Filter       
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Организация].members,
                not isempty       
                (
                    [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember       
                ) and [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember > 0     
            )       
        )/ Filter       
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Организация].members,
            not isempty       
            (
                [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember       
            ) and [Организации__Предприятия торговли].[Организации__Предприятия торговли].currentmember > 0     
        ).count '     
    SET [FilterColumnSet]     
    AS 'tail     
        (
            Filter     
            (
                Descendants     
                (
                    [Период__День].[Период__День].[Данные всех периодов],
                    [Период__День].[Период__День].[День],
                    SELF_AND_AFTER     
                ) ,
                not IsEmpty     
                (
                    (
                        [Measures].[Цена],
                        [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember     
                    )     
                ) and not     
                (
                    [Measures].[Цена],
                    [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember     
                ) = 0     
            ),
            26     
        )'     
    member [Measures].[Цена ]     
    as '    
        (
            [Measures].[Цена],
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[sumregion]    
        ) '    
    set [Территории]    
    as 'filter    
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].children ,
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember and not IsEmpty ([Measures].[Цена])    
        )'    
    member [Территории__Сопоставимый].[Территории__Сопоставимый].[Аггрегированные территории]  
    as 'aggregate ([Территории])'   
    member [Measures].[Средняя цена ]  
    as '  
        (
            [Measures].[Цена ],
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Аггрегированные территории]  
        ) / [Территории].Count'  
    member measures.[Период ] 
    as '[Период__День].[Период__День].CurrentMember.UniqueName' 
select
    {
        measures.[Период ],
       [Measures].[Средняя цена ]
    }  on columns,
    { [FilterColumnSet] }on rows      
from  [Организации_Цены и тарифы]       
where       
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная],
        [Организации__Тип цены].[Организации__Тип цены].[Тип цены].[Розничная цена],
        [Организации__Товары и услуги].[Организации__Товары и услуги].[(All)].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[<%oil%>]  
    )   
      ]]>
  </query>
</root>