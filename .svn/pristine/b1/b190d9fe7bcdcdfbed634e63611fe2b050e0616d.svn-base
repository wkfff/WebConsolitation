<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0016_0001_date">
    <![CDATA[
    --FO_0016_0001_date
with                
    member [Measures].[ДанныеНа]  
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'      
    set [Показатели]      
    as 'Filter             
        (
            Descendants      
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF      
            ),
            not isEmpty 
            (
                [Measures].[Количество нарушений] 
            ) and not 
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]            
            ) and not  
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]  
            ) and 
            (
                [Период__Период].[Период__Период].CurrentMember 
            ) 
        )'          
    set [NonEmptySet]                
    as 'Tail                
        (
            Filter                
            (
                Descendants                
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF                
                ),
                not IsEmpty  ( Aggregate([Показатели]) ) and    
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"                
                )                
            ),
            1  
        )'                
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows  
from [ФО_БККУ_Показатели]             
    ]]>
  </query> 
  
  <query id="FO_0016_0001_grid">
    <![CDATA[
    --FO_0016_0001_grid
with 
    set [Районы] 
    as 'Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Муниципальные районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER 
            ),
            (
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember 
                ) or 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" 
                ) or 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП" 
                ) 
            ) and 
            (
                not 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Муниципальные районы].DATAMEMBER 
                )  
            ) 
        ) + Filter 
        (
            Descendants 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF 
            ),
            not 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа].DATAMEMBER 
            ) 
        )  ' 
    member [Measures].[Количество нарушений ] 
    as ' 
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников] 
            ) 
        )' 
    member [Measures].[Наименование] 
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name' 
    member [Measures].[Уровень] 
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП",
            1,
            0 
        )' 
select
    {
        [Measures].[Наименование],
        [Measures].[Количество нарушений ],
        [Measures].[Уровень] 
    } on columns,
    { [Районы] } on rows 
from  [ФО_БККУ_Показатели] 
where 
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>] 
    ) 
  ]]>
  </query>

  <query id="FO_0016_0001_gridTables">
    <![CDATA[
    --FO_0016_0001_gridTables
  with   
    set [Районы]   
    as 'Filter   
        (
            Descendants   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Муниципальные районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER   
            ),
            (
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember   
                ) or   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"   
                ) or   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"   
                )   
            ) and   
            (
                not   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Муниципальные районы].DATAMEMBER   
                )   
            )   
        ) + Filter   
        (
            Descendants   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF   
            ),
            not   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа].DATAMEMBER   
            )   
        )  '   
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование] 
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name' 
    set [Показатели]   
    as ' Filter   
        (
            Descendants   
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF   
            ),
            not IsEmpty
            (
                [Measures].[Количество нарушений] 
            ) and 
            (
                [Период__Период].[Период__Период].CurrentMember 
            ) and not 
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]   
            ) and not   
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]   
            )  
        )' 
    member [Measures].[Значение ] 
    as 'IIF
        (
            [Measures].[Количество нарушений] = 1,
            [Measures].[Значение],
            null
        )' 
    set [Показатели_фильтр] 
    as 'Filter 
        (
            [Показатели],
            (
                [Measures].[Количество нарушений] = 1
            ) and 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
            ) 
        )' 
     member [Measures].[Норматив.значение] 
    as ' [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Условия проверки")
    + " " +
    [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Пороговое значение")'
select
    {
        [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование]
        *{[Measures].[Значение]} +  [Показатели] 
        *   
        {
             [Measures].[Значение ],
            [Measures].[Норматив.значение]   
        }   
    } on columns,
    { [Районы] } on rows   
from  [ФО_БККУ_Показатели]   
where   
    (
         [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>] 
    )   
    ]]>
  </query>

  <query id="FO_0016_0001_indicators">
    <![CDATA[
    --FO_0016_0001_indicators
    with
    set [Показатели]
    as ' Filter
        (
            Descendants
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF
            ),
            not isEmpty
            (
                [Measures].[Количество нарушений]
            ) and not
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]
            ) and not
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]
            ) and
            (
                [Период__Период].[Период__Период].CurrentMember
            )
        )'
    member [Measures].[Наименование]
    as '[Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Наименование")
    + ", " + [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Единицы измерения")'
select
    {
       [Показатели] 
    } on columns,
    { [Measures].[Наименование]} on rows
from  [ФО_БККУ_Показатели]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>] 
    )
    ]]>
  </query>

  <query id="FO_0016_0001_MaxMinValue">
    <![CDATA[
    --FO_0016_0001_MaxMinValue
  with
    set [Районы]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Муниципальные районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                not
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Муниципальные районы].DATAMEMBER
                )
            )
        ) + Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF
            ),
            not
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа].DATAMEMBER
            )
        )  '
    member [Measures].[Количество нарушений ]
    as '
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников]
            )
        )'
    member [Measures].[Максимальное количество нарушений]
    as ' Max
        (
            [Районы],
            [Measures].[Количество нарушений ]
        )'
    member [Measures].[Минимальное количество нарушений]
    as ' Min
        (
            [Районы],
            [Measures].[Количество нарушений ]
        )'
select
    {
        [Measures].[Максимальное количество нарушений],
        [Measures].[Минимальное количество нарушений]
    } on columns,
    { [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа].[г. Новосибирск] } on rows
from  [ФО_БККУ_Показатели]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>] 
    )
   ]]>
</query>

</root>
