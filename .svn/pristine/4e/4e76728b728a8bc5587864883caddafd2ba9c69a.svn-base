<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0002_0054_01_grid">
    <![CDATA[
-- FO_0002_0054_01_grid
with       
    set [Список МО]      
    as ' Filter       
        (
            Descendants       
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF       
            ),
            not       
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember      
            ) and      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"      
            )      
        ) '      
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ]     
    as 'Aggregate       
        (
            {
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района]      
            }       
        ) '       
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]      
    as 'Aggregate      
        (
            {
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта]   
            }      
        ) '      
    member [Measures].[Расходы, направляемые на увеличение основных средств]     
    as '   
        (
            [Measures].[<%selected_measure%>],
            [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости основных средств]   
        )  / 1000'   
    member [Measures].[Расходы всего]    
    as 'IIF
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember is [РзПр__Сопоставимый].[РзПр__Сопоставимый].DefaultMember,
            (
                [Measures].[Факт],
                [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]
            ) / 1000,   
            (
                [Measures].[<%selected_measure%>],
                <%selected_rzpr%>
            ) / 1000
        )    '  
    member [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета]   
    as 'IIF  
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
            [Measures].[Расходы, направляемые на увеличение основных средств]  / [Measures].[Расходы всего]  
        )'   
    member [Measures].[Доля расходов прошлый год] 
    as '
        (
            [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета],
            ParallelPeriod
            (
                [Период__Период].[Период__Период].[Год],
                1,
                [Период__Период].[Период__Период].CurrentMember
            )
        )' 
    member [Measures].[Ранг МО по доле расходов]  
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета]  
            ),
            null,
            Rank  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                Order  
                (
                    [Список МО],
                    [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета],
                    BDESC  
                ),
                [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета]  
            )  
        )'  
    member [Measures].[Худший ранг МО по доле расходов]  
    as 'IIF  
        (
            IsEmpty  
            (
                [Measures].[Ранг МО по доле расходов] 
            ),
            null,
            max  
            (
                [Список МО],
                [Measures].[Ранг МО по доле расходов]  
            )  
        )'  
    member [Measures].[Максимальная доля]  
    as 'max  
        (
            [Список МО],
            [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета]  
        )'  
    member [Measures].[Минимальная доля]  
    as 'min  
        (
            [Список МО],
            [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета]  
        )'  
    member [Measures].[Оценка доли расходов]  
    as 'IIF  
        (
            (
                IsEmpty ([Measures].[Максимальная доля]) and IsEmpty ([Measures].[Минимальная доля]) 
            ) or  
            (
                [Measures].[Максимальная доля] - [Measures].[Минимальная доля] 
            ) = 0,
            null,
            (
                [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета] - [Measures].[Минимальная доля] 
            ) /  
            (
                [Measures].[Максимальная доля] - [Measures].[Минимальная доля] 
            )  
        )'   
    member [Measures].[Темп роста доли расходов] 
    as 'IIF 
        (
            IsEmpty([Measures].[Доля расходов прошлый год] ) or ([Measures].[Доля расходов прошлый год] ) = 0,
            null,
            [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета]     / [Measures].[Доля расходов прошлый год]
        )' 
select
    {
        [Measures].[Расходы, направляемые на увеличение основных средств],
        [Measures].[Расходы всего] ,
        [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета],
        [Measures].[Ранг МО по доле расходов],
        [Measures].[Оценка доли расходов],
        [Measures].[Темп роста доли расходов],
        [Measures].[Худший ранг МО по доле расходов]
    } on columns,
    { [Список МО] } on rows      
from [ФО_МесОтч_Расходы]      
where      
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ],
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%selected_rzpr%>
    )      
  ]]>
  </query>

  <query id="FO_0002_0054_01_chart">
    <![CDATA[
-- FO_0002_0054_01_chart
with        
    set [Список МО]       
    as ' Filter        
        (
            Descendants        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF        
            ),
            not        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember       
            ) and       
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"       
            )       
        ) '       
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ]      
    as 'Aggregate        
        (
            {
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района]       
            }        
        ) '        
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]       
    as 'Aggregate       
        (
            {
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта]     
            }       
        ) '       
    member [Measures].[Расходы, направляемые на увеличение основных средств]      
    as '    
        (
            [Measures].[<%selected_measure%>],
            [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости основных средств]    
        ) / 1000'    
    member [Measures].[Расходы всего]    
    as 'IIF
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember is [РзПр__Сопоставимый].[РзПр__Сопоставимый].DefaultMember,
            (
                [Measures].[Факт],
                [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]
            ) / 1000,   
            (
                [Measures].[<%selected_measure%>],
                <%selected_rzpr%>
            ) / 1000
        )    '    
    member [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета]    
    as 'IIF   
        (
            IsEmpty([Measures].[Расходы всего]) or ([Measures].[Расходы всего]) = 0,
            null,
            [Measures].[Расходы, направляемые на увеличение основных средств]  / [Measures].[Расходы всего]   
        )'     
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее] 
    as 'AVG
        (
            [Список МО],
            [Measures].CurrentMember
        )'  
    member [Measures].[Доведение до среднего]   
    as 'IIF 
        (
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета] 
            ) <
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее],
                [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета] 
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее],
                [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета] 
            ) -  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета] 
            ),
            0
        )'        
        
select
    {
        [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета],
        [Measures].[Доведение до среднего]
    } on columns,
    non Empty
    {
        Order
        (
            [Список МО],
            [Measures].[Доля расходов, направляемых на увеличение основных средств, в расходах бюджета],
            BDESC
        ) +
        { [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее] }
    } on rows 
from [ФО_МесОтч_Расходы]       
where       
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа ],
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%selected_rzpr%>
    )       
  ]]>
  </query>

  <query id="FO_0002_0054_01_rzprDigest">
    <![CDATA[
-- FO_0002_0054_01_rzprDigest
with   
    member [Measures].[Имя]  
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name'  
    member [Measures].[Уникальное имя]  
    as '[РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.UniqueName'   
    member [Measures].[Уровень]  
    as 'IIF 
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Level is [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Раздел],
            0,
            1 
        )'  
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]  
    } on columns,
    Filter   
    (
        [РзПр__Сопоставимый].[РзПр__Сопоставимый].AllMembers -  
        {
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].[Все коды ФКР]  
        },
        not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember is [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Parent.DataMember   
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name = "Несопоставленные данные"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name = "Всего"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Name = "Всего расходов"  
        ) and not  
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9600"  
        ) and not  
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9700"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9701"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9702"  
        ) and not   
        (
            [РзПр__Сопоставимый].[РзПр__Сопоставимый].CurrentMember.Properties("Код") = "9703"  
        ) and not
        IsEmpty([Measures].[Факт])
    ) on rows   
from  [ФО_МесОтч_Расходы]   
where 
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>]
    ) 
]]>
  </query>
</root>