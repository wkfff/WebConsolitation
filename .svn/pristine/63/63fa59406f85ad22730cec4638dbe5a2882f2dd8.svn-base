<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0016_0002_date">
    <![CDATA[
    --FO_0016_0002_date
with                
    member [Measures].[ДанныеНа]  
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'      
    set [Показатели]      
    as 'Filter             
        (
            Descendants      
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF      
            ),
            not isEmpty 
            (
                [Measures].[Количество нарушений] 
            ) and not 
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]            
            ) and not  
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]  
            ) and 
            (
                [Период__Период].[Период__Период].CurrentMember 
            ) 
        )'          
    set [NonEmptySet]                
    as 'Tail                
        (
            Filter                
            (
                Descendants                
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF                
                ),
                not IsEmpty  ( Aggregate([Показатели]) ) and    
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"                
                ) and                
                (
                    [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"                
                )                
            ),
            1  
        )'                
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows  
from [ФО_БККУ_Показатели]             
    ]]>
  </query> 
 
  <query id="FO_0016_0002_gridAvg">
    <![CDATA[
    --FO_0016_0002_gridAverage
with      
    set [ГО]     
    as ' Filter     
        (
            Descendants     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER     
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"     
            ) and not     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember     
            )     
        )'     
    set [СП]     
    as ' Filter     
        (
            Descendants     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER     
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"     
            ) or     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"     
            )     
        )'     
    set [МР]     
    as ' Filter     
        (
            Descendants     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER     
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"     
            ) and     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember     
            )     
        )'     
    set [Показатели]    
    as 'Filter    
        (
            Descendants    
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF    
            ),
            not isEmpty    
            (
                [Measures].[Количество нарушений]    
            ) and not    
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]    
            ) and not    
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]    
            ) and    
            (
                [Период__Период].[Период__Период].CurrentMember    
            )    
        )'    
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа]     
    as 'Aggregate([ГО])'     
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы]     
    as 'Aggregate([МР])'     
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Поселения]     
    as 'Aggregate([СП])'     
    member [Measures].[Количество нарушений ]     
    as '     
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников] 
            )     
        )' 

    member [Measures].[Среднее количество нарушений] 
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа],
            [Measures].[Количество нарушений ]  / [ГО].Count,
            IIF 
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы],
                [Measures].[Количество нарушений ]  / [МР].Count,
                IIF 
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Поселения],
                    [Measures].[Количество нарушений ]  / [СП].Count,
                    null
                ) 
            ) 
        )' 
    member [Measures].[Максимальное]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа],
            Max([ГО],[Measures].[Количество нарушений ]),
            IIF
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы],
                Max([МР],[Measures].[Количество нарушений ]),
                IIF
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Поселения],
                    Max([СП],[Measures].[Количество нарушений ]),
                    null
                )
            )
        )'
     member [Measures].[Минимальное]
     as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа],
            Min([ГО],[Measures].[Количество нарушений ]),
            IIF
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы],
                Min([МР],[Measures].[Количество нарушений ]),
                IIF
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Поселения],
                    Min([СП],[Measures].[Количество нарушений ]),
                    null
                )
            )
        )'
select
    {
        [Measures].[Количество нарушений ],
        [Measures].[Среднее количество нарушений],
        [Measures].[Максимальное],
        [Measures].[Минимальное]
    } on columns,
    {
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Городские округа],
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Муниципальные районы],
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Поселения]    
    } on rows     
from  [ФО_БККУ_Показатели]     
where     
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]      
    )     
   ]]>
  </query>

  <query id="FO_0016_0002_chart">
    <![CDATA[
    --FO_0016_0002_chart
with   
    set [Районы]   
    as ' Filter   
        (
            Descendants   
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF_AND_AFTER   
            ),
            (
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember   
                ) or   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"   
                ) or   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"   
                ) or   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"   
                )   
            ) and   
            (
                not   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Муниципальные районы].DATAMEMBER   
                ) and not   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа].DATAMEMBER   
                ) and not   
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Городские округа].[г. Новосибирск]   
                )   
            )   
        )  '   
    set [Показатели]   
    as 'Filter   
        (
            Descendants   
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Показатели],
                SELF   
            ),
            not isEmpty   
            (
                [Measures].[Количество нарушений]   
            ) and not   
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Несопоставленные данные]   
            ) and not   
            (
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember is [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[Группа МО]   
            ) and   
            (
                [Период__Период].[Период__Период].CurrentMember   
            )   
        )'   
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Районы]   
    as 'Aggregate([Районы])'   
    member [Measures].[Количество нарушений ]   
    as '   
        (
            [Measures].[Количество нарушений],
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Районы],
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember   
            )   
        )'   
    member [Measures].[Краткое наименование]   
    as ' [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember.Properties("Содержание")'   
    member [Measures].[Хинт]
    as 'Generate
        (
            Head (
            Filter
            (
                [Районы],
                (
                    [Measures].[Количество нарушений],
                    [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].CurrentMember 
                )  
            ),27),
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name,
            ", "
        )'
select
    {
        [Measures].[Краткое наименование],
        [Measures].[Количество нарушений ],
        [Measures].[Хинт]
    } on columns,
    { [Показатели] } on rows   
from  [ФО_БККУ_Показатели]  
where 
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>]  
    ) 
  ]]>
  </query>
</root>
