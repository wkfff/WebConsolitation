<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0042_0003_date">
    <![CDATA[
-- FO_0042_0003_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период].[Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as 'Tail 
        (
            Filter 
            (
                [Период].[Период].Members,
                not IsEmpty 
                (
                    (
                        [Measures].[Значение],
                        [Показатели].[Оценка качества ФМ_Сопоставимый].[Все показатели]
                    ) 
                ) and 
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and 
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and 
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and 
                [Период].[Период].CurrentMember.Name <> "Данные года" and 
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and 
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты" 
            ),
            1 
        )' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
]]>
  </query>

  <query id="FO_0042_0003_grid">
    <![CDATA[
-- FO_0042_0003_grid
with      
    set [Администраторы] 
    as 'Filter
        (
            Descendants 
            (
                <%administrator_all_level%>,
                <%administrator_dimension%>.[Администратор],
                SELF 
            ),
            not IsEmpty
            (
                [Measures].[Оценка показателя]
            )
        )'       
    set [Показатели]      
    as 'Order
        (
            Filter      
            (
                Descendants      
                (
                    <%indicator_all_level%>,
                    <%indicator_dimension%>.[Показатели 1],
                    SELF      
                ),
                not      
                (
                    <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.CurrentMember.Parent.DataMember      
                ) and
                (InStr(<%indicator_dimension%>.CurrentMember.Properties("Обозначение"), "Рейтинг") = 0) and
                (InStr(<%indicator_dimension%>.CurrentMember.Properties("Обозначение"), "Р") > 0)    
            ),
            StrToValue
            (
                <%indicator_dimension%>.CurrentMember.Properties("Код")
            ),
            BASC
        )'      
    member <%administrator_dimension%>.[Обозначение]     
    as '<%indicator_dimension%>.CurrentMember.Properties("Обозначение")'     
    member <%administrator_dimension%>.[Наименование]     
    as '<%indicator_dimension%>.CurrentMember.Name'    
    member <%administrator_dimension%>.[UniqName]     
    as '<%indicator_dimension%>.CurrentMember.UniqueName'         
    member <%administrator_dimension%>.[Кол-во ГРБС с применимой оценкой]     
    as 'Sum   
        (
            [Администраторы],
            [Measures].[Применим ли в оценке]   
        )'     
    member <%administrator_dimension%>.[Сумма оценок по ГРБС]   
    as 'Sum   
        (
            [Администраторы],
            [Measures].[Оценка показателя]   
        )'   
    member <%administrator_dimension%>.[Средняя оценка показателя исходя из его применимости к ГРБС]     
    as 'IIF  
        (
            IsEmpty  
            (
                <%administrator_dimension%>.[Кол-во ГРБС с применимой оценкой]    
            ) or <%administrator_dimension%>.[Кол-во ГРБС с применимой оценкой] = 0,
            null,
            <%administrator_dimension%>.[Сумма оценок по ГРБС]  / <%administrator_dimension%>.[Кол-во ГРБС с применимой оценкой]  
        )'   
    member <%administrator_dimension%>.[ГРБС, получивший минимальную оценку]  
    as 'Generate 
        (
            Filter 
            (
                [Администраторы],
                ([Measures].[Оценка показателя], [Период].[Период].[Данные всех периодов].[<%period_year%>]) = 0 and 
                ([Measures].[Применим ли в оценке], [Период].[Период].[Данные всех периодов].[<%period_year%>]) = 1 
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'  
    member [Measures].[Максимальная оценка] 
    as 'IIF
        (
            [Период].[Период].[Данные всех периодов].[<%period_year%>] is [Период].[Период].[Данные всех периодов].[2008],
            4,
            1
        )' 
    member <%administrator_dimension%>.[ГРБС, получивший максимальную оценку] 
    as 'Generate 
        (
            Filter 
            (
                [Администраторы],
                ([Measures].[Оценка показателя], [Период].[Период].[Данные всех периодов].[<%period_year%>]) = [Measures].[Максимальная оценка] and
                ([Measures].[Применим ли в оценке], [Период].[Период].[Данные всех периодов].[<%period_year%>]) = 1
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )' 
    member <%administrator_dimension%>.[ГРБС, по которому показатель не применим]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                ([Measures].[Применим ли в оценке], [Период].[Период].[Данные всех периодов].[<%period_year%>]) = 0
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member <%administrator_dimension%>.[№ п/п]
    as '0'        
select
    {
        <%administrator_dimension%>.[№ п/п],
        <%administrator_dimension%>.[Обозначение],
        <%administrator_dimension%>.[Наименование],
        <%administrator_dimension%>.[Средняя оценка показателя исходя из его применимости к ГРБС],
        <%administrator_dimension%>.[ГРБС, получивший минимальную оценку],
        <%administrator_dimension%>.[ГРБС, получивший максимальную оценку],
        <%administrator_dimension%>.[ГРБС, по которому показатель не применим],
        <%administrator_dimension%>.[UniqName]  
    } on columns,
    { [Показатели] } on rows      
from [ФО_Оценка качества ФМ_Показатели]      
where      
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>],
        [Measures].[Оценка показателя]      
    )     
  ]]>
  </query>

  <query id="FO_0042_0003_chart_tenth">
    <![CDATA[
-- FO_0042_0003_chart_tenth
with
    set [Администраторы] 
    as 'Filter
        (
            Descendants 
            (
                <%administrator_all_level%>,
                <%administrator_dimension%>.[Администратор],
                SELF 
            ),
            not IsEmpty
            (
                [Measures].[Оценка показателя]
            )
        )'  
    member [Measures].[Оценка]
    as '([Measures].[Оценка показателя], [Период].[Период].[Данные всех периодов].[<%period_year%>])'
    member [Measures].[Применимость к оценке]
    as '([Measures].[Применим ли в оценке], [Период].[Период].[Данные всех периодов].[<%period_year%>]) = 1'    
-----------Кол-во МО
    member [Measures].[Число [0,0:0,1)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                     [Measures].[Оценка] >= 0.0 and [Measures].[Оценка] < 0.1
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,1:0,2)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.1 and [Measures].[Оценка] < 0.2
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,2:0,3)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.2 and [Measures].[Оценка] < 0.3
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,3:0,4)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.3 and [Measures].[Оценка] < 0.4
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,4:0,5)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.4 and [Measures].[Оценка] < 0.5
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,5:0,6)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.5 and [Measures].[Оценка] < 0.6
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,6:0,7)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.6 and [Measures].[Оценка] < 0.7
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,7:0,8)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.7 and [Measures].[Оценка] < 0.8
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,8:0,9)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.8 and [Measures].[Оценка] < 0.9
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [0,9:1,0_]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.9 and [Measures].[Оценка] <= 1.0
                ) and [Measures].[Применимость к оценке]
            )
        )'
----------- Хинты
    member [Measures].[Хинт [0,0:0,1)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.0 and [Measures].[Оценка] < 0.1
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,1:0,2)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.1 and [Measures].[Оценка] < 0.2
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,2:0,3)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.2 and [Measures].[Оценка] < 0.3
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,3:0,4)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.3 and [Measures].[Оценка] < 0.4
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,4:0,5)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.4 and [Measures].[Оценка] < 0.5
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,5:0,6)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.5 and [Measures].[Оценка] < 0.6
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,6:0,7)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.6 and [Measures].[Оценка] < 0.7
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,7:0,8)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.7 and [Measures].[Оценка] < 0.8
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,8:0,9)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.8 and [Measures].[Оценка] < 0.9
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [0,9:1,0_]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0.9 and [Measures].[Оценка] <= 1.0
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
----------- Меры
    member [Measures].[[0,0:0,1)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,0:0,1)],
            [Measures].[Число [0,0:0,1)]
        )'
    member [Measures].[[0,1:0,2)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,1:0,2)],
            [Measures].[Число [0,1:0,2)]
        )'
    member [Measures].[[0,2:0,3)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,2:0,3)],
            [Measures].[Число [0,2:0,3)]
        )'
    member [Measures].[[0,3:0,4)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,3:0,4)],
            [Measures].[Число [0,3:0,4)]
        )'
    member [Measures].[[0,4:0,5)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,4:0,5)],
            [Measures].[Число [0,4:0,5)]
        )'
    member [Measures].[[0,5:0,6)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,5:0,6)],
            [Measures].[Число [0,5:0,6)]
        )'
    member [Measures].[[0,6:0,7)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,6:0,7)],
            [Measures].[Число [0,6:0,7)]
        )'
    member [Measures].[[0,7:0,8)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,7:0,8)],
            [Measures].[Число [0,7:0,8)]
        )'
    member [Measures].[[0,8:0,9)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,8:0,9)],
            [Measures].[Число [0,8:0,9)]
        )'
    member [Measures].[[0,9:1,0_]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0,9:1,0_],
            [Measures].[Число [0,9:1,0_]
        )'
---------------
    member <%indicator_dimension%>.[Хинт]
    as '<%selected_indicator%>'


select
    {
        <%selected_indicator%>,
        <%indicator_dimension%>.[Хинт]
    } on columns,

       {
        [Measures].[[0,0:0,1)],
        [Measures].[[0,1:0,2)],
        [Measures].[[0,2:0,3)],
        [Measures].[[0,3:0,4)],
        [Measures].[[0,4:0,5)],
        [Measures].[[0,5:0,6)],
        [Measures].[[0,6:0,7)],
        [Measures].[[0,7:0,8)],
        [Measures].[[0,8:0,9)],
        [Measures].[[0,9:1,0_]
       }
     on rows
from [ФО_Оценка качества ФМ_Показатели]
where
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>]
    )
  ]]>
  </query>

  <query id="FO_0042_0003_chart_fourth">
    <![CDATA[
-- FO_0042_0003_chart_fourth
with
    set [Администраторы] 
    as 'Filter
        (
            Descendants 
            (
                <%administrator_all_level%>,
                <%administrator_dimension%>.[Администратор],
                SELF 
            ),
            not IsEmpty
            (
                [Measures].[Оценка показателя]
            )
        )'  
    member [Measures].[Оценка]
    as '([Measures].[Оценка показателя], [Период].[Период].[Данные всех периодов].[<%period_year%>])'
    member [Measures].[Применимость к оценке]
    as '([Measures].[Применим ли в оценке], [Период].[Период].[Данные всех периодов].[<%period_year%>]) = 1'       
-----------Кол-во МО
    member [Measures].[Число [0:1)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                     [Measures].[Оценка] >= 0 and [Measures].[Оценка] < 1
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [1:2)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 1 and [Measures].[Оценка] < 2
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [2:3)]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 2 and [Measures].[Оценка] < 3
                ) and [Measures].[Применимость к оценке]
            )
        )'
    member [Measures].[Число [3:4_]
    as 'Count
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 3 and [Measures].[Оценка] <= 4
                ) and [Measures].[Применимость к оценке]
            )
        )'

----------- Хинты
    member [Measures].[Хинт [0:1)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 0 and [Measures].[Оценка] < 1
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [1:2)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 1 and [Measures].[Оценка] < 2
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [2:3)]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 2 and [Measures].[Оценка] < 3
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'
    member [Measures].[Хинт [3:4_]
    as 'Generate
        (
            Filter
            (
                [Администраторы],
                (
                    [Measures].[Оценка] >= 3 and [Measures].[Оценка] <= 4
                ) and [Measures].[Применимость к оценке]
            ),
            <%administrator_dimension%>.CurrentMember.Name,
            ";"
        )'

----------- Меры
    member [Measures].[[0:1)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [0:1)],
            [Measures].[Число [0:1)]
        )'
    member [Measures].[[1:2)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [1:2)],
            [Measures].[Число [1:2)]
        )'
    member [Measures].[[2:3)]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [2:3)],
            [Measures].[Число [2:3)]
        )'
    member [Measures].[[3:4_]
    as 'IIF
        (
            <%indicator_dimension%>.CurrentMember is <%indicator_dimension%>.[Хинт],
            [Measures].[Хинт [3:4_],
            [Measures].[Число [3:4_]
        )'

---------------
    member <%indicator_dimension%>.[Хинт]
    as '<%selected_indicator%>'


select
    {
        <%selected_indicator%>,
        <%indicator_dimension%>.[Хинт]
    } on columns,

       {
        [Measures].[[0:1)],
        [Measures].[[1:2)],
        [Measures].[[2:3)],
        [Measures].[[3:4_]
       }
     on rows
from [ФО_Оценка качества ФМ_Показатели]
where
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>]
    )
  ]]>
  </query>

  <query id="FO_0042_0003_grbsDigest">
    - <![CDATA[ 
-- FO_0042_0003_grbsDigest
with   
    set [Администраторы]   
    as 'Descendants   
        (
            [Администратор].[Сопоставим],
            [Администратор].[Сопоставим].[Администратор],
            SELF   
        ) - {[Администратор].[Сопоставим].[Все администраторы].[Несопоставленные данные]}'
    member [Measures].[Имя]   
    as ' [Администратор].[Сопоставим].CurrentMember.Name '   
    member [Measures].[Уникальное имя]   
    as '[Администратор].[Сопоставим].CurrentMember.UniqueName'  
    member [Measures].[Краткое имя]  
    as '[Администратор].[Сопоставим].CurrentMember.Properties("Краткое наименование")'  
    member [Measures].[Полное имя]  
    as '[Администратор].[Сопоставим].CurrentMember.Name'  
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Краткое имя],
        [Measures].[Полное имя] 
    } on columns,
    { [Администраторы] } on rows
From  [ФО_Оценка качества ФМ_Показатели]
  ]]>
  </query>  
  
</root>