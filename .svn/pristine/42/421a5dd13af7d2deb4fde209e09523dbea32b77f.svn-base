<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0042_0001_date">
    <![CDATA[
-- FO_0042_0001_date
-- <#[ФО_Оценка качества ФМ_Показатели]#>
with 
    member [Measures].[ДанныеНа] 
    as '[Период].[Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as 'Tail 
        (
            Filter 
            (
                [Период].[Период].Members,
                not IsEmpty 
                (
                    (
                        [Measures].[Значение],
                        [Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели]
                    ) 
                ) and  
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and 
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and 
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and 
                [Период].[Период].CurrentMember.Name <> "Данные года" and 
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and 
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты" 
            ), 
            1 
        )'  
select
    {  [Показатели].[Оценка качества ФМ].[Данные всех источников] } on columns,
 non empty   { [Период].[Период].[Год].members } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
where ([Measures].[Значение])
]]>
  </query>

  <query id="FO_0042_0001_grid">
    <![CDATA[
-- FO_0042_0001_grid
-- <#[ФО_Оценка качества ФМ_Показатели]#>
with               
    set [Администраторы]             
    as 'Descendants            
        (
            [Администратор].[Анализ].[Данные всех источников].[ФО Анализ данных - <%period_year%>],
            [Администратор].[Анализ].[Администратор],
            SELF            
        )'             
    set [Показатели]      
    as 'Filter
        (
            Descendants           
            (
                [Показатели].[Оценка качества ФМ].[Данные всех источников].[ФО\0042 Оценка качества ФМ - <%period_year%> квартал 0],
                [Показатели].[Оценка качества ФМ].[Показатели 2],
                SELF           
            ),
            not
            (
               [Показатели].[Оценка качества ФМ].CurrentMember is [Показатели].[Оценка качества ФМ].CurrentMember.Parent.DataMember
            )
        ) '         
    member [Показатели].[Оценка качества ФМ].[Код ГРБС]            
    as '[Администратор].[Анализ].CurrentMember.Properties("Код")'          
    member [Показатели].[Оценка качества ФМ].[Наименование ГРБС]            
    as '[Администратор].[Анализ].CurrentMember.Name'        
    member [Показатели].[Оценка качества ФМ].[Уровень качества финансового менеджмента ГРБС]          
    as 'Sum         
        (
            [Показатели],
            [Measures].CurrentMember
        )'  
    member [Measures].[Множитель] 
    as '5'        
    member [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей]
    as '[Measures].[Множитель]
        * Sum 
        (
            [Показатели],
            [Measures].[Применим ли в оценке] 
        )'        
    member [Показатели].[Оценка качества ФМ].[Значение оценки качества финансового менеджмента ГРБС]         
    as 'IIF        
        (
            IsEmpty        
            (
                [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей]        
            ) or [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей] = 0,
            null,
            100*
            (
                [Показатели].[Оценка качества ФМ].[Уровень качества финансового менеджмента ГРБС]      
            ) /       
            (
                [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей]      
            )       
        )'     
    member [Measures].[Не применим к оценке ]
    as '"Не применим к оценке"'
    member [Measures].[Оценка показателя ]
    as 'IIF
        (
            [Measures].[Применим ли в оценке] = 0,
            -100500,
            [Measures].[<%selected_maasure%>] 
        )'  
    member [Показатели].[Оценка качества ФМ].[№ п/п]
    as '0'
select
    Filter     
    (
        {
            {
                [Показатели].[Оценка качества ФМ].[№ п/п],
                [Показатели].[Оценка качества ФМ].[Код ГРБС],
                [Показатели].[Оценка качества ФМ].[Наименование ГРБС],
                [Показатели].[Оценка качества ФМ].[Уровень качества финансового менеджмента ГРБС],
                [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей]
                
            } + [Показатели]          
        },
        IIF    
        (
            (
                [Показатели].[Оценка качества ФМ].CurrentMember is [Показатели].[Оценка качества ФМ].[Уровень качества финансового менеджмента ГРБС]    
            ) or    
            (
                [Показатели].[Оценка качества ФМ].CurrentMember is [Показатели].[Оценка качества ФМ].[Максимально возможное (наилучшее) значение оценки показателей]    
            ) or    
            (
                [Показатели].[Оценка качества ФМ].CurrentMember is [Показатели].[Оценка качества ФМ].[Значение оценки качества финансового менеджмента ГРБС]    
            ),
            [Measures].[<%selected_maasure%>] is [Measures].[Оценка показателя],
            true  
        )   
    ) on columns,
    { 
      filter
      (
        [Администраторы],
        [Measures].[Оценка показателя ]  <>-100500
       ) 
    } on rows            
from [ФО_Оценка качества ФМ_Показатели]             
where            
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%selected_quater%>],
        [Measures].[Оценка показателя ]           
    )                       
  ]]>
  </query>

  <query id="FO_0042_0001_indicatorDescription">
    <![CDATA[
-- FO_0042_0001_indicatorDescription
With
    set [Показатели]      
    as 'Filter
        (
            Descendants           
            (
                [Показатели__Оценка качества ФМ].[Показатели__Оценка качества ФМ].[Данные всех источников].[ФО\0042 Оценка качества ФМ - <%period_year%> квартал 0],
                [Показатели__Оценка качества ФМ].[Показатели__Оценка качества ФМ].[Показатели 2],
                SELF           
            ),
            not
            (
               [Показатели__Оценка качества ФМ].CurrentMember is [Показатели__Оценка качества ФМ].CurrentMember.Parent.DataMember
            )
        )' 

    member [Measures].[Обозначение]
    as '[Показатели__Оценка качества ФМ].CurrentMember.Properties("Обозначение")'
    member [Measures].[Единицы измерения]
    as '[Показатели__Оценка качества ФМ].CurrentMember.Properties("Единицы измерения")'
Select
    {
       [Measures].[Обозначение],
       [Measures].[Единицы измерения]
    } on columns,
    { [Показатели] } on rows
From [ФО_Оценка качества ФМ_Показатели]
  ]]>
  </query>

</root>