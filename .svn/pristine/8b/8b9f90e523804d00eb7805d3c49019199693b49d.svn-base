<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0002_0016_03_moGrid">
    <![CDATA[
-- FO_0002_0016_03_moGrid
with        
    set [Список МО]     
    as 'Filter     
        (
            Descendants     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 03],
                SELF     
            ),
            not     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember     
            ) and     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"     
            )     
        )'  
   
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого]
    as 'Aggregate({[Список МО]})'
   
   set [Список МО с итого]   
    as  '[Список МО] + [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого]'            
   
   set [Список МБТ] 
    as '  
        {
            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты]
        } '   
    
    member [КД__Сопоставимый].[КД__Сопоставимый].[Всего]  
    as 'Aggregate 
        (
            {
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты]  
            } 
        )' 
        
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]  
    as 'Aggregate   
        (
            {
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]   
            }   
        )'  
    member [Measures].[Утверждено на год] 
    as '[Measures].[Годовые назначения] / 1000'  
    member [Measures].[Профинансировано] 
    as '[Measures].[Факт] / 1000'  
    member [Measures].[Остаток финансирования от плана на год] 
    as '[Measures].[Утверждено на год] - [Measures].[Профинансировано]' 

    member [Measures].[Уровень]    
    as 'IIF   
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
            0,
            1 
        )'  
    member [Measures].[Аггрегированные меры] 
    as 'Aggregate
        (
            {
                [Measures].[Годовые назначения],
                [Measures].[Факт]
            }
        )'         
select
    {
        {
            { {[КД__Сопоставимый].[КД__Сопоставимый].[Всего]} + [Список МБТ] }
            * 
            {
                [Measures].[Утверждено на год],
                [Measures].[Профинансировано],
                [Measures].[Остаток финансирования от плана на год]
            }
        } +
        {
            {[КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов]}
            *
            {[Measures].[Уровень] }
        }
    } on columns,
    Filter
    (
       { {[Районы__Сопоставимый].[Районы__Сопоставимый].[Итого]} + [Список МО] },
       not 
       (
          IsEmpty(([Measures].[Аггрегированные меры], [КД__Сопоставимый].[КД__Сопоставимый].[Всего]))
       )  
    ) on rows
from [ФО_МесОтч_Доходы]     
where     
    (
        <%selected_period%>,
        [ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]   
    )     
  ]]>
  </query>

  <query id="FO_0002_0016_03_kdGrid">
    <![CDATA[
-- FO_0002_0016_03_kdGrid
with    
    set [Список МО]     
    as 'Filter     
        (
            Descendants     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 03],
                SELF     
            ),
            not     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember     
            ) and     
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"     
            )     
        )'  
   
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого]
    as 'Aggregate({[Список МО]})'
      
    set [Список КД]         
    as 'Generate        
        (
            {
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты]         
            },
            {
                [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember       
            } + Filter       
            (
                Descendants      
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember,
                    [КД__Сопоставимый].[КД__Сопоставимый].[Элемент подстатьи],
                    SELF_AND_BEFORE      
                ),
                not        
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember is [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember.Parent.DataMember       
                )       
            )        
        )'      
    member [КД__Сопоставимый].[КД__Сопоставимый].[Итого]      
    as 'Aggregate     
        (
            {
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Дотации бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субсидии бюджетам субъектов Российской Федерации и муниципальных образований (межбюджетные субсидии)],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты]      
            }     
        )'       
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]          
    as 'Aggregate          
        (
            {
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]          
            }          
        )'          
    member [Measures].[Утверждено на год]          
    as '[Measures].[Годовые назначения] / 1000'          
    member [Measures].[Профинансировано]          
    as '[Measures].[Факт] / 1000'          
    member [Measures].[Остаток финансирования от плана на год]          
    as '[Measures].[Утверждено на год] - [Measures].[Профинансировано]'     
    member [Measures].[Уровень]    
    as 'IIF   
        (
            [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember is [КД__Сопоставимый].[КД__Сопоставимый].[Итого],
            0,
            StrToValue  
            (
                [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember.Properties("LEVEL_NUMBER")  
            ) - 2  
        )'    
select
    {
        [Measures].[Утверждено на год],
        [Measures].[Профинансировано],
        [Measures].[Остаток финансирования от плана на год],
        [Measures].[Уровень]   
    } on columns,
    Filter 
    (
        {
            [КД__Сопоставимый].[КД__Сопоставимый].[Итого]     
        } + [Список КД],
        not 
        (
            IsEmpty 
            (
                [Measures].[Утверждено на год] 
            ) and IsEmpty 
            (
                [Measures].[Профинансировано] 
            )
        ) 
    ) on rows  
from [ФО_МесОтч_Доходы]          
where          
    (
        <%selected_period%>,
        [Районы__Сопоставимый].[Районы__Сопоставимый].[<%selected_grid_indicator%>],
        [ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Уровень бюджета ]          
    )             
  ]]>
  </query>
</root>