<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0039_0005_Kostroma_date">
    <![CDATA[
-- FO_0039_0005_Kostroma_date
with    
    member [Measures].[ДанныеНа]    
    as '[Период].[Период].CurrentMember.UniqueName'    
    set [NonEmptySet]    
    as 'Tail    
        (
            Filter    
            (
                Descendants   
                (
                    [Период].[Период].[Данные всех периодов],
                    [Период].[Период].[Квартал],
                    SELF   
                ),
                not IsEmpty    
                (
                    (
                        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р2]    
                    )    
                ) and   
                (
                    [Период].[Период].CurrentMember.Name <> "Остатки на начало года"  
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные квартала" 
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные полугодия" 
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Данные месяца"
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
                ) 
            ),
            1    
        )'    
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows    
from [ФО_Оценка качества ОиОБП_Показатели]   
]]>
  </query>

  <query id="FO_0039_0005_Kostroma_map">
    <![CDATA[
-- FO_0039_0005_Kostroma_map
with  
    set [Список МР]  
    as 'Filter  
        (
            Descendants  
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF  
            ),
            not  
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember  
            ) and  
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"  
            )  
        )'  
    set [Список ГО]  
    as 'Filter  
        (
            Descendants  
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF  
            ),
            not  
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember  
            ) and  
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"  
            )  
        )'  
    set [Список MО]    
    as '[Список ГО] + [Список МР]' 
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Код] 
    as ' [Районы].[Сопоставимый].CurrentMember.Properties("Код объекта карты")'
    set [Ненулевые P1] 
    as 'Filter 
        (
            [Список MО],
            not  
            (
                [Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Год] and
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р1],
                    [Measures].[Значение]  
                ) <> 0  
            )  
        )  '     
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Итоговая оценка уровня качества ОиОБП ]    
    as 'IIF 
        (
            Count([Ненулевые P1]) = 0,
            null,
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка]   
        )' 
    member Measures.[Выводим пустоту]    
    as '[Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Год] and 
        IsEmpty
        (
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р4],
                [Период].[Период].[Данные всех периодов].<%selected_period%>.DataMember,
                [Measures].[<%selected_measure%>]
            )   
        ) '   
    member Measures.[Мера] 
    as 'IIF
        (
            not ([Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember is [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Код]) and Measures.[Выводим пустоту],
            null,
            [Measures].[<%selected_measure%>]
        )'
select
    {
        <%selected_indicator%>
    } on columns,
    {
        Filter  
        (
            [Список MО],
            not IsEmpty([Measures].[Значение])
        )   
    } on rows   
from  [ФО_Оценка качества ОиОБП_Показатели]   
where   
    (
        Measures.[Мера],
        [Период].[Период].[Данные всех периодов].<%selected_period%>  
    )    
  ]]>
</query>

  <query id="FO_0039_0005_QualityValueIndicatorList">
    <![CDATA[
-- FO_0039_0005_QualityValueIndicatorList
with    
    set [Список показателей]    
    as '    
        {
            Filter    
            (
                Descendants    
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Показатели],
                    SELF    
                ) -    
                {
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Несопоставленные данные],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Средняя оценка по МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Ранг],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Степень качества]   
                },
                not
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember is [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Parent.DataMember    
                )    
            )    
        }'
    member [Measures].[Имя]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Name'
    member [Measures].[Уникальное имя]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.UniqueName'    
    member [Measures].[Уровень]
    as '0'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]     
    } on columns,
    { [Список показателей] } on rows    
from  [ФО_Оценка качества ОиОБП_Показатели]
  ]]>
  </query>

  <query id="FO_0039_0005_QualityEvaluationIndicatorList">
    <![CDATA[
-- FO_0039_0005_QualityEvaluationIndicatorList
with    
    set [Список показателей]    
    as '    
        {
            Filter    
            (
                Descendants    
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Показатели],
                    SELF    
                ) -    
                {
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Несопоставленные данные],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Степень качества],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Средняя оценка по МО],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Ранг]
                },
                not
                (
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember is [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Parent.DataMember    
                )    
            )    
        }'
    member [Measures].[Имя]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.Name'
    member [Measures].[Уникальное имя]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember.UniqueName'    
    member [Measures].[Уровень]
    as '0'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]     
    } on columns,
    { [Список показателей] } on rows    
from  [ФО_Оценка качества ОиОБП_Показатели]
  ]]>
  </query>

  <query id="FO_0039_0005_indicator_detail">
     <![CDATA[ 
-- FO_0039_0005_indicator_detail
with  
    set [Список МО]  
    as 'Filter  
        (
            Descendants  
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF  
            ),
            not  
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember  
            ) and  
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"  
            )  
        )'  
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества]  
    as 'AVG  
        (
            [Список МО],
            (
                [Measures].CurrentMember,
                <%selected_indicator%>
            )  
        )'  
 
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Наименование] 
    as '<%selected_indicator%>.Properties("Наименование")'
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Периодичность расчета показателя]
    as '<%selected_indicator%>.Properties("Периодичность расчета показателя")' 
    
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Начальная граница интервала для года] 
    as '20'   
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Конечная граница интервала для года] 
    as '10'  
    
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Начальная граница интервала для квартала] 
    as '10'   
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Конечная граница интервала для квартала] 
    as '5'   
select
    {
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Наименование],
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Начальная граница интервала для года],
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Конечная граница интервала для года],
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Начальная граница интервала для квартала],
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Конечная граница интервала для квартала],
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Периодичность расчета показателя]  
    } on columns  
from [ФО_Оценка качества ОиОБП_Показатели]  
where  
    (
        [Measures].[<%selected_measure%>],
        [Период].[Период].[Данные всех периодов].<%selected_period%>
    )   
  ]]>
  </query>


</root>