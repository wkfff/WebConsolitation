<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0021_0004_Saratov_date">
    <![CDATA[
-- FO_0021_0004_Saratov_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели]
                    )
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_ФПКУ_Показатели]
]]>
  </query>

  <query id="FO_0021_0004_Saratov_map">
    <![CDATA[
-- FO_0021_0004_Saratov_map
with
    set [Список МО]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 03],
                SELF
            ),
            not
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            )
        )'
select
    {
         <%selected_indicator%>
    } on columns,
    {
        Order
        (
            Filter
            (
                [Список МО],
                not IsEmpty([Measures].[Взвешенное значение])
            ),
            <%selected_indicator%>,
            <%sorting_type%>
        )
    } on rows
from [ФО_ФПКУ_Показатели]
where
    (
        [Measures].[Взвешенное значение],
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>
    ) 
  ]]>
</query>

  <query id="FO_0021_0004_Saratov_indicatorList">
    <![CDATA[
-- FO_0021_0004_Saratov_indicatorList
with
    set [Показатели]
    as 'Filter
        (
            Descendants
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели],
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Показатели],
                SELF
            ),
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Итоговая оценка"
            ) and
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Ранг"
            ) and
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Средняя оценка"
            ) and
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Несопоставленные данные"
            ) and
            (
                [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Группа МО"
            )
        )'

    set [Список общих показателей]
    as '{
            [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Итоговая оценка],
            [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Ранг],
            [Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].[Все показатели].[Средняя оценка]
        }'

    member [Measures].[Имя]
    as 'IIF
		(	
			[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Итоговая оценка",
			[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Properties("Наименование"),
			"Комплексная оценка МО"
		)'
    member [Measures].[Уникальное имя]
    as '[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.UniqueName'
    member [Measures].[Уровень]
    as '0'
    member [Measures].[Полное имя]
    as 'IIF
		(	
			[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name <> "Итоговая оценка",
			[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Properties("Наименование"),
			"Комплексная оценка МО"
		)'
    member [Measures].[Краткое имя]
    as '[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Name'
    member [Measures].[Тип]
    as '[Показатели__ФПКУ_Сопоставимый].[Показатели__ФПКУ_Сопоставимый].CurrentMember.Properties("Содержание")'

    set [Список районов]
    as 'Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 03],
                SELF
            ),
            not
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            )
        )'

    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Аггрегироавнные районы]
    as 'Aggregate({[Список районов]})'
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень],
        [Measures].[Полное имя],
        [Measures].[Краткое имя],
        [Measures].[Тип]
    } on columns,
    {
        Filter
        (
           [Показатели] + [Список общих показателей],
           not
           (
               IsEmpty
               (
                   ([Районы__Сопоставимый].[Районы__Сопоставимый].[Аггрегироавнные районы], [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>)
               )
           )
        )
    } on rows
from  [ФО_ФПКУ_Показатели] 
  ]]>
  </query>
  
  <query id="FO_0021_0004_Saratov_quality_limit">
        <![CDATA[
-- FO_0021_0004_Saratov_quality_limit
  with
  set [Список районов]
  as 'Filter
  (
  Descendants
  (
  [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
  [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 03],
  SELF
  ),
  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
  and <%selected_indicator%>
    )'
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Первая граница]
    as ' Tail
    (
    Head
    (
    Order
    (
    [Список районов],
    <%selected_indicator%>,
    <%sorting_type%>
      ),
      3
      )
      ). Item(0)  '
      member [Районы__Сопоставимый].[Районы__Сопоставимый].[Вторая граница]
      as ' Head
      (
      Tail
      (
      Order
      (
      [Список районов],
      <%selected_indicator%>,
      <%sorting_type%>
        ),
        3
        )
        ). Item(0)  '
        select
        non empty
        {
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Первая граница],
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Вторая граница]
        } on columns,
        {
        <%selected_indicator%>
          }on rows
          from  [ФО_ФПКУ_Показатели]
          where
          (
          [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>,
        [Measures].[Взвешенное значение]
    )  
  ]]>
  </query>
  
</root>