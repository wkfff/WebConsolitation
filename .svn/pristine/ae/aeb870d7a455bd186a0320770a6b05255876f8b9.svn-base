<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0002_0036_date">
    <![CDATA[
-- FO_0002_0036_detail_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName' 
select
    { [Measures].[ДанныеНа] } on columns,
    {
        Tail 
        (
            Filter 
            (
                [Период__Период].[Период__Период].[Месяц].Members,
                not IsEmpty([Measures].[Факт]) 
            ) 
        ) 
    } on rows 
from   [ФО_МесОтч_СпрВнутрДолг] 
  ]]>
  </query>

  <query id="FO_0002_0036_level_budget">
    <![CDATA[
-- FO_0002_0036_level_budget
with
    member [Measures].[Уровень]
    as '0'
    member [Measures].[Уникальное имя]
    as ' [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember.UniqueName '
    member [Measures].[Имя]
    as ' [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember.Name '
SELECT
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]
    }ON COLUMNS,
    {
        {
           [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет субъекта],
           [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет субъекта],
           [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
           [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
           [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
           [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет МО]
        }
    } ON ROWS
FROM    [ФО_МесОтч_СпрВнутрДолг]
  ]]>
  </query>

  <query id="FO_0002_0036_grid">
    <![CDATA[
    -- FO_0002_0036_grid
with  
    set [Районы]  
    as ' Filter  
        (
            Descendants  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF  
            ),
            not  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember  
            )  
        ) '  
    member [Measures].[Факт ]  
    as '  
        (
            [Measures].[Факт],
            [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего]  
        ) +  
        (
            [Measures].[Факт],
            [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего]  
        )'  
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого]  
    as ' Aggregate( [Районы] ) '  
    member [Measures].[Долг МО]  
    as 'IIF  
        (
            (
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
                    [Measures].[Факт ]  
                ) = 0 or  
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)]  
                )  
            ),
            null,
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                [Measures].[Факт ]  
            ) /  
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого],
                [Measures].[Факт ]  
            )  
        ) '  
    member [Measures].[Доходы]  
    as ' LookupCube  
        (
            "[ФО_МесОтч_Доходы]",
            "  
            (
                [Measures].[Факт],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[Доходы бюджета - Всего],
                " + MemberToStr  
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember  
                ) + ",
                " + MemberToStr  
                (
                    [Период__Период].[Период__Период].CurrentMember  
                ) + "  
            )"  
        ) '  
    member [Measures].[Безвозм поступления]  
    as ' LookupCube  
        (
            "[ФО_МесОтч_Доходы]",
            "  
            (
                [Measures].[Факт],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ],
                " + MemberToStr  
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember  
                ) + ",
                " + MemberToStr  
                (
                    [Период__Период].[Период__Период].CurrentMember  
                ) + "  
            )"  
        ) '  
    member [Measures].[Доходы без безвозм поступлений]  
    as ' [Measures].[Доходы] - [Measures].[Безвозм поступления]'  
    member [Measures].[Отношение долга к доходам]  
    as 'IIF  
        (
            [Measures].[Доходы без безвозм поступлений] <> 0,
            [Measures].[Факт ] / [Measures].[Доходы без безвозм поступлений],
            0  
        )'  
    member [Measures].[Ранг]
    as ' IIF
        (
            IsEmpty
            (
                [Measures].[Отношение долга к доходам]
            ),
            null,
            Rank
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        {
                            [Районы]
                        },
                        ([Measures].[Факт ]) and not
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого]
                        )
                    ),
                    [Measures].[Отношение долга к доходам],
                    BDESC
                ),
                -[Measures].[Отношение долга к доходам]
            )
        )'
    member [Measures].[Худший ранг]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Отношение долга к доходам]
            ),
            null,
            max
            (
                Filter
                (
                    {
                        [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)] + [Районы]
                    },
                    [Measures].[Факт ]
                ),
                [Measures].[Ранг]
            )
        )'
    member [Measures].[Долг за предыдущий год]           
    as '          
        (
            [Measures].[Факт ],
            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_prev_year%>].[<%period_halfyear%>].[<%period_quater%>].[<%period_month%>]          
        )' 
    member [Measures].[Изменение за год] 
    as '([Measures].[Факт ] - [Measures].[Долг за предыдущий год])' 
    member [Measures].[Долг к началу года] 
    as '
        (
            [Measures].[Факт ],
            [Период__Период].[Период__Период].[Данные всех периодов].[<%period_prev_year%>].[Полугодие 2].[Квартал 4].[Декабрь] 
        )' 
    member [Measures].[Изменение к началу года] 
    as '([Measures].[Факт ] - [Measures].[Долг к началу года])' 
    
    member [Measures].[Факт со множителем]
    as '[Measures].[Факт ] / <%rubMultiplier%>'
    member [Measures].[Доходы со множителем]
    as '[Measures].[Доходы] / <%rubMultiplier%>'
    member [Measures].[Безвозм поступления со множителем]
    as '[Measures].[Безвозм поступления] / <%rubMultiplier%>'
    member [Measures].[Доходы без безвозм поступлений со множителем]
    as '[Measures].[Доходы без безвозм поступлений] / <%rubMultiplier%>'
    member [Measures].[Изменение за год со множителем]
    as '[Measures].[Изменение за год] / <%rubMultiplier%>'
    member [Measures].[Изменение к началу года со множителем]
    as '[Measures].[Изменение к началу года] / <%rubMultiplier%>'
    
select
    {
        [Measures].[Факт со множителем],
        [Measures].[Долг МО],
        [Measures].[Доходы со множителем],
        [Measures].[Безвозм поступления со множителем],
        [Measures].[Доходы без безвозм поступлений со множителем],
        [Measures].[Отношение долга к доходам],
        [Measures].[Ранг],
        [Measures].[Изменение за год со множителем],
        [Measures].[Изменение к началу года со множителем],
        [Measures].[Худший ранг]
    }  on columns,
    {
        Filter 
        (
            {
                {[Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)]}
                 +
                {
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого]
                } + [Районы] 
            },
            not IsEmpty([Measures].[Факт ]) 
        )  
    } on rows            
from [ФО_МесОтч_СпрВнутрДолг]            
where            
    (
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[<%level_budget%>],
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_halfyear%>].[<%period_quater%>].[<%period_month%>]  
    )            
  ]]>
  </query>

  <query id="FO_0002_0036_chart">
    <![CDATA[
    -- FO_0002_0036_chart    
with
   member [Measures].[Факт ]
   as '[Measures].[Факт] / <%rubMultiplier%>'
    select
    non empty{
        IIF  
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].<%region_chart%> is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].[Новосибирская Область (Бюджет Субъекта)],
              
            {
                {
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего].Children  
                } -  
                {
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего].DATAMEMBER
                }  
            },
           
            {
                {
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего].Children
                } -
                {
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего].DATAMEMBER
                }
            }
        ) 
    } on columns,
    { [Measures].[Факт ] } on rows  
from [ФО_МесОтч_СпрВнутрДолг]  
where  
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[<%level_budget%>],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Новосибирская область (Консолидированный)].<%region_chart%>,
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_halfyear%>].[<%period_quater%>].[<%period_month%>]  
    )  
   ]]>
  </query>

  <query id="FO_0002_0036_chartSum">
    <![CDATA[
    -- FO_0002_0036_chartSum    
with
   member [Measures].[Факт ]
   as '[Measures].[Факт] / <%rubMultiplier%>'
    select
    non empty
    {
        {
            {
                {[Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего].Children}
            } -
            {
                {[Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего].DATAMEMBER}
            }
        }
    } on columns,
    { [Measures].[Факт ] } on rows  
from [ФО_МесОтч_СпрВнутрДолг]  
where  
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[<%level_budget%>],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_halfyear%>].[<%period_quater%>].[<%period_month%>]  
    )  
   ]]>
  </query>
    
</root>