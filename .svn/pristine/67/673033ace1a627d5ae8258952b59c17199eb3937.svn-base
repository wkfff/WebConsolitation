<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0008_0002_endYear">
    <![CDATA[
--FO_0008_0002_endYear
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период__Период].[Период__Период].Members,
                not IsEmpty
                (
                   [Measures].[План НПА]
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from   [ФО_Финансирование КАИП]
Where
(
  [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].[Все].[Финансирование за счет средств фед.бюджета строек и объектов фед.целевых программ, ВСЕГО]
)
]]>
  </query>

  <query id="FO_0008_0002_endDate">
<![CDATA[
--FO_0008_0002_endYear
with 
    member [Measures].[ДанныеНа] 
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as 'Tail 
        (
            Filter 
            (
                [Период__Период].[Период__Период].Members,
                not IsEmpty ( [Measures].[Финансирование] ) 
            ),
            1 
        )' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from   [ФО_АС Бюджет_КазнИсп_Финансирование] 
]]>
</query>
	
 <query id="FO_0008_0002_grid">
    <![CDATA[
-- FO_0008_0002_grid
with                    
    member Measures.[Количество цифр в коде]                   
    as 'IIF                   
        (
            StrToValue                   
            (
                [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember.Properties("Код")                   
            ) > 99999999 and StrToValue                   
            (
                [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember.Properties("Код")                   
            )<1000000000 ,
            true,
            false                   
        )'       
		
	member Measures.[Первая цифра 7, 8 или 9]    
    as ' mid    
        (
            [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember.Properties("Код"),
            1,
            1   
        )' 
    member Measures.[Первая цифра] 
    as 'IIF 
        (
            (
                Measures.[Первая цифра 7, 8 или 9] = "7" 
            ) or 
            (
                Measures.[Первая цифра 7, 8 или 9] = "8" 
            ) or 
            (
                Measures.[Первая цифра 7, 8 или 9]= "9" 
            ),
            false,
            true 
        )'	
    member Measures.[Код целевых средств]                   
    as 'IIF                   
        (
            Measures.[Количество цифр в коде] and Measures.[Первая цифра],
            [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember.Properties("Код"),
            null                   
        )'                     
    member Measures.[Целевая статья]                 
    as 'IIF
	    (
		   Measures.[Количество цифр в коде] and Measures.[Первая цифра],
		Tail                 
        (
            Filter                 
            (
                Descendants                 
                (
                    [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов],
                    [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Целевая статья 3],
                    self_and_before                 
                ) - Descendants                 
                (
                    [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов].[Региональные целевые программы],
                    [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Целевая статья 3],
                    self_and_before                 
                )
				-[КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов].[(УДАЛЕНО) Прочие мероприятия, осуществляемые за счет межбюджетных трансфертов прошлых лет из федерального бюджета]
				,
                not                 
                (
                    [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].CurrentMember is [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].CurrentMember.Parent.DataMember                 
                )    and not IsEmpty 
                (
                    (
                        [Measures].[Финансирование нараст итог],
                        [Период__Период].[Период__Период].[Данные всех периодов].[<%cur_year%>] 
                    ) 
                )              
            )                 
        ).Item(0).Properties("Код"),
		null
	)'        
    set [Целевая статья]        
    as ' Filter        
        (
            Descendants        
            (
                [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов],
                [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Целевая статья 3],
                self_and_before        
            ) - Descendants        
            (
                [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Все целевые статьи расходов].[Региональные целевые программы],
                [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].[Целевая статья 3],
                self_and_before        
            ),
            not        
            (
                [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].CurrentMember is [КЦСР__Сопоставимый].[КЦСР__Сопоставимый].CurrentMember.Parent.DataMember        
            )      
        )'       
    set [СубКОСГУ]       
    as 'Filter       
        (
            Descendants       
            (
                [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[Все субкоды ЭКР],
                [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[СубЭКР уровень 3 4],
                self_and_before       
            ),
            not       
            (
                [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].CurrentMember is [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].CurrentMember.Parent.DataMember       
            )       
        )   '       
    member Measures.[СубКОСГУ]                
    as 'IIF
	    (
		   Measures.[Количество цифр в коде] and Measures.[Первая цифра],
		 Tail                
        (
            Filter                
            (
                Descendants                
                (
                    [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[Все субкоды ЭКР],
                    [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[СубЭКР уровень 3 4],
                    self_and_before                
                ),
                not                
                (
                    [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].CurrentMember is [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].CurrentMember.Parent.DataMember                
                )    and not IsEmpty 
                (
                    (
                        [Measures].[Финансирование нараст итог],
                        [Период__Период].[Период__Период].[Данные всех периодов].[<%cur_year%>] 
                    ) 
                )               
            )                
        ).Item(0).Properties("Код"),
		null
	)'                
    member Measures.[Получатель бюджетных средств]                
    as '[Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].CurrentMember.Properties("Получатель бюджетных средств")'                 
    member Measures.[Условия софинансирования фед./субъект]                
    as '[Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].CurrentMember.Properties("Условия софинансирования")'                 
    member Measures.[Остаток средств на 01.01]                
    as 'LookUpCube                
        (
            "[ФО_Финансирование КАИП]",
            "               
            (
                [Measures].[Остаток на начало года],
                [Период__Период].[Период__Период].[Данные всех периодов].[<%cur_year%>].[Полугодие 1].[Квартал 1].[Январь].[1],
                "+memberToStr               
                (
                    [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember               
                )+"               
            )"                
        )/<%rub_multiplier%>'                 
    member Measures.[План в соотв.с пост.Правит.на год]              
    as 'LookUpCube              
        (
            "[ФО_Финансирование КАИП]",
            "              
            (
                [Measures].[План НПА],
                "+memberToStr              
                (
                    [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember              
                )+",
                Tail              
                (
                    Filter              
                    (
                        [Период__Период].[Период__Период].[<%cur_year%>].[Полугодие 1].[Квартал 1].[январь].[1] : <%selected_period%>,
                        not IsEmpty              
                        (
                            (
                                [Measures].[План НПА],
                                "+memberToStr              
                                (
                                    [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember              
                                )+"             
                            )              
                        ) and (
                                [Measures].[План НПА],
                                "+memberToStr              
                                (
                                    [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember              
                                )+"             
                            ) <> 0             
                    )              
                ).Item(0)              
            )"              
        )/<%rub_multiplier%>'              
    member Measures.[Поступило в году]            
    as 'LookUpCube              
        (
            "[ФО_АС Бюджет_Факт доходов]",
            "             
            (
                [Measures].[Факт доходов нараст итог],
                "+memberToStr             
                (
                    [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember             
                )+",
                Tail             
                (
                    Filter             
                    (
                        [Период__Период].[Период__Период].[<%cur_year%>].[Полугодие 1].[Квартал 1].[январь].[1] : <%selected_period%>,
                        not IsEmpty             
                        (
                            (
                                [Measures].[Факт доходов нараст итог],
                                "+memberToStr             
                                (
                                    [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember             
                                )+"             
                            )             
                        )            
                    )             
                ).Item(0)              
            )"               
        )/<%rub_multiplier%>'              
    member Measures.[Финансирование за]            
    as ' sum          
        (
            {
                <%dates%>        
            },
            ( [Measures].[Финансирование] )
        )/<%rub_multiplier%>' 
    member Measures.[Финансирование всего на ]          
    as '         
        (
            [Measures].[Финансирование нараст итог],
            Tail         
            (
                Filter         
                (
                    [Период__Период].[Период__Период].[<%cur_year%>].[Полугодие 1].[Квартал 1].[январь].[1] : <%selected_period%>,
                    not IsEmpty         
                    (
                        [Measures].[Финансирование нараст итог]          
                    ) 
                )         
            ).Item(0)   
        )/<%rub_multiplier%>'          
    member Measures.[Остаток от плана]        
    as '       
        (
            Measures.[План в соотв.с пост.Правит.на год] - Measures.[Финансирование всего на ]        
        )'        
    member Measures.[Остаток средств]        
    as '       
        (
            Measures.[Остаток средств на 01.01] + Measures.[Поступило в году] - Measures.[Финансирование всего на ]       
        )'        
    set [Наименование федеральной целевой программы, отрасли, объекта]                      
    as 'Filter                     
        (
            Descendants                    
            (
                [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].[Все].[Финансирование за счет средств фед.бюджета строек и объектов фед.целевых программ, ВСЕГО],
                [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].[Уровень 05],
                self_and_before                 
            ),
            not [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember is [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember.Parent.DataMember                    
        )'     
	 member Measures.[Уровень]
    as '(
           [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].Currentmember.Properties("Level_number")
        )'
select
    {
        <%param%>
        Measures.[Остаток средств на 01.01],
        Measures.[План в соотв.с пост.Правит.на год]  ,
        Measures.[Поступило в году],
        Measures.[Финансирование за],
        Measures.[Финансирование всего на ],
        <%rest%>
        Measures.[Остаток средств],
		Measures.[Уровень]		
    }on columns,
    {
        [Наименование федеральной целевой программы, отрасли, объекта]                     
    }on rows                      
From [ФО_АС Бюджет_КазнИсп_Финансирование]                                               
  ]]>
</query>

 <query id="FO_0008_0002_grid_detail">
 <![CDATA[
-- FO_0008_0002_grid_detail
   with
    member Measures.[СубКОСГУ]
    as '[СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].CurrentMember.Item(0).Properties("Код")'          
     member Measures.[Финансирование за]            
    as ' sum          
        (
            {
                <%dates%>        
            },
            ( [Measures].[Финансирование] )
        )/<%rub_multiplier%>' 
		
    member Measures.[Финансирование всего на ]          
    as '         
        (
            [Measures].[Финансирование нараст итог],
            Tail         
            (
                Filter         
                (
                    [Период__Период].[Период__Период].[<%cur_year%>].[Полугодие 1].[Квартал 1].[январь].[1] : <%selected_period%>,
                    not IsEmpty         
                    (
                        [Measures].[Финансирование нараст итог]          
                    )                             
                )         
            ).Item(0)   
        )/<%rub_multiplier%>'           
select
    {
        Measures.[СубКОСГУ],
        Measures.[Финансирование за],
        Measures.[Финансирование всего на ]	          
    }on columns,
   
        {
            [Код целевых средств__Сопоставимый].[Код целевых средств__Сопоставимый].[Все].[Финансирование за счет средств фед.бюджета строек и объектов фед.целевых программ, ВСЕГО].[ФЦП "Социальное развитие села до 2013 года"].[3. Газификация в сельской местности]         
        }       
        *        
        {
            {
                [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[Все субкоды ЭКР].[Федеральные целевые программы].[ФЦП "Социальное развитие села до 2012 года"].[Мероприятия по развитию газификации в сельской местности],
                
                [СубЭКР__Сопоставимый].[СубЭКР__Сопоставимый].[Все субкоды ЭКР].[Федеральные целевые программы].[ФЦП "Социальное развитие села до 2012 года"].[фед.мероприятия по развитию водоснабжения в сельской местности]   
            }    
        } 
    on rows  
From [ФО_АС Бюджет_КазнИсп_Финансирование]
  ]]>
</query>
</root>