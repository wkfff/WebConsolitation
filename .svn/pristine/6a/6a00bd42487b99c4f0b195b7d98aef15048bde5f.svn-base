<?xml version="1.0" encoding="windows-1251"?>
<root>
<query id="FO_0001_0004_compare_Chart1">
    <![CDATA[
  
    with ---------- Краткий список доходов     
    member [КД__Сопоставимый].[КД__Сопоставимый].[Год]    
    as 'IIF    
        (
            [Период__Период].[Период__Период].CurrentMember.Level.Name = "Месяц",
            [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Parent.Name,
            [Период__Период].[Период__Период].CurrentMember.Parent.Parent.Name    
        )'     
     set [Периоды] 
    as 'Filter 
        (
            {
                Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов].[<%Year%>].PrevMember.PrevMember,
                    [Период__Период].[Период__Период].[Месяц],
                    SELF
                ) + Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов].[<%Year%>].PrevMember,
                    [Период__Период].[Период__Период].[Месяц],
                    SELF
                ) + Descendants 
                (
                    [Период__Период].[Период__Период].[Данные всех периодов].[<%Year%>],
                    [Период__Период].[Период__Период].[Месяц],
                    SELF
                ) 
            },
            not    
            (
                [Период__Период].[Период__Период].CurrentMember is [Период__Период].[Период__Период].CurrentMember.Parent.DataMember    
            ) and    
            (
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"    
            )
            and
            (
                [Период__Период].[Период__Период].CurrentMember <> null
            )
        ) '     
    set [Города]    
    as 'Filter    
        (
            Descendants    
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Самарская область],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF    
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"    
            ) and not    
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember    
            )    
        )'    
    set [Районы]    
    as 'Filter    
        (
            Descendants    
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Самарская область],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF    
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"    
            ) and not    
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember    
            )    
        )'    
    set [Муниципальные образования]    
    as '[Города] + [Районы]'    
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по городским округам]    
    as 'Aggregate({[Города]})'    
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по муниципальным районам]    
    as 'Aggregate({[Районы]})'    
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по муниципальным образованиям]    
    as 'Aggregate({[Муниципальные образования]})'    
    member [Measures].[IsNotMO]    
    as '    
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по городским округам] or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным районам] or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным образованиям]    
        )'    
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Бюджет МР и ГО]    
    as 'Aggregate    
        (
            {
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]    
                }    
            }    
        )'    
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа МР и ГО]    
    as 'Aggregate    
        (
            {
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района]    
            }    
        )'     
    member [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]    
    as 'LookupCube    
        (
            "[ФО_МесОтч_СпрВнутрДолг]",
            "    
            (
                [Measures].[Факт],
                [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего],
                " + MemberToStr    
                (
                    [Период__Период].[Период__Период].CurrentMember    
                ) + ",
                " + MemberToStr    
                (
                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember    
                ) + "    
            )"    
        )' 

   member [КД__Сопоставимый].[КД__Сопоставимый].[УДН]
    as '  IIF
        (
            isEmpty
            (
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [Measures].CurrentMember
                ) -
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].CurrentMember
                ) -
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].CurrentMember
                )
            ) or (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]
                ) = 0,
             null,
            (
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]
                )/
                (
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                        [Measures].CurrentMember
                    ) -
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                        [Measures].CurrentMember
                    ) -
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                        [Measures].CurrentMember
                    )
                )
            )
        )  * 100 '
SELECT
    non empty      
    {
        [КД__Сопоставимый].[КД__Сопоставимый].[Год],
        [КД__Сопоставимый].[КД__Сопоставимый].[УДН]
    } on columns,
    non empty { [Периоды] } on rows    
FROM [ФО_МесОтч_Доходы]    
WHERE    
    (
        <%regionChart%>,
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Бюджет МР и ГО],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа МР и ГО]    
    )  
    
    
    
  
    ]]>
  </query>

  
  <query id="FO_0001_0004_compare_Grid">
    <![CDATA[
-- FO_0001_0004_compare_Grid  
with      
    set [Города]      
    as 'Filter      
        (
            Descendants      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Самарская область],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF      
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"      
            ) and not      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember      
            )      
        )'      
    set [Районы]      
    as 'Filter      
        (
            Descendants      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Самарская область],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 04],
                SELF      
            ),
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"      
            ) and not      
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember      
            )      
        )'      
    set [Муниципальные образования]      
    as '[Города] + [Районы]'       
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по городским округам]      
    as 'Aggregate({[Города]})'       
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по муниципальным районам]      
    as 'Aggregate({[Районы]})'       
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по муниципальным образованиям]      
    as 'Aggregate({[Муниципальные образования]})'       
    member [Measures].[IsNotMO]      
    as '      
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по городским округам] or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным районам] or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным образованиям]      
        )'       
    member [КД__Сопоставимый].[КД__Сопоставимый].[УДН] 
    as 'IIF
        (
            isEmpty 
            (
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [Measures].CurrentMember 
                ) - 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].CurrentMember 
                ) - 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].CurrentMember 
                ) 
            ) ,
            null,
            (
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг] 
                )/ 
                (
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                        [Measures].CurrentMember 
                    ) - 
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                        [Measures].CurrentMember 
                    ) - 
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                        [Measures].CurrentMember 
                    ) 
                )
            )
        )* 100'
        
            member [КД__Сопоставимый].[КД__Сопоставимый].[УДН ГодОтч] 
    as 'IIF 
        (
            isEmpty 
            (
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [Measures].CurrentMember 
                ) - 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].CurrentMember 
                ) - 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].CurrentMember 
                ) 
            ) ,
            null,
            (
                [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг1]/ [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ] 
            ) 
        ) 
        * 100' 
    member [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ] 
    as 'IIF      
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            LookupCube      
            (
                "[ФО_ГодОтч_Доходы]",
                "Sum   
                (
                    {
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].Children -   
                        {
                            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ]   
                        }   
                    },
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember,
                        [Measures].[Исполнено],
                        " + MemberToStr      
                        (
                            [Период__Период].[Период__Период].CurrentMember      
                        ) + ",
                        "+ MemberToStr      
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember      
                        ) + ",
                        " +MemberToStr      
                        (
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]      
                        )+ ",
                        "+ MemberToStr      
                        (
                            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района]      
                        ) + "      
                    )
                )" 
            ),
            LookupCube      
            (
                "[ФО_ГодОтч_Доходы]",
                "Sum  
                (
                    {
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].Children -  
                        {
                            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                            [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ]  
                        }  
                    },
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].CurrentMember,
                        [Measures].[Исполнено],
                        " + MemberToStr      
                        (
                            [Период__Период].[Период__Период].CurrentMember      
                        ) + ",
                        "+ MemberToStr      
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember      
                        ) + ",
                        " +MemberToStr      
                        (
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]      
                        )+ ",
                        "+ MemberToStr      
                        (
                            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа]      
                        ) + "      
                    ) 
                )"  
            )      
        )'
    member [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ1 ] 
    as 'IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            LookupCube 
            (
                "[ФО_ГодОтч_Доходы]",
                " 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [Measures].[Исполнено],
                    " + MemberToStr 
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + ",
                    "+ MemberToStr 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                    ) + ",
                    " +MemberToStr 
                    (
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района] 
                    )+ ",
                    "+ MemberToStr 
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района] 
                    ) + " 
                )" 
            ),
            LookupCube 
            (
                "[ФО_ГодОтч_Доходы]",
                " 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                    [Measures].[Исполнено],
                    " + MemberToStr 
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + ",
                    "+ MemberToStr 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                    ) + ",
                    " +MemberToStr 
                    (
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа] 
                    )+ ",
                    "+ MemberToStr 
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа] 
                    ) + " 
                )" 
            ) 
        )' 
    member [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ2 ] 
    as 'IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            LookupCube 
            (
                "[ФО_ГодОтч_Доходы]",
                " 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].[Исполнено],
                    " + MemberToStr 
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + ",
                    "+ MemberToStr 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                    ) + ",
                    " +MemberToStr 
                    (
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района] 
                    )+ ",
                    "+ MemberToStr 
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района] 
                    ) + " 
                )" 
            ),
            LookupCube 
            (
                "[ФО_ГодОтч_Доходы]",
                " 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].[Исполнено],
                    " + MemberToStr 
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + ",
                    "+ MemberToStr 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                    ) + ",
                    " +MemberToStr 
                    (
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа] 
                    )+ ",
                    "+ MemberToStr 
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа] 
                    ) + " 
                )" 
            ) 
        ) 
        * 100' 
    member [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ3 ] 
    as 'IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР",
            LookupCube 
            (
                "[ФО_ГодОтч_Доходы]",
                " 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].[Исполнено],
                    " + MemberToStr 
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + ",
                    "+ MemberToStr 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                    ) + ",
                    " +MemberToStr 
                    (
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района] 
                    )+ ",
                    "+ MemberToStr 
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района] 
                    ) + " 
                )" 
            ),
            LookupCube 
            (
                "[ФО_ГодОтч_Доходы]",
                " 
                (
                    [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                    [Measures].[Исполнено],
                    " + MemberToStr 
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + ",
                    "+ MemberToStr 
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember 
                    ) + ",
                    " +MemberToStr 
                    (
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа] 
                    )+ ",
                    "+ MemberToStr 
                    (
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа] 
                    ) + " 
                )" 
            ) 
        )'  
    member [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Бюджет МР и ГО]      
    as 'Aggregate      
        (
            {
                {
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]      
                }      
            }      
        )'      
    member [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа МР и ГО]      
    as 'Aggregate      
        (
            {
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района]      
            }      
        )'      
    member Measures.[Всего]      
    as '[Measures].[Годовые назначения]' 
    member Measures.[Всего факт]      
    as '[Measures].[Факт]' 
   
    member [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО",
            LookupCube
            (
                "[ФО_МесОтч_СпрВнутрДолг]",
                "
                (
                    [Measures].[Факт],
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
               
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                    ) + "
                )"
            ),
            LookupCube
            (
                "[ФО_МесОтч_СпрВнутрДолг]",
                "
                (
                    [Measures].[Факт],
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
               
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                    ) + "
                ) "
            )
        )'
        
   member [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг1]  
    as 'IIF  
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО",
            LookupCube  
            (
                "[ФО_МесОтч_СпрВнутрДолг]",
                "  
                (
                    [Measures].[Факт],
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                    " + MemberToStr  
                    (
                   Filter
                        (
                            Descendants
                            (
                                [Период__Период].[Период__Период].CurrentMember,
                                [Период__Период].[Период__Период].[Месяц],
                                SELF 
                            ),
                            [Период__Период].[Период__Период].CurrentMember.name = "Декабрь"
                        ).item(0)
                    ) + ",
                    " + MemberToStr  
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember  
                    ) + "  
                )"  
            ),
            LookupCube  
            (
                "[ФО_МесОтч_СпрВнутрДолг]",
                "  
                (
                    [Measures].[Факт],
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района],
                    " + MemberToStr  
                    (
                        Filter 
                        (
                            Descendants 
                            (
                                [Период__Период].[Период__Период].CurrentMember,
                                [Период__Период].[Период__Период].[Месяц],
                                SELF  
                            ),
                            [Период__Период].[Период__Период].CurrentMember.name = "Декабрь"
                        ).item(0)
                    ) + ",
                    " + MemberToStr  
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember  
                    ) + "  
                ) "  
            )  
        )'
        
        member [КД__Сопоставимый].[КД__Сопоставимый].[Доходы]
    as 'LookupCube
        (
            "[ФО_МесОтч_СпрВнутрДолг]",
            "Sum
            (
                {
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет городского округа],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет района]
                },
                (
                    [Measures].[Факт],
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].CurrentMember,
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                    ) + "
                ) +
                (
                    [Measures].[Факт],
                    [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[МУНИЦИПАЛЬНЫЙ ДОЛГ, всего],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].CurrentMember,
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].CurrentMember
                    ) + ",
                    " + MemberToStr
                    (
                        [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                    ) + "
                )
            )"
        )'
 member [КД__Сопоставимый].[КД__Сопоставимый].[Разность]
         as'(
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                        [Measures].CurrentMember
                    ) -
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ДОХОДЫ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ ОТ ВОЗВРАТА ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                        [Measures].CurrentMember
                    ) -
                    (
                        [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ].[ВОЗВРАТ ОСТАТКОВ СУБСИДИЙ, СУБВЕНЦИЙ И ИНЫХ МЕЖБЮДЖЕТНЫХ ТРАНСФЕРТОВ, ИМЕЮЩИХ ЦЕЛЕВОЕ НАЗНАЧЕНИЕ, ПРОШЛЫХ ЛЕТ],
                        [Measures].CurrentMember
                    )
                )'
     member [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по городским округам ]    
    as ' IIF    
        (
            (
                [Период__Период].[Период__Период].[Данные всех периодов].CurentMember =[Период__Период].[Период__Период].[Данные всех периодов].[<%PprevYear%>]    
            )or    
            (
                [Период__Период].[Период__Период].[Данные всех периодов].CurentMember =[Период__Период].[Период__Период].[Данные всех периодов].[<%PrevYear%>]    
            ),
            IIF 
            (
                sum 
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ] 
                ) = null,
                null,
                sum    
                (
                    [Города],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]    
                )/    
                (
                    sum    
                    (
                        [Города],
                        [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ]    
                    )    
                )    
                * 100
            ),
            IIF 
            (
                sum 
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Разность] 
                ) = null,
                null,
                sum    
                (
                    [Города],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]    
                )/    
                (
                    sum    
                    (
                        [Города],
                        [КД__Сопоставимый].[КД__Сопоставимый].[Разность]    
                    )    
                )    
                * 100
            ) 
        )   ' 
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным районам ]    
    as ' IIF    
        (
            (
                [Период__Период].[Период__Период].[Данные всех периодов].CurentMember =[Период__Период].[Период__Период].[Данные всех периодов].[<%PprevYear%>]    
            )or    
            (
                [Период__Период].[Период__Период].[Данные всех периодов].CurentMember =[Период__Период].[Период__Период].[Данные всех периодов].[<%PrevYear%>]    
            ),
            IIF 
            (
                sum 
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ] 
                ) = null,
                null,
                sum    
                (
                    [Районы],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]    
                )/    
                (
                    sum    
                    (
                        [Районы],
                        [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ]    
                    )    
                )    
                * 100
            ),
            IIF 
            (
                sum 
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Разность] 
                ) = null,
                null,
                sum    
                (
                    [Районы],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]    
                )/    
                (
                    sum    
                    (
                        [Районы],
                        [КД__Сопоставимый].[КД__Сопоставимый].[Разность]    
                    )    
                )    
                * 100
            ) 
        )   ' 
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным образованиям ]    
    as ' IIF    
        (
            (
                [Период__Период].[Период__Период].[Данные всех периодов].CurentMember =[Период__Период].[Период__Период].[Данные всех периодов].[<%PprevYear%>]    
            )or    
            (
                [Период__Период].[Период__Период].[Данные всех периодов].CurentMember =[Период__Период].[Период__Период].[Данные всех периодов].[<%PrevYear%>]    
            ),
            IIF   
            (
                sum   
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ]   
                ) = null,
                null,
                sum    
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]    
                )/    
                (
                    sum    
                    (
                        [Муниципальные образования],
                        [КД__Сопоставимый].[КД__Сопоставимый].[ДОХОДЫ ]    
                    )    
                )    
                * 100  
            ),
            IIF   
            (
                sum   
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Разность]   
                ) = null,
                null,
                sum    
                (
                    [Муниципальные образования],
                    [КД__Сопоставимый].[КД__Сопоставимый].[Муниципальный долг]    
                )/    
                (
                    sum    
                    (
                        [Муниципальные образования],
                        [КД__Сопоставимый].[КД__Сопоставимый].[Разность]    
                    )    
                )    
                * 100  
            )   
        ) '  
   
SELECT
    {
        {
            [Период__Период].[Период__Период].[Данные всех периодов].[<%PprevYear%>]
        } 
        * 
        {
            {
                [КД__Сопоставимый].[КД__Сопоставимый].[УДН ГодОтч]  
            } 
      
        }  +
         {
            [Период__Период].[Период__Период].[Данные всех периодов].[<%PrevYear%>]
        } 
        * 
        {
            {
                [КД__Сопоставимый].[КД__Сопоставимый].[УДН ГодОтч] 
            } 
       
        }  +
        {
            {
                filter  
                (
                    {
                        Descendants
                        (
                            [Период__Период].[Период__Период].[Данные всех периодов].[<%Year%>],
                            [Период__Период].[Период__Период].[Месяц],
                            SELF
                        ) - [Период__Период].[Период__Период].[Данные всех периодов].[<%Year%>].[Полугодие 2].[Квартал 4].[Декабрь].[31] 
                    },
                    (
                        not  
                        (
                            [Период__Период].[Период__Период].CurrentMember.Name = "Данные года" OR [Период__Период].[Период__Период].CurrentMember.Name = "Остатки на начало года"  
                             OR [Период__Период].[Период__Период].CurrentMember = null
                        )  
                    )  
                )  
            }  
            *  
            {
                {
                    [КД__Сопоставимый].[КД__Сопоставимый].[УДН]  
                }  
  
            } + filter   
            (
                {
                    [Период__Период].[Период__Период].[Данные всех периодов].[<%Year%>].[Полугодие 2].[Квартал 4].[Декабрь].[31]   
                }   
                *   
                {
                    {
                        [КД__Сопоставимый].[КД__Сопоставимый].[УДН]   
                    }   
  
                }  ,
                (
                    not   
                    (
                        [Период__Период].[Период__Период].CurrentMember.Name = "Данные года" OR [Период__Период].[Период__Период].CurrentMember.Name = "Остатки на начало года" OR [Период__Период].[Период__Период].CurrentMember = null   
                    )   
                )  
            )  
        }  
    }on columns,
 non empty   {
        [Города] +      
        {
            [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по городским округам ]     
        } + [Районы] +      
        {
            [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным районам ]     
        } + [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее по муниципальным образованиям ]      
    } on rows      
FROM [ФО_МесОтч_Доходы]      
where      
    (
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Бюджет МР и ГО],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Тип документа МР и ГО]      
    )      
  ]]>
</query>
</root>

