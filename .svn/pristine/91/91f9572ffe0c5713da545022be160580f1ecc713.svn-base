<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="ComboOrg">
    <![CDATA[with
    member [ref]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.Properties("REFREGIONAN")'
    member [name]
    as '[Районы__Анализ].[Районы__Анализ].CurrentMember.Properties("PKID")'
    member [parent]
    as '[Районы__Анализ].[Районы__Анализ].currentmember.name'
    member [parent-uname]
    as '[Районы__Анализ].[Районы__Анализ].currentmember.uniquename'

    member [child]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.name'
    member [child-uname]
    as '[Организации__Реестр организаций].[Организации__Реестр организаций].currentmember.uniquename'


select
    non empty
    {
        filter
        (
            Crossjoin
            (
                Except
                (
                    [Районы__Анализ].[Районы__Анализ].members,
                    {[Районы__Анализ].[Районы__Анализ].[Данные всех источников],
                    [Районы__Анализ].[Районы__Анализ].[Значение не указано],
                    [Районы__Анализ].[Районы__Анализ].[Неизвестные данные],
                    [Районы__Анализ].[Районы__Анализ].[Неуказанный район]}
                ),
                except(
                [Организации__Реестр организаций].[Организации__Реестр организаций].members,
                {[Организации__Реестр организаций].[Организации__Реестр организаций].[Неизвестные данные],
                [Организации__Реестр организаций].[Организации__Реестр организаций].[Неуказанный район]})

            ),
            [ref] = [name]
        )
    } on rows,
    {
        [Measures].[Значение],
        [ref],
        [name],
        [parent],[child],
        [child-uname],[parent-uname]

    }on columns
from [ОРГАНИЗАЦИИ_Характеристика деятельности]
    ]]>
  </query>
  <query id="ComboDates">
    <![CDATA[
  with 
    member [EdIzm] 
    as '[Организации__Показатели работы].[Организации__Показатели работы].currentmember.properties("Единица измерения")' 
    member [level] 
    as '[Организации__Показатели работы].[Организации__Показатели работы].currentmember.level_number'   
    member [% исполнения] 
    as '[Measures].[Факт]/ [Measures].[План] 
        * 100'    
        member [Организации__Показатели работы].[Организации__Показатели работы].[UName]
        as '[Период__Период].[Период__Период].currentmember.unique_name'
        
        
select
    non empty 
    {
    filter(
        [Период__Период].[Период__Период].[Год].members  ,
        [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели] > 0)
    } on rows ,
    non empty 
    {

        [Организации__Показатели работы].[Организации__Показатели работы].[UName]
    } on columns
from [ОРГАНИЗАЦИИ_Характеристика деятельности] 
where 
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область],
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Муниципальный раздел]   ,
        [Measures].[Факт] 
    ) 
    ]]>
  </query>
  <query id = "YearDefault">
    <![CDATA[with 
    member [Стратегия развития__Показатели].[Стратегия развития__Показатели].[select-strategy] 
    as '[Стратегия развития__Показатели].[Стратегия развития__Показатели].[Все показатели].[Перечень параметров для оценки индикаторов стратегии социально-экономического развития Сахалинской области в части фактических значений]' 
    member [level] 
    as '[Стратегия развития__Показатели].[Стратегия развития__Показатели].currentmember.level_number' 
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[comment]
    as '[Стратегия развития__Показатели].[Стратегия развития__Показатели].currentmember.properties("Описание")'
    member [% Исполнения] 
    as '100 
        *[Measures].[Факт]/[Measures].[План]' 
    member [UName] 
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.uniquename' 
select
    {
[Стратегия развития__Показатели].[Стратегия развития__Показатели].[Все показатели].[Перечень параметров для оценки индикаторов программы социально-экономического развития Сахалинской области в части фактических значений]
    }    on rows ,
    { [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[comment]    }on columns
FROM [МО_Стратегия развития] 
where 
    (
        [Источники данных].[Источники данных].[Все источники данных].[МО Стратегия развития],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область]
    ) 
    ]]>
  </query>

  <query id = "PeriodAlovalebleFirstGrid">
    <![CDATA[
    --PeriodAlovalebleFirstGrid    
    with
    set [set_test]
    as
    '
filter([Период__Период].[Период__Период].[День].members,
           [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)]>0)
    '
member [Период__Период].[Период__Период].[Last]
as '        Max([set_test])'
    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников организаций и предприятий, человек в % к трудовым ресурсам]  
    as '  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий]  
        )'  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[   в % к трудовым ресурсам]  
    as '   
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий] 
        ) / 
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)] ,
            [Период__Период].[Период__Период].[Last]
        )  '  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников крупных и средних организаций, человек]  
    as '  
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников крупных и средних организаций]  
        )'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_PP]
    as '[Период__Период].[Период__Период].currentmember.parent.parent.parent.parent.name'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_P]
    as '[Период__Период].[Период__Период].currentmember.parent.name'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[day_U]
    as '[Период__Период].[Период__Период].currentmember.unique_name'
    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[sumf] 
    as 'Sum({<%Fields%>}, [Measures].[Значение])'
         
SELECT
    {
    [Показатели__Рынок труда].[Показатели__Рынок труда].[day_P],
    [Показатели__Рынок труда].[Показатели__Рынок труда].[day_U]

    }on rows  ,
   non empty {
   
   filter(
       [Период__Период].[Период__Период].[День].members,
       [Показатели__Рынок труда].[Показатели__Рынок труда].[sumf]>0
       <%Comennt%>and[Показатели__Рынок труда].[Показатели__Рынок труда].[day_PP]="<%SelectUserYear%>"
       )
           } on columns
FROM [СТАТ_Мониторинг ситуации на рынке труда]  
where  
    (
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область] 
        --<%ActiveRegion%>
    )
    ]]>
  </query>
  <query id = "ComboProg">
    <![CDATA[   with  
    member [Стратегия развития__Показатели].[Стратегия развития__Показатели].[select-strategy]  
    as '[Стратегия развития__Показатели].[Стратегия развития__Показатели].[Все показатели].[Перечень параметров для оценки индикаторов стратегии социально-экономического развития Сахалинской области в части фактических значений]'  
    member [level]  
    as '[Стратегия развития__Показатели].[Стратегия развития__Показатели].currentmember.level_number'  
    member [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[EdIzm]  
    as '[Стратегия развития__Показатели].[Стратегия развития__Показатели].currentmember.properties("Единица измерения")'  
    member [% Исполнения]  
    as '100 
        *[Measures].[Факт]/[Measures].[План]'  
    member [UName]  
    as '[Стратегия развития__Показатели].[Стратегия развития__Показатели].currentmember.uniquename'   
select
    {
        filter 
        (
            [Стратегия развития__Показатели].[Стратегия развития__Показатели].[Все показатели].[Перечень параметров для оценки индикаторов программы социально-экономического развития Сахалинской области в части фактических значений].children,
            not [Стратегия развития__Показатели].[Стратегия развития__Показатели].currentmember.is_datamember  
        ) 
    }    on rows ,
    { [UName]    }on columns  
FROM [МО_Стратегия развития]  
where  
    (
        [Источники данных].[Источники данных].[Все источники данных].[МО Стратегия развития],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область]   
    )  ]]>
  </query>

  <query id = "Grid">
    <![CDATA[--Grid   
with 
  member [EdIzm]
  as '[Организации__Показатели работы].[Организации__Показатели работы].currentmember.properties("Единица измерения")'
  member [level]
  as '[Организации__Показатели работы].[Организации__Показатели работы].currentmember.level_number -1'
  member [% исполнения]
  as '
  iif([Measures].[План] > 0,
  [Measures].[Факт]/ [Measures].[План] * 100,null)'
   <%QuartType%>
   select 
    non empty
    {
    Crossjoin( {[Период__Период].[Период__Период].[Год].[<%SelectYear%>].[Полугодие 1].[Квартал 1]},{[level],
    [EdIzm]}),
    
        Crossjoin     
        (
            {
                [Период__Период].[Период__Период].[Квартал 1],
                [Период__Период].[Период__Период].[Квартал 2],
                [Период__Период].[Период__Период].[Квартал 3],
                [Период__Период].[Период__Период].[Квартал 4]
            } ,
            {
            [Measures].[Факт],                
                [Measures].[План],                
                [% исполнения]
            }   
        )    
    } on columns,
    non empty      
    {
    
    filter(
    
    except(
    
        [Организации__Показатели работы].[Организации__Показатели работы].members,
        [Организации__Показатели работы].[Организации__Показатели работы].[Все показатели]),
        not isempty([Measures].[Факт]))
    } on rows     
from [ОРГАНИЗАЦИИ_Характеристика деятельности]
where
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область],
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Муниципальный раздел],
        <%org%>,
        <%region%>
    )           
    ]]>
  </query>

  <query id = "Chart">
    <![CDATA[
    with 
    member [EdIzm]
    as '[Организации__Показатели работы].[Организации__Показатели работы].currentmember.properties("Единица измерения")'
    member [level]
    as '[Организации__Показатели работы].[Организации__Показатели работы].currentmember.level_number'


  member [% исполнения]
  as '[Measures].[Факт]/ [Measures].[План] * 100'



select
    non empty    
    {

                [Период__Период].[Период__Период].[Год].[<%SelectYear%>].[Полугодие 1].[Квартал 1],
                [Период__Период].[Период__Период].[Год].[<%SelectYear%>].[Полугодие 1].[Квартал 2],
                [Период__Период].[Период__Период].[Год].[<%SelectYear%>].[Полугодие 2].[Квартал 3],
                [Период__Период].[Период__Период].[Год].[<%SelectYear%>].[Полугодие 2].[Квартал 4]  

    } on columns,
    non empty      
    {    
    filter(
--[Организации__Показатели работы].[Организации__Показатели работы].[Все показатели].[Доходы]
<%ChartParamType%>.children,
        not isempty([Measures].[Факт]))
    } on rows     
from [ОРГАНИЗАЦИИ_Характеристика деятельности]     
where     
    (
        /**/[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область],
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Муниципальный раздел]   ,
                        [Measures].[Факт],
                        <%org%>,
        <%region%>
    )         
    ]]>
  </query>


  <query id = "Grid_Rf">
    <![CDATA[
    --grid_rf
    with
 member [Территории__Сопоставимый].[Территории__Сопоставимый].[year]
 as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.parent.parent.parent.name'
 member [Территории__Сопоставимый].[Территории__Сопоставимый].[name]
 as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.name'
 member [Территории__Сопоставимый].[Территории__Сопоставимый].[DisplayName]
 as 'iif([Территории__Сопоставимый].[Территории__Сопоставимый].[name]="Январь",
 "январь "+ [Территории__Сопоставимый].[Территории__Сопоставимый].[year] + " года",
 "январь - "+[Территории__Сопоставимый].[Территории__Сопоставимый].[name]+" "+ [Территории__Сопоставимый].[Территории__Сопоставимый].[year] + " года")'
 
member [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Среднемесячная номинальная начисленная заработная плата работников организаций]
as '[СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Уровень жизни населения].[Среднемесячная номинальная начисленная заработная плата работников организаций]'

    member [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Реальная начисленная заработная плата, к предыдущему году] 
    as '[СЭП].[Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта].[Уровень жизни населения].[Реальная начисленная заработная плата, к предыдущему году]' 
member [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация ]
as '[Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember'
member [Территории__Сопоставимый].[Территории__Сопоставимый].[Новосибирская область ]
as '[Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].[Сибирский федеральный округ].[Новосибирская область].DataMember'

SELECT
    non empty
    {
    filter(
[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц].members,

not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].currentmember.is_datamember
and      [Measures].[За период] > 0
and (1=2  <%Dates%>))
    }on rows  ,
    non empty 
    {
    [Территории__Сопоставимый].[Территории__Сопоставимый].[DisplayName],
   	[Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация ],
            	[Территории__Сопоставимый].[Территории__Сопоставимый].[Новосибирская область ]   	
    } on columns
FROM [СТАТ_СЭП_Годовой сборник]
where
    (
     [Measures].[За период],
     <%Fields%>
    )
    ]]>
  </query>
  <query id = "GridRang">
    <![CDATA[
    --GridRang
with   
    <%WithZoneDate%>
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения ]
    as '(--<%ActiveRegion%>.datamember,
    [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень регистрируемой безработицы, % от численности экономически активного населения])'    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Уровень трудоустройства ]
    as '(--<%ActiveRegion%>.datamember,
    [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Уровень трудоустройства ищущих работу граждан])'
SELECT
    {
       [Показатели__Рынок труда].[Показатели__Рынок труда].[<%FieldForRang%>]
    } on columns,
    non empty
    {
        order
        (
        filter(<%ActiveRegion%>.parent.children,
            not [Территории__Сопоставимый].[Территории__Сопоставимый].currentmember.is_datamember),
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[<%FieldForRang%>]
        ) 
    }on rows 
FROM [СТАТ_Мониторинг ситуации на рынке труда]   
where   
    (
        [Период__Период].[Период__Период].[<%DateForRang%>],
        [Measures].[Значение]
    )]]>
  </query>
  <query id = "Chart">
    <![CDATA[
    --Chart
    with
    <%WithZoneDate%>
    SELECT
    {
           <%ActiveRegion%>.datamember ,
           <%ActiveRegion%>.parent.datamember
    }   on columns,
    non empty    
    {
        <%Dates%>
    }on rows
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where (<%ChangeNavigatorChart%>, 
[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО])]]>
  </query>
  <query id = "Chart2">
    <![CDATA[
    --Chart2
    with
    <%WithZoneDate%>
    SELECT
    {
    <%ChangeNavigatorChart%>
    } on rows ,
    non empty    
    {
        <%Dates%>
    } on columns
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where (<%ActiveRegion%>,
[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО])]]>
  </query>
  <query id = "Textovka">
    <![CDATA[
   with   
    set [fields]   
    as '   
        {
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Минимальная заработная плата, установленная в Региональном соглашении (для работников организаций бюджетной сферы, финансируемых из областного и местных бюджетов)],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Минимальная заработная плата, установленная в Региональном соглашении (для работников организаций внебюджетной сферы, кроме организаций сельского хозяйства)],
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Минимальная заработная плата, установленная в Региональном соглашении (для работников организаций сельского хозяйства)]           
        }'      
    member [sum-fields]   
    as 'Aggregate  
        (
            [fields] ,
            [Measures].[Значение]  
        )'  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[mounth] 
    as '[Период__Период].[Период__Период].parent.name'  
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[year] 
    as '[Период__Период].[Период__Период].parent.parent.parent.parent.name'   
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Uname]
    as '[Период__Период].[Период__Период].currentmember.uniquename'
SELECT
    non empty         
    {
        BottomCount      
        (
            Filter      
            (
                [Период__Период].[Период__Период].members,
                (
                    [sum-fields],
                    <%ActiveRegion%>    
                ) > 0      
            ),
            1      
        )        
    } on rows,
    {
[Показатели__Рынок труда].[Показатели__Рынок труда].[Uname],
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Минимальная заработная плата, установленная в Региональном соглашении (для работников организаций бюджетной сферы, финансируемых из областного и местных бюджетов)],
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Минимальная заработная плата, установленная в Региональном соглашении (для работников организаций внебюджетной сферы, кроме организаций сельского хозяйства)],
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Минимальная заработная плата, установленная в Региональном соглашении (для работников организаций сельского хозяйства)]   
    } on columns 
FROM  [СТАТ_Мониторинг ситуации на рынке труда]       
where       
    (
        <%ActiveRegion%>,
        [Measures].[Значение]
    )       
    ]]>
  </query>
  <query id = "Textovka2">
    <![CDATA[with    
    set [fields]    
    as '    
        {
            <%Field%>
        }'       
    member [sum-fields]    
    as 'Aggregate   
        (
            [fields] ,
            [Measures].[Значение]   
        )'   
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[mounth]  
    as '[Период__Период].[Период__Период].parent.name'   
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[year]  
    as '[Период__Период].[Период__Период].parent.parent.name'    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Uname] 
    as '[Период__Период].[Период__Период].currentmember.uniquename' 
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[level] 
    as '[Период__Период].[Период__Период].currentmember.level_number'
SELECT
    non empty          
    {
        BottomCount       
        (
            Filter       
            (
                [Период__Период].[Период__Период].members,
                (
                    [sum-fields],
                    <%ActiveRegion%>  
                ) > 0
                and
[Показатели__Рынок труда].[Показатели__Рынок труда].[level]=3
            ),
            2
        )         
    } on rows,
    {
    [Показатели__Рынок труда].[Показатели__Рынок труда].[year],
    [Показатели__Рынок труда].[Показатели__Рынок труда].[level],
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Uname],
        <%Field%>
    } on columns  
FROM  [СТАТ_Мониторинг ситуации на рынке труда]        
where        
    (
        <%ActiveRegion%>,
        [Measures].[Значение]       ,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО]
    )            
    ]]>
  </query>
  <query id = "Textovka3">
    <![CDATA[with    
    set [fields]    
    as '    
        {
            <%Field%>
        }'       
    member [sum-fields]    
    as 'Aggregate   
        (
            [fields] ,
            [Measures].[Значение]   
        )'   
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[mounth]  
    as '[Период__Период].[Период__Период].parent.name'   
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[year]  
    as '[Период__Период].[Период__Период].parent.parent.name'    
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Uname] 
    as '[Период__Период].[Период__Период].currentmember.uniquename' 
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[level] 
    as '[Период__Период].[Период__Период].currentmember.level_number'
SELECT
    non empty          
    {
        BottomCount       
        (
            Filter       
            (
                [Период__Период].[Период__Период].members,
                (
                    [sum-fields],
                    <%ActiveRegion%>  
                ) > 0
                and
[Показатели__Рынок труда].[Показатели__Рынок труда].[level]=5
            ),
            2
        )         
    } on rows,
    {
    [Показатели__Рынок труда].[Показатели__Рынок труда].[year],
    [Показатели__Рынок труда].[Показатели__Рынок труда].[level],
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Uname],
        <%Field%>
    } on columns  
FROM  [СТАТ_Мониторинг ситуации на рынке труда]        
where        
    (
        <%ActiveRegion%>,
        [Measures].[Значение]
        ,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Минтруд НСО]
    )            
    ]]>
  </query>
  <query id = "BottomChart">
    <![CDATA[with
<%WithZoneDate%>
    set [set_test]
    as ' filter
        (
            [Период__Период].[Период__Период].[День].members,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)]>0
        ) '
    member [Период__Период].[Период__Период].[Last]
    as '        Max([set_test])'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников организаций и предприятий, человек в % к трудовым ресурсам]
    as '
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий]
        )'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[   в % к трудовым ресурсам]
    as ' iif
        (
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
                [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)] ,
                [Период__Период].[Период__Период].[Last]
            )  <>0,
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
                [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий]
            ) /
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область],
                [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Численность трудовых ресурсов (без учёта маятниковой миграции)] ,
                [Период__Период].[Период__Период].[Last]
            )  ,
            null
        )'
    member [Показатели__Рынок труда].[Показатели__Рынок труда].[Среднесписочная численность работников крупных и средних организаций, человек]
    as '
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Сибирский федеральный округ].[Новосибирская область].datamember,
            [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников крупных и средних организаций]
        )'
SELECT
   non empty {
   Except(
        [ОК__ОКВЭД].[ОК__ОКВЭД].members,
        [ОК__ОКВЭД].[ОК__ОКВЭД].[Все виды экономической деятельности])
    }on rows  ,
   non empty {
        <%Dates%>
    } on columns
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where
    (
        [Measures].[Значение],        
        [Показатели__Рынок труда].[Показатели__Рынок труда].[Все].[Среднесписочная численность работников организаций и предприятий (по видам деятельности)],
        <%ActiveRegion%>) 
]]>
  </query>
  <query id = "Text0">
    <![CDATA[
    --Text0
select


BottomCount( filter(
[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год].members,
[Measures].[За период]>0),1) on rows,
[Measures].[За период] on columns
from [СТАТ_Население_Численность и состав]
where
    (
        [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Численность населения на начало года],
--[Группировки__Население_Численность и состав].[Группировки__Население_Численность и состав].[Все группировки].[По городам и районам],
[Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Новосибирскстат],
<%ActiveRegion%>

    )
]]>
  </query>

  <query id = "Text1">
    <![CDATA[SELECT
    non empty
    {
        topcount
        (
            Filter
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год].members,
                [Measures].[За период]>0
            ),
             1
        )
    }on rows,
    non empty 
    {
        [СЭП__Годовой сборник].[СЭП__Годовой сборник].[Данные всех источников].[СТАТ\0001 Отчетность - вариант: Без варианта]--.[Население].[Численность постоянного населения на начало года] 
    } on columns 
FROM [СТАТ_СЭП_Годовой сборник] 
where ( [Measures].[За период] ,<%ActiveRegion%>)  
]]>
  </query>

  <query id = "Text2">
    <![CDATA[
    --text2
    with
<%WithZoneDate%>
    SELECT
    non empty 
    {
        topcount
        (
            {<%Dates%>},
             2
        )
    }on rows,
    non empty 
    {
        {<%Fields%>}
    } on columns 
FROM [СТАТ_Мониторинг ситуации на рынке труда]
where ( [Measures].[Значение],<%ActiveRegion%> )
]]>
  </query>

</root>