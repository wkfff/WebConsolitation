<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id = "STAT_0001_0020_list_of_regions">
    <![CDATA[ -- STAT_0001_0020_list_of_regions
with
    set [Регионы]
    as '
        {
            filter
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].Children,
                [Measures].[За период] > 0 
            )
        }'
    member [Measures].[Имя региона]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'
select
    [Measures].[Имя региона] on columns,
    [Регионы] on rows
from [СТАТ_Инвестиции_Иностранные вложения]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]
    )
    ]]>
  </query>

  <query id = "STAT_0001_0020_quarters">
    <![CDATA[ -- STAT_0001_0020_quarters
with
    set [Кварталы]
    as '
        (
            filter
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                    ([Measures].[За период],
                        [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций]
                    ) > 0 or
                    ([Measures].[За период],
                        [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели]
                    ) > 0
            )
        )'
    member [Measures].[Уникальное имя квартала]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName'
select
    [Measures].[Уникальное имя квартала] on columns,
    [Кварталы] on rows
from [СТАТ_Инвестиции_Иностранные вложения]
where
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра],
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]
    )
  ]]>
  </query>
  
  <query id = "STAT_0001_0020_grid">
    <![CDATA[ -- STAT_0001_0020_grid
with
    set [Кварталы]
    as '
        {
            filter
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал].Members,
                not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember and [Measures].[За период] > 0
            )
        }'
    member [Measures].[В этом году]
    as '
        (
            [Measures].[За период],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
        )'
    member [Measures].[В прошлом году]
    as '
        (
            [Measures].[За период],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Lag(6)
        )'
    member [Measures].[Прирост к АППГ]
    as 'iif
        (
            IsEmpty([Measures].[В этом году]) or IsEmpty([Measures].[В прошлом году]),
            null,
            [Measures].[В этом году] - [Measures].[В прошлом году]
        )'
    member [Measures].[Темп роста к АППГ]
    as 'iif
        (
            IsEmpty([Measures].[В этом году]) or IsEmpty([Measures].[В прошлом году]) or ([Measures].[В прошлом году]) = 0,
            null,
            [Measures].[В этом году] / [Measures].[В прошлом году]
        )'
    set [Виды вложений]
    as '
        {
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Поступило иностранных инвестиций],
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Объём инвестиций из России за рубеж]
        }'
    set [Инвестиции]
    as '
        {
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прямые инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Портфельные инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прочие инвестиции]
        }'
    member [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Всего инвестиций]
    as 'aggregate({[Инвестиции]})'
    member [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год]
    as '"Год " + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Name +
    + ";" + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name'
    set [Строки грида]
    as '
        {
            [Measures].[В этом году],
            [Measures].[Прирост к АППГ],
            [Measures].[Темп роста к АППГ]
        }'
select
    { [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели] * {[Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год]} +
        [Виды вложений]
        * [Инвестиции]
    } on columns,
    [Кварталы]
    * [Строки грида] on rows
from [СТАТ_Инвестиции_Иностранные вложения]
where
    (
        <%selected_region%>,
        <%group%>,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]
    )
    ]]>
  </query>

  <query id = "STAT_0001_0020_chart">
    <![CDATA[ -- STAT_0001_0020_chart
with
    set [Кварталы]
    as '
        {
            tail
            (
                filter
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал].Members,
                    [Measures].[За период] > 0 and not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember
                ),
                8
            )
        }'
    member [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Пустой параметр]
    as '0'
    set [Виды вложений]
    as '
        {
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Поступило иностранных инвестиций],
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Объём инвестиций из России за рубеж],
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Пустой параметр]
        }    '
    set [Инвестиции]
    as '
        {
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прямые инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Портфельные инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прочие инвестиции]
        } '
    member [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год] 
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Name + ";" +
    + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + ";" +
    + [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].CurrentMember.Name'
select
    {{[Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год] } + [Инвестиции]} on columns,
    [Кварталы] * [Виды вложений] on rows
from [СТАТ_Инвестиции_Иностранные вложения] 
where
    (
        [Measures].[За период],
        <%selected_region%>,
        <%group%>,
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ХМАО-Югра]
    )
  ]]>
  </query>
  
</root>