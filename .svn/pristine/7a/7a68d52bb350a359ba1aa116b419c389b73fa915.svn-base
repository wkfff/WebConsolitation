<?xml version="1.0" encoding="windows-1251"?>
<root>  
<query id="FO_0002_0005_date">
    <![CDATA[
-- FO_0002_0005_compare_date
with
    member [Measures].[ДанныеНа]
    as '<%period_dimension%>.CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                <%period_dimension%>.Members,
                not IsEmpty([Measures].[Факт])
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_МесОтч_Доходы]
  ]]>
  </query>

  <query id="FO_0002_0005_compare_Grid">
    <![CDATA[
-- FO_0002_0005_compare_Grid 
with 
--------- Полный список доходов 
    member <%incomes_kd_dimension%>.[Административные платежи и сборы ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ]'
    member <%incomes_kd_dimension%>.[Прочие ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ]'
    member <%incomes_kd_dimension%>.[Доходы бюджетов от возврата остатков МБТ прошлых лет ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_11800000000000000%>]'
    member <%incomes_kd_dimension%>.[Возврат остатков МБТ прошлых лет ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_return_of_remains%>]'
    member <%incomes_kd_dimension%>.[Налог на имущество физ.лиц ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц]'
    member <%incomes_kd_dimension%>.[Транспортный налог с физ.лиц ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог].[Транспортный налог с физических лиц]'

    member <%incomes_kd_dimension%>.[Транспортный налог с организаций ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог].[Транспортный налог с организаций]'

    member <%incomes_kd_dimension%>.[Платежи при пользовании недрами ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Платежи при пользовании недрами]'

    member <%incomes_kd_dimension%>.[Налоговые доходы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_social_needs_tax%>],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_10800000000000000%>] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Налог на прибыль ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]' 
    member <%incomes_kd_dimension%>.[НДФЛ ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]' 
    member <%incomes_kd_dimension%>.[Налоги на имущество ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО]' 

    member <%incomes_kd_dimension%>.[Налог на имущество организаций ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество организаций]' 
    member <%incomes_kd_dimension%>.[Транспортный налог ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог]' 
    member <%incomes_kd_dimension%>.[Земельный налог ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог]' 
    member <%incomes_kd_dimension%>.[Акцизы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Акцизы на нефтепродукты ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на бензин, производимый на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на автомобильный бензин, дизельное топливо, моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, производимые на территории Российской Федерации (в части погашения задолженности прошлых лет, образовавшейся до 1 января 2003 г],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на дизельное топливо, производимое на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, производимые на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на дизельное топливо, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на автомобильный бензин, производимый на территории Российской Федерации, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на прямогонный бензин, производимый на территории Российской Федерации, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на автомобильный бензин, ввозимый на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на дизельное топливо, ввозимое на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, ввозимые на территорию Российской Федерации] 
            } 
        )'  
	member [КД].[Сопоставимый].[Акцизы на алкоголь ]
    as 'Aggregate
        (
            {
              Filter
              (
                Descendants
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>],
                    [КД].[Сопоставимый].[Элемент],
                    SELF_AND_BEFORE
                ),
                not
                (
                   <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                ) and
               (
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302010010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302020010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302090010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302100010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302110010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302120010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302130010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302140010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302190010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302200010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402010010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402020010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402090010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402100010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402110010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402120010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402130010000110"))
              )
            }
        )'
    member <%incomes_kd_dimension%>.[НДПИ ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]' 
    member <%incomes_kd_dimension%>.[Налоги на совокупный доход ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД]' 
    member <%incomes_kd_dimension%>.[УСН ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Налог, взимаемый в связи с применением упрощенной системы налогообложения]' 
    member <%incomes_kd_dimension%>.[ЕНВД ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Единый налог на вмененный доход для отдельных видов деятельности]' 
    member <%incomes_kd_dimension%>.[ЕСХН ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Единый сельскохозяйственный налог]' 
    member <%incomes_kd_dimension%>.[Гос.пошлина ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_10800000000000000%>]' 
    member <%incomes_kd_dimension%>.[Задолженность по отмененным налогам ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ]' 

    member <%incomes_kd_dimension%>.[Неналоговые доходы ] 
    as 'Aggregate
        (
            {
                Filter
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].Children,
                    not
                    (
                        <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                    ) and
                    (
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011000000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011100000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011200000000000000") or
						(<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011300000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011400000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011500000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011600000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011700000000000000")
                    )
                )
            }
        )' 
        
    member <%incomes_kd_dimension%>.[Доходы от использования имущества ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ]' 
    member <%incomes_kd_dimension%>.[Дивиденды по акциям ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы в виде прибыли, приходящейся на доли в уставных (складочных) капиталах хозяйственных товариществ и обществ, или дивидендов по акциям, принадлежащим Российской Федерации, субъектам Российской Федерации или муниципальным образованиям]' 

        
         member <%incomes_kd_dimension%>.[Арендная плата за земли ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы, получаемые в виде арендной платы за земельные участки, государственная собственность на которые не разграничена, а также средства от продажи права на заключение договоров аренды указанных земельных участков],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы, получаемые в виде арендной платы за земли после разграничения государственной собственности на землю, а также средства от продажи права на заключение договоров аренды указанных земельных участков (за исключением земельных участков бюджетных и авто] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Доходы от сдачи в аренду имущества ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от сдачи в аренду имущества, находящегося в оперативном управлении органов государственной власти, органов местного самоуправления, государственных внебюджетных фондов и созданных ими учреждений (за исключением имущества бюджетных и автономных учре],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от использования федерального имущества, расположенного за пределами территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от использования федерального имущества, расположенного за пределами территории Российской Федерации, получаемые за рубежом]
            } 
        )'
        
    member <%incomes_kd_dimension%>.[Платежи от ГУПов и МУПов ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Платежи от государственных и муниципальных унитарных предприятий]' 
    member <%incomes_kd_dimension%>.[Платежи при пользовании природными ресурсами ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ]' 
    member <%incomes_kd_dimension%>.[Плата за негативное воздействие на окруж.среду ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Плата за негативное воздействие на окружающую среду]' 
    member <%incomes_kd_dimension%>.[Платежи за пользование лесным фондом ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Плата за использование лесов]' 
    member <%incomes_kd_dimension%>.[Доходы от оказания платных услуг ]
    as 'Aggregate
        (
            {
                Filter
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].Children,
                    not
                    (
                        <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                    ) and
                    (
            						<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011300000000000000"
                    )
                )
            }
        )'
    member <%incomes_kd_dimension%>.[Доходы от продажи активов ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ]' 

    member <%incomes_kd_dimension%>.[Доходы от продажи активов (кроме зем.участков) ]  
    as 'Aggregate  
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи квартир],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[<%incomes_kd_11402000000000000%>],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Средства от распоряжения и реализации конфискованного и иного имущества, обращенного в доход государства (в части реализации основных средств по указанному имуществу)] ,
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Средства от распоряжения и реализации конфискованного и иного имущества, обращенного в доход государства (в части реализации материальных запасов по указанному имуществу)],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи нематериальных активов],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы в виде доли прибыльной продукции государства при выполнении соглашений о разделе продукции]  
            }  
        )'  
    member <%incomes_kd_dimension%>.[Доходы от продажи зем. участков ]  
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи земельных участков, находящихся в государственной и муниципальной собственности (за исключением земельных участков бюджетных и автономных учреждений)]' 
    member <%incomes_kd_dimension%>.[Доходы от приносящей доход деятельности ] 
    as '<%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]' 
    
    member <%incomes_kd_dimension%>.[Штрафы ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА]' 
       
    member <%incomes_kd_dimension%>.[Налоговые и неналоговые доходы ]
    as 'Aggregate
        (
            {
                Filter
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].Children,
                    not
                    (
                        <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                    ) and
                    (
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010100000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010300000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010400000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010500000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010600000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010700000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010800000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010900000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011000000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011100000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011200000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011300000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011400000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011500000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011600000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011700000000000000")
                    )
                )
            }
        )'        
        
    member <%incomes_kd_dimension%>.[Безвозмездные поступления ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ]' 
    
    member <%incomes_kd_dimension%>.[Доходы бюджета - Итого ] 
    as '<%incomes_total%>'
    
    member <%incomes_kd_dimension%>.[Собственные доходы ]    
    AS ' Aggregate
        (
            {
                {
                    <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].Children -    
                    {
                        <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации]    
                    }     
                }, 
                {
                    <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].Children -    
                    {
                        <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований]    
                    }     
                },  
                {
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>],
                    <%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]    
                }     
            }
        ) '     
----------------------------

    member Measures.[isMRGO] 
    as 'not( [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта] or
         [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>] or
         [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты]) '
    
    member Measures.[isMR]
    as ' Measures.[isMRGO] and not ([Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО") '
    
    member Measures.[Численность постоянного населения по МО]   
    as 'IIF            
        (
            not(Measures.[isMRGO]),
            Sum            
            (
                [Города и районы],
                Measures.[Численность постоянного населения по МО]   
            ),
            LookupCube            
            (
                "<%population_cube%>",
                "            
                (
                    <%population_filter%>,
                    " + MemberToStr            
                    (
                        [Районы].[Сопоставимый].CurrentMember            
                    ) + ",
                    <%population_period_dimension%>.[" + [Период].[Период].CurrentMember.Name + "]     
                ) / <%population_value_divider%>"            
            )              
        )'             
    member Measures.[Численность постоянного населения]
    as 'IIF 
        (
            not IsEmpty 
            (
                (
                    Measures.[Численность постоянного населения по МО],
                    [Период].[Период].[Данные всех периодов].[<%population_measure_year%>] 
                ) 
            ),
            (
                Measures.[Численность постоянного населения по МО],
                [Период].[Период].[Данные всех периодов].[<%population_measure_year%>] 
            ),
            (
                Tail 
                (
                    Filter 
                    (
                        {
                            [Период].[Период].[Данные всех периодов].[2000] : [Период].[Период].[Данные всех периодов].[<%population_measure_year%>].PrevMember 
                        },
                        not IsEmpty 
                        (
                            Measures.[Численность постоянного населения по МО] 
                        ) 
                    ) 
                ).Item(0),
                Measures.[Численность постоянного населения по МО] 
            ) 
        )'      
    
    member Measures.[Ранг процент МО]    
    as 'IIF    
        (
            IsEmpty    
            (
                [Measures].[% выполнения годовых назначений]    
            ) or not ( Measures.[isMRGO]),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    [Города и районы],
                    [Measures].[% выполнения годовых назначений],
                    BDESC    
                ),
                [Measures].[% выполнения годовых назначений]    
            )    
        )'    
    member Measures.[Худший ранг процент МО]    
    as 'IIF  
        (
            IsEmpty  ( Measures.[Ранг процент МО] ) or not (Measures.[isMRGO]),
            null,
            max  
            (
                [Города и районы],
                Measures.[Ранг процент МО]    
            ) 
        )'  
        
    member Measures.[Среднедушевые доходы] 
    as 'IIF 
        (
            IsEmpty 
            (
                Measures.[Численность постоянного населения] 
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Факт]/ 
            (
                Measures.[Численность постоянного населения] 
                *1000 
            ) 
        ) ' 
    member Measures.[Ранг среднедуш МО]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Среднедушевые доходы]    
            ) or not (Measures.[isMRGO]),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Города и районы],
                        not IsEmpty    
                        (
                            Measures.[Среднедушевые доходы]    
                        )    
                    ),
                    Measures.[Среднедушевые доходы],
                    BDESC    
                ),
                Measures.[Среднедушевые доходы]    
            )    
        )'    
    member Measures.[Худший ранг среднедуш МО]    
    as 'IIF   
        (
            IsEmpty   
            (
                 Measures.[Ранг среднедуш МО]
            ) or not (Measures.[isMRGO]),
            null,
            max  
            (
                [Города и районы],
                Measures.[Ранг среднедуш МО]    
            )  
        )'   
    member Measures.[Доля в МО] 
    as 'IIF 
        (
            not Measures.[isMRGO] or
            IsEmpty
            (
              Sum 
              (
                  [Города и районы],
                  Measures.[Факт] 
              )
            ) or 
            Sum 
            (
                [Города и районы],
                Measures.[Факт] 
            )  = 0,
            null,
            100*
            (
                Measures.[Факт]
            )/ Sum 
            (
                [Города и районы],
                Measures.[Факт] 
            ) 
        )'  
    member Measures.[Доля в КБ] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    Measures.[Факт],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                    <%regions_consolidate_level%> 
                ) 
            ) or 
            (
                Measures.[Факт],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                <%regions_consolidate_level%> 
            ) = 0,
            IIF 
            (
                IsEmpty 
                (
                    (
                        Measures.[Факт],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
                        <%regions_consolidate_level%> 
                    ) 
                ) or 
                (
                    Measures.[Факт],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
                    <%regions_consolidate_level%> 
                ) = 0,
                null,
                100 
                * 
                (
                    Measures.[Факт]
                )/ 
                (
                    Measures.[Факт],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
                    <%regions_consolidate_level%> 
                ) 
            ),
            100 
            * 
            (
                Measures.[Факт]
            )/ 
            (
                Measures.[Факт],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                <%regions_consolidate_level%> 
            ) 
        ) '          
    set [Города]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            )
        )'
    set [Районы]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"
            )
        )'
    set [Города и районы]
    as '[Города] + [Районы]'        

    member [Районы].[Сопоставимый].[Консолидированный бюджет субъекта]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_level%>,
                    <%consolidate_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_level%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_level%>,
                <%consolidate_document_skif_type%>
            )
        )'
    
    member [Районы].[Сопоставимый].[<%own_subject_budget_name%>]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_level%>,
                    <%consolidate_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_level%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_level%>,
                <%consolidate_document_skif_type%>
            )
        )'
    
    member [Районы].[Сопоставимый].[Местные бюджеты]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_level%>,
                    <%consolidate_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_level%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_level%>,
                <%consolidate_document_skif_type%>
            )
        )'   
 
    member [Уровни бюджета].[СКИФ].[Уровень бюджета ] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            IIF 
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                IIF 
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО],
                    <%region_budget_skif_level%>
                ) 
            ) 
        ) ' 
    member [Уровни бюджета].[СКИФ].[Бюджет гор.округа, мун.района и поселения] 
    as 'Aggregate
        (
          {
            [Уровни бюджета].[СКИФ].[Бюджет поселения],
            [Уровни бюджета].[СКИФ].[Бюджет гор.округа],
            [Уровни бюджета].[СКИФ].[Бюджет района]
          }
        )'  
        
    member Measures.[Ранг среднедуш МР]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Среднедушевые доходы]
            ) or not ( Measures.[isMR] ),
            null,
            Rank
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Районы],
                        not IsEmpty
                        (
                            Measures.[Среднедушевые доходы]
                        )
                    ),
                    Measures.[Среднедушевые доходы],
                    BDESC
                ),
                Measures.[Среднедушевые доходы]
            )
        )'
    member Measures.[Худший ранг среднедуш МР]
    as 'IIF
        (
            IsEmpty
            (
                 Measures.[Ранг среднедуш МР]
            ) or not ( Measures.[isMR] ),
            null,
            max
            (
                [Районы],
                Measures.[Ранг среднедуш МР]
            )
        )'
     
    member Measures.[Доля в МР]
    as 'IIF
        (
            not Measures.[isMR] or
            IsEmpty
            (
              Sum
              (
                  [Районы],
                  Measures.[Факт]
              )
            ) or
            Sum
            (
                [Районы],
                Measures.[Факт]
            ) = 0,
            null,
            100 *
            (
                Measures.[Факт],
                [Районы].[Сопоставимый].CurrentMember
            )/ Sum
            (
                [Районы],
                Measures.[Факт]
            )
        )'  
        
    member Measures.[Ранг процент МР]    
    as 'IIF    
        (
            IsEmpty    
            (
                [Measures].[% выполнения годовых назначений]    
            ) or not ( Measures.[isMR]),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    [Районы],
                    [Measures].[% выполнения годовых назначений],
                    BDESC    
                ),
                [Measures].[% выполнения годовых назначений]    
            )    
        )'    
    member Measures.[Худший ранг процент МР]    
    as 'IIF  
        (
            IsEmpty  ( Measures.[Ранг процент МР] ) or not (Measures.[isMR]),
            null,
            max  
            (
                [Районы],
                Measures.[Ранг процент МР]    
            ) 
        )'          
select
    {
        Measures.[Годовые назначения],
        Measures.[Факт],
        Measures.[% выполнения годовых назначений],
        Measures.[Ранг процент <%avg_incomes_compare_type%>],
        Measures.[Худший ранг процент <%avg_incomes_compare_type%>],
        Measures.[Численность постоянного населения],
        Measures.[Среднедушевые доходы],
        Measures.[Ранг среднедуш <%avg_incomes_compare_type%>],
        Measures.[Худший ранг среднедуш <%avg_incomes_compare_type%>],
        Measures.[Доля в <%avg_incomes_compare_type%>],
        Measures.[Доля в КБ]
    } on columns,
    Non Empty
    {
        {
            [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Районы].[Сопоставимый].[<%own_subject_budget_name%>],
            [Районы].[Сопоставимый].[Местные бюджеты] 
        } + [Города и районы]
    } on rows 
from [ФО_МесОтч_Доходы] 
where 
    (
        <%period_dimension%>.[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%region_document_skif_type%>,
        [Уровни бюджета].[СКИФ].[Уровень бюджета ],
        [КД].[Сопоставимый].[<%kd_group_name%>]
    ) 
  ]]>
</query>

  <query id="FO_0002_0005_compare_Map">
    <![CDATA[
-- FO_0002_0005_compare_Map 
with 
--------- Полный список доходов 
    member <%incomes_kd_dimension%>.[Административные платежи и сборы ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[АДМИНИСТРАТИВНЫЕ ПЛАТЕЖИ И СБОРЫ]'
    member <%incomes_kd_dimension%>.[Прочие ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПРОЧИЕ НЕНАЛОГОВЫЕ ДОХОДЫ]'
    member <%incomes_kd_dimension%>.[Доходы бюджетов от возврата остатков МБТ прошлых лет ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_11800000000000000%>]'
    member <%incomes_kd_dimension%>.[Возврат остатков МБТ прошлых лет ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_return_of_remains%>]'
    member <%incomes_kd_dimension%>.[Налог на имущество физ.лиц ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество физических лиц]'
    member <%incomes_kd_dimension%>.[Транспортный налог с физ.лиц ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог].[Транспортный налог с физических лиц]'

    member <%incomes_kd_dimension%>.[Транспортный налог с организаций ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог].[Транспортный налог с организаций]'

    member <%incomes_kd_dimension%>.[Платежи при пользовании недрами ]
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Платежи при пользовании недрами]'

    member <%incomes_kd_dimension%>.[Налоговые доходы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_social_needs_tax%>],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_10800000000000000%>] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Налог на прибыль ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на прибыль организаций]' 
    member <%incomes_kd_dimension%>.[НДФЛ ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ПРИБЫЛЬ, ДОХОДЫ].[Налог на доходы физических лиц]' 
    member <%incomes_kd_dimension%>.[Налоги на имущество ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО]' 

    member <%incomes_kd_dimension%>.[Налог на имущество организаций ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Налог на имущество организаций]' 
    member <%incomes_kd_dimension%>.[Транспортный налог ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Транспортный налог]' 
    member <%incomes_kd_dimension%>.[Земельный налог ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ИМУЩЕСТВО].[Земельный налог]' 
    member <%incomes_kd_dimension%>.[Акцизы ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Акцизы на нефтепродукты ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на бензин, производимый на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на автомобильный бензин, дизельное топливо, моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, производимые на территории Российской Федерации (в части погашения задолженности прошлых лет, образовавшейся до 1 января 2003 г],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на дизельное топливо, производимое на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Акцизы на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, производимые на территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на дизельное топливо, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на автомобильный бензин, производимый на территории Российской Федерации, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ (РАБОТЫ, УСЛУГИ), РЕАЛИЗУЕМЫЕ НА ТЕРРИТОРИИ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), производимым на территории Российской Федерации].[Доходы от уплаты акцизов на прямогонный бензин, производимый на территории Российской Федерации, подлежащие распределению в консолидированные бюджеты субъектов Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на автомобильный бензин, ввозимый на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на дизельное топливо, ввозимое на территорию Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА ТОВАРЫ, ВВОЗИМЫЕ НА ТЕРРИТОРИЮ РОССИЙСКОЙ ФЕДЕРАЦИИ].[Акцизы по подакцизным товарам (продукции), ввозимым на территорию Российской Федерации].[Акцизы на моторные масла для дизельных и (или) карбюраторных (инжекторных) двигателей, ввозимые на территорию Российской Федерации] 
            } 
        )'  
	member [КД].[Сопоставимый].[Акцизы на алкоголь ]
    as 'Aggregate
        (
            {
              Filter
              (
                Descendants
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>],
                    [КД].[Сопоставимый].[Элемент],
                    SELF_AND_BEFORE
                ),
                not
                (
                   <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                ) and
               (
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302010010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302020010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302090010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302100010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302110010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302120010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302130010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302140010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302190010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010302200010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402010010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402020010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402090010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402100010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402110010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402120010000110") or
                (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010402130010000110"))
              )
            }
        )'
    member <%incomes_kd_dimension%>.[НДПИ ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ, СБОРЫ И РЕГУЛЯРНЫЕ ПЛАТЕЖИ ЗА ПОЛЬЗОВАНИЕ ПРИРОДНЫМИ РЕСУРСАМИ].[Налог на добычу полезных ископаемых]' 
    member <%incomes_kd_dimension%>.[Налоги на совокупный доход ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД]' 
    member <%incomes_kd_dimension%>.[УСН ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Налог, взимаемый в связи с применением упрощенной системы налогообложения]' 
    member <%incomes_kd_dimension%>.[ЕНВД ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Единый налог на вмененный доход для отдельных видов деятельности]' 
    member <%incomes_kd_dimension%>.[ЕСХН ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[НАЛОГИ НА СОВОКУПНЫЙ ДОХОД].[Единый сельскохозяйственный налог]' 
    member <%incomes_kd_dimension%>.[Гос.пошлина ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[<%incomes_kd_10800000000000000%>]' 
    member <%incomes_kd_dimension%>.[Задолженность по отмененным налогам ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ЗАДОЛЖЕННОСТЬ И ПЕРЕРАСЧЕТЫ ПО ОТМЕНЕННЫМ НАЛОГАМ, СБОРАМ И ИНЫМ ОБЯЗАТЕЛЬНЫМ ПЛАТЕЖАМ]' 
    member <%incomes_kd_dimension%>.[Неналоговые доходы ] 
    as 'Aggregate
        (
            {
                Filter
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].Children,
                    not
                    (
                        <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                    ) and
                    (
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011000000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011100000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011200000000000000") or
						(<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011300000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011400000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011500000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011600000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011700000000000000")
                    )
                )
            }
        )'
    member <%incomes_kd_dimension%>.[Доходы от использования имущества ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ]' 
    member <%incomes_kd_dimension%>.[Дивиденды по акциям ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы в виде прибыли, приходящейся на доли в уставных (складочных) капиталах хозяйственных товариществ и обществ, или дивидендов по акциям, принадлежащим Российской Федерации, субъектам Российской Федерации или муниципальным образованиям]' 

        
         member <%incomes_kd_dimension%>.[Арендная плата за земли ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы, получаемые в виде арендной платы за земельные участки, государственная собственность на которые не разграничена, а также средства от продажи права на заключение договоров аренды указанных земельных участков],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы, получаемые в виде арендной платы за земли после разграничения государственной собственности на землю, а также средства от продажи права на заключение договоров аренды указанных земельных участков (за исключением земельных участков бюджетных и авто] 
            } 
        )' 
    member <%incomes_kd_dimension%>.[Доходы от сдачи в аренду имущества ] 
    as 'Aggregate 
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от сдачи в аренду имущества, находящегося в оперативном управлении органов государственной власти, органов местного самоуправления, государственных внебюджетных фондов и созданных ими учреждений (за исключением имущества бюджетных и автономных учре],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от использования федерального имущества, расположенного за пределами территории Российской Федерации],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Доходы, получаемые в виде арендной либо иной платы за передачу в возмездное пользование государственного и муниципального имущества (за исключением имущества бюджетных и автономных учреждений, а также имущества государственных и муниципальных унитарных пр].[Доходы от использования федерального имущества, расположенного за пределами территории Российской Федерации, получаемые за рубежом] 
            } 
        )'
        
    member <%incomes_kd_dimension%>.[Платежи от ГУПов и МУПов ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ИСПОЛЬЗОВАНИЯ ИМУЩЕСТВА, НАХОДЯЩЕГОСЯ В ГОСУДАРСТВЕННОЙ И МУНИЦИПАЛЬНОЙ СОБСТВЕННОСТИ].[Платежи от государственных и муниципальных унитарных предприятий]' 
    member <%incomes_kd_dimension%>.[Платежи при пользовании природными ресурсами ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ]' 
    member <%incomes_kd_dimension%>.[Плата за негативное воздействие на окруж.среду ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Плата за негативное воздействие на окружающую среду]' 
    member <%incomes_kd_dimension%>.[Платежи за пользование лесным фондом ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ПЛАТЕЖИ ПРИ ПОЛЬЗОВАНИИ ПРИРОДНЫМИ РЕСУРСАМИ].[Плата за использование лесов]' 
    member <%incomes_kd_dimension%>.[Доходы от оказания платных услуг ]
    as 'Aggregate
        (
            {
                Filter
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].Children,
                    not
                    (
                        <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                    ) and
                    (
            						<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011300000000000000"
                    )
                )
            }
        )'
    member <%incomes_kd_dimension%>.[Доходы от продажи активов ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ]' 

    member <%incomes_kd_dimension%>.[Доходы от продажи активов (кроме зем.участков) ]  
    as 'Aggregate  
        (
            {
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи квартир],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[<%incomes_kd_11402000000000000%>],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Средства от распоряжения и реализации конфискованного и иного имущества, обращенного в доход государства (в части реализации основных средств по указанному имуществу)] ,
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Средства от распоряжения и реализации конфискованного и иного имущества, обращенного в доход государства (в части реализации материальных запасов по указанному имуществу)],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи нематериальных активов],
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы в виде доли прибыльной продукции государства при выполнении соглашений о разделе продукции]  
            }  
        )'  
    member <%incomes_kd_dimension%>.[Доходы от продажи зем. участков ]  
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ДОХОДЫ ОТ ПРОДАЖИ МАТЕРИАЛЬНЫХ И НЕМАТЕРИАЛЬНЫХ АКТИВОВ].[Доходы от продажи земельных участков, находящихся в государственной и муниципальной собственности (за исключением земельных участков бюджетных и автономных учреждений)]' 
    member <%incomes_kd_dimension%>.[Доходы от приносящей доход деятельности ] 
    as '<%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]' 
    
    member <%incomes_kd_dimension%>.[Штрафы ] 
    as '<%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].[ШТРАФЫ, САНКЦИИ, ВОЗМЕЩЕНИЕ УЩЕРБА]' 
    member <%incomes_kd_dimension%>.[Налоговые и неналоговые доходы ]
    as 'Aggregate
        (
            {
                Filter
                (
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>].Children,
                    not
                    (
                        <%incomes_kd_dimension%>.CurrentMember is <%incomes_kd_dimension%>.CurrentMember.Parent.DataMember
                    ) and
                    (
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010100000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010300000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010400000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010500000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010600000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010700000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010800000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00010900000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011000000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011100000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011200000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011300000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011400000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011500000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011600000000000000") or
                        (<%incomes_kd_dimension%>.CurrentMember.Properties("Код") = "00011700000000000000")
                    )
                )
            }
        )'  
    member <%incomes_kd_dimension%>.[Безвозмездные поступления ] 
    as '<%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ]' 
    
    member <%incomes_kd_dimension%>.[Доходы бюджета - Итого ] 
    as '<%incomes_total%>'
    
    member <%incomes_kd_dimension%>.[Собственные доходы ]    
    AS ' Aggregate
        (
            {
                {
                    <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].Children -    
                    {
                        <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации]    
                    }     
                },  
                {
                    <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].Children -    
                    {
                        <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований]    
                    }     
                },
                {
                    <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>],
                    <%incomes_kd_all_level%>.[ДОХОДЫ ОТ ПРИНОСЯЩЕЙ ДОХОД ДЕЯТЕЛЬНОСТИ]    
                }     
            }
        ) '     
----------------------------

    member Measures.[isMRGO] 
    as 'not( [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта] or
         [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>] or
         [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты]) '
    
    member Measures.[isMR]
    as ' Measures.[isMRGO] and not ([Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО") '
    
    member Measures.[Численность постоянного населения по МО]   
    as 'IIF            
        (
            not(Measures.[isMRGO]),
            Sum            
            (
                [Города и районы],
                Measures.[Численность постоянного населения по МО]   
            ),
            LookupCube            
            (
                "<%population_cube%>",
                "            
                (
                    <%population_filter%>,
                    " + MemberToStr            
                    (
                        [Районы].[Сопоставимый].CurrentMember            
                    ) + ",
                    <%population_period_dimension%>.[" + [Период].[Период].CurrentMember.Name + "]     
                ) / <%population_value_divider%>"            
            )              
        )'             
    member Measures.[Численность постоянного населения]
    as 'IIF 
        (
            not IsEmpty 
            (
                (
                    Measures.[Численность постоянного населения по МО],
                    [Период].[Период].[Данные всех периодов].[<%population_measure_year%>] 
                ) 
            ),
            (
                Measures.[Численность постоянного населения по МО],
                [Период].[Период].[Данные всех периодов].[<%population_measure_year%>] 
            ),
            (
                Tail 
                (
                    Filter 
                    (
                        {
                            [Период].[Период].[Данные всех периодов].[2000] : [Период].[Период].[Данные всех периодов].[<%population_measure_year%>].PrevMember 
                        },
                        not IsEmpty 
                        (
                            Measures.[Численность постоянного населения по МО] 
                        ) 
                    ) 
                ).Item(0),
                Measures.[Численность постоянного населения по МО] 
            ) 
        )'      
    
    member Measures.[Ранг процент МО]    
    as 'IIF    
        (
            IsEmpty    
            (
                [Measures].[% выполнения годовых назначений]    
            ) or not ( Measures.[isMRGO]),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    [Города и районы],
                    [Measures].[% выполнения годовых назначений],
                    BDESC    
                ),
                [Measures].[% выполнения годовых назначений]    
            )    
        )'    
    member Measures.[Худший ранг процент МО]    
    as 'IIF  
        (
            IsEmpty  ( Measures.[Ранг процент МО] ) or not (Measures.[isMRGO]),
            null,
            max  
            (
                [Города и районы],
                Measures.[Ранг процент МО]    
            ) 
        )'  
        
    member Measures.[Среднедушевые доходы] 
    as 'IIF 
        (
            IsEmpty 
            (
                Measures.[Численность постоянного населения] 
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Факт]/ 
            (
                Measures.[Численность постоянного населения] 
                *1000 
            ) 
        ) ' 
    member Measures.[Ранг среднедуш МО]    
    as 'IIF    
        (
            IsEmpty    
            (
                Measures.[Среднедушевые доходы]    
            ) or not (Measures.[isMRGO]),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Города и районы],
                        not IsEmpty    
                        (
                            Measures.[Среднедушевые доходы]    
                        )    
                    ),
                    Measures.[Среднедушевые доходы],
                    BDESC    
                ),
                Measures.[Среднедушевые доходы]    
            )    
        )'    
    member Measures.[Худший ранг среднедуш МО]    
    as 'IIF   
        (
            IsEmpty   
            (
                 Measures.[Ранг среднедуш МО]
            ) or not (Measures.[isMRGO]),
            null,
            max  
            (
                [Города и районы],
                Measures.[Ранг среднедуш МО]    
            )  
        )'   
    member Measures.[Доля в МО] 
    as 'IIF 
        (
            not Measures.[isMRGO] or
            IsEmpty
            (
              Sum 
              (
                  [Города и районы],
                  Measures.[Факт] 
              )
            ) or 
            Sum 
            (
                [Города и районы],
                Measures.[Факт] 
            )  = 0,
            null,
            100*
            (
                Measures.[Факт],
                [Районы].[Сопоставимый].CurrentMember 
            )/ Sum 
            (
                [Города и районы],
                Measures.[Факт] 
            ) 
        )'  
    member Measures.[Доля в КБ] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    Measures.[Факт],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                    <%regions_consolidate_level%> 
                ) 
            ) or 
            (
                Measures.[Факт],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                <%regions_consolidate_level%> 
            ) = 0,
            IIF 
            (
                IsEmpty 
                (
                    (
                        Measures.[Факт],
                        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                        [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
                        <%regions_consolidate_level%> 
                    ) 
                ) or 
                (
                    Measures.[Факт],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
                    <%regions_consolidate_level%> 
                ) = 0,
                null,
                100 
                * 
                (
                    Measures.[Факт],
                    [Районы].[Сопоставимый].CurrentMember 
                )/ 
                (
                    Measures.[Факт],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                    [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)],
                    <%regions_consolidate_level%> 
                ) 
            ),
            100 
            * 
            (
                Measures.[Факт],
                [Районы].[Сопоставимый].CurrentMember 
            )/ 
            (
                Measures.[Факт],
                [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
                [ТипДокумента].[СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                <%regions_consolidate_level%> 
            ) 
        ) '          
    set [Города]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"
            )
        )'
    set [Районы]
    as 'Filter
        (
            Descendants
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF
            ),
            not
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember
            ) and
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"
            )
        )'
    set [Города и районы]
    as '[Города] + [Районы]'        

    member [Районы].[Сопоставимый].[Консолидированный бюджет субъекта]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_level%>,
                    <%consolidate_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_level%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_level%>,
                <%consolidate_document_skif_type%>
            )
        )'
    
    member [Районы].[Сопоставимый].[<%own_subject_budget_name%>]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_level%>,
                    <%consolidate_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_level%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_level%>,
                <%consolidate_document_skif_type%>
            )
        )'
    
    member [Районы].[Сопоставимый].[Местные бюджеты]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_level%>,
                    <%consolidate_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_level%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_level%>,
                <%consolidate_document_skif_type%>
            )
        )'   
 
    member [Уровни бюджета].[СКИФ].[Уровень бюджета ] 
    as 'IIF 
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            IIF 
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                IIF 
                (
                    [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Местные бюджеты],
                    [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет МО],
                    <%region_budget_skif_level%>
                ) 
            ) 
        ) ' 
    member [Уровни бюджета].[СКИФ].[Бюджет гор.округа, мун.района и поселения] 
    as 'Aggregate
        (
          {
            [Уровни бюджета].[СКИФ].[Бюджет поселения],
            [Уровни бюджета].[СКИФ].[Бюджет гор.округа],
            [Уровни бюджета].[СКИФ].[Бюджет района]
          }
        )'  
        
    member Measures.[Ранг среднедуш МР]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Среднедушевые доходы]
            ) or not ( Measures.[isMR] ),
            null,
            Rank
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Районы],
                        not IsEmpty
                        (
                            Measures.[Среднедушевые доходы]
                        )
                    ),
                    Measures.[Среднедушевые доходы],
                    BDESC
                ),
                Measures.[Среднедушевые доходы]
            )
        )'
    member Measures.[Худший ранг среднедуш МР]
    as 'IIF
        (
            IsEmpty
            (
                 Measures.[Ранг среднедуш МР]
            ) or not ( Measures.[isMR] ),
            null,
            max
            (
                [Районы],
                Measures.[Ранг среднедуш МР]
            )
        )'
     
    member Measures.[Доля в МР]
    as 'IIF
        (
            not Measures.[isMR] or
            IsEmpty
            (
              Sum
              (
                  [Районы],
                  Measures.[Факт]
              )
            ) or
            Sum
            (
                [Районы],
                Measures.[Факт]
            ) = 0,
            null,
            100 *
            (
                Measures.[Факт],
                [Районы].[Сопоставимый].CurrentMember
            )/ Sum
            (
                [Районы],
                Measures.[Факт]
            )
        )'  
        
    member Measures.[Ранг процент МР]    
    as 'IIF    
        (
            IsEmpty    
            (
                [Measures].[% выполнения годовых назначений]    
            ) or not ( Measures.[isMR]),
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    [Районы],
                    [Measures].[% выполнения годовых назначений],
                    BDESC    
                ),
                [Measures].[% выполнения годовых назначений]    
            )    
        )'    
    member Measures.[Худший ранг процент МР]    
    as 'IIF  
        (
            IsEmpty  ( Measures.[Ранг процент МР] ) or not (Measures.[isMR]),
            null,
            max  
            (
                [Районы],
                Measures.[Ранг процент МР]    
            ) 
        )' 
        
   member Measures.[Код объекта карты]
   as '[Районы].[Сопоставимый].CurrentMember.Properties("Код объекта карты")'
select
    {
        Measures.[% выполнения годовых назначений],
        Measures.[Код объекта карты]
    } on columns,
    Non Empty
    {
        [Города и районы]
    } on rows 
from [ФО_МесОтч_Доходы] 
where 
    (
        <%period_dimension%>.[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%region_document_skif_type%>,
        [Уровни бюджета].[СКИФ].[Уровень бюджета ],
        [КД].[Сопоставимый].[<%kd_group_name%>]
    ) 
  ]]>
  </query>  
</root>
