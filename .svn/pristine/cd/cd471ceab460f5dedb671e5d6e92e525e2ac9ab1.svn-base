<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FK_0001_0003_date">
    <![CDATA[
-- FK_0001_0003_iphone_Date    
with
    member [Measures].[ДанныеНа]
    as '[Период].[Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                [Период].[Период].Members,
                not IsEmpty([Measures].[Исполнено]) and
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФК_МесОтч_Расходы]
  ]]>
  </query>

  <query id="FK_0001_0003">
    <![CDATA[
-- FK_0001_0003_iphone     
with
   member Measures.[Ранг процент]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Процент выполнения назначений]
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            [Measures].[Процент выполнения назначений]
                        )
                    ),
                    [Measures].[Процент выполнения назначений],
                    DESC
                ),
                [Measures].[Процент выполнения назначений]
            )
        )'
    member Measures.[Худший ранг процент]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг процент]
        )'
    member Measures.[Ранг процент РФ]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Процент выполнения назначений]
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].[Субъект РФ].Members,
                        not IsEmpty
                        (
                            [Measures].[Процент выполнения назначений]
                        )
                    ),
                    [Measures].[Процент выполнения назначений],
                    BDESC
                ),
                [Measures].[Процент выполнения назначений]
            )
        )'
    member Measures.[Худший ранг процент РФ]
    as 'max
        (
            [Территории].[Сопоставимый].[Субъект РФ].Members,
            Measures.[Ранг процент РФ]
        )'
    member Measures.[Ранг бюджетной обеспеченности]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Коэффициент бюджетной обеспеченности населения]
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            Measures.[Коэффициент бюджетной обеспеченности населения]
                        )
                    ),
                    Measures.[Коэффициент бюджетной обеспеченности населения],
                    DESC
                ),
                Measures.[Коэффициент бюджетной обеспеченности населения]
            )
        )'
    member Measures.[Худший ранг бюджетной обеспеченности]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг бюджетной обеспеченности]
        )'
    member Measures.[Ранг бюджетной обеспеченности РФ]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Коэффициент бюджетной обеспеченности населения]
            ),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].[Субъект РФ].Members,
                        not IsEmpty
                        (
                            Measures.[Коэффициент бюджетной обеспеченности населения]
                        )
                    ),
                    Measures.[Коэффициент бюджетной обеспеченности населения],
                    BDESC
                ),
                Measures.[Коэффициент бюджетной обеспеченности населения]
            )
        )'
    member Measures.[Худший ранг бюджетной обеспеченности РФ]
    as 'max
        (
            [Территории].[Сопоставимый].[Субъект РФ].Members,
            Measures.[Ранг бюджетной обеспеченности РФ]
        )'
   member Measures.[Численность постоянного населения_Prev]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения_This]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '
    member Measures.[Коэффициент бюджетной обеспеченности населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения]
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Исполнено]/
            (
                Measures.[Численность постоянного населения]
                *1000
            )
        )'
member Measures.[Факт прошл] as '(Measures.[Исполнено], [КОСГУ].[Сопоставимый].[Все коды ЭКР], <%period_last_date%>)'
member Measures.[План прошл] as '(Measures.[Назначено], [КОСГУ].[Сопоставимый].[Все коды ЭКР], <%period_last_date%>)'
member Measures.[Темп роста Факт прошл] as 'IIF(IsEmpty(Measures.[Факт прошл]) or Measures.[Факт прошл] = 0, null, [Measures].[Исполнено]/Measures.[Факт прошл])'
member Measures.[Темп роста План прошл] as 'IIF(IsEmpty(Measures.[План прошл]) or Measures.[План прошл] = 0, null, [Measures].[Назначено]/Measures.[План прошл])'
select
    {
[Measures].[Процент выполнения назначений],
[Measures].[Исполнено],
[Measures].[Назначено],
        Measures.[Ранг процент],
        Measures.[Худший ранг процент],
        Measures.[Ранг процент РФ],
        Measures.[Худший ранг процент РФ],
        Measures.[Численность постоянного населения],
        Measures.[Коэффициент бюджетной обеспеченности населения],
        Measures.[Ранг бюджетной обеспеченности],
        Measures.[Худший ранг бюджетной обеспеченности],
        Measures.[Ранг бюджетной обеспеченности РФ],
        Measures.[Худший ранг бюджетной обеспеченности РФ],
        Measures.[Темп роста Факт прошл],
        Measures.[Темп роста План прошл]
    } on columns
from [ФК_МесОтч_Расходы]
where
    (
        <%period_day_fk%>,
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>],
        [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта]
    )
  ]]>
  </query>

  <query id="FK_0001_0003_v">
    <![CDATA[
-- FK_0001_0002_iphone_V         
with
   member Measures.[Численность постоянного населения_Prev]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения_This]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '
    member Measures.[Коэффициент бюджетной обеспеченности населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения]
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Исполнено]/
            (
                Measures.[Численность постоянного населения]
                *1000
            )
        )'
    member Measures.[Ранг процент]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Процент выполнения назначений]
            ) or not([Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ"),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            [Measures].[Процент выполнения назначений]
                        )
                    ),
                    [Measures].[Процент выполнения назначений],
                    DESC
                ),
                [Measures].[Процент выполнения назначений]
            )
        )'
    member Measures.[Худший ранг процент]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг процент]
        )'
    member Measures.[Ранг бюджетной обеспеченности]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Коэффициент бюджетной обеспеченности населения]
            ) or not([Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ"),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            Measures.[Коэффициент бюджетной обеспеченности населения]
                        )
                    ),
                    Measures.[Коэффициент бюджетной обеспеченности населения],
                    DESC
                ),
                Measures.[Коэффициент бюджетной обеспеченности населения]
            )
        )'
    member Measures.[Худший ранг бюджетной обеспеченности]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг бюджетной обеспеченности]
        )'
    member Measures.[Сокращенное наименование]
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование")'
select
    {
        Measures.[Сокращенное наименование],
        [Measures].[Процент выполнения назначений],
        Measures.[Ранг процент],
        Measures.[Худший ранг процент],
        Measures.[Коэффициент бюджетной обеспеченности населения],
        Measures.[Ранг бюджетной обеспеченности],
        Measures.[Худший ранг бюджетной обеспеченности]
    } on columns,
    {
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>],
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>],
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация],
        {
          Filter
          (
              [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>].Siblings,
              not IsEmpty(Measures.[Исполнено])
          )
        } -
        {
          [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>]
        }
    } on rows
from [ФК_МесОтч_Расходы]
where
    (
        <%period_day_fk%>,
        [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта]
    )
  ]]>
</query>

<query id="FK_0001_0003_h">
<![CDATA[
-- FK_0001_0002_iphone_H 
with
   member Measures.[Численность постоянного населения_Prev]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения_This]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '
    member Measures.[Ранг процент]
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Процент выполнения назначений]
            ) or not([Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ"),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            [Measures].[Процент выполнения назначений]
                        )
                    ),
                    [Measures].[Процент выполнения назначений],
                    DESC
                ),
                [Measures].[Процент выполнения назначений]
            )
        )'
    member Measures.[Худший ранг процент]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг процент]
        )'
    member Measures.[Ранг бюджетной обеспеченности]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Коэффициент бюджетной обеспеченности населения]
            ) or not([Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ"),
            null,
            Rank
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty
                        (
                            Measures.[Коэффициент бюджетной обеспеченности населения]
                        )
                    ),
                    Measures.[Коэффициент бюджетной обеспеченности населения],
                    DESC
                ),
                Measures.[Коэффициент бюджетной обеспеченности населения]
            )
        )'
    member Measures.[Худший ранг бюджетной обеспеченности]
    as 'max
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг бюджетной обеспеченности]
        )'
    member Measures.[Коэффициент бюджетной обеспеченности населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения]
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Исполнено]/
            (
                Measures.[Численность постоянного населения]
                *1000
            )
        )'
    member Measures.[Сокращенное наименование]
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование")'
select
    {
        Measures.[Сокращенное наименование],
        Measures.[Исполнено],
        [Measures].[Процент выполнения назначений],
        Measures.[Ранг процент],
        Measures.[Худший ранг процент],
        Measures.[Численность постоянного населения],
        Measures.[Коэффициент бюджетной обеспеченности населения],
        Measures.[Ранг бюджетной обеспеченности],
        Measures.[Худший ранг бюджетной обеспеченности]
    } on columns,
    {
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>],
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>],
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация],
        {
          Filter
          (
              [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>].Siblings,
              not IsEmpty(Measures.[Исполнено])
          )
        } -
        {
          [Территории].[Сопоставимый].[Все территории].[Российская  Федерация].[<%region%>].[<%state_area%>]
        }
    } on rows
from [ФК_МесОтч_Расходы]
where
    (
        <%period_day_fk%>,
        [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО],
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта]
    )
  ]]>
  </query>

</root>