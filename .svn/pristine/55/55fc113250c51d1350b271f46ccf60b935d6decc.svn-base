<?xml version="1.0" encoding="Windows-1251"?>
<root>
  
<query id="FO_0002_0013_01_date">
<![CDATA[
-- FO_0002_0013_01_date
with
    member [Measures].[ДанныеНа]
    as '<%period_dimension%>.CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                <%period_dimension%>.Members,
                not IsEmpty([Measures].[Факт])
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_МесОтч_Доходы]
]]>
</query>

<query id="FO_0002_0013_01_grid">
    <![CDATA[
-- FO_0002_0013_01_grid
With   
    set [Города]   
    as 'Filter   
        (
            Descendants   
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF   
            ),
            not   
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember   
            ) and   
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"   
            )   
        )'   
    set [Районы]   
    as 'Filter   
        (
            Descendants   
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF   
            ),
            not   
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember   
            ) and   
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР"   
            )   
        )'   

   member [Районы].[Сопоставимый].[Консолидированный бюджет субъекта]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_budget%>,
                    <%consolidate_budget_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_budget%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_budget%>,
                <%consolidate_budget_document_skif_type%>
            )
        )'
    
    member [Районы].[Сопоставимый].[<%own_subject_budget_name%>]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_budget%>,
                    <%consolidate_budget_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_budget%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_budget%>,
                <%consolidate_budget_document_skif_type%>
            )
        )'
    
    member [Районы].[Сопоставимый].[Местные бюджеты]
    as 'IIF
        (
            IsEmpty
            (
                (
                    <%regions_consolidate_budget%>,
                    <%consolidate_budget_document_skif_type%>
                )
            ),
            (
                <%regions_consolidate_budget%>,
                [ТипДокумента].[СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов, районов и поселений (5+6+7+8)]
            ),
            (
                <%regions_consolidate_budget%>,
                <%consolidate_budget_document_skif_type%>
            )
        )'   
 
    member [Уровни бюджета].[СКИФ].[Уровень бюджета ]   
    as 'IIF   
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта],
            IIF   
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>],
                [Уровни бюджета].[СКИФ].[Все].[Бюджет субъекта],
                <%region_budget_skif_level%>  
            )   
        ) ' 
    member [Уровни бюджета].[СКИФ].[Бюджет гор.округа, мун.района и поселения] 
    as 'Aggregate
        (
          {
            [Уровни бюджета].[СКИФ].[Бюджет поселения],
            [Уровни бюджета].[СКИФ].[Бюджет гор.округа],
            [Уровни бюджета].[СКИФ].[Бюджет района]
          }
        )'         
    member [Районы].[Сопоставимый].[Городские округа ] 
    as 'Sum 
        (
            [Города],
            (
                [Measures].CurrentMember,
                <%period_dimension%>.CurrentMember
            ) 
        )' 
    member [Районы].[Сопоставимый].[Муниципальные районы ] 
    as 'Sum 
        (
            [Районы],
            (
                [Measures].CurrentMember,
                <%period_dimension%>.CurrentMember
            ) 
        )' 
    member <%fkr_dimension%>.[РАСХОДЫ ВСЕГО ] 
    as 'Aggregate 
        (
            {<%fkr_dimension%>.[Оплата труда с начислениями ], <%fkr_dimension%>.[Капитальные вложения ], <%fkr_dimension%>.[Иные расходы ]}
        )' 
    member <%ekr_dimension%>.[Оплата труда_]    
    as '
        Sum
        (
            Filter
            (
                Descendants
                (
                    <%ekr_dimension%>.[Все коды ЭКР],
                    <%ekr_dimension%>.[Статья],
                    SELF
                ) +
                Descendants
                (
                    <%ekr_dimension%>.[Все коды ЭКР],
                    <%ekr_dimension%>.[Подстатья],
                    SELF
                ),
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "211" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "213"
            ) 
        )
       '
    member <%fkr_dimension%>.[Оплата труда с начислениями ] 
    as ' 
        (
            <%ekr_dimension%>.[Оплата труда_],
            <%fkr_dimension%>.[FKRSlicer] 
        )' 
    member <%fkr_dimension%>.[Капитальные вложения ] 
    as ' 
        (
            Filter
            (
                Descendants
                (
                    <%ekr_dimension%>.[Все коды ЭКР],
                    <%ekr_dimension%>.[Статья],
                    SELF
                ) + Descendants
                (
                    <%ekr_dimension%>.[Все коды ЭКР],
                    <%ekr_dimension%>.[Подстатья],
                    SELF
                ),
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "310"
            ).Item(0),
            <%fkr_dimension%>.[FKRSlicer]
        )' 
    member <%ekr_dimension%>.[Иные расходы_] 
    as 'Sum
        (
            Filter
            (
                Descendants
                (
                    <%ekr_dimension%>.[Все коды ЭКР],
                    <%ekr_dimension%>.[Статья],
                    SELF
                ) +
                Descendants
                (
                    <%ekr_dimension%>.[Все коды ЭКР],
                    <%ekr_dimension%>.[Подстатья],
                    SELF
                ),
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "212" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "220" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "230" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "240" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "250" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "260" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "290" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "320" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "330" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "340" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "500" or
                <%ekr_dimension%>.CurrentMember.Properties("Код") = "600"
            ) 
        )
           ' 
    member <%fkr_dimension%>.[Иные расходы ] 
    as ' 
        (
            <%ekr_dimension%>.[Иные расходы_],
            <%fkr_dimension%>.[FKRSlicer] 
        )' 
    member <%fkr_dimension%>.[ДЕФИЦИТ/ПРОФИЦИТ] 
    as 'LookupCube 
        (
            "[ФО_МесОтч_Дефицит Профицит]",
            " 
            (
                " + MemberToStr ( [Measures].CurrentMember ) + ",
                " + MemberToStr 
                (
                    [Районы].[Сопоставимый].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Период].[Период].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [ТипДокумента].[СКИФ].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Уровни бюджета].[СКИФ].CurrentMember 
                ) + " 
            )" 
        )' 
    member <%fkr_dimension%>.[Налоговые и неналоговые доходы ] 
    as 'LookupCube 
        (
            "[ФО_МесОтч_Доходы]",
            " 
            (
                <%incomes_kd_all_level%>.[<%incomes_kd_root_name%>],
                " + MemberToStr ( [Measures].CurrentMember ) + ",
                " + MemberToStr 
                (
                    [Районы].[Сопоставимый].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Период].[Период].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [ТипДокумента].[СКИФ].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Уровни бюджета].[СКИФ].CurrentMember 
                ) + " 
            )" 
        )' 
    member <%fkr_dimension%>.[Безвозмездные поступления ] 
    as 'LookupCube 
        (
            "[ФО_МесОтч_Доходы]",
            " 
            (
                <%incomes_kd_all_level%>.[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ],
                " + MemberToStr ( [Measures].CurrentMember ) + ",
                " + MemberToStr 
                (
                    [Районы].[Сопоставимый].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Период].[Период].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [ТипДокумента].[СКИФ].CurrentMember 
                ) + ",
                " + MemberToStr 
                (
                    [Уровни бюджета].[СКИФ].CurrentMember 
                ) + " 
            )" 
        )' 
    member <%fkr_dimension%>.[ДОХОДЫ ВСЕГО ] 
    as 'LookupCube    
        (
            "[ФО_МесОтч_Доходы]",
            "    
            (
                <%incomes_all%>,
                " + MemberToStr ( [Measures].CurrentMember ) + ",
                " + MemberToStr    
                (
                    [Районы].[Сопоставимый].CurrentMember    
                ) + ",
                " + MemberToStr    
                (
                    [Период].[Период].CurrentMember    
                ) + ",
                " + MemberToStr    
                (
                    [ТипДокумента].[СКИФ].CurrentMember    
                ) + ",
                " + MemberToStr    
                (
                    [Уровни бюджета].[СКИФ].CurrentMember    
                ) + "    
            )"    
        )'    
    member <%fkr_dimension%>.[FKRSlicer] 
    as '
      Aggregate
      (
        {
            Filter
            (
                <%fkr_all_level%>.Children,
                <%fkr_dimension%>.CurrentMember.Properties("Код") <> "9700" and
                <%fkr_dimension%>.CurrentMember.Properties("Код") <> "9600"
            )
        }
     )' 
    member Measures.[% выполнения годовых назначений ]  
    as '
            IIF
            (
                IsEmpty 
                (
                    (
                        [Районы].[Сопоставимый].CurrentMember,
                        [Measures].[Годовые назначения] 
                    ) 
                ) or  
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    [Measures].[Годовые назначения] 
                ) = 0,
                null,
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    [Measures].[Факт] 
                ) /  
                (
                    [Районы].[Сопоставимый].CurrentMember,
                    [Measures].[Годовые назначения] 
                )  
            )'     
    member [ТипДокумента].[СКИФ].[Тип документа ] 
    as 'IIF
        (
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[Консолидированный бюджет субъекта] or
            [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].[<%own_subject_budget_name%>] ,
            [ТипДокумента].[СКИФ].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
            <%region_budget_document_skif_type%>
        )'    
    member [КОСГУ].[Сопоставимый].[KOSGUSlicer]
    as 'IIF
        (
            <%fkr_dimension%> is <%fkr_dimension%>.[ДОХОДЫ ВСЕГО ] or
            <%fkr_dimension%> is <%fkr_dimension%>.[Налоговые и неналоговые доходы ] or
            <%fkr_dimension%> is <%fkr_dimension%>.[Безвозмездные поступления ] or
            <%fkr_dimension%> is <%fkr_dimension%>.[Оплата труда с начислениями ] or
            <%fkr_dimension%> is <%fkr_dimension%>.[Капитальные вложения ] or
            <%fkr_dimension%> is <%fkr_dimension%>.[Иные расходы ] or
            <%fkr_dimension%> is <%fkr_dimension%>.[ДЕФИЦИТ/ПРОФИЦИТ],
            [КОСГУ].[Сопоставимый].DefaultMember,    
            Aggregate
            (
                Filter
                (
                   [КОСГУ].[Сопоставимый].[Все коды ЭКР].Children,
                   [КОСГУ].[Сопоставимый].CurrentMember.Properties("Код") <> "960"
                )
            )
        ) '         
SELECT
    {
        {
            {
                <%fkr_dimension%>.[ДОХОДЫ ВСЕГО ],
                <%fkr_dimension%>.[Налоговые и неналоговые доходы ],
                <%fkr_dimension%>.[Безвозмездные поступления ],
                <%fkr_dimension%>.[РАСХОДЫ ВСЕГО ],
                <%fkr_dimension%>.[Оплата труда с начислениями ],
                <%fkr_dimension%>.[Капитальные вложения ],
                <%fkr_dimension%>.[Иные расходы ],
                <%fkr_dimension%>.[ДЕФИЦИТ/ПРОФИЦИТ]
            }    
            *    
            {
                [Measures].[Годовые назначения],
                [Measures].[Факт],
                [Measures].[% выполнения годовых назначений ]    
            }    
        }    
    } on columns,
    {
        {
            [Районы].[Сопоставимый].[Консолидированный бюджет субъекта],
            [Районы].[Сопоставимый].[<%own_subject_budget_name%>]    
        } +    
        {
            [Районы].[Сопоставимый].[Городские округа ]    
        } + [Города] +    
        {
            [Районы].[Сопоставимый].[Муниципальные районы ]    
        } + [Районы]    
    } on rows    
FROM [ФО_МесОтч_Расходы]    
WHERE    
    (
        <%period_dimension%>.[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        [ТипДокумента].[СКИФ].[Тип документа ],
        [Уровни бюджета].[СКИФ].[Уровень бюджета ]
    )     
  ]]>
      </query>

    </root>