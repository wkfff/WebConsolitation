<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="ORG_0003_0018_list_of_dates">
    <![CDATA[ -- name: ORG_0003_0018_list_of_dates
    with 
 member [Measures].[uniqueName]
 as '[Период__День].[Период__День].currentmember.uniqueName'
select
    {
    [Measures].[uniqueName],
    [Measures].[Средняя цена]} on columns,
    {
        filter
        (  
            [Период].[День].[День].members,
            [Measures].[Средняя цена] > 0
        )
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where 
    (   [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра],
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Ежемесячная отч],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена],
        [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары])
    ]]>
  </query>

  <query id ="ORG_0003_0018_list_of_food">
    <![CDATA[ -- name:ORG_0003_0018_list_of_food
with
member [Measures].[Единица измерения]
as '[Организации].[Товары и услуги].CurrentMember.Properties("Единица измерения")'

member [Measures].[Uname]
as '[Организации].[Товары и услуги].CurrentMember.UniqueName'


select
    {[Measures].[Средняя цена], [Measures].[Единица измерения],[Measures].[Uname]} on columns,
    {
        Except(
        filter
        (
            descendants 
            (
                [Организации].[Товары и услуги].[Все товары и услуги].[Продовольственные товары],
                [Организации].[Товары и услуги].[Уровень 3]
            ),
            [Measures].[Средняя цена] > 0
        )
        +
        {
        filter([Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Моющие средства].children,
        not [Организации__Товары и услуги].[Организации__Товары и услуги].currentmember.is_datamember)}
        +{[Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Прочие непродовольственные товары].[Сигареты с фильтром отечественные]}
        ,{[Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Продовольственные товары].[Молочная продукция].[Молоко цельное пастеризованное стерилизованное (2,5-3,2 % жирности.)]})
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Территории].[РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра],
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Ежемесячная отч],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена]
    )
    ]]>
  </query>

  <query id = "ORG_0003_0018_grid">
    <![CDATA[ -- ORG_0003_0018_grid
with 
 member [Территории__РФ].[Территории__РФ].[Ханты-Мансийский автономный округ - Югра ]
 as '[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].datamember'
select
    CrossJoin
    (
        {
            <%selected_date%>,                                    
            <%previous_date%>,
            <%year_date%>
            
        },
        {[Measures].[Средняя цена]}
    ) on columns,
    non empty 
    {
        --{[Территории__РФ].[Территории__РФ].[Ханты-Мансийский автономный округ - Югра ]}+
        filter 
        (
            descendants
            (
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра],
                [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ], SELF_AND_BEFORE
            ),
            ([Measures].[Средняя цена] > 0) and
            ((
                [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
            ) or (IsLeaf([Территории__РФ].[Территории__РФ].CurrentMember) and ([Территории__РФ].[Территории__РФ].CurrentMember.Level.UniqueName = [Территории__РФ].[Территории__РФ].[МР ГО].UniqueName)))
        ) 
    } on rows 
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Ежемесячная отч],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена],
        <%selected_food%>
    )
    ]]>
  </query>

  <query id = "ORG_0003_0018_chart">
    <![CDATA[ -- ORG_0003_0018_chart
select
    { [Measures].[Средняя цена] } on columns,
    non empty order
    (
        {
            filter
            (
                descendants
                (
                    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра],
                    [Территории__РФ].[Территории__РФ].[ГП СП ВТГФЗ],
                    SELF_AND_BEFORE
                ),
                ([Measures].[Средняя цена] > 0) and
                (
                    (
                        [Территории__РФ].[Территории__РФ].CurrentMember is [Территории__РФ].[Территории__РФ].CurrentMember.Parent.DataMember
                    ) or
                    (
                        IsLeaf
                        (
                            [Территории__РФ].[Территории__РФ].CurrentMember
                        ) and
                        (
                            [Территории__РФ].[Территории__РФ].CurrentMember.Level.UniqueName = [Территории__РФ].[Территории__РФ].[МР ГО].UniqueName
                        )
                    )
                )
            )
        },
        ([Measures].[Средняя цена]),
        asc
    ) on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Ежемесячная отч],
        [Организации].[Предприятия торговли].[Все организации].[Значение не указано],
        [Организации].[Тип цены].[Все типы цен].[Розничная цена],
        <%selected_date%>,
        <%selected_food%>
    )
    ]]>
  </query>
  <query id = "ORG_0003_0018_chart_line">
    <![CDATA[-- ORG_0003_0018_chart_line
select
    {[Measures].[Значение]} on columns,
    {
    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Тюменская область с Ханты-Мансийским автономным округом, Ямало-Ненецким автономным округом].[Ханты-Мансийский автономный округ - Югра].datamember
    } on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where(
<%selected_date%>,
<%IndexInf%>)
    ]]>
  </query>

</root>