<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id="Regions">
    <![CDATA[
--STAT_0003_0005 Regions
select
   { [Measures].[Нарастающий итог] } on columns,
    {

[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.],
        filter
        (
            {
                [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].children
            },
            Right
            (
                [Территории__РФ].[Территории__РФ].Currentmember.UniqueName,
                10
            ) <> "DATAMEMBER"
        )
    } on rows
from   [СТАТ_Население_Естественное движение]
where ([Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся],
[Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - Статистический раздел]
) ]]>
  </query>
  <query id="Date">
    <![CDATA[
--STAT_0003_0005 Date
select
   { [Measures].[Нарастающий итог]} on columns,
   non empty {
   filter
   (
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].members,
                    Right
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].Currentmember.UniqueName,
                10
            ) <> "DATAMEMBER"
        )
    } on rows
from   [СТАТ_Население_Естественное движение]
where ([Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся],
[Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - Статистический раздел]
)    ]]>
</query>
<query id="Grid1">
    <![CDATA[
--STAT_0003_0005 Grid1 
with 
    member [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Естественный прирост населения] 
    as '[Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся]- [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших]' 
         member [Measures].[на начало года прирост]
    as 'IIF
        (
            (
                head
                (
                    filter
                    (
                        descendants
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц]
                        ),
                        not isempty( [Measures].[Нарастающий итог])
                    ),
                    1
                ).Item(0).Uniquename<>[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Uniquename
            ),
            -
            (
                (
                    head
                    (
                        filter
                        (
                            descendants
                            (
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent,
                                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц]
                            ),
                            not isempty([Measures].[Нарастающий итог])
                        ),
                        1
                    ).Item(0),
                    [Measures].[Нарастающий итог]
                )-[Measures].[Нарастающий итог]
            ),
            null
        )'
    member [Measures].[на начало года темп прироста]
    as ' IIF
        (
            (
                head
                (
                    filter
                    (
                        descendants
                        (
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent,
                            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц]
                        ),
                        not isempty( [Measures].[Нарастающий итог])
                    ),
                    1
                ).Item(0).Uniquename<>[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Uniquename
            ),
            (
                IIF
                (
                    (
                       (
                            head
                            (
                                filter
                                (
                                    descendants
                                    (
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent,
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц]
                                    ),
                                    not isempty([Measures].[Нарастающий итог])
                                ),
                                1
                            ).Item(0),
                            [Measures].[Нарастающий итог]
                        )>0
                    ) ,
                    (
                        [Measures].[Нарастающий итог]/
                        (
                            head
                            (
                                filter
                                (
                                    descendants
                                    (
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent,
                                        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц]
                                    ),
                                    not isempty([Measures].[Нарастающий итог])
                                ),
                                1
                            ).Item(0),
                            [Measures].[Нарастающий итог]
                        )-1
                    ),
                    null
                )
            ),
            null
        ) '
    member [Measures].[к предыдущему периоду прирост] 
    as '[Measures].[Прирост цепной]' 
    member [Measures].[к предыдущему периоду темп прироста] 
    as '[Measures].[Темп прироста цепной]' 
    
    member [Measures].[к аналогичному периоду прошлого года прирост] 
    as '[Measures].[Прирост базисный]' 
    member [Measures].[к аналогичному периоду прошлого года темп прироста] 
    as '[Measures].[Темп прироста базисный]' 
select
    {
        {

       
        {
            <%selectedDate%>
            }    

        }
        
    } on columns,
    {
       { [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся],
       [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число мертворожденных],
        [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших],
        [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших детей в возрасте до 1 года],
            [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Естественный прирост населения]
        }
        *
        {
            [Measures].[Нарастающий итог],
            [Measures].[<%compareType%> прирост],
            [Measures].[<%compareType%> темп прироста]
        }
    } on rows 
from   [СТАТ_Население_Естественное движение] 
where 
    (
        <%baseRegion%>,
    --    [Группировки__Население_Численность и состав].[Группировки__Население_Численность и состав].[Все группировки].[По городам и районам],
        [Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - Статистический раздел],
        [Тип местности],
        [Половая принадлежность],
        [ОК__Основные возрастные группы],
        [ОК__Отдельные возрастные группы] 
    ) 
   ]]>
  </query>
  <query id="Grid2">
    <![CDATA[
    --Grid2
    with 
    member [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Численность] 
    as 'IIF
        (
            (
               [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Среднегодовая численность населения]
            )<>null,
            [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Среднегодовая численность населения],
            [Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Численность населения на начало года]
        )'  
select
    {
        {[Население__Численность и состав].[Население__Численность и состав].[Все показатели].[Численность]}*
        {
          <%baseRegion%>,
          [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.]
        }
    } on columns,
    {
        <%selectedYears%> 
    } on rows 
from    [СТАТ_Население_Численность и состав] 
where 
    (

        [Группировки__Население_Численность и состав].[Группировки__Население_Численность и состав].[Все группировки].[По городам и районам],
        [Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - Статистический раздел],
        [Тип местности],
        [Половая принадлежность],
        [ОК__Основные возрастные группы],
        [ОК__Отдельные возрастные группы],
        [Measures].[Нарастающий итог] 
    )  ]]>
  </query>

  <query id="Chart1">
    <![CDATA[
    --STAT_0003_0005 chart1
with 
    member [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Естественный прирост населения] 
    as '[Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся]- [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших]'  
select
    {
        {
            <%chartPok%>
        }
        
    } on columns,
  non empty  {
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц].members
    } on rows 
from   [СТАТ_Население_Естественное движение] 
where 
    (
        [Measures].[Нарастающий итог],
        <%baseRegion%>,
       [Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - Статистический раздел],
        [Тип местности],
        [Половая принадлежность],
        [ОК__Основные возрастные группы],
        [ОК__Отдельные возрастные группы] 
    ) 
 ]]>
  </query>

  <query id="Grid_Description">
    <![CDATA[
--STAT_0003_0005 grid_description  
with  
    member [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Естественный прирост населения]  
    as '[Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся]- [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших]'  
    member [Measures].[на начало года]  
    as 'head  
        (
            filter  
            (
                descendants  
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Parent,
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц]  
                ),
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся]
                ) > 0 or
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших]
                ) > 0 or
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Естественный прирост населения]
                ) > 0  or
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число мертворожденных]
                ) > 0 or
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших детей в возрасте до 1 года]
                ) > 0
            ),
            1  
        ).Item(0).Uniquename'  
    member [Measures].[к предыдущему периоду]  
    as 'Tail  
        (
            Filter  
            (
                {
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[1998].[Полугодие 1].[Квартал 1].[Январь]:[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                } -  
                {
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember  
                },
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число родившихся]  
                ) > 0 or  
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших]  
                ) > 0 or  
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Естественный прирост населения]  
                ) > 0  or
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число мертворожденных]
                ) > 0 or
                (
                    [Measures].[Нарастающий итог],
                    [Население__Естественное движение].[Население__Естественное движение].[Все показатели].[Число умерших детей в возрасте до 1 года]
                ) > 0
            ),
            1  
        ).Item(0).Uniquename'  
    member [Measures].[к аналогичному периоду прошлого года] 
    as 'ParallelPeriod
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Год],
            1,
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
        ).UniqueName'
    member [Measures].[Текущая дата]  
    as ' 
        (
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName 
        )'  
select
    {
        <%selectedDate%> 
    } on columns,
    {
        [Measures].[Текущая дата],
        [Measures].[<%compareType%>]  
    } on rows  
from  [СТАТ_Население_Естественное движение]  
where  
    (
        <%baseRegion%>,
        [Источники данных].[Источники данных].[Источник].[СТАТ Отчетность - Статистический раздел],
        [Тип местности],
        [Половая принадлежность],
        [ОК__Основные возрастные группы],
        [ОК__Отдельные возрастные группы]  
    )  
 ]]>
  </query>
</root>