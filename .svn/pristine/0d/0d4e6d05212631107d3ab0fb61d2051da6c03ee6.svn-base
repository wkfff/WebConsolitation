<?xml version="1.0" encoding="Windows-1251"?>
<root>
  
  <query id="Oil_0005_0001_date">
    <![CDATA[ -- Oil_0005_0001_date
with
    member [Measures].[Дата]
    as '[Период__День].[Период__День].CurrentMember.UniqueName'
    member [Measures].[Ключ]
    as '[Период__День].[Период__День].CurrentMember.Properties("MEMBER_KEY")'
    set [Даты]
    as 'order
        (
            tail
            (
                filter
                (
                    [Период__День].[Период__День].[День].Members,
                    [Measures].[Цена] > 0 and not IsEmpty([Measures].[Цена])
                ),
                2
            ),
            [Measures].[Ключ],
            desc
        )'
select
    [Measures].[Дата] on columns,
    [Даты] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
        {
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-80],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-92],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-95],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Дизельное топливо]
        },
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ]
    )
    ]]>
  </query>

  <query id="Oil_0005_0001_data">
    <![CDATA[ -- Oil_0005_0001_data
with
    set [Территории]
    as 'filter
        (
            Descendants
            (
                [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                [Территории__Сопоставимый].[Территории__Сопоставимый].[ГП СП ВТГФЗ],
                LEAVES
            ),
            not IsEmpty ([Measures].[Цена])
        )'
    set [Организации]
    as 'filter
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            not IsEmpty
            (
                [Measures].[Средняя по организации]
            )
        )'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории],
            ( [Measures].[Цена ] )
        )'
    member [Measures].[Цена ]
    as '
        (
            [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
            [Measures].[Цена],
            [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            <%date%>,
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.DataMember,
            [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
        )'
    set [ГСМ]
    as '
        {
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-80],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-92],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-95],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Дизельное топливо]
        }'
select
    [ГСМ] on columns,
    [Организации] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Measures].[Средняя по организации]
    )
    ]]>
  </query>

  <query id="Oil_0005_0001_v_text">
    <![CDATA[ -- Oil_0005_0001_v_text
with
    set [Территории]
    as 'order
        (
            filter
            (
                Descendants
                (
                    [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
                    [Территории__Сопоставимый].[Территории__Сопоставимый].[МР ГО],
                    SELF
                ),
                not [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember is [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Parent.DataMember and
                not IsEmpty(([Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember, [Measures].[Средняя по МО на последнюю дату]))
            ),
            [Measures].[Средняя по МО на последнюю дату]
        )'
    set [Организации]
    as '[Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children'
    member [Measures].[Город]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[МР]
    as 'iif
        (
            [Measures].[Уровень] = "МР ГО" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count > 0,
            true,
            false
        )'
    member [Measures].[ГП СП]
    as 'iif
        (
            [Measures].[Уровень] = "ГП СП ВТГФЗ" and [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children.Count = 0,
            true,
            false
        )'
    member [Measures].[Средняя розничная цена_Город]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена_МР]
    as 'avg
        (
            [Организации],
            [Measures].[Средняя по организации]
        )'
    member [Measures].[Средняя по организации]
    as 'avg
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Children,
            ( [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember, [Measures].[Цена] )
        )'
    member [Measures].[Средняя розничная цена_ГП СП]
    as 'avg
        (
            [Организации],
            [Measures].[Цена]
        )'
    member [Measures].[Средняя розничная цена]
    as 'iif
        (
            [Measures].[Город],
            [Measures].[Средняя розничная цена_Город],
            iif
            (
                [Measures].[МР],
                [Measures].[Средняя розничная цена_МР],
                iif
                (
                    [Measures].[ГП СП],
                    [Measures].[Средняя розничная цена_ГП СП],
                    null
                )
            )
        )'
    member [Measures].[Средняя по МО на последнюю дату]
    as '
        (
            <%last_date%>,
            [Measures].[Средняя розничная цена]
        )'
    member [Measures].[Средняя розничная цена на предыдущую дату]
    as '
        (
            <%prev_date%>,
            [Measures].[Средняя розничная цена]
        )'
    member [Measures].[Темп роста по МО]
    as 'iif(not IsEmpty([Measures].[Средняя по МО на последнюю дату]) and not IsEmpty([Measures].[Средняя розничная цена на предыдущую дату]) and
    [Measures].[Средняя розничная цена на предыдущую дату] > 0,
    [Measures].[Средняя по МО на последнюю дату] / [Measures].[Средняя розничная цена на предыдущую дату],
    null)'
    member [Measures].[Уровень]
    as '[Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.Level.Name'
    member [Measures].[Темп роста по субъекту]
    as 'iif([Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember is [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-80],
    <%grown_80%>,
    iif([Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember is [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-92],
    <%grown_92%>,
    iif([Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember is [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-95],
    <%grown_95%>,
    iif([Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember is [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[[Дизельное топливо],
    <%grown_DT%>,
    null))))'
    set [ГСМ]
    as '
        {
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-80],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-92],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-95],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Дизельное топливо]
        }'
select
    {
        [Measures].[Средняя по МО на последнюю дату],
        [Measures].[Темп роста по МО]
    } on columns,
    non empty Generate
    (
        [ГСМ],
        {
            [Организации__Товары и услуги].[Организации__Товары и услуги].CurrentMember
        }
        * head
        (
            order
            (
                filter
                (
                    [Территории],
                    [Measures].[Темп роста по МО] > [Measures].[Темп роста по субъекту] and [Measures].[Темп роста по МО] > 1
                ),
                [Measures].[Темп роста по МО],
                desc
            ),
            2
        )
    )  on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )    
    ]]>
  </query>

  <query id="Oil_0005_0001_v_grid_hmao">
    <![CDATA[ -- Oil_0005_0001_v_grid_hmao
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Цена],
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.DataMember,
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Цена],
            [Территории__Сопоставимый].[Территории__Сопоставимый].CurrentMember.DataMember,
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].CurrentMember,
            <%prev_date%>
        )'
    member [Measures].[Средняя по МО на последнюю дату]
    as 'Avg
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            [Measures].[Цена на последнюю дату]
        )'
    member [Measures].[Средняя по МО на предыдущую дату]
    as 'Avg
        (
            [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации].Children,
            [Measures].[Цена на предыдущую дату]
        )'
    member [Measures].[Средняя по субъекту на последнюю дату]
    as 'Avg
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].Children,
            [Measures].[Средняя по МО на последнюю дату]
        )'
    member [Measures].[Средняя по субъекту на предыдущую дату]
    as 'Avg
        (
            [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ].Children,
            [Measures].[Средняя по МО на предыдущую дату]
        )'
    member [Measures].[Темп прироста]
    as 'iif(not IsEmpty([Measures].[Средняя по субъекту на последнюю дату]) and ([Measures].[Средняя по субъекту на последнюю дату] > 0) and
    not IsEmpty([Measures].[Средняя по субъекту на предыдущую дату]) and ([Measures].[Средняя по субъекту на предыдущую дату] > 0),
    [Measures].[Средняя по субъекту на последнюю дату] / [Measures].[Средняя по субъекту на предыдущую дату] - 1,
    null)'
    member [Measures].[Прирост]
    as 'iif(not IsEmpty([Measures].[Средняя по субъекту на последнюю дату]) and ([Measures].[Средняя по субъекту на последнюю дату] > 0) and
    not IsEmpty([Measures].[Средняя по субъекту на предыдущую дату]) and ([Measures].[Средняя по субъекту на предыдущую дату] > 0),
    [Measures].[Средняя по субъекту на последнюю дату] - [Measures].[Средняя по субъекту на предыдущую дату],
    null)'
    set [ГСМ]
    as '
        {
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-80],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-92],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-95],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Дизельное топливо]
        }'
select
    {[Measures].[Средняя по субъекту на последнюю дату], [Measures].[Средняя по субъекту на предыдущую дату], [Measures].[Прирост], [Measures].[Темп прироста]} on columns,
    [ГСМ] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена]
    )    
    ]]>
  </query>

  <query id="Oil_0005_0001_v_grid_rf">
    <![CDATA[ -- Oil_0005_0001_v_grid_rf
with
    member [Measures].[Цена на последнюю дату]
    as '
        (
            [Measures].[Цена],
            <%last_date%>
        )'
    member [Measures].[Цена на предыдущую дату]
    as '
        (
            [Measures].[Цена],
            <%prev_date%>
        )'
    member [Measures].[Прирост]
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) or IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) or [Measures].[Цена на предыдущую дату] = 0 or [Measures].[Цена на последнюю дату] = 0,
            null,
            [Measures].[Цена на последнюю дату] - [Measures].[Цена на предыдущую дату]
        )'
    member [Measures].[Темп прироста]
    as 'iif
        (
            IsEmpty
            (
                [Measures].[Цена на последнюю дату]
            ) or IsEmpty
            (
                [Measures].[Цена на предыдущую дату]
            ) or [Measures].[Цена на предыдущую дату] = 0 or [Measures].[Цена на последнюю дату] = 0,
            null,
            [Measures].[Цена на последнюю дату] / [Measures].[Цена на предыдущую дату] - 1
        )'
    member [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин марки АИ-80]
    as '[Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)]'
    member [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин марки АИ-92]
    as '[Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)]'
    member [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин марки АИ-95]
    as '[Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше]'
    set [ГСМ]
    as '
        {
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин марки АИ-80],
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин марки АИ-92],
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин марки АИ-95],
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Дизельное топливо]
        }'
select
    {[Measures].[Цена на последнюю дату], [Measures].[Цена на предыдущую дату], [Measures].[Прирост], [Measures].[Темп прироста]} on columns,
    [ГСМ] on rows
from [ФСГС_Цены РФ]
where
    (
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember
    )    
    ]]>
  </query>

  <query id="Oil_0005_0001_h_year">
    <![CDATA[ -- Oil_0005_0001_h_year
with
    member [Measures].[Дата]
    as '[Период__День].[Период__День].CurrentMember.UniqueName'
    set [Даты]
    as 'order
        (
            head
            (
                filter
                (
                    descendants
                    (
                        <%year%>,
                        [Период__День].[Период__День].[День]
                    ),
                    [Measures].[Цена] > 0 and not IsEmpty([Measures].[Цена])
                ),
                1
            ),
            [Measures].[Дата],
            asc
        )'
select
    [Measures].[Дата] on columns,
    [Даты] on rows
from [ОРГАНИЗАЦИИ_Цены и тарифы]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - ДЭ Еженедельная (поселения)],
        [Организации__Предприятия торговли].[Организации__Предприятия торговли].[Все организации],
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Розничная цена],
        {
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-80],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-92],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Бензин марки АИ-95],
            [Организации__Товары и услуги].[Организации__Товары и услуги].[Все товары и услуги].[Непродовольственные товары].[Горюче-смазочные материалы].[Дизельное топливо]
        },
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская Федерация].[Уральский федеральный округ].[Ханты-Мансийский автономный округ]
    )    
    ]]>
  </query>

  <query id="Oil_0005_0001_h_year_rf">
    <![CDATA[ -- Oil_0005_0001_h_year_rf
with
    member [Measures].[Дата]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [Даты]
    as 'order
        (
            head
            (
                filter
                (
                    descendants
                    (
                        <%year%>,
                        [Период__Период].[Период__Период].[День]
                    ),
                    [Measures].[Цена] > 0 and not IsEmpty([Measures].[Цена])
                ),
                1
            ),
            [Measures].[Дата],
            asc
        )'
select
    [Measures].[Дата] on columns,
    [Даты] on rows
from [ФСГС_Цены РФ]
where
    (
        [Организации__Тип цены].[Организации__Тип цены].[Все типы цен].[Средняя розничная цена],
        {
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Дизельное топливо],
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин автомобильный марки А-76 (АИ-80)],
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-92 (АИ-93 и т.п.)],
            [Продукция__Сопоставимый].[Продукция__Сопоставимый].[Все виды продукции].[Бензин автомобильный марки АИ-95 и выше]
        },
        [Территории__Сопоставимый].[Территории__Сопоставимый].[Все территории].[Российская  Федерация].DataMember
    )    
    ]]>
  </query>
  
</root>