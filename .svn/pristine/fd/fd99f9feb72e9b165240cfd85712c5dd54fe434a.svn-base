<?xml version="1.0" encoding="windows-1251"?>
<root>
  <query id="Years">
    <![CDATA[
select
    {      filter
            (
                [Период].[Год].Members,
                [Measures].[Оценка]>0
            ) } on columns,
    {
 [КЖН].[Ленинградская область].[Интегральный показатель],
            [КЖН].[Ленинградская область].[Интегральный показатель].children
    } on rows 
from  [ЭО_КЖН_Ленинградская область] 
where 
    (
        [Measures].[Оценка],
        <%baseRegion%>
    )  ]]>
  </query>
  <query id="Grid">
    <![CDATA[
    --Grid
select
    {
            [КЖН].[Ленинградская область].[Интегральный показатель],
            [КЖН].[Ленинградская область].[Интегральный показатель].children
    } on columns--,
   -- {
   ---    [Период].[Год].[Данные всех периодов].[<%curYear%>]
   -- } on rows  
from  [ЭО_КЖН_Ленинградская область]      
where      
    (
[Measures].[Оценка],
        <%baseRegion%>,
         [Период].[Год].[Данные всех периодов].[<%curYear%>]
    )]]>
  </query>
  <query id="Grid1">
    <![CDATA[
    --Grid1
    with 
    member [Measures].[Весовой коэффициент] 
    as   '[КЖН].[Ленинградская область].CurrentMember.Properties("Весовой коэффициент")' 
select
    {
            [КЖН].[Ленинградская область].[Интегральный показатель],
            [КЖН].[Ленинградская область].[Интегральный показатель].children
    } on columns--,
  --  {
   --    [Период].[Год].[Данные всех периодов].[<%curYear%>]
  --  } on rows  
from  [ЭО_КЖН_Ленинградская область]      
where      
    (
 [Measures].[Весовой коэффициент],
        <%baseRegion%>,
        [Период].[Год].[Данные всех периодов].[<%curYear%>]
        ) ]]>
  </query>
  <query id="Chart2">
    <![CDATA[
    --Chart2
select
 non empty  {

          [Период].[Год].[Данные всех периодов].[<%curYear%>]:[Период].[Год].[Данные всех периодов].[<%curYear%>].lag(4)
    } on columns,
    {
              [КЖН].[Ленинградская область].[Интегральный показатель]
    } on rows 
from  [ЭО_КЖН_Ленинградская область] 
where 
    (
        [Measures].[Оценка],
        <%baseRegion%> ) ]]>
  </query>
  <query id="Chart1">
    <![CDATA[
    --Chart1
with   
    member [Measures].[Весовой коэффициент] 
    as   '[КЖН].[Ленинградская область].CurrentMember.Properties("Весовой коэффициент")'     
select

        {
           order( {[КЖН].[Ленинградская область].[Интегральный показатель].children},([Measures].[Оценка]),asc)
        }
 
     on columns

from  [ЭО_КЖН_Ленинградская область]     
where     
    (
        [Measures].[Оценка] ,
        [Период].[Год].[Данные всех периодов].[<%curYear%>],
        <%baseRegion%>
    )   ]]>
  </query>
  <query id="Chart1_2">
    <![CDATA[
    --Chart1_2
with   
    member [Measures].[Весовой коэффициент] 
    as   '[КЖН].[Ленинградская область].CurrentMember.Properties("Весовой коэффициент")'     
select

        {
            [КЖН].[Ленинградская область].[Интегральный показатель]
        }
 
     on columns
from  [ЭО_КЖН_Ленинградская область]     
where     
    (
        [Measures].[Оценка] ,
        [Период].[Год].[Данные всех периодов].[<%curYear%>],
        <%baseRegion%>
    )   ]]>
  </query>
  <query id="Chart1_3">
    <![CDATA[
    --Chart1_3
with   
    member [Measures].[Весовой коэффициент] 
    as   '[КЖН].[Ленинградская область].CurrentMember.Properties("Весовой коэффициент")'     
select

        {
            order( {[КЖН].[Ленинградская область].[Интегральный показатель].children},([Measures].[Оценка]),asc)
        }
 
     on columns,
     { [Measures].[Весовой коэффициент] , [Measures].[Оценка] } on rows
from  [ЭО_КЖН_Ленинградская область]     
where     
    (
        [Период].[Год].[Данные всех периодов].[<%curYear%>],
        <%baseRegion%>
    )   ]]>
  </query>
  
</root>