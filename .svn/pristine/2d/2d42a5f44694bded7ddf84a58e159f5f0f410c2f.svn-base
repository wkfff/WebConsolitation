<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FO_0035_0026_date">
    <![CDATA[
-- FO_0035_0026_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Measures].[Сумма]
                    )
                ) and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from  [ФО_Реестр платежных поручений]   
  ]]>
  </query>

  <query id="FO_0035_0026_ReviewGrid">
    <![CDATA[
-- FO_0035_0026_ReviewGrid
with
    member [Состояние документа].[Состояние документа].[Глаз]
    as '"Глаз"'
    member Measures.[Уровень]
    as '[КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].CurrentMember.Level.Name'
    member Measures.[Платежные поручения на рассмотрении ФО.]
    as '
        (
            [Состояние документа].[Состояние документа].[Все].[Платежные поручения на рассмотрении ФО.],
            [Measures].[Сумма ]
        )'
    member Measures.[Доля в общей сумме]
    as 'IIF
        (
            not isEmpty
            (
                (
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Всего],
                    Measures.[Платежные поручения на рассмотрении ФО.]
                )
            ) and not
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Всего],
                Measures.[Платежные поручения на рассмотрении ФО.]
            ) = 0,
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].CurrentMember,
                Measures.[Платежные поручения на рассмотрении ФО.]
            ) /
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Всего],
                Measures.[Платежные поручения на рассмотрении ФО.]
            )
            ,
            null
        )'
    member Measures.[Платежные поручения проверены ФО (еще не санкционированы).]
    as '
        (
            [Состояние документа].[Состояние документа].[Все].[Платежные поручения проверены ФО (еще не санкционированы).],
            [Measures].[Сумма ]
        )'
    member Measures.[Проведенные платежные поручения.] 
    as '([Состояние документа].[Состояние документа].[Все].[Проведенные платежные поручения.],
    [Measures].[Сумма ],
         Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF
                ),
                not IsEmpty 
                    (
                        (
                            [Measures].[Сумма],
                            [Состояние документа].[Состояние документа].[Все].[Проведенные платежные поручения.],
[КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Всего]
                        ) 
                    ) and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        ).Item(0)
        )' 
    member [Measures].[Сумма ]
    as '[Measures].[Сумма] / 1000'
    member [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Всего]
    as 'aggregate
        (
            filter
            (
                Descendants
                (
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР],
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Статья],
                    SELF
                ),
                not  [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].CurrentMember is [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].CurrentMember.Parent.Datamember and not isEmpty ([Measures].[Сумма])
            )
        )'
    set [Косгу]
    as 'filter
        (
            Descendants
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР],
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Статья],
                SELF_AND_AFTER
            ),
   not  [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].CurrentMember is [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].CurrentMember.Parent.Datamember and (not isEmpty ([Measures].[Сумма])
 or not isEmpty ( Measures.[Платежные поручения на рассмотрении ФО.])
 or not isEmpty ( Measures.[Платежные поручения проверены ФО (еще не санкционированы).])
 or not isEmpty ( Measures.[Проведенные платежные поручения ]))
        )'
    member Measures.[Ранг процент]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Платежные поручения на рассмотрении ФО.]
            ),
            null,
            Rank
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].CurrentMember,
                Order
                (
                    [Косгу],
                    Measures.[Платежные поручения на рассмотрении ФО.],
                    BDESC
                ),
                Measures.[Платежные поручения на рассмотрении ФО.]
            )
        )
        '
    member Measures.[Проведенные платежные поручения ]    
    as '([Состояние документа].[Состояние документа].[Все].[Проведенные платежные поручения.],
     [Measures].[Сумма ],
    Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[День],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Состояние документа].[Состояние документа].[Все].[Проведенные платежные поручения.],
                        [Measures].[Сумма],			
			[Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все]
                    )
                ) and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца" and
                [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
            ),
            1
        ).Item(0))'    
SELECT
    {
        Measures.[Платежные поручения на рассмотрении ФО.],
        Measures.[Доля в общей сумме],
        Measures.[Платежные поручения проверены ФО (еще не санкционированы).],
        Measures.[Проведенные платежные поручения ],
        Measures.[Ранг процент],
        Measures.[Уровень]
    } on columns,
    {
        [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Всего],
        [Косгу]
    } ON rows
FROM  [ФО_Реестр платежных поручений]       
WHERE       
    (        
        <%selected_period%>,    
        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[<%grbs%>]
    )      
  ]]>
  </query>

    <query id="person">
        <![CDATA[
-- fo_0035_0001_data   
  with         
    member [Measures].[Имя ]   
    as ' [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].CurrentMember.Properties("Краткое наименование")' 
    member [Measures].[Сайт ] 
    as ' [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].CurrentMember.Properties("Сайт")' 
    member [Measures].[ФИО ] 
    as ' [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].CurrentMember.Properties("ФИО")' 
    member [Measures].[Телефон ] 
    as ' [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].CurrentMember.Properties("Телефон")' 
    member [Measures].[Адрес электронной почты ] 
    as ' [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].CurrentMember.Properties("Адрес электронной почты")' 
select
    {
        [Measures].[Имя ],
        [Measures].[Сайт ],
        [Measures].[ФИО ],
        [Measures].[Телефон ],
        [Measures].[Адрес электронной почты ]
    }   on columns,
    {
        [Администратор__ИспКасПланСопост].[Администратор__ИспКасПланСопост].[Все].[<%grbs%>]   
    }  on rows     
from [ФО_Реестр платежных поручений]          
where        
    (
       <%selected_period%>
    )  
  ]]>
    </query>
    
</root>