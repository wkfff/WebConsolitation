<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="fo_0042_0001_date">
    <![CDATA[
-- fo_0042_0001_date
with 
    member [Measures].[ДанныеНа] 
    as '[Период].[Период].CurrentMember.UniqueName' 
    set [NonEmptySet] 
    as 'Tail 
        (
            Filter 
            (
                Descendants   
                (
                    [Период].[Период].[Данные всех периодов],
                    [Период].[Период].[Квартал],
                    SELF   
                ),
                not IsEmpty 
                (
                    (
                        [Measures].[Значение],
                        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели]
                    ) 
                ) and 
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and 
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and 
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and 
                [Период].[Период].CurrentMember.Name <> "Данные года" and 
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and 
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты" 
            ),
            1 
        )' 
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows 
from [ФО_Оценка качества ФМ_Показатели] 
  ]]>
  </query>

  <query id="fo_0042_0001_avg">
    <![CDATA[
-- fo_0042_0001_avg
with   
    set [Администраторы]  
    as 'Filter  
        (
            {
                Descendants  
                (
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                    SELF  
                ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]  
            },
            not IsEmpty 
            (
                (
                    [Measures].[Взвешенное значение],
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Итоговая оценка] 
                ) 
            ) 
        )'  
    member [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Итоговая оценка]   
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Итоговая оценка по главному распорядителю средств бюджета автономного округа]'    
    member [measures].[Количество ГРБС]  
    as 'Count([Администраторы])'  
    member [measures].[Оценка]  
    as 'IIF  
        (
            not isEmpty ([measures].[Количество ГРБС]) and not  
            (
                [measures].[Количество ГРБС] = 0 
            ),
            [Measures].[Взвешенное значение] / [measures].[Количество ГРБС],
            null 
        )'  
select
    {
        [measures].[Оценка] 
    } on columns
from [ФО_Оценка качества ФМ_Показатели]  
where  
    (
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>,
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Итоговая оценка по главному распорядителю средств бюджета автономного округа]
    )  
  ]]>
  </query>

  <query id="fo_0042_0001_group_avg">
    <![CDATA[
-- fo_0042_0001_group_avg
with      
    member [measures].[Количество ГРБС]        
    as 'Count 
        (
            Filter  
            (
                {
                    Descendants  
                    (
                        [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
                        [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                        SELF  
                    ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]  
                },
                not isEmpty  
                (
                    (
                        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember,
                        [Measures].[Взвешенное значение]  
                    )  
                ) and not  
                (
                    (
                        [Measures].[Применим ли в оценке],
                        [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember,
                        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember  
                    ) = 0  
                )   
            ) 
        )'  
    member [measures].[Оценка] 
    as 'IIF 
        (
            not isEmpty ([measures].[Количество ГРБС]) and not 
            (
                [measures].[Количество ГРБС] = 0 
            ),
            [Measures].[Взвешенное значение] / [measures].[Количество ГРБС],
            null 
        )' 
select
    {
        [measures].[Оценка] 
    } on columns,
    {
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[1. Среднесрочное финансовое планирование],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[2. Исполнение бюджета в части расходов],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[3. Исполнение бюджета по доходам],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[4. Учет и отчетность],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[5. Контроль и аудит],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[6. Исполнение судебных актов],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[7. Кадровый потенциал финансового (финансово-экономического) подразделения ГРБС],
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[8. Управление активами]     
    }  on rows     
from [ФО_Оценка качества ФМ_Показатели]           
where           
    (
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>          
    )
  ]]>
  </query>

  <query id="fo_0042_0001_bestGRBSGrid">
    <![CDATA[
-- fo_0042_0001_bestGRBSGrid  
with
    set [Администраторы]
    as 'Head
        (
            Order
            (
                Filter
                (
                    {
                        Descendants
                        (
                            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
                            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                            SELF
                        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]
                    },
                    not IsEmpty
                    (
                        [Measures].[Взвешенное значение]
                    )
                ),
                [Measures].[Взвешенное значение],
                BDESC
            ),
            5
        )'
    member [Measures].[Код ГРБС]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")'

select
    {
        [Measures].[Код ГРБС],
        [Measures].[Взвешенное значение]
    }  on columns,
    { [Администраторы] } on rows
from [ФО_Оценка качества ФМ_Показатели]
where
    (
        
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>,
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Итоговая оценка по главному распорядителю средств бюджета автономного округа]
    )   
  ]]>
  </query>

  <query id="fo_0042_0001_worseGRBSGrid">
    <![CDATA[
-- fo_0042_0001_worseGRBSGrid  
with
    set [Администраторы]
    as 'Tail
        (
            Order
            (
                Filter
                (
                    {
                        Descendants
                        (
                            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
                            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                            SELF
                        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]
                    },
                    not IsEmpty
                    (
                        [Measures].[Взвешенное значение]
                    )
                ),
                [Measures].[Взвешенное значение],
                BDESC
            ),
            5
        )'
    member [Measures].[Код ГРБС]
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")'

select
    {
        [Measures].[Код ГРБС],
        [Measures].[Взвешенное значение]
    }  on columns,
    { [Администраторы] } on rows
from [ФО_Оценка качества ФМ_Показатели]
where
    (
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>,
        [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Итоговая оценка по главному распорядителю средств бюджета автономного округа]
    )   
  ]]>
  </query>

  <query id="FO_0042_0001_HMAO_grid">
    <![CDATA[
-- FO_0042_0001_HMAO_grid
with  
    set [Администраторы]  
    as 'Descendants  
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
            SELF  
        ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]'  
    set [Администраторы с данными]  
    as 'Filter  
        (
            {
                Descendants  
                (
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы],
                    [Администратор__Сопоставим].[Администратор__Сопоставим].[Администратор],
                    SELF  
                ) - [Администратор__Сопоставим].[Администратор__Сопоставим].[Все администраторы].[Несопоставленные данные]  
            },
            not IsEmpty         ( [Measures].[Итоговая оценка] )  
        )'  
    member [Администратор__Сопоставим].[Администратор__Сопоставим].[Аггрегированные администраторы]  
    as 'Aggregate  
        (
            { [Администраторы с данными]  }  
        )'  
    member [Measures].[Код ГРБС]  
    as '[Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember.Properties("Код")'  
    member [Measures].[Оценка показателя ]  
    as 'IIF  
        (
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Итоговая оценка]  
            ) or  
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Level is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 1]  
            ),
            [Measures].[Взвешенное значение],
            [Measures].[Оценка показателя]  
        )'  
    member [Measures].[Количество ГРБС]  
    as 'Count([Администраторы с данными])'  
    member [Measures].[Итоговая оценка]  
    as '  
        (
            [Measures].[Взвешенное значение],
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Итоговая оценка по главному распорядителю средств бюджета автономного округа]  
        )'  
    member [Measures].[Итоговая оценка по всем]  
    as '  
        (
            [Measures].[Взвешенное значение],
            [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Итоговая оценка по главному распорядителю средств бюджета автономного округа],
            [Администратор__Сопоставим].[Администратор__Сопоставим].[Аггрегированные администраторы]  
        )'  
    member [Measures].[Средняя оценка]  
    as 'IIF  
        (
            not isEmpty        ( [Measures].[Количество ГРБС] ) and not  
            (
                [Measures].[Количество ГРБС]  = 0  
            ),
            [Measures].[Итоговая оценка по всем] /[Measures].[Количество ГРБС] ,
            null  
        )'  
    member [Measures].[Отклонение от среднего]  
    as '[Measures].[Итоговая оценка] - [Measures].[Средняя оценка]'  
    member [Measures].[Ранг] 
    as ' Rank 
        (
            [Администратор__Сопоставим].[Администратор__Сопоставим].CurrentMember,
            Order 
            (
                [Администраторы с данными],
                [Measures].[Итоговая оценка],
                BDESC 
            ),
            [Measures].[Итоговая оценка] 
        )' 
select
    {
        [Measures].[Код ГРБС],
        [Measures].[Итоговая оценка],
        [Measures].[Отклонение от среднего],
        [Measures].[Ранг],
        [Measures].[Количество ГРБС]  
    }         on columns,
    {[Администраторы с данными]} on rows  
from [ФО_Оценка качества ФМ_Показатели]  
where  
    (
        [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%>
    )
  ]]>
</query>

<query id="FO_0042_0001_HMAO_indicatorDescription">
<![CDATA[
-- FO_0042_0001_HMAO_indicatorDescription
With
    set [Показатели]                 
    as 'Filter                 
        (
            Generate            
            (
                Descendants             
                (
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели],
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 1],
                    SELF             
                ) -            
                {
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Несопоставленные данные],
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Все показатели].[Итоговая оценка по главному распорядителю средств бюджета автономного округа]       
                },
                {
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember           
                } + Descendants            
                (
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember,
                    [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели 2],
                    SELF            
                )            
            ),
            not                 
            (
                [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember is [Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Parent.DataMember                 
            )                 
        ) '   
    member [Measures].[Единицы измерения]
    as '[Показатели__Оценка качества ФМ_Сопоставимый].[Показатели__Оценка качества ФМ_Сопоставимый].CurrentMember.Properties("Единицы измерения")'
Select
    {
       [Measures].[Единицы измерения]
    } on columns,
    { [Показатели] } on rows
From [ФО_Оценка качества ФМ_Показатели]
  ]]>
  </query>
  
</root>