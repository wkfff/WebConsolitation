<?xml version="1.0" encoding="Windows-1251"?>
<root>

    <query id="FO_0002_0013_01_Settlement_last_period">
        <![CDATA[
-- FO_0002_0013_01_Settlement_last_period
with 
    member [ДанныеНа] 
    as 'tail 
        (
            filter 
            (
                descendants 
                (
                    [Период__Период].[Период__Период],
                    [Период__Период].[Период__Период].[Месяц],
                    SELF 
                ),
                not isEmpty ( [Measures].[Факт] ) 
                AND not isEmpty ( [Measures].[Годовые назначения] ) 
            ) 
        ).item(0).uniqueName' 
select
    { [Measures].[ДанныеНа] } on columns 
from  [ФО_МесОтч_Дефицит Профицит] 
where 
    (
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Консолидированный бюджет Астраханская область].[Районы Астраханской области],
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет поселения],
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]  
    )       
]]>
    </query>

    <query id="FO_0002_0013_01_Settlement_filter_area">
        <![CDATA[
-- FO_0002_0013_01_Settlement_filter_area
with  
    member [Measures].[Уникальное имя]  
    as '[Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.UniqueName'
    member [Measures].[Имя]  
    as 'iif
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Консолидированный бюджет Астраханская область].[Районы Астраханской области].[Ахтубинский район],
            "Ахтубинский",
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name
        )'
    member [Measures].[Уровень]  
    as '0'  
select
    {
        [Measures].[Имя],
        [Measures].[Уникальное имя],
        [Measures].[Уровень]  
    } on columns,
    {
        filter
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Консолидированный бюджет Астраханская область].[Районы Астраханской области].Children,
            not [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Консолидированный бюджет Астраханская область].[Районы Астраханской области].DATAMEMBER
        )
    } on rows  
from [ФО_МесОтч_Дефицит Профицит]
]]>
    </query>


    <query id="FO_0002_0013_01_Settlement_grid">
        <![CDATA[
-- FO_0002_0013_01_Settlement_grid  
with  
    member [Measures].[_факт]
    as '[Measures].[Факт] / <%selected_scale%>'
    member [Measures].[_план]
    as '[Measures].[Годовые назначения] / <%selected_scale%>'
    member [Measures].[_%выполнения]
    as 'iif
       (
           isEmpty ( [Measures].[_план] ) OR ( [Measures].[_план] = 0),
           null,
           [Measures].[_факт] / [Measures].[_план]
       )'
       
    member [КД__Сопоставимый].[КД__Сопоставимый].[Параметры]  
    as 'MemberToStr ( [Measures].CurrentMember ) + ",
        " + MemberToStr  
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember  
        ) + ",
        " + MemberToStr  
        (
            [Период__Период].[Период__Период].CurrentMember  
        ) + ",
        " + MemberToStr  
        (
            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].CurrentMember  
        ) + ",
        " + MemberToStr  
        (
            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember  
        )'  
    member [КД__Сопоставимый].[КД__Сопоставимый].[Расходы всего]  
    as 'LookupCube  
        (
            "[ФО_МесОтч_Расходы]",
            "
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Итого расходов],
                " + [КД__Сопоставимый].[КД__Сопоставимый].[Параметры] + "  
            )"  
        )'  
    member [КД__Сопоставимый].[КД__Сопоставимый].[Расходы всего] 
    as 'LookupCube 
        (
            "[ФО_МесОтч_Расходы]",
            "
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Итого расходов],
                " + [КД__Сопоставимый].[КД__Сопоставимый].[Параметры] + " 
            )" 
        )' 
    member [КД__Сопоставимый].[КД__Сопоставимый].[Оплата труда с начислениями] 
    as 'LookupCube 
        (
            "[ФО_МесОтч_Расходы]",
            "aggregate 
            (
                {
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Заработная плата],
                    [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Расходы].[Оплата труда и начисления на выплаты по оплате труда].[Начисления на выплаты по оплате труда] 
                },
                (
                    " + [КД__Сопоставимый].[КД__Сопоставимый].[Параметры] + " 
                ) 
            )" 
        )' 
    member [КД__Сопоставимый].[КД__Сопоставимый].[Капитальные вложения]
    as 'LookupCube
        (
            "[ФО_МесОтч_Расходы]",
            "
            (
                [КОСГУ__Сопоставимый].[КОСГУ__Сопоставимый].[Все коды ЭКР].[Поступление нефинансовых активов].[Увеличение стоимости основных средств],
                " + [КД__Сопоставимый].[КД__Сопоставимый].[Параметры] + "
            )"
        )'
    member [КД__Сопоставимый].[КД__Сопоставимый].[Иные расходы]
    as '
           [КД__Сопоставимый].[КД__Сопоставимый].[Расходы всего]
           -[КД__Сопоставимый].[КД__Сопоставимый].[Оплата труда с начислениями]
           -[КД__Сопоставимый].[КД__Сопоставимый].[Капитальные вложения]
       '
    member [КД__Сопоставимый].[КД__Сопоставимый].[Дефицит] 
    as 'LookupCube 
        (
            "[ФО_МесОтч_Дефицит Профицит]",
            "
            (
                " + [КД__Сопоставимый].[КД__Сопоставимый].[Параметры] + "
            )" 
        )' 
    member [Measures].[УровеньИерархии]
    as 'iif
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый] is [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по поселениям],
            0,
            1
        )'
        
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее]
    as 'avg
        ( 
            [Поселения], 
            (
                [КД__Сопоставимый].[КД__Сопоставимый].currentMember,
                [Measures].currentMember
            )
        )'
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по поселениям]
    as 'aggregate
        ( 
            [Поселения], 
            (
                [КД__Сопоставимый].[КД__Сопоставимый].currentMember,
                [Measures].currentMember
            )
        )'
    set [Поселения]   
    as ' filter   
        (
            descendants   
            (
                <%selected_area%>,
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 06],
                SELF   
            ),
            NOT [Районы__Сопоставимый].[Районы__Сопоставимый].currentMember.properties("IS_DATAMEMBER")   
        ) '   
select
    {
        {
            {
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[Доходы бюджета - Всего],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[НАЛОГОВЫЕ И НЕНАЛОГОВЫЕ ДОХОДЫ],
                [КД__Сопоставимый].[КД__Сопоставимый].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ ОТ ДРУГИХ БЮДЖЕТОВ БЮДЖЕТНОЙ СИСТЕМЫ РОССИЙСКОЙ ФЕДЕРАЦИИ],
                [КД__Сопоставимый].[КД__Сопоставимый].[Расходы всего],
                [КД__Сопоставимый].[КД__Сопоставимый].[Оплата труда с начислениями],
                [КД__Сопоставимый].[КД__Сопоставимый].[Капитальные вложения],
                [КД__Сопоставимый].[КД__Сопоставимый].[Иные расходы],
                [КД__Сопоставимый].[КД__Сопоставимый].[Дефицит]
            }  
            *  
            {
                [Measures].[_план],
                [Measures].[_факт],
                [Measures].[_%выполнения]
            }
        }
        +
        {
            { [КД__Сопоставимый].[КД__Сопоставимый].defaultMember }
            * { [Measures].[УровеньИерархии] }
        }
    } on columns,
    { 
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Среднее]
        + [Поселения] +
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Итого по поселениям]
    } on rows   
from [ФО_МесОтч_Доходы] 
where      
    (
        <%selected_period%>,        
        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Собственный отчет поселения],
        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]       
    )  
]]>
    </query>


</root>