<?xml version="1.0" encoding="windows-1251"?>
<root>  
  <query id="FK_0001_0003_Saratov_populationDate">
    <![CDATA[
-- FK_0001_0003_Saratov_populationDate
with 
    member Measures.[Численность постоянного населения_Prev] 
    as ' LookupCube 
        (
            "[ФСГС_Численность населения]",
            " 
            (
                [Measures].[Факт],
                [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                [ФСГС].[Численность населения].[Все].[Все население],
                [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                " + MemberToStr 
                (
                    [Территории].[Сопоставимый].CurrentMember 
                ) + " 
            )" 
        ) ' 
    member Measures.[Численность постоянного населения_This] 
    as ' LookupCube 
        (
            "[ФСГС_Численность населения]",
            " 
            (
                [Measures].[Факт],
                [Период].[Период].[Данные всех периодов].[<%period_year%>],
                [ФСГС].[Численность населения].[Все].[Все население],
                [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                " + MemberToStr 
                (
                    [Территории].[Сопоставимый].CurrentMember 
                ) + " 
            )" 
        ) ' 
    member Measures.[Численность постоянного населения] 
    as 'IIF 
        (
            IsEmpty 
            (
                Measures.[Численность постоянного населения_This] 
            ) or Measures.[Численность постоянного населения_This] = 0,
            <%period_last_year%>,
            <%period_year%>
        ) '  
select
    {
        Measures.[Численность постоянного населения] 
    } on columns,
    {
        [Территории].[Сопоставимый].[Все территории].[Российская  Федерация] 
    } on rows 
from [ФК_МесОтч_Расходы] 
  ]]>
  </query>  
  
  <query id="FK_0001_0003_Saratov_compare_Grid">
    <![CDATA[
-- FK_0001_0003_Saratov_compare_Grid 
with   
   member Measures.[Численность постоянного населения_Prev]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения_This]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '
    member Measures.[Исполнено_]   
    as 'IIF   
        (
            (
                (
                    [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ"  
                ) or   
                (
                    [Территории].[Сопоставимый].CurrentMember.Level.Name = "РФ"  
                )  
            ),
            Measures.[Исполнено],
            Sum   
            (
                Filter   
                (
                    [Территории].[Сопоставимый].Children,
                    (
                        Measures.[Численность постоянного населения] <> 0   
                    )   
                ),
                Measures.[Исполнено_]   
            )   
        ) '   
    member Measures.[Коэффициент бюджетной обеспеченности населения]  
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Численность постоянного населения]   
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Исполнено_]/   
            (
                Measures.[Численность постоянного населения]   
                *1000   
            )   
        )'   
    member Measures.[Ранг бюдж.обесп. ФО]
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Коэффициент бюджетной обеспеченности населения]  
            ) or [Территории].[Сопоставимый].CurrentMember.Level.Name <> "Субъект РФ",
            null,
            Rank   
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order   
                (
                    Filter   
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty   
                        (
                            Measures.[Коэффициент бюджетной обеспеченности населения]  
                        )   
                    ),
                    Measures.[Коэффициент бюджетной обеспеченности населения],
                    DESC   
                ),
                Measures.[Коэффициент бюджетной обеспеченности населения]  
            )   
        )'   
    member Measures.[Худший ранг бюдж.обесп. ФО]
    as 'max   
        (
            [Территории].[Сопоставимый].CurrentMember.Siblings,
            Measures.[Ранг бюдж.обесп. ФО]
        )'   
    member Measures.[Ранг бюдж.обесп. РФ]
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Коэффициент бюджетной обеспеченности населения]  
            ) or [Территории].[Сопоставимый].CurrentMember.Level.Name <> "Субъект РФ",
            null,
            Rank   
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order   
                (
                    Filter   
                    (
                        [Территории].[Сопоставимый].[Субъект РФ].Members,
                        not IsEmpty   
                        (
                            Measures.[Коэффициент бюджетной обеспеченности населения]  
                        )   
                    ),
                    Measures.[Коэффициент бюджетной обеспеченности населения],
                    BDESC   
                ),
                Measures.[Коэффициент бюджетной обеспеченности населения]  
            )   
        )'   
    member Measures.[Худший ранг бюдж.обесп. РФ]
    as 'max   
        (
            [Территории].[Сопоставимый].[Субъект РФ].Members,
            Measures.[Ранг бюдж.обесп. РФ]
        )'   
    member Measures.[Доля]  
    as '   (
                Measures.[Исполнено],
                [РзПр].[Сопоставимый].CurrentMember
            )/   
            (
                Measures.[Исполнено],
                [РзПр].[Сопоставимый].[Все коды ФКР].[Расходы бюджета - ИТОГО]
            )
        '
    member Measures.[Ранг ФО]    
    as 'IIF    
        (
            IsEmpty ( [Measures].[Доля] ) or ([Территории].[Сопоставимый].CurrentMember.Level.Name <> "Субъект РФ"),
            null,
            Rank    
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Территории].[Сопоставимый].CurrentMember.Siblings,
                        not IsEmpty ( [Measures].[Доля] )    
                    ),
                    [Measures].[Доля],
                    DESC    
                ),
                [Measures].[Доля]    
            )    
        )'    
    member Measures.[Худший ранг ФО]    
    as 'IIF    
        (
            IsEmpty ( [Measures].[Доля] ),
            null,
            max    
            (
                [Территории].[Сопоставимый].CurrentMember.Siblings,
                Measures.[Ранг ФО]    
            )    
        ) '    
    member Measures.[Ранг РФ]    
    as 'IIF    
        (
            IsEmpty ([Measures].[Доля]) or [Территории].[Сопоставимый].CurrentMember.Level.Name <> "Субъект РФ",
            null,
            Rank    
            (
                [Территории].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Территории].[Сопоставимый].[Субъект РФ].Members,
                        not IsEmpty ( [Measures].[Доля] )    
                    ),
                    [Measures].[Доля],
                    BDESC    
                ),
                [Measures].[Доля]    
            )    
        )'    
    member Measures.[Худший ранг РФ] 
    as 'IIF    
        (
            IsEmpty ( [Measures].[Доля]),
            null,
            max    
            (
                [Территории].[Сопоставимый].[Субъект РФ].Members,
                Measures.[Ранг РФ]    
            )    
        ) '        
    member Measures.[ShortName]
    as '[Территории].[Сопоставимый].CurrentMember.Properties("Сокращенное наименование")'   
    member Measures.[ParentShortName]   
    as '[Территории].[Сопоставимый].CurrentMember.Parent.Properties("Сокращенное наименование")'   
    member Measures.[ФО]   
    as 'IIF   
        (
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ" or [Территории].[Сопоставимый].CurrentMember.Level.Name = "Федеральный округ"   
            ) and   
            (
                (
                    Measures.[Исполнено] + Measures.[Назначено]   
                ) <> 0   
            ),
            IIF   
            (
                [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ",
                Measures.[ParentShortName],
                Measures.[ShortName]   
            ),
            null   
        )'   
    member Measures.[Уровень]  
    as 'IIF  
        (
            (
                [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[РФ] or
                [Территории].[Сопоставимый].CurrentMember.Level is [Территории].[Сопоставимый].[Федеральный округ]
            ),
            0,
            1
        )'   
        
   member  Measures.[Исполнено ]
   as ' Measures.[Исполнено] / 1000000'
   member  Measures.[Назначено ]
   as ' Measures.[Назначено] / 1000000'   
    member Measures.[Темп роста]
    as 'IIF
        (
            IsEmpty
            (
            
                (
                Measures.[Исполнено],
                ParallelPeriod
                (
                   [Период].[Период].[Год],
                   1,
                   [Период].[Период].CurrentMember
                )
            )
            ) or 
            (
                Measures.[Исполнено],
                ParallelPeriod
                (
                   [Период].[Период].[Год],
                   1,
                   [Период].[Период].CurrentMember
                )
            ) = 0, 
            null,
            (
                Measures.[Исполнено],
                [Период].[Период].CurrentMember
            )/
            (
                Measures.[Исполнено],
                ParallelPeriod
                (
                   [Период].[Период].[Год],
                   1,
                   [Период].[Период].CurrentMember
                )
            )
        )    '      
select
    {
        Filter
        (
            {
                Measures.[ФО],
                Measures.[Исполнено ],
                Measures.[Назначено ],
                Measures.[Процент выполнения назначений],
                Measures.[Темп роста],
                Measures.[Численность постоянного населения],
                Measures.[Коэффициент бюджетной обеспеченности населения],
                Measures.[Ранг бюдж.обесп. ФО],
                Measures.[Ранг бюдж.обесп. РФ],
                Measures.[Доля],
                Measures.[Ранг ФО],
                Measures.[Ранг РФ],
                Measures.[Худший ранг бюдж.обесп. ФО],
                Measures.[Худший ранг бюдж.обесп. РФ],
                Measures.[Худший ранг ФО],
                Measures.[Худший ранг РФ],
                Measures.[Уровень]
            },
            IIF
            (
                <%percent_rank_hidden%> = true,
                not (Measures.CurrentMember is Measures.[Ранг ФО] or Measures.CurrentMember is Measures.[Ранг РФ]),
                true
            )
        )    
    } on columns,
    non Empty Filter  
    (
        {
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]   
            } + Generate   
            (
                [Территории].[Сопоставимый].[Федеральный округ].Members,
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF_AND_BEFORE   
                )   
            )   
        },
        (
            Measures.[Исполнено] + Measures.[Назначено] 
        ) <> 0  
    ) on rows  
from  [ФК_МесОтч_Расходы]  
where   
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%kd_group%>,
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта]
    )
  ]]>
</query>

  <query id="FK_0001_0003_Saratov_compare_map">
    <![CDATA[
-- FK_0001_0003_Saratov_compare_map 
with
  member Measures.[Численность постоянного населения_Prev]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_last_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения_This]
    as 'LookupCube
            (
                "[ФСГС_Численность населения]",
                "
                (
                    [Measures].[Факт],
                    [Период].[Период].[Данные всех периодов].[<%period_year%>],
                    [ФСГС].[Численность населения].[Все].[Все население],
                    [Вариант].[ФСГС Население].[Все].[Численность населения на 1 января],
                    " + MemberToStr
                    (
                        [Территории].[Сопоставимый].CurrentMember
                    ) + "
                )"
            ) / 1000'
    member Measures.[Численность постоянного населения]
    as 'IIF
        (
            IsEmpty
            (
                Measures.[Численность постоянного населения_This]
            ) or Measures.[Численность постоянного населения_This] = 0,
            Measures.[Численность постоянного населения_Prev],
            Measures.[Численность постоянного населения_This]
        ) '
    member Measures.[Исполнено_]   
    as 'IIF   
        (
            (
                (
                    [Территории].[Сопоставимый].CurrentMember.Level.Name = "Субъект РФ"  
                ) or   
                (
                    [Территории].[Сопоставимый].CurrentMember.Level.Name = "РФ"  
                )  
            ),
            Measures.[Исполнено],
            Sum   
            (
                Filter   
                (
                    [Территории].[Сопоставимый].Children,
                    (
                        Measures.[Численность постоянного населения] <> 0   
                    )   
                ),
                Measures.[Исполнено_]   
            )   
        ) '   
    member Measures.[Коэффициент бюджетной обеспеченности населения]  
    as 'IIF   
        (
            IsEmpty   
            (
                Measures.[Численность постоянного населения]   
            ) or Measures.[Численность постоянного населения] = 0,
            null,
            Measures.[Исполнено_]/   
            (
                Measures.[Численность постоянного населения]   
                *1000   
            )   
        )'   
select
    {
        Measures.[Коэффициент бюджетной обеспеченности населения]  
    } on columns,
    non Empty Filter  
    (
        {
            {
                [Территории].[Сопоставимый].[Все территории].[Российская  Федерация]   
            } + Generate   
            (
                [Территории].[Сопоставимый].[Федеральный округ].Members,
                Descendants   
                (
                    [Территории].[Сопоставимый].CurrentMember,
                    [Территории].[Сопоставимый].[Субъект РФ],
                    SELF_AND_BEFORE   
                )   
            )   
        },
        (
            Measures.[Исполнено]
        ) <> 0  
    ) on rows  
from  [ФК_МесОтч_Расходы]  
where   
    (
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>],
        <%kd_group%>,
        [Уровни бюджета].[СКИФ].[Все].[Конс.бюджет субъекта]
    )
  ]]>
  </query>
  
</root>