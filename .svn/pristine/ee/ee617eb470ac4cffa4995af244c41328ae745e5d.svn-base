<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0045_0003_date">
    <![CDATA[
-- FO_0045_0003_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Месяц],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Measures].[Значение]
                    )
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_Государственный долг]
]]>
  </query>

  <query id="FO_0045_0003_grid">
    <![CDATA[
-- FO_0045_0003_grid
with           
    set [Районы]           
    as 'Filter           
        (
            Descendants           
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF           
            ),
            not           
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember           
            ) and           
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"           
            )           
        )'           
    member [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ]   
    as 'Aggregate({[Районы]})'           
    member [Measures].[Объем долга]           
    as 'IIF 
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ],
            LookupCube 
            (
                "[ФО_Государственный долг]",
                " 
                (
                    [Measures].[Значение],
                    [Показатели__Виды ГосДолгОбязательств].[Показатели__Виды ГосДолгОбязательств].[Все].[Объем государственного долга автономного округа, всего],
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + " 
                ) " 
            ) / 1000,           
            (
                [Measures].[Значение],
                [Показатели__Виды МуниципДолгОбязательств].[Показатели__Виды МуниципДолгОбязательств].[Все].[Всего объем муниципального долга]           
            ) / 1000
         ) '           

    member [Measures].[Выбран район]
    as ' [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" '
    member [Measures].[Доходы бюджета итого]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ],
            LookupCube 
            (
                "[ФО_МесОтч_Доходы]",
                " 
                (
                    [Measures].[<%selected_measure%>],
                    [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[Доходы бюджета - ИТОГО],
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Консолидированный бюджет - Ханты-Мансийский автономный округ],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Бюджет субъекта],
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + "
                ) "
            ),
            IIF
            (
                [Measures].[Выбран район],
                LookupCube
                (
                    "[ФО_МесОтч_Доходы]",
                    "
                    (
                        [Measures].[<%selected_measure%>],
                        [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[Доходы бюджета - ИТОГО],
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                        " + MemberToStr
                        (
                            [Период__Период].[Период__Период].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                        ) + "
                    ) +
                    (
                        [Measures].[<%selected_measure%>],
                        [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[Доходы бюджета - ИТОГО],
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения],
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                        " + MemberToStr
                        (
                            [Период__Период].[Период__Период].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                        ) + "
                    ) "
                ),
                LookupCube
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum
                    (
                        {
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]
                        },
                        (
                            [Measures].[<%selected_measure%>],
                            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[Доходы бюджета - ИТОГО],
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr
                            (
                                [Период__Период].[Период__Период].CurrentMember
                            ) + ",
                            " + MemberToStr
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                            ) + "
                        )
                    ) "
                )
            )
        ) '
   member [Measures].[Доходы бюджета безвозмездные поступления]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ],
            0,
            IIF
            (
                [Measures].[Выбран район],
                LookupCube
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum
                    (
                        {
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]
                        },
                        (
                            [Measures].[<%selected_measure%>],
                            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Иные межбюджетные трансферты].[Средства бюджетов, передаваемые бюджетам на переселение граждан из закрытых административно-территориальных образований].[Средства бюджетов, передаваемые бюджетам муниципальных образований на осуществление части полномочий по решению вопросов местного значения в соответствии с заключенными соглашениями],
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr
                            (
                                [Период__Период].[Период__Период].CurrentMember
                            ) + ",
                            " + MemberToStr
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                            ) + "
                        )
                    ) "
                ) +
                LookupCube
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum
                    (
                        {
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]
                        },
                        (
                            [Measures].[<%selected_measure%>],
                            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации],
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr
                            (
                                [Период__Период].[Период__Период].CurrentMember
                            ) + ",
                            " + MemberToStr
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                            ) + "
                        )
                    ) "
                ),
                0
            )
        ) '
   member [Measures].[Доходы бюджета, cубвенции бюджетам субъектов]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ],
            LookupCube 
            (
                "[ФО_МесОтч_Доходы]",
                " 
                (
                    [Measures].[<%selected_measure%>],
                    [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                    [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Консолидированный бюджет - Ханты-Мансийский автономный округ],
                    [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Консолидированная отчетность и отчетность внебюджетных территориальных фондов],
                    [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Бюджет субъекта],
                    " + MemberToStr
                    (
                        [Период__Период].[Период__Период].CurrentMember 
                    ) + "
                ) "
            ),
            IIF
            (
                [Measures].[Выбран район],
                IIF
                (
                    [Период__Период].[Период__Период].CurrentMember.Properties("PKID") >= [Период__Период].[Период__Период].[Данные всех периодов].[2011].[Полугодие 1].[Квартал 1].[Январь].Properties("PKID"),
                    LookupCube
                    (
                        "[ФО_МесОтч_Доходы]",
                        "Sum
                        (
                            {
                                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района],
                                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]
                            },
                            (
                                [Measures].[<%selected_measure%>],
                                [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                                " + MemberToStr
                                (
                                    [Период__Период].[Период__Период].CurrentMember
                                ) + ",
                                " + MemberToStr
                                (
                                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                                ) + "
                            )
                        ) "
                    ),
                    LookupCube
                    (
                        "[ФО_МесОтч_Доходы]",
                        "Sum
                        (
                            {
                                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет района]
                            },
                            (
                                [Measures].[<%selected_measure%>],
                                [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                                " + MemberToStr
                                (
                                    [Период__Период].[Период__Период].CurrentMember
                                ) + ",
                                " + MemberToStr
                                (
                                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                                ) + "
                            )
                        ) "
                    ) +
                    LookupCube
                    (
                        "[ФО_МесОтч_Доходы]",
                        "Sum
                        (
                            {
                                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет поселения]
                            },
                            (
                                [Measures].[<%selected_measure%>],
                                [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                                [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                                [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                                " + MemberToStr
                                (
                                    [Период__Период].[Период__Период].CurrentMember
                                ) + ",
                                " + MemberToStr
                                (
                                    [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                                ) + "
                            )
                        ) "
                    )
                ),   
                LookupCube
                (
                    "[ФО_МесОтч_Доходы]",
                    "Sum
                    (
                        {
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет гор.округа]
                        },
                        (
                            [Measures].[<%selected_measure%>],
                            [КД__Сопоставимый План].[КД__Сопоставимый План].[Все коды доходов].[БЕЗВОЗМЕЗДНЫЕ ПОСТУПЛЕНИЯ].[Безвозмездные поступления от других бюджетов бюджетной системы Российской Федерации].[Субвенции бюджетам субъектов Российской Федерации и муниципальных образований],
                            [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].CurrentMember,
                            [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                            " + MemberToStr
                            (
                                [Период__Период].[Период__Период].CurrentMember
                            ) + ",
                            " + MemberToStr
                            (
                                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                            ) + "
                        )
                    ) "
                )
            )
        ) '        
    member [Measures].[Доходы бюджета]
    as 'IIF
        (
            (
                [Период__Период].[Период__Период].CurrentMember.Properties("PKID") >= [Период__Период].[Период__Период].[Данные всех периодов].[2011].[Полугодие 1].[Квартал 1].[Январь].Properties("PKID")
            ),
            [Measures].[Доходы бюджета итого] / 1000 - [Measures].[Доходы бюджета безвозмездные поступления] / 1000 - [Measures].[Доходы бюджета, cубвенции бюджетам субъектов] / 1000,
            [Measures].[Доходы бюджета итого] / 1000 - [Measures].[Доходы бюджета, cубвенции бюджетам субъектов] / 1000
        )'

    member [Measures].[Уровень долговой нагрузки]         
    as 'IIF        
        (
            IsEmpty([Measures].[Доходы бюджета]) or [Measures].[Доходы бюджета] = 0,
            null,
            [Measures].[Объем долга] / [Measures].[Доходы бюджета]        
        )'     
    member [Measures].[Уровень долговой нагрузки прошлый год]     
    as '    
        (
            [Measures].[Уровень долговой нагрузки],
            ParallelPeriod    
            (
                [Период__Период].[Период__Период].[Год],
                1,
                [Период__Период].[Период__Период].CurrentMember    
            )    
        )'     
    member Measures.[Ранг]        
    as 'IIF        
        (
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ] 
            ) or IsEmpty
            (
                [Measures].[Уровень долговой нагрузки]        
            ),
            null,
            Rank        
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember,
                Order        
                (
                    Filter        
                    (
                        [Районы],
                        not IsEmpty        
                        (
                            [Measures].[Уровень долговой нагрузки]        
                        )        
                    ),
                    [Measures].[Уровень долговой нагрузки],
                    BDESC        
                ),
                -[Measures].[Уровень долговой нагрузки]        
            )        
        )'        
    member Measures.[Худший ранг]        
    as 'max        
        (
            [Районы],
            Measures.[Ранг]        
        )'        
     
    member Measures.[Темп роста]     
    as 'IIF     
        (
            IsEmpty     
            (
                [Measures].[Уровень долговой нагрузки прошлый год]    
            ) or     
            (
                [Measures].[Уровень долговой нагрузки прошлый год]    
            )= 0,
            null,
            (
                [Measures].[Уровень долговой нагрузки]     
            ) /    
            (
                [Measures].[Уровень долговой нагрузки прошлый год]     
            )    
        )'  
        
   member [Measures].[Просороченная задолженность по долговым обязательствам]
    as 'IIF
        (
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ],
            Sum
            (
                [Районы],
                [Measures].[Просороченная задолженность по долговым обязательствам]
            ),
            LookupCube
            (
                "[ФО_МесОтч_СпрВнутрДолг]",
                "Sum
                (
                    {
                        [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[ГОСУДАРСТВЕННЫЙ ВНУТРЕННИЙ ДОЛГ СУБЪЕКТА РОССИЙСКОЙ ФЕДЕРАЦИИ, всего].[объем просроченной задолженности по долговым обязательствам субъекта Российской Федерации, составляющим внутренний долг субъекта Российской Федерации],
                        [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].[Все показатели].[объем просроченной задолженности по муниципальным долговым обязательствам]
                    },
                    (
                        [Measures].[Факт],
                        [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].CurrentMember,
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Бюджет субъекта],
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                        " + MemberToStr
                        (
                            [Период__Период].[Период__Период].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                        ) + "
                    ) +
                    (
                        [Measures].[Факт],
                        [Показатели__СопМесОСпВнтД].[Показатели__СопМесОСпВнтД].CurrentMember,
                        [Уровни бюджета__СКИФ].[Уровни бюджета__СКИФ].[Все].[Конс.бюджет МО],
                        [ТипДокумента__СКИФ].[ТипДокумента__СКИФ].[Все].[Данные конс. отчета субъекта в разрезе городов и районов (5+7+10)],
                        " + MemberToStr
                        (
                            [Период__Период].[Период__Период].CurrentMember
                        ) + ",
                        " + MemberToStr
                        (
                            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
                        ) + "
                    )
                ) "
            ) / 1000 
        )'       
    member Measures.[Удельный вес просроченной задолженности по долговым обязательствам]     
    as 'IIF     
        (
            IsEmpty     
            (
                [Measures].[Объем долга]
            ) or     
            (
                [Measures].[Объем долга]
            )= 0,
            null,
            (
                [Measures].[Просороченная задолженность по долговым обязательствам]
            ) /    
            (
                [Measures].[Объем долга]
            )    
        )'
                
select
    {
        [Measures].[Объем долга],
        [Measures].[Доходы бюджета],
        [Measures].[Уровень долговой нагрузки],
        [Measures].[Ранг],
        [Measures].[Темп роста],
        [Measures].[Просороченная задолженность по долговым обязательствам],
        [Measures].[Удельный вес просроченной задолженности по долговым обязательствам],
        [Measures].[Худший ранг]   
    } on columns,
    {
        {
            [Районы__Сопоставимый].[Районы__Сопоставимый].[Бюджет субъекта ]  
        } + [Районы]   
    } on rows   
from  [ФО_Муниципальный долг]           
where           
    (
        [Период__Период].[Период__Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]        
    )           
    ]]>
  </query>
  
</root>