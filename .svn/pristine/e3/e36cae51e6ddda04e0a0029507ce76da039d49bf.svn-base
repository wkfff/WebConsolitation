<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id = "STAT_0001_0020_Sakhalin_list_of_regions">
    <![CDATA[ -- STAT_0001_0020_list_of_regions
with
    set [Регионы]
    as '[Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].DataMember +
    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].Children -
    [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область].[Сахалинская обл.].DataMember'
    member [Measures].[Имя региона]
    as '[Территории__РФ].[Территории__РФ].CurrentMember.UniqueName'
select
    [Measures].[Имя региона] on columns,
    [Регионы] on rows
from [СТАТ_Инвестиции_Иностранные вложения]
where
    (
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Статистический раздел]
    )
    ]]>
  </query>

  <query id = "STAT_0001_0020_Sakhalin_quarters">
    <![CDATA[ -- STAT_0001_0020_Sakhalin_quarters
with
    set [Кварталы]
    as '
        (
            filter
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал],
                [Measures].[Нарастающий итог] > 0 and not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember
            )
        )'
    member [Measures].[Уникальное имя квартала]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.UniqueName'
select
    [Measures].[Уникальное имя квартала] on columns,
    [Кварталы] on rows
from [СТАТ_Инвестиции_Иностранные вложения]
where
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Дальневосточный федеральный округ].[Сахалинская область],
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Статистический раздел],
        [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций],
        [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели]
    )
  ]]>
  </query>
  
  <query id = "STAT_0001_0020_Sakhalin_grid">
    <![CDATA[ -- STAT_0001_0020_Sakhalin_grid
with
    set [Кварталы]
    as '
        {
            filter
            (
                [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал].Members,
                not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember and
                [Measures].[Фильтр] > 0 and not IsEmpty([Measures].[Фильтр])
            )
        }'
    member [Measures].[Поступило иностранных инвестиций]
    as '([Measures].[Нарастающий итог], [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Поступило иностранных инвестиций])'
    member [Measures].[Объём инвестиций из России за рубеж]
    as '([Measures].[Нарастающий итог], [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Объём инвестиций из России за рубеж])'
    member [Measures].[Вложения]
    as '[Measures].[Поступило иностранных инвестиций] + [Measures].[Объём инвестиций из России за рубеж]'
    member [Measures].[Фильтр]
    as 'Sum([Инвестиции], [Measures].[Вложения])'
    member [Measures].[В этом году]
    as '
        (
            [Measures].[Нарастающий итог],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember
        )'
    member [Measures].[В прошлом году]
    as '
        (
            [Measures].[Нарастающий итог],
            [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Lag(6)
        )'
    member [Measures].[Прирост к АППГ]
    as 'iif
        (
            IsEmpty([Measures].[В этом году]) or IsEmpty([Measures].[В прошлом году]),
            null,
            [Measures].[В этом году] - [Measures].[В прошлом году]
        )'
    member [Measures].[Темп роста к АППГ]
    as 'iif
        (
            IsEmpty([Measures].[В этом году]) or IsEmpty([Measures].[В прошлом году]) or ([Measures].[В прошлом году]) = 0,
            null,
            [Measures].[В этом году] / [Measures].[В прошлом году]
        )'
    set [Виды вложений]
    as '
        {
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Поступило иностранных инвестиций],
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Объём инвестиций из России за рубеж]
        }'
    set [Инвестиции]
    as '
        {
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прямые инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Портфельные инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прочие инвестиции]
        }'
    member [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Всего инвестиций]
    as 'aggregate({[Инвестиции]})'
    member [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год]
    as '"Год " + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Name +
    + ";" + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name'
    set [Строки грида]
    as '
        {
            [Measures].[В этом году],
            [Measures].[Прирост к АППГ],
            [Measures].[Темп роста к АППГ]
        }'
select
    { [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели] * {[Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год]} +
        [Виды вложений]
        * [Инвестиции]
    } on columns,
    [Кварталы]
    * [Строки грида] on rows
from [СТАТ_Инвестиции_Иностранные вложения]
where
    (
        <%selected_region%>,
        <%group%>,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Статистический раздел]
    )
    ]]>
  </query>

  <query id = "STAT_0001_0020_Sakhalin_chart">
    <![CDATA[ -- STAT_0001_0020_Sakhalin_chart
with
    set [Кварталы]
    as '{
            tail
            (
                filter
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Квартал].Members,
                    [Measures].[Фильтр] > 0 and not IsEmpty([Measures].[Фильтр]) and not [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember is [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.DataMember
                ),
                8
            )
        }'
    member [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Пустой параметр]
    as '0'
    set [Виды вложений]
    as '
        {
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Поступило иностранных инвестиций],
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Объём инвестиций из России за рубеж],
            [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Пустой параметр]
        }'
    member [Measures].[Поступило иностранных инвестиций]
    as '([Measures].[Нарастающий итог], [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Поступило иностранных инвестиций])'
    member [Measures].[Объём инвестиций из России за рубеж]
    as '([Measures].[Нарастающий итог], [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].[Все показатели].[Объём инвестиций из России за рубеж])'
    member [Measures].[Вложения]
    as '[Measures].[Поступило иностранных инвестиций] + [Measures].[Объём инвестиций из России за рубеж]'
    member [Measures].[Фильтр]
    as 'Sum([Инвестиции], [Measures].[Вложения])'
    set [Инвестиции]
    as '
        {
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прямые инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Портфельные инвестиции],
            [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Все виды инвестиций].[Прочие инвестиции]
        }'
    member [Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год]
    as '[Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Parent.Parent.Name + ";" +
    + [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].CurrentMember.Name + ";" +
    + [Инвестиции__Иностранные вложения].[Инвестиции__Иностранные вложения].CurrentMember.Name'
select
    {{[Инвестиции__Виды инвестиций].[Инвестиции__Виды инвестиций].[Год] } + [Инвестиции]} on columns,
    [Кварталы] * [Виды вложений] on rows
from [СТАТ_Инвестиции_Иностранные вложения] 
where
    (
        [Measures].[Нарастающий итог],
        <%selected_region%>,
        <%group%>,
        [Источники данных].[Источники данных].[Все источники данных].[СТАТ Отчетность - Статистический раздел]
    )
  ]]>
  </query>
  
</root>