<?xml version="1.0" encoding="windows-1251"?>
<root>

  <query id = "ComboProgram">
  <![CDATA[ With
  
member [Measures].[Код]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Код")+"!"'
member [Measures].[level]
as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.LEVEL_NUMBER'

member [Measures].[UniqueName]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.unique_name'

member [Measures].[Основание для разработки программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Основание для разработки программы")'

member [Measures].[Ожидаемый результат реализации]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Ожидаемый результат реализации")'

member [Measures].[Система реализации контроля за исполнением]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Система реализации контроля за исполнением")'

member [Measures].[Цель программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Цель программы")'


member [Measures].[Задачи программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Задачи программы")'


member [Measures].[Перечень основных мероприятий]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Перечень основных мероприятий")'

member [Measures].[Объем и источники финансирования]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Объем и источники финансирования")'


SELECT
    {
    [Measures].[UniqueName],
    [Measures].[level],
    [Measures].[План],
    [Measures].[Исполнено],
    [Measures].[Освоено],
    [Measures].[Основание для разработки программы],

    [Measures].[Ожидаемый результат реализации],
        [Measures].[Система реализации контроля за исполнением],
    [Measures].[Цель программы],
    [Measures].[Задачи программы],
    [Measures].[Перечень основных мероприятий],
    [Measures].[Объем и источники финансирования],
    [Measures].[Код]

    }  on columns,
    non empty{
[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].members
    } on rows
FROM  [ЭО_Программы_Долгосрочные целевые программы]
where
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Ненецкий автономный округ],
        [Программы__Источники финансирования].[Программы__Источники финансирования].[Все источники],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2010].[Полугодие 2].[Квартал 4].[Декабрь]
    )]]>
  </query>
   
    <query id = "Lepochka">
    <![CDATA[ With
member [Measures].[level]
as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.LEVEL_NUMBER'

member [Measures].[UniqueName]
as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.unique_name'

member [Measures].[Основание для разработки программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Основание для разработки программы")'

member [Measures].[Ожидаемый результат реализации]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Ожидаемый результат реализации")'

member [Measures].[Система реализации контроля за исполнением]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Система реализации контроля за исполнением")'

member [Measures].[Цель программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Цель программы")'

member [Measures].[Задачи программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Задачи программы")'


member [Measures].[Перечень основных мероприятий]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Перечень основных мероприятий")'

member [Measures].[Объем и источники финансирования]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Объем и источники финансирования")'
member [Measures].[Код]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Код")'
member [Measures].[Код1]
as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.properties("Код")'



SELECT
   non empty {
[Программы__Источники финансирования].[Программы__Источники финансирования].members
    }   on rows,
    non empty{
filter(
[Программы__Реестр программ].[Программы__Реестр программ].members,
[Measures].[Код1] ="<%code%>"
and
not [Программы__Реестр программ].[Программы__Реестр программ].currentmember.is_datamember
)
    }on columns
FROM  [ЭО_Программы_Долгосрочные целевые программы]
where
   ([Measures].[План],
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Ненецкий автономный округ],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2010].[Полугодие 2].[Квартал 4].[Декабрь]
    )
]]></query>

  <query id = "gauj">
    <![CDATA[With
member [Measures].[level]
as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.LEVEL_NUMBER'

member [Measures].[UniqueName]
as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.unique_name'

member [Measures].[Основание для разработки программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Основание для разработки программы")'

member [Measures].[Ожидаемый результат реализации]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Ожидаемый результат реализации")'

member [Measures].[Система реализации контроля за исполнением]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Система реализации контроля за исполнением")'

member [Measures].[Цель программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Цель программы")'

member [Measures].[Задачи программы]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Задачи программы")'


member [Measures].[Перечень основных мероприятий]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Перечень основных мероприятий")'

member [Measures].[Объем и источники финансирования]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Объем и источники финансирования")'
member [Measures].[Код]
as '[Программы__Реестр программ Сопоставимый].[Программы__Реестр программ Сопоставимый].currentmember.properties("Код")'
member [Measures].[Код1]
as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.properties("Код")'

member [Measures].[ga1]
as '[Measures].[Освоено]/[Measures].[План]'

member [Measures].[ga2]
as '[Measures].[Исполнено]/[Measures].[План]'



SELECT
   non empty {
[Measures].[ga1],
[Measures].[ga2]
    }   on rows,
    non empty{
filter(
[Программы__Реестр программ].[Программы__Реестр программ].members,
[Measures].[Код1] ="<%code%>"
and
not [Программы__Реестр программ].[Программы__Реестр программ].currentmember.is_datamember
)
    }on columns
FROM  [ЭО_Программы_Долгосрочные целевые программы]
where
   (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Ненецкий автономный округ],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2010].[Полугодие 2].[Квартал 4].[Декабрь]
    )
]]>
  </query>

  <query id = "UnameProgram">
    <![CDATA[ With  
    member [Measures].[Код1]  
    as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.properties("Код")'
    member [Measures].[uniqueName]
    as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.uniqueName'


SELECT
    {
[Measures].[uniqueName]
    }on columns   ,
    non empty{
filter
        (
            [Программы__Реестр программ].[Программы__Реестр программ].members,
            [Measures].[Код1] = "<%code%>" and not [Программы__Реестр программ].[Программы__Реестр программ].currentmember.is_datamember
        )
    }on rows
FROM  [ЭО_Программы_Долгосрочные целевые программы]  
where  
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Ненецкий автономный округ],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2010].[Полугодие 2].[Квартал 4].[Декабрь]
    )]]>
  </query>

  <query id = "Grid">
    <![CDATA[With
    member [Measures].[level]
    as '[Программы__Реестр программ].[Программы__Реестр программ].currentmember.LEVEL_NUMBER -2'
    member [Программы__Реестр программ].[Программы__Реестр программ].[mem]
    --as '[Программы__Реестр программ].[Программы__Реестр программ].[Данные всех источников].[ЭО\0005 Программы - вариант: 2010, ДЦП, месяц: 12, территория: Ненецкий автономный округ].[ДЦП "Сохранение и развитие коренных малочисленных народов Севера в НАО на 2009-2010 годы"]'
    as '<%code%>'
    member [Measures].[ПланО]
    as '
        (
            [Measures].[План]
        )'
    member [Measures].[ПланОбл]
    as '
        (
            [Measures].[План],
            [Программы__Источники финансирования].[Программы__Источники финансирования].[Источник].[Областной бюджет]
        )'
    member [Measures].[ПланМ]
    as '
        (
            [Measures].[План],
            [Программы__Источники финансирования].[Программы__Источники финансирования].[Источник].[Муниципальный бюджет]
        )'
    member [Measures].[ОсвоеноО]
    as '
        (
            [Measures].[Освоено]
        )'
    member [Measures].[ОсвоеноОбл]
    as '
        (
            [Measures].[Освоено],
            [Программы__Источники финансирования].[Программы__Источники финансирования].[Источник].[Областной бюджет]
        )'
    member [Measures].[ОсвоеноМ]
    as '
        (
            [Measures].[Освоено],
            [Программы__Источники финансирования].[Программы__Источники финансирования].[Источник].[Муниципальный бюджет]
        )'
    member [Measures].[ИсполненоО]
    as '
        (
            [Measures].[Исполнено]
        )'
    member [Measures].[ИсполненоОбл]
    as '
        (
            [Measures].[Исполнено],
            [Программы__Источники финансирования].[Программы__Источники финансирования].[Источник].[Областной бюджет]
        )'
    member [Measures].[ИсполненоМ]
    as '
        (
            [Measures].[Исполнено],
            [Программы__Источники финансирования].[Программы__Источники финансирования].[Источник].[Муниципальный бюджет]
        )'
SELECT
    {[Measures].[level] ,
        [Measures].[ПланО],
        [Measures].[ПланОбл],
        [Measures].[ПланМ],
        [Measures].[ИсполненоО],
        [Measures].[ИсполненоОбл],
        [Measures].[ИсполненоМ] ,
        [Measures].[ОсвоеноО],
        [Measures].[ОсвоеноОбл],
        [Measures].[ОсвоеноМ]

    } on columns,
    non empty  
    { 
        filter 
        (
            [Программы__Реестр программ].[Программы__Реестр программ].members,
            (
                   [Программы__Реестр программ].[Программы__Реестр программ].currentmember.uniquename = '<%code%>'
                or [Программы__Реестр программ].[Программы__Реестр программ].currentmember.parent = [Программы__Реестр программ].[Программы__Реестр программ].[mem]
                or [Программы__Реестр программ].[Программы__Реестр программ].currentmember.parent.parent = [Программы__Реестр программ].[Программы__Реестр программ].[mem]
                or [Программы__Реестр программ].[Программы__Реестр программ].currentmember.parent.parent.parent = [Программы__Реестр программ].[Программы__Реестр программ].[mem]
                or [Программы__Реестр программ].[Программы__Реестр программ].currentmember.parent.parent.parent.parent = [Программы__Реестр программ].[Программы__Реестр программ].[mem]
                or [Программы__Реестр программ].[Программы__Реестр программ].currentmember.parent.parent.parent.parent.parent = [Программы__Реестр программ].[Программы__Реестр программ].[mem]
            ) and not [Программы__Реестр программ].[Программы__Реестр программ].currentmember.is_datamember 
        )  
    } on rows  
FROM  [ЭО_Программы_Долгосрочные целевые программы]  
where  
    (
        [Территории__РФ].[Территории__РФ].[Все территории].[Российская Федерация].[Северо-Западный федеральный округ].[Ненецкий автономный округ],
        [Программы__Источники финансирования].[Программы__Источники финансирования].[Все источники],
        [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов].[2010].[Полугодие 2].[Квартал 4].[Декабрь]
    )]]>
</query>
 

 <query id = "ChartComparable">
    <![CDATA[ 
    ---ChartComparable
    with
    member [Measures].[<%ChosenRegionSubject%>]
    as '
        (
            [Measures].[За период],
            [Территории].[СЭП].[Все территории].[<%ChosenRegionSubject%>].datamember

        )'
    member [Measures].[<%ChosenRegionFO%>]
    as '
        (
            [Measures].[За период],
            [Территории].[СЭП].[Все территории].[<%ChosenRegionFO%>].datamember

        )'
    member [Measures].[Российская Федерация]
    as '
        (
            [Measures].[За период],
            [Территории].[СЭП].[Все территории].[Российская Федерация].datamember

        )'
    member [Measures].[ChartCaption]
    as '
 [Период].[Год Квартал Месяц].CurrentMember.Name +" "+  [Период].[Год Квартал Месяц].CurrentMember.parent.parent.parent.Name
        '
        
select
    {
				        [Measures].[ChartCaption],
                [Measures].[<%ChosenRegionSubject%>],
                [Measures].[<%ChosenRegionFO%>],
                [Measures].[Российская Федерация]
    } on columns,
    non empty
    {
filter(
<%ChosenDate%>:<%ChosenDate%>.lag(48)
,

not IsEmpty( [Measures].[<%ChosenRegionSubject%>]))

    }  on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
(
<%ChosenDetail%>
)
]]>
</query>

 <query id = "ChartDynamic">
    <![CDATA[ with   
    member [Measures].[ValueSubject]   
    as '   
        (
            [Measures].[За период],
            [Территории].[СЭП].[Все территории].[Республика Саха (Якутия)].datamember    
        )'   
    member [Measures].[ValueFO]   
    as '   
        (
            [Measures].[За период],
            [Территории].[СЭП].[Все территории].[Дальневосточный федеральный округ].datamember    
        )'   
    member [Measures].[ValueRF]   
    as '   
        (
            [Measures].[За период],
            [Территории].[СЭП].[Все территории].[Российская Федерация].datamember    
        )'   
    member [Measures].[ChartCaption]   
    as ' [Период].[Год Квартал Месяц].CurrentMember.parent.parent.parent.Name +", "+ [Период].[Год Квартал Месяц].CurrentMember.Name '
    member [Measures].[Year]
    as
    '[Период].[Год Квартал Месяц].CurrentMember.parent.parent.parent.Name'


select
    {
        [Measures].[Year],
        [Measures].[ChartCaption],
        [Measures].[ValueSubject]
  
    } on columns,
    non empty   
    {
    filter
    (
		{       
		[Период].[Год Квартал Месяц].[Год].[<%ChosenYear%>].[Полугодие 2].[Квартал 4].[Декабрь].lag(33):[Период].[Год Квартал Месяц].[Год].[<%ChosenYear%>].[Полугодие 2].[Квартал 4].[Декабрь].lag(48),
        [Период].[Год Квартал Месяц].[Год].[<%ChosenYear%>].[Полугодие 2].[Квартал 4].[Декабрь].lag(17):[Период].[Год Квартал Месяц].[Год].[<%ChosenYear%>].[Полугодие 2].[Квартал 4].[Декабрь].lag(32),
        [Период].[Год Квартал Месяц].[Год].[<%ChosenYear%>].[Полугодие 2].[Квартал 4].[Декабрь]:[Период].[Год Квартал Месяц].[Год].[<%ChosenYear%>].[Полугодие 2].[Квартал 4].[Декабрь].lag(16)},
 not IsEmpty(  [Measures].[ValueSubject])
        )
    }  on rows   
FROM  [СТАТ_СЭП_Годовой сборник]    
where
(
<%ChosenDetail%>
)
]]>
</query>
  <query id = "DefaultParam">
    <![CDATA[   
    --DefaultParam
 with
    member [Measures].[reverce]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Обратный показатель")'
    member [Measures].[UniqueName]
    as '[СЭП].[Годовой сборник].currentmember.UniqueName'
    member [Measures].[Unit]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Единица измерения")'
    member [Measures].[comparable]
    as '[СЭП].[Годовой сборник].CurrentMember.Properties("Сопоставимый показатель")'
select
    {
    <%ChosenDate%>
    } on columns,
    {
    TopCount(
        filter
        (
            [СЭП].[Годовой сборник].[Раздел].members,
            not IsEmpty
            (
                (
                    [Measures].[За период],
                    <%ChosenDate%>
                )
            )
        )
        ,
        1)
    }DIMENSION PROPERTIES PARENT_UNIQUE_NAME on rows
FROM  [СТАТ_СЭП_Годовой сборник]
where
    (
        [Территории].[СЭП].[Территория].[Центральный федеральный округ]
    )
  ]]>
  </query>

</root>