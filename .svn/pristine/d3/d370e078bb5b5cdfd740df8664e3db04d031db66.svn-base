<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="EO_0002_0005_lastDate">
    <![CDATA[
-- EO_0002_0005_lastDate
with  
    set [Месяцы с данными]  
    as 'tail  
        (
            filter  
            (
                [Период__Период].[Период__Период].[Месяц].Members,
                not IsEmpty ( [Measures].[Факт] ) and not 
                (
                    [Measures].[Факт] = 0
                )  
            ),
            1  
        )'  
    member [Measures].[Месяц]  
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'  
    set [Программы] 
    as ' 
        {
            descendants 
            (
                [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы],
                [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Программа],
                SELF 
            ) 
        }' 
    member [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП] 
    as 'aggregate ([Программы])' 
select
    {[Measures].[Месяц]} on columns,
    {[Месяцы с данными]} on rows  
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП]  
where 
    (
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП] 
    ) 
  ]]>
  </query>

  <query id="EO_0002_0005_info">
    <![CDATA[ -- EO_0002_0005_info
with
    member measures.[Объем ЦП]
    as 'count ([Программы])'
    member measures.[План ]
    as '([Период__Период].[Период__Период].[Данные всех периодов], measures.[План] ) / 1000'
    member measures.[Факт ]
    as 'measures.[Факт] / 1000'
    member [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП]
    as 'aggregate ([Программы])'
    member measures.[Количество программ]
    as 'count ([Программы])'
    member measures.[План текущий год]
    as 'measures.[План]  / 1000'
    member measures.[Процент исполнения]
    as 'IIF
        (
            not isEmpty(measures.[План текущий год]) and not (measures.[План текущий год]) = 0,
            measures.[Факт ] / measures.[План текущий год],
            0
        )'
            member measures.[Факт фильтр]  
    as ' 
        (
            measures.[Факт ] ,
            [Источники данных].[Источники данных].[Slicer]  
        )'  
    member measures.[Тип] 
    as '[Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].CurrentMember.Properties("REFTYPEPROG")' 
    set [Программы]   
    as '   
        {
            filter  
            (
                descendants   
                (
                    [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы],
                    [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Программа],
                    SELF   
                ) - [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Значение не указано],
                measures.[Тип] = "5" 
            )   
        }'   
    member [Источники данных].[Источники данных].[Slicer]   
    as 'aggregate   
        (
            [Источники данных].[Источники данных].[Все источники данных].[ЭО Сбор ЦП - Первоначальные данные],
            [Источники данных].[Источники данных].[Все источники данных].[ЭО Сбор ЦП - Фактические значения]   
        )'  
            member [Период__Период].[Период__Период].[Все годы]
    as 'Sum
        (
            {
                [Период__Период].[Период__Период].[2011],
                [Период__Период].[Период__Период].[2012],
                [Период__Период].[Период__Период].[2013]
            }
        )'
select
    {
        measures.[Количество программ],
        [Measures].[План ],
        measures.[Факт фильтр], 
        measures.[Процент исполнения],
        measures.[План текущий год]
    } on columns,
    {
        [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП]
    } on rows
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП]
where 
    (
    [Исполнение расходов__Типы программ].[Исполнение расходов__Типы программ].[Все типы программ].[Муниципальная целевая программа],
        <%selected_period%>.Parent.Parent.Parent
    )
    ]]>
  </query>

  <query id="EO_0002_0005_grid">
    <![CDATA[ -- EO_0002_0005_grid
with    
    member measures.[Объем ЦП]    
    as 'count ([Программы])'    
    member measures.[План ]    
    as 'measures.[План] / 1000'    
    member measures.[Факт ]    
    as 'measures.[Факт] / 1000'  
    member measures.[Факт фильтр]  
    as ' 
        (
            measures.[Факт ] ,
            [Источники данных].[Источники данных].[Slicer]  
        )'  
    member [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все ЦП]    
    as 'aggregate ([Программы])'    
    member measures.[Количество программ]    
    as 'count ([Программы])'    
    member measures.[Процент исполнения]    
    as 'IIF    
        (
            not isEmpty([Measures].[План ]) and not ([Measures].[План ]) = 0,
            measures.[Факт ] / [Measures].[План ],
            0    
        )'    
    member [Источники данных].[Источники данных].[Slicer]   
    as 'aggregate   
        (
            [Источники данных].[Источники данных].[Все источники данных].[ЭО Сбор ЦП - Первоначальные данные],
            [Источники данных].[Источники данных].[Все источники данных].[ЭО Сбор ЦП - Фактические значения]   
        )'   
    member measures.[Имя]    
    as '[Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].CurrentMember.Name'    
    member measures.[Тип]    
    as '[Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].CurrentMember.Properties("REFTYPEPROG")'    
    set [Программы]    
    as '    
        {
            descendants    
            (
                [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы],
                [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Программа],
                SELF    
            )  - [Исполнение расходов__Реестр программ].[Исполнение расходов__Реестр программ].[Все программы].[Значение не указано]    
        }'    
    set [МЦП]    
    as '    
        {
            Filter    
            (
                [Программы],
                measures.[Тип] = "5"   
            )    
        }'    
select
    {
        measures.[Имя],
        [Measures].[План ],
        measures.[Факт фильтр],
        [Measures].[Процент исполнения]    
    } on columns,
    { [МЦП] } on rows    
from  [ЭО_Сбор исполнения расходов_Финансирование ЦП]    
where    
    (
        [Исполнение расходов__Типы программ].[Исполнение расходов__Типы программ].[Все типы программ].[Муниципальная целевая программа]  ,  
        <%selected_period%>.Parent.Parent.Parent
    )
  
    ]]>
  </query>

</root>