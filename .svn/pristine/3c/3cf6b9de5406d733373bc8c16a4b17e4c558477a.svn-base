<?xml version="1.0" encoding="Windows-1251"?>
<root>

    <query id="RG_0017_0001_last_period">
        <![CDATA[
-- RG_0017_0001_last_period
with 
    member [Measures].[ДанныеНа] 
    as 'tail 
        (
            filter 
            (
                descendants 
                (
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Данные всех периодов],
                    [Период__Год Квартал Месяц].[Период__Год Квартал Месяц].[Месяц],
                    SELF 
                ),
                not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия политикам],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Электоральные предпочтения],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия институтам власти],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс восприятия уровня распространенности коррупции],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия главам],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия Думе],
                        [Measures].[Значение]
                    ) 
                ) and not isEmpty
                (
                    (
                        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия председателю Думы],
                        [Measures].[Значение]
                    ) 
                ) 
            ),
            1 
        ).item(0).uniqueName'
select
    { [Measures].[ДанныеНа] } on columns 
from  [РЕГИОН_Данные опросов] 
where 
    (
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        <%param_territory%>.DATAMEMBER        
    )  
    ]]>
    </query>

    <query id="RG_0017_0001_politician">
        <![CDATA[
-- RG_0017_0001_politician
with   
    member [Measures].[pkid]
    as '[СоцОпрос__Политики].[СоцОпрос__Политики].currentMember.properties("PKID")'
    member [Measures].[ФИО] 
    as '[СоцОпрос__Политики].[СоцОпрос__Политики].currentMember.properties("MEMBER_CAPTION")' 
    member [Measures].[Должность] 
    as '[СоцОпрос__Политики].[СоцОпрос__Политики].currentMember.properties("Должность")' 
    
    member [Measures].[Индекс] 
    as '
        (
            [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Индекс],
            [Measures].[Значение]
        )' 
    member [Measures].[Доверяют] 
    as '
        (
            [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Доверяю],
            [Measures].[Значение]
        )' 
    member [Measures].[Не доверяют] 
    as '
        (
            [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Не доверяю],
            [Measures].[Значение]
        )'    
    
    set [Строки]  
    as 'order
        (
            filter 
            (
                [СоцОпрос__Политики].[СоцОпрос__Политики].[Политик].members,
                not [СоцОпрос__Политики].[СоцОпрос__Политики].currentMember is [СоцОпрос__Политики].[СоцОпрос__Политики].[Все политики].[Значение не указано]   
            ),
            [Measures].[Индекс],
            DESC 
        )'  
select
    {
        [Measures].[pkid],
        [Measures].[ФИО],
        [Measures].[Должность],
        [Measures].[Индекс],
        [Measures].[Доверяют],
        [Measures].[Не доверяют]        
    } on columns,
    { [Строки] } on rows  
from  [РЕГИОН_Данные опросов]   
where   
    (
        <%param_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия политикам],
        <%param_territory%>.DATAMEMBER
    )
    ]]>
    </query>
    
    <query id="RG_0017_0001_electorate">
        <![CDATA[
-- RG_0017_0001_electorate
with 
    member [Measures].[pkid] 
    as '[СоцОпрос__Партии].[СоцОпрос__Партии].currentMember.properties("PKID")'  

    set [Строки]   
    as 'filter  
        (
            [СоцОпрос__Партии].[СоцОпрос__Партии].[Партия].members,
            not [СоцОпрос__Партии].[СоцОпрос__Партии].currentMember is [СоцОпрос__Партии].[СоцОпрос__Партии].[Все партии].[Значение не указано] 
        )'  
select
    {
        [Measures].[pkid],
        [Measures].[Значение]
    } on columns,
    { [Строки] } on rows    
from  [РЕГИОН_Данные опросов]     
where     
    (
        <%param_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Электоральные предпочтения],
        <%param_territory%>.DATAMEMBER
    )  
    ]]>
    </query>
    
    <query id="RG_0017_0001_power">
        <![CDATA[
-- RG_0017_0001_power
with     
    member [Measures].[Максимум общий]  
    as '2*max([Measures].[Максимум недоверия],[Measures].[Максимум доверия])'    --'[Measures].[Максимум недоверия]+[Measures].[Максимум доверия]' 
    member [Measures].[Максимум недоверия]  
    as 'max
        (
            [Строки],
            [Measures].[Не доверяю]
        )'
    member [Measures].[Максимум доверия]  
    as 'max
        (
            [Строки],
            [Measures].[Доверяю]
        )' 
    member [Measures].[Индекс]   
    as '  
        (
            [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Индекс],
            [Measures].[Значение]  
        )'   
    member [Measures].[Доверяю]  
    as '  
        (
            [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Доверяю],
            [Measures].[Значение]  
        )'  
    member [Measures].[Не доверяю]  
    as '  
        (
            [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Не доверяю],
            [Measures].[Значение]  
        )'   
    set [Строки]       
    as 'filter      
        (
            [СоцОпрос__Институты власти].[СоцОпрос__Институты власти].[Институт власти].members,
            not [СоцОпрос__Институты власти].[СоцОпрос__Институты власти].currentMember is [СоцОпрос__Институты власти].[СоцОпрос__Институты власти].[Все институты власти].[Значение не указано]    
        )'  
select
    {
        [Measures].[Максимум общий],
        [Measures].[Максимум недоверия],
        [Measures].[Максимум доверия],
        [Measures].[Индекс],
        [Measures].[Доверяю],
        [Measures].[Не доверяю]  
    } on columns,
    { [Строки] } on rows        
from  [РЕГИОН_Данные опросов]       
where       
    (
        <%param_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия институтам власти],
        <%param_territory%>.DATAMEMBER
    )  
    ]]>
    </query>      
  
    <query id="RG_0017_0001_government">
        <![CDATA[
-- RG_0017_0001_government
with  
    set [Варианты]   
    as 'filter  
        (
            [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Вариант].members,
            not [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].currentMember is [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].[Все варианты].[Значение не указано]
            and not isEmpty 
            (
                (
                    [СоцОпрос__Варианты ответов].[СоцОпрос__Варианты ответов].currentMember,
                    [Measures].[Значение] 
                ) 
            ) 
        ) ' 
    set [Строки]    
    as '   
        {
            [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс восприятия уровня распространенности коррупции],
            [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия главам],
            [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия Думе],
            [СоцОпрос__Показатели].[СоцОпрос__Показатели].[Все показатели].[Индекс доверия председателю Думы]    
        }'    
select
    { [Варианты]  } on columns,
    { [Строки] } on rows    
from  [РЕГИОН_Данные опросов]    
where    
    (
        <%param_period%>,
        [Источники данных].[Источники данных].[Все источники данных].[РЕГИОН СоцОпросы],
        <%param_territory%>.DATAMEMBER
    )   
    ]]>
    </query>  
    
</root>
