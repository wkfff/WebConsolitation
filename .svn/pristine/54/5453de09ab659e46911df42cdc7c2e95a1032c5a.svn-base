<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0039_0003_date">
    <![CDATA[
-- FO_0039_0003_date
with    
    member [Measures].[ДанныеНа]    
    as '[Период].[Период].CurrentMember.UniqueName'    
    set [NonEmptySet]    
    as 'Tail    
        (
            Filter    
            (
                Descendants   
                (
                    [Период].[Период].[Данные всех периодов],
                    [Период].[Период].[Квартал],
                    SELF   
                ),
                not IsEmpty    
                (
                    (
                        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р2]    
                    )    
                ) and   

                (
                    [Период].[Период].CurrentMember.Name <> "Остатки на начало года"  
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные квартала" 
                ) and  
                (
                    [Период].[Период].CurrentMember.Name <> "Данные полугодия" 
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Данные месяца"
                ) and 
                (
                    [Период].[Период].CurrentMember.Name <> "Заключительные обороты"
                ) 
            ),
            1    
        )'    
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows    
from [ФО_Оценка качества ОиОБП_Показатели]  
]]>
  </query>

  <query id="FO_0039_0003_grid">
    <![CDATA[
-- FO_0039_0003_grid
with    
    set [Список МО]    
    as 'Filter    
        (
            Descendants    
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF    
            ) - { [Районы].[Сопоставимый].[Все районы].[г.Омск] },
            not    
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember    
            ) and    
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"    
            )    
        )'    
    member [Measures].[Предыдущий квартал]    
    as '    
        (
            [Период].[Период].[Данные всех периодов].<%selected_prev_period%>,
            [Measures].[Оценка показателя]    
        )'    
    member [Measures].[Текущий квартал]    
    as '    
        (
            [Период].[Период].[Данные всех периодов].<%selected_period%>,
            [Measures].[Оценка показателя]    
        )'    
    member [Measures].[Отклонение]
    as 'IIF(IsEmpty([Measures].[Предыдущий квартал]) or IsEmpty([Measures].[Текущий квартал]), null, [Measures].[Текущий квартал] - [Measures].[Предыдущий квартал])'
    member [Measures].[Изменение рейтинга]
    as 'IIF(IsEmpty([Measures].[Предыдущий квартал]) or IsEmpty([Measures].[Текущий квартал]), null, [Measures].[Предыдущий квартал] - [Measures].[Текущий квартал])'
    member [Measures].[Темп роста] 
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[Предыдущий квартал]
            ) or 
            (
                [Measures].[Предыдущий квартал]
            ) = 0,
            null,
            [Measures].[Текущий квартал] / [Measures].[Предыдущий квартал]
        )' 
    member [Measures].[Отношение фактического результата к максимально возможному пред.квартал]
    as '[Measures].[Предыдущий квартал] / 45'
    member [Measures].[Отношение фактического результата к максимально возможному тек.квартал]
    as '[Measures].[Текущий квартал]  / 45'
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Занимаемое место по данным оценки]
    as 'IIF    
        (
            IsEmpty    
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Рейтинг МО]    
            ) or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО",
            null,
            Rank    
            (
                [Районы].[Сопоставимый].CurrentMember,
                Order    
                (
                    Filter    
                    (
                        [Список МО],
                        not IsEmpty    
                        (
                            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Рейтинг МО]    
                        )    
                    ),
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Рейтинг МО],
                    BASC  
                ),
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Рейтинг МО]    
            )    
        )' 
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Динамика итоговой оценки]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]'
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Отношение фактического результата к максимально возможному]
    as '[Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]'
    member Measures.[Выводим пустоту]    
    as '[Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Год] and 
        IsEmpty
        (
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р4],
                [Период].[Период].[Данные всех периодов].<%selected_period%>.DataMember,
                [Measures].[Оценка показателя]
            )   
        ) '      
select
    {
        {
            {
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Занимаемое место по данным оценки]
            }   
            *    
            {
                [Measures].[Предыдущий квартал],
                [Measures].[Текущий квартал],
                [Measures].[Изменение рейтинга]
            } 
        } + 
        {
            {
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП] 
            } 
            * 
            {
                [Measures].[Предыдущий квартал],
                [Measures].[Текущий квартал]
            }
        } +
        {
            {
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Динамика итоговой оценки]
            }
            *
            {
                [Measures].[Темп роста],
                [Measures].[Отклонение]
            }
        } +
        {
            {
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Отношение фактического результата к максимально возможному]
            }
            *
            {
                [Measures].[Отношение фактического результата к максимально возможному пред.квартал],
                [Measures].[Отношение фактического результата к максимально возможному тек.квартал]
            }
        }
    } on columns,
    { 
        Order
        (
            Filter([Список МО], not (Measures.[Выводим пустоту])),
            ([Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП], [Measures].[Оценка показателя]),
            BDESC
        )      
    } on rows    
from  [ФО_Оценка качества ОиОБП_Показатели]    
where    
    (
        [Период].[Период].[Данные всех периодов].<%selected_period%> 
    )    
  ]]>
  </query>

  <query id="FO_0039_0003_summaryGrid">
    <![CDATA[
-- FO_0039_0003_summaryGrid
with             
    set [Список МО]             
    as 'Filter             
        (
            Descendants             
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%> ,
                SELF             
            ) - { [Районы].[Сопоставимый].[Все районы].[г.Омск] },
            not             
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember             
            ) and             
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"             
            )             
        )'             
    member [Measures].[Предыдущий квартал]             
    as '             
        (
            [Период].[Период].[Данные всех периодов].<%selected_prev_period%>,
            [Measures].[Оценка показателя],
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember      
        )'             
    member [Measures].[Текущий квартал]             
    as '             
        (
            [Период].[Период].[Данные всех периодов].<%selected_period%>,
            [Measures].[Оценка показателя],
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember      
        )'       
    member [Measures].[Отклонение]       
    as 'IIF
        (
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember is [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимально возможная оценка качества, балл] or
            IsEmpty(([Measures].[Текущий квартал],[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember)) or IsEmpty(([Measures].[Предыдущий квартал],[Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember)),
            null,
            (
                (
                    [Measures].[Текущий квартал],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember       
                ) -       
                (
                    [Measures].[Предыдущий квартал],
                    [Показатели].[Оценка качества ОиОБП_Сопоставимый].CurrentMember       
                )
            )
        )' 
   
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества в муниципальных образованиях Омской области, балл]      
    as 'AVG      
        (
            [Список МО],
            (
                [Measures].CurrentMember,
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]     
            )      
        )'      
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл]      
    as 'MAX      
        (
            [Список МО],
            (
                [Measures].CurrentMember,
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]     
            )      
        )'      
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Минимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл]      
    as 'MIN      
        (
            [Список МО],
            (
                [Measures].CurrentMember,
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]     
            )      
        )'      
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимально возможная оценка качества, балл]      
    as 'IIF 
        (
            [Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Год],
            45,
            22  
        )' 
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Отношение средней оценки качества к максимально возможной, %]     
    as 'IIF     
        (
            IsEmpty    
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимально возможная оценка качества, балл]     
            ) or     
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимально возможная оценка качества, балл]     
            ) = 0,
            null,
            100 * [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества в муниципальных образованиях Омской области, балл] / [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимально возможная оценка качества, балл]     
        )'      
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Коэффициент определения границ интервала степени качества]    
    as '   
        (
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл] - [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Минимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл]   
        ) / 3'  
    member Measures.[Выводим пустоту]    
    as '[Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Год] and 
        IsEmpty
        (
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р4],
                [Период].[Период].[Данные всех периодов].<%selected_period%>.DataMember,
                [Measures].[Оценка показателя]
            )   
        ) '
select
    {
        [Measures].[Предыдущий квартал],
        [Measures].[Текущий квартал],
        [Measures].[Отклонение]      
    } on columns,
    {
        Filter
        (
            {
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества в муниципальных образованиях Омской области, балл],
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл],
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Минимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл],
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимально возможная оценка качества, балл],
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Отношение средней оценки качества к максимально возможной, %],
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Коэффициент определения границ интервала степени качества]   
            },
            not (Measures.[Выводим пустоту])
        )
    } on rows         
from  [ФО_Оценка качества ОиОБП_Показатели]             
where             
    (
        [Период].[Период].[Данные всех периодов].<%selected_period%>             
    )             
  ]]>
  </query>

  <query id="FO_0039_0003_chart">
    <![CDATA[
-- FO_0039_0003_chart
with              
    set [Список МО]              
    as 'Filter              
        (
            Descendants              
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF              
            ) - { [Районы].[Сопоставимый].[Все районы].[г.Омск] },
            not              
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember              
            ) and              
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"              
            )              
        )'         
    member Measures.[Выводим пустоту]    
    as '[Период].[Период].[Данные всех периодов].<%selected_period%>.Level is [Период].[Период].[Год] and 
        IsEmpty
        (
            (
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Р4],
                [Период].[Период].[Данные всех периодов].<%selected_period%>.DataMember,
                [Measures].[Оценка показателя]
            )   
        ) '     
select
    {
       [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП] 
    } on columns,
    non empty
    {
        Order
        (
            Filter([Список МО], not (Measures.[Выводим пустоту])),
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП],
            BDESC
        ) 
    } on rows          
from  [ФО_Оценка качества ОиОБП_Показатели]              
where              
    (
        [Measures].[Оценка показателя],
        [Период].[Период].[Данные всех периодов].<%selected_period%>            
    )                   
  ]]>
  </query>

  <query id="FO_0039_0003_avg_chart">
    <![CDATA[
-- FO_0039_0003_avg_chart
with   
    set [Список МО]   
    as 'Filter   
        (
            Descendants   
            (
                [Районы].[Сопоставимый].[Все районы],
                <%regions_level%>,
                SELF   
            ) - { [Районы].[Сопоставимый].[Все районы].[г.Омск] },
            not   
            (
                [Районы].[Сопоставимый].CurrentMember is [Районы].[Сопоставимый].CurrentMember.Parent.DataMember   
            ) and   
            (
                [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "МР" or [Районы].[Сопоставимый].CurrentMember.Properties("Тип территории") = "ГО"   
            )   
        )'   
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества]   
    as 'AVG   
        (
            [Список МО],
            (
                [Measures].CurrentMember,
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]   
            )   
        )'    
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл]   
    as 'MAX   
        (
            [Список МО],
            (
                [Measures].CurrentMember,
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]   
            )   
        )'   
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Минимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл]   
    as 'MIN   
        (
            [Список МО],
            (
                [Measures].CurrentMember,
                [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Все показатели].[Итоговая оценка уровня качества ОиОБП]   
            )   
        )'   
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Коэффициент определения границ интервала степени качества]   
    as '   
        (
            [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Максимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл] - [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Минимальная оценка уровня качества организации и осуществления бюджетного процесса среди всех муниципальных образований Омской области, балл]   
        ) / 3'    
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Начальная граница интервала] 
    as ' [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества] + [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Коэффициент определения границ интервала степени качества] '   
    member [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Конечная граница интервала] 
    as ' [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества] - [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Коэффициент определения границ интервала степени качества] '  
select
    {
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Средняя оценка уровня качества],
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Начальная граница интервала],
        [Показатели].[Оценка качества ОиОБП_Сопоставимый].[Конечная граница интервала] 
    } on columns  
from [ФО_Оценка качества ОиОБП_Показатели]   
where   
    (
        [Measures].[Оценка показателя],
        [Период].[Период].[Данные всех периодов].<%selected_period%>
    )             
  ]]>
  </query>

</root>