<?xml version="1.0" encoding="Windows-1251"?>
<root>

  <query id="FO_0016_0004_HMAO_date">
    <![CDATA[
-- FO_0016_0004_HMAO_date
with
    member [Measures].[ДанныеНа]
    as '[Период__Период].[Период__Период].CurrentMember.UniqueName'
    set [NonEmptySet]
    as 'Tail
        (
            Filter
            (
                Descendants
                (
                    [Период__Период].[Период__Период].[Данные всех периодов],
                    [Период__Период].[Период__Период].[Квартал],
                    SELF
                ),
                not IsEmpty
                (
                    (
                        [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5]
                    )
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Остатки на начало года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные квартала"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные полугодия"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные месяца"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Данные года"
                ) and
                (
                   [Период__Период].[Период__Период].CurrentMember.Name <> "Заключительные обороты"
                )
            ),
            1
        )'
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows
from [ФО_БККУ_Показатели]
]]>
  </query>

 

  <query id="FO_0016_0004_HMAO_grid">
    <![CDATA[
-- FO_0016_0004_HMAO_grid
with
    set [Список районов]
    as '
        [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Белоярский].DATAMEMBER
        +
        Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Белоярский],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 03],
                SELF_AND_AFTER
            ),
            not (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
        )
        +
        Filter
        (
            Descendants
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы],
                [Районы__Сопоставимый].[Районы__Сопоставимый].[Уровень 02],
                SELF_AND_AFTER
            ),
            ((
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent.DataMember
            )
            or
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "ГП"
            )
            or
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории") = "СП"
            ))
            and not
            (
                [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Белоярский].DATAMEMBER
                
            ) and not
            (
                  [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Parent is [Районы__Сопоставимый].[Районы__Сопоставимый].[Все районы].[Белоярский]
            )
            
        )'
    member  [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование района]
    as ' [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Name'
    member  [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Тип территории]
    as '
       [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember.Properties("Тип территории")
       '
    set [Непустые показатели]
    as '
        {
            {
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Наименование района]
            }
            *{[Measures].[Значение]}
        } +
        {
            {
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Тип территории]
            }
            *{[Measures].[Значение]}
        }+ nonEmptyCrossJoin
        (
            {
                [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Данные всех источников].[БК 5]
                *
                {
                    [Measures].[Значение],
                    [Measures].[Количество нарушений]
                }
            }
        )'
    member [Показатели__БККУ_Сопоставимый].[Показатели__БККУ_Сопоставимый].[Общее количество нарушений]
    as 'Sum
        (
            [Список показателей],
            [Районы__Сопоставимый].[Районы__Сопоставимый].CurrentMember
        )'
select
    {
        [Непустые показатели]
    } on columns,
    {
        [Список районов]
    } on rows
from  [ФО_БККУ_Показатели]
where
    (
      [Период__Период].[Период__Период].[Данные всех периодов].<%selected_period%> 
    )
    ]]>
  </query>

</root>