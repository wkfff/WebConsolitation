<?xml version="1.0" encoding="Windows-1251"?>
<root>
  <query id="FNS_0001_0006_iphone_date">
    <![CDATA[
-- FNS_0001_0006_iphone_date
with  
    member [Measures].[ДанныеНа]  
    as '[Период].[Период].CurrentMember.UniqueName'  
    set [NonEmptySet]  
    as 'Tail  
        (
            Filter  
            (
                NonEmptyCrossjoin 
                (
                    OpeningPeriod 
                    (
                        [Период].[Период].[Месяц],
                        [Период].[Период].[Данные всех периодов].[2008]
                    ) : ClosingPeriod 
                    (
                        [Период].[Период].[Месяц],
                        [Период].[Период].[Данные всех периодов].[2012]
                    ) 
                ),
                [Период].[Период].CurrentMember.Name <> "Остатки на начало года" and
                [Период].[Период].CurrentMember.Name <> "Данные квартала" and
                [Период].[Период].CurrentMember.Name <> "Данные полугодия" and
                [Период].[Период].CurrentMember.Name <> "Данные года" and
                [Период].[Период].CurrentMember.Name <> "Данные месяца" and
                [Период].[Период].CurrentMember.Name <> "Заключительные обороты"  
            )  
        )'  
select
    { [Measures].[ДанныеНа] } on columns,
    { [NonEmptySet] } on rows  
from [ФНС_28н_с расщеплением] 
  ]]>
  </query>

  <query id="FNS_0001_0006_iphone_chart">
    <![CDATA[
-- FNS_0001_0006_iphone_chart
 
with
    set [Список КД]  
    as 'Filter  
        (
            Descendants  
            (
                [КД].[Сопоставимый].[Все коды доходов].[<%incomes_kd_root_name%>],
                [КД].[Сопоставимый].[Статья],
                SELF  
            ),
            not  
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].CurrentMember.Parent.DataMember  
            )  
        )'
    member [КД].[Сопоставимый].[Итого ]  
    as 'Aggregate ( {[Список КД]} )'  
    
    set [Список ОКВЭД]
    as 'Filter
        (
            Descendants
            (
                [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД],
                [ОКВЭД].[Сопоставимый].[Раздел],
                SELF
            ) ,
            not
            (
                [ОКВЭД].[Сопоставимый].CurrentMember is [ОКВЭД].[Сопоставимый].CurrentMember.Parent.DataMember
            )
        )'
    set [Лучшие 5 ОКВЭД]
    as 'Tail
        (
            Order
            (
                [Список ОКВЭД] - {[ОКВЭД].[Сопоставимый].[Все коды ОКВЭД].[Нет кода ОКВЭД]},
                [Measures].[С начала года, млн.руб.],
                BASC
            ),
            5
        )'
    member [ОКВЭД].[Сопоставимый].[Прочие]
    as 'Aggregate
        (
            {[Список ОКВЭД] - [Лучшие 5 ОКВЭД]}
        )'        
    member  [Measures].[С начала года, млн.руб.]
    as ' [Measures].[С начала года] / 1000000'
select
    non Empty{ {[ОКВЭД].[Сопоставимый].[Прочие]} + [Лучшие 5 ОКВЭД] } on columns,
    {
        [Measures].[С начала года, млн.руб.]
    } on rows  
from [ФНС_28н_с расщеплением]
where
    (
        [КД].[Сопоставимый].[Итого ],
        [ФНС_65н_Показатели].[Все].[Поступило - всего],
        <%consolidate_region_element%>,
        [Уровни бюджетов].[Все].[Все уровни].[Конс.бюджет субъекта].[Бюджет субъекта],
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>] 
    )
  ]]>
  </query>

  <query id="FNS_0001_0006_iphone_top5">
    <![CDATA[
-- FNS_0001_0006_iphone_top5
with     
    set [Список КД]  
    as 'Filter  
        (
            Descendants  
            (
                [КД].[Сопоставимый].[Все коды доходов].[<%incomes_kd_root_name%>],
                [КД].[Сопоставимый].[Статья],
                SELF  
            ),
            not  
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].CurrentMember.Parent.DataMember  
            )  
        )'
    member [КД].[Сопоставимый].[Итого ]  
    as 'Aggregate ( {[Список КД]} )'  
    
    set [Список ОКВЭД]       
    as 'Filter       
        (
            Descendants       
            (
                [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД],
                [ОКВЭД].[Сопоставимый].[Раздел],
                SELF       
            ),
            not       
            (
                [ОКВЭД].[Сопоставимый].CurrentMember is [ОКВЭД].[Сопоставимый].CurrentMember.Parent.DataMember       
            )       
        )'       
    set [Лучшие 5 ОКВЭД]       
    as 'Head     
        (
            Order       
            (
                [Список ОКВЭД] - {[ОКВЭД].[Сопоставимый].[Все коды ОКВЭД].[Нет кода ОКВЭД]},
                [Measures].[С начала года],
                BDESC     
            ),
            5       
        )'       
    member [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего] 
    as 'Aggregate([Список ОКВЭД])'   
    member [ОКВЭД].[Сопоставимый].[Сумма 5 лучших]       
    as 'Aggregate([Лучшие 5 ОКВЭД])'       
    member [Measures].[Доля]       
    as 'IIF       
        (
            IsEmpty      
            (
                (
                    [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего],
                    [Measures].[С начала года]     
                )      
            ) or      
            (
                [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего],
                [Measures].[С начала года]     
            ) = 0,
            null,
            (
                [ОКВЭД].[Сопоставимый].CurrentMember,
                [Measures].[С начала года]     
            ) /      
            (
                [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего],
                [Measures].[С начала года]     
            )      
        )'   
    member [Measures].[Доля лучшего из лучших ОКВЭД]
    as '(Head([Лучшие 5 ОКВЭД]).Item(0), [Measures].[Доля])'
    member [Measures].[Доля худшего из лучших ОКВЭД]
    as '(Tail([Лучшие 5 ОКВЭД]).Item(0), [Measures].[Доля])'
    member [Measures].[Лучший из лучших ОКВЭД]
    as 'Head([Лучшие 5 ОКВЭД]).Item(0).Properties("NAME")'
    member [Measures].[Худший из лучших ОКВЭД]
    as 'Tail([Лучшие 5 ОКВЭД]).Item(0).Properties("NAME")'
select
    {
        [Measures].[Лучший из лучших ОКВЭД],
        [Measures].[Доля лучшего из лучших ОКВЭД],
        [Measures].[Худший из лучших ОКВЭД],
        [Measures].[Доля худшего из лучших ОКВЭД]
    } on columns
from [ФНС_28н_с расщеплением]       
where       
    (
        [КД].[Сопоставимый].[Итого ],
        [ФНС_65н_Показатели].[Все].[Поступило - всего],
        <%consolidate_region_element%>,
        [Уровни бюджетов].[Все].[Все уровни].[Конс.бюджет субъекта].[Бюджет субъекта],
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]
    )       
  ]]>
  </query>

  <query id="FNS_0001_0006_iphone_v">
    <![CDATA[
-- FNS_0001_0006_iphone_v
with  
    member [КД].[Сопоставимый].[Итого ]  
    as 'Aggregate ( {[Список КД]} )'  
    
    set [Список ОКВЭД]  
    as 'Filter  
        (
            Descendants  
            (
                [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД],
                [ОКВЭД].[Сопоставимый].[Раздел],
                SELF  
            ),
            not  
            (
                [ОКВЭД].[Сопоставимый].CurrentMember is [ОКВЭД].[Сопоставимый].CurrentMember.Parent.DataMember  
            )  
        )'  
    set [Лучшие 5 ОКВЭД]  
    as 'Head  
        (
            Order  
            (
                [Список ОКВЭД] - {[ОКВЭД].[Сопоставимый].[Все коды ОКВЭД].[Нет кода ОКВЭД]},
                [Measures].[С начала года, млн.руб.],
                BDESC  
            ),
            5  
        )'  
    set [Список КД]  
    as 'Filter  
        (
            Descendants  
            (
                [КД].[Сопоставимый].[Все коды доходов].[<%incomes_kd_root_name%>],
                [КД].[Сопоставимый].[Статья],
                SELF  
            ),
            not  
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].CurrentMember.Parent.DataMember  
            )  
        )'  
    member [ОКВЭД].[Сопоставимый].[Прочие]
    as 'Aggregate
        (
            {[Список ОКВЭД] - [Лучшие 5 ОКВЭД]}
        )' 
    member [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего] 
    as 'Aggregate
        (
            {[Список ОКВЭД]}
        )' 
    member [Measures].[С начала года, млн.руб.]
    as ' [Measures].[С начала года] / 1000000'  
    member [Measures].[Доля] 
    as 'IIF 
        (
            IsEmpty 
            (
                (
                    [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего],
                    [Measures].[С начала года, млн.руб.]
                ) 
            ) or 
            (

                    [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего],
                    [Measures].[С начала года, млн.руб.]

            ) = 0,
            null,
            100*
            (
                [ОКВЭД].[Сопоставимый].CurrentMember,
                [Measures].[С начала года, млн.руб.]
            ) / 
            (
                [ОКВЭД].[Сопоставимый].[По отраслям ОКВЭД Всего],
                [Measures].[С начала года, млн.руб.]
            ) 
        )' 
    member Measures.[Ранг по доле]
    as 'IIF
        (
            IsEmpty
            (
               [Measures].[Доля]
            ),
            null,
            Rank
            (
                [ОКВЭД].[Сопоставимый].CurrentMember,
                Order
                (
                    Filter
                    (
                        [Лучшие 5 ОКВЭД] + {[ОКВЭД].[Сопоставимый].[Прочие]},
                        not IsEmpty
                        (
                            [Measures].[Доля]
                        )
                    ),
                    [Measures].[Доля],
                    BDESC
                ),
                [Measures].[Доля]
            )
        )'
    member Measures.[Худший ранг по доле]
    as 'IIF
        (
            IsEmpty
            (
                 Measures.[Ранг по доле]
            ),
            null,
            max
            (
                [Лучшие 5 ОКВЭД] + {[ОКВЭД].[Сопоставимый].[Прочие]},
                Measures.[Ранг по доле]
            )
        )'
select
    {
        [Measures].[С начала года, млн.руб.],
        [Measures].[Темп роста к аналогичному периоду предыдущего года_С начала года],
        [Measures].[Доля],
        [Measures].[Ранг по доле],
        [Measures].[Худший ранг по доле]
    } on columns,
    non Empty  
    {
        [Лучшие 5 ОКВЭД] +  
        {
            [ОКВЭД].[Сопоставимый].[Прочие]  
        }  
    } on rows  
from [ФНС_28н_с расщеплением]  
where  
    (
        [КД].[Сопоставимый].[Итого ],
        [ФНС_65н_Показатели].[Все].[Поступило - всего],
        <%consolidate_region_element%>,
        [Уровни бюджетов].[Все].[Все уровни].[Конс.бюджет субъекта].[Бюджет субъекта],
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>] 
    )  
  ]]>
  </query>

  <query id="FNS_0001_0006_iphone_h">
    <![CDATA[
-- FNS_0001_0006_iphone_h
with 
    set [Список КД]  
    as 'Filter  
        (
            Descendants  
            (
                [КД].[Сопоставимый].[Все коды доходов].[<%incomes_kd_root_name%>],
                [КД].[Сопоставимый].[Статья],
                SELF  
            ),
            not  
            (
                [КД].[Сопоставимый].CurrentMember is [КД].[Сопоставимый].CurrentMember.Parent.DataMember  
            )  
        )'
    member [КД].[Сопоставимый].[Итого ]  
    as 'Aggregate ( {[Список КД]} )'  
    
    set [Список ОКВЭД]   
    as 'Filter   
        (
            Descendants   
            (
                [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД],
                [ОКВЭД].[Сопоставимый].[Раздел],
                SELF   
            ),
            not   
            (
                [ОКВЭД].[Сопоставимый].CurrentMember is [ОКВЭД].[Сопоставимый].CurrentMember.Parent.DataMember   
            )   
        )'    
    member [Measures].[С начала года, млн.руб.] 
    as ' [Measures].[С начала года] / 1000000'   
    member [Measures].[С начала года прошлый год, млн.руб.] 
    as ' [Measures].[С начала года прошлый год] / 1000000' 
    member [Measures].[Отклонение от аналогичного периода прошлого года, млн.руб.] 
    as 'IIF
        (
            IsEmpty
            (
                [Measures].[С начала года, млн.руб.]
            ) or 
            (
                [Measures].[С начала года, млн.руб.]
            ) = 0,
            null,
            [Measures].[С начала года, млн.руб.] - [Measures].[С начала года прошлый год, млн.руб.]
        )' 
    member [Measures].[На начало года, млн.руб.]  
    as '  
        (
            [Период].[Период].[Данные всех периодов].[<%period_last_year%>].[Полугодие 2].[Квартал 4].[Декабрь],
            [Measures].[С начала года, млн.руб.]
        )'          
select
    {
        [Measures].[На начало года, млн.руб.],
        [Measures].[С начала года, млн.руб.],
        [Measures].[Отклонение от аналогичного периода прошлого года, млн.руб.] 
    } on columns,
    non Empty 
    {
        [Список ОКВЭД] -   
        {
            [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД].[Нет кода ОКВЭД]   
        } +   
        {
            [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД].[Нет кода ОКВЭД]   
        } +   
        {
            [ОКВЭД].[Сопоставимый].[Все коды ОКВЭД]   
        }   
    } on rows   
from [ФНС_28н_с расщеплением]   
where   
    (
        [КД].[Сопоставимый].[Итого ],
        [ФНС_65н_Показатели].[Все].[Поступило - всего],
        <%consolidate_region_element%>,
        [Уровни бюджетов].[Все].[Все уровни].[Конс.бюджет субъекта].[Бюджет субъекта],
        [Период].[Период].[Данные всех периодов].[<%period_year%>].[<%period_half_year%>].[<%period_quater%>].[<%period_month%>]  
    )   
  ]]>
  </query>
</root>