CALCULATE;

//Период__Месяц
SCOPE([Период__Период].[Период__Период].[Квартал].members);
    this = Tail(Filter([Период__Период].[Период__Период].CurrentMember.Children, not (Measures.CurrentMember = 0)), 1).Item(0);
END SCOPE;

SCOPE([Период__Период].[Период__Период].[Полугодие].members);
    this = Tail(Filter([Период__Период].[Период__Период].CurrentMember.Children, not (Measures.CurrentMember = 0)), 1).Item(0);
END SCOPE;

SCOPE([Период__Период].[Период__Период].[Год].members);
    this = Tail(Filter([Период__Период].[Период__Период].CurrentMember.Children, not (Measures.CurrentMember = 0)), 1).Item(0);
END SCOPE;

//Вычисляемые меры

CREATE MEMBER CURRENTCUBE.Measures.[Начислено За период] AS
IIF(IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember)),
null,
IIF(IsLeaf([Период__Период].[Период__Период].CurrentMember), 
([Период__Период].[Период__Период].CurrentMember,[Measures].[Начислено С начала года])
- (Tail(Filter(
TopCount(DESCENDANTS(Ancestor([Период__Период].[Период__Период].CurrentMember,[Период__Период].[Период__Период].[Год]),[Период__Период].[Период__Период].[День],SELF),1).Item(0):[Период__Период].[Период__Период].CurrentMember.PrevMember
, not IsEmpty([Measures].[Начислено С начала года]))).Item(0),[Measures].[Начислено С начала года])
,null)
/*IIF([Период__Период].[Период__Период].CurrentMember.Level.Name = "Год" or [Период__Период].[Период__Период].CurrentMember.Level.Name = "All" or  [Период__Период].[Период__Период].CurrentMember is OpeningPeriod([Период__Период].[Период__Период].CurrentMember.Level, Ancestor([Период__Период].[Период__Период].CurrentMember, [Период__Период].[Период__Период].[Год])),
[Measures].[Начислено С начала года],

IIF([Период__Период].[Период__Период].CurrentMember.Name = "Полугодие 1", ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember),
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 1", ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember),
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 2", ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember),

IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(1))) and ([Период__Период].[Период__Период].CurrentMember.Lag(1).Name <> "Декабрь"), ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(1)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(2))) and ([Период__Период].[Период__Период].CurrentMember.Lag(2).Name <> "Декабрь"), ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(2)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(3))) and ([Период__Период].[Период__Период].CurrentMember.Lag(3).Name <> "Декабрь"),([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(3)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(4))) and ([Период__Период].[Период__Период].CurrentMember.Lag(4).Name <> "Декабрь"),([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(4)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(5))) and ([Период__Период].[Период__Период].CurrentMember.Lag(5).Name <> "Декабрь"),([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(5)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(6))) and ([Период__Период].[Период__Период].CurrentMember.Lag(6).Name <> "Декабрь"),([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(6)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(7))) and ([Период__Период].[Период__Период].CurrentMember.Lag(7).Name <> "Декабрь"),([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(7)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(8))) and ([Период__Период].[Период__Период].CurrentMember.Lag(8).Name <> "Декабрь"),([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(8)),
IIF(not IsEmpty(([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(9))) and ([Период__Период].[Период__Период].CurrentMember.Lag(9).Name <> "Декабрь"),([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember.Lag(9)),
[Measures].[Начислено С начала года]))))))))))))

)*/),
FORMAT_STRING = "Currency";

SCOPE([Measures].[Начислено За период]);
    this = IIF(not IsLeaf([Период__Период].[Период__Период].CurrentMember),
Sum([Период__Период].[Период__Период].CurrentMember.Children, [Measures].[Начислено За период]), ([Период__Период].[Период__Период].CurrentMember, [Measures].[Начислено За период]));
END SCOPE;

CREATE MEMBER CURRENTCUBE.Measures.[Поступило За период] AS
IIF(IsEmpty(([Measures].[Поступило С начала года], [Период__Период].[Период__Период].CurrentMember)),
null,
IIF(IsLeaf([Период__Период].[Период__Период].CurrentMember), 
([Период__Период].[Период__Период].CurrentMember,[Measures].[Поступило С начала года])
- (Tail(Filter(
TopCount(DESCENDANTS(Ancestor([Период__Период].[Период__Период].CurrentMember,
[Период__Период].[Период__Период].[Год]),[Период__Период].[Период__Период].[День],SELF)
,1).Item(0):[Период__Период].[Период__Период].CurrentMember.PrevMember
, not IsEmpty([Measures].[Поступило С начала года]))).Item(0),[Measures].[Поступило С начала года])
,null)),
FORMAT_STRING = "Currency";

SCOPE([Measures].[Поступило За период]);
    this = IIF(not IsLeaf([Период__Период].[Период__Период].CurrentMember),
Sum([Период__Период].[Период__Период].CurrentMember.Children, [Measures].[Поступило За период]), ([Период__Период].[Период__Период].CurrentMember, [Measures].[Поступило За период]));
END SCOPE;

CREATE MEMBER CURRENTCUBE.Measures.[Темп роста к предыдущему периоду_Начислено за период] AS
IIF(IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)), null, 
//IIF([Период__Период].[Период__Период].CurrentMember.Name = "Полугодие 1", null, 
//IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 1", null, 
//IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 2", null,
/*IIF([Период__Период].[Период__Период].CurrentMember.Name = "Январь", null, 
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Февраль", null, 
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Март", null, */
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))), IIF(([Measures].[Начислено за период], 
[Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], 
[Период__Период].[Период__Период].CurrentMember.Lag(1)) > 0, 
([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/
([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), 
IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)) < 0 and 
([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, 
(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) 
+ ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)))) / 
ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))), 
IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))>0 and 
([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, 
(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - 
([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))) / 
([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), 
- ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/
([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))))),
IIF(not IsEmpty(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)) > 0, ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)) < 0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)))) / ABS(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))), IIF(([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))>0 and ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))) / ([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)), -([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)))))
,null)))))))))))),
FORMAT_STRING = "Percent";
/*
CREATE MEMBER CURRENTCUBE.Measures.[Темп роста к предыдущему периоду_Поступило за период] AS
IIF(IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)), null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Полугодие 1", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 1", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Январь", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Февраль", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Март", null, IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))) and ([Период__Период].[Период__Период].CurrentMember.Lag(1).Name <> "Декабрь"), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))))),
IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))) and ([Период__Период].[Период__Период].CurrentMember.Lag(2).Name <> "Декабрь"), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))))),
IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))) and ([Период__Период].[Период__Период].CurrentMember.Lag(3).Name <> "Декабрь"), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))))),
IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))) and ([Период__Период].[Период__Период].CurrentMember.Lag(4).Name <> "Декабрь"), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))))),
IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))) and ([Период__Период].[Период__Период].CurrentMember.Lag(5).Name <> "Декабрь"), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))))),
IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))) and ([Период__Период].[Период__Период].CurrentMember.Lag(6).Name <> "Декабрь"), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))))),null)))))))))))),
FORMAT_STRING = "Percent";*/

CREATE MEMBER CURRENTCUBE.Measures.[Темп роста к предыдущему периоду_Поступило за период] AS
IIF(IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)), null,
/*IIF([Период__Период].[Период__Период].CurrentMember.Name = "Полугодие 1", null,
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 1", null,
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 2", null,
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Январь", null,
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Февраль", null,
IIF([Период__Период].[Период__Период].CurrentMember.Name = "Март", null,*/

IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
  0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), - ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(1))))),
  IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
    0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(2))))),
    IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
      0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(3))))),
      IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
        0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(4))))),
        IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
          0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(5))))),
          IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
            0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(6))))),
            IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
              0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(7))))),
              IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
                0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(8))))),
                IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
                  0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(9))))),
                  IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
                  0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(10))))),
                  IIF(not IsEmpty(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)) > 0, ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)) < 0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)>
                  0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) + ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)))) / ABS(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))), IIF(([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))>0 and ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)<0, (([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember) = ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11))) / ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)), -([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember.Lag(11)))))
                ,null)))))))))))),
                  FORMAT_STRING =
                "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[Предыдущий год_Поступило За период] AS
([Measures].[Поступило За период], ParallelPeriod([Период__Период].[Период__Период].[Год], 1, [Период__Период].[Период__Период].CurrentMember)),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Предыдущий год_Начислено За период] AS
([Measures].[Начислено За период], ParallelPeriod([Период__Период].[Период__Период].[Год], 1, [Период__Период].[Период__Период].CurrentMember)),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Темп роста к аналогичному периоду предыдущего года_Начислено за период] AS
IIF(IsEmpty([Measures].[Предыдущий год_Начислено За период]), null, IIF(([Measures].[Предыдущий год_Начислено За период] > 0) and ([Measures].[Начислено За период] > 0), [Measures].[Начислено За период]/[Measures].[Предыдущий год_Начислено За период], IIF(([Measures].[Предыдущий год_Начислено За период] < 0) and ([Measures].[Начислено За период] > 0), ([Measures].[Начислено За период] + ABS([Measures].[Предыдущий год_Начислено За период])) / ABS([Measures].[Предыдущий год_Начислено За период]), IIF(([Measures].[Предыдущий год_Начислено За период] > 0) and ([Measures].[Начислено За период] < 0), ([Measures].[Начислено За период] - [Measures].[Предыдущий год_Начислено За период]) / [Measures].[Предыдущий год_Начислено За период], -[Measures].[Начислено За период]/[Measures].[Предыдущий год_Начислено За период])))),
FORMAT_STRING = "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[Темп роста к аналогичному периоду предыдущего года_Поступило за период] AS
IIF(IsEmpty([Measures].[Предыдущий год_Поступило За период]), null, IIF(([Measures].[Предыдущий год_Поступило За период] > 0) and ([Measures].[Поступило За период] > 0), [Measures].[Поступило За период]/[Measures].[Предыдущий год_Поступило За период], IIF(([Measures].[Предыдущий год_Поступило За период] < 0) and ([Measures].[Поступило За период] > 0), ([Measures].[Поступило За период] + ABS([Measures].[Предыдущий год_Поступило За период])) / ABS([Measures].[Предыдущий год_Поступило За период]), IIF(([Measures].[Предыдущий год_Поступило За период] > 0) and ([Measures].[Поступило За период] < 0), ([Measures].[Поступило За период] - [Measures].[Предыдущий год_Поступило За период]) / [Measures].[Предыдущий год_Поступило За период], -[Measures].[Поступило За период]/[Measures].[Предыдущий год_Поступило За период])))),
FORMAT_STRING = "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[Отклонение от предыдущего периода_Начислено за период] AS
IIF(IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember)), null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Полугодие 1", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 1", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Январь", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Февраль", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Март", null,
IIF(not IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(1))) and ([Период__Период].[Период__Период].CurrentMember.Lag(1).Name <> "Декабрь"),([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), IIF(not IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(2))) and ([Период__Период].[Период__Период].CurrentMember.Lag(2).Name <> "Декабрь"),([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), IIF(not IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(3))) and ([Период__Период].[Период__Период].CurrentMember.Lag(3).Name <> "Декабрь"),([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), IIF(not IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(4))) and ([Период__Период].[Период__Период].CurrentMember.Lag(4).Name <> "Декабрь"),([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), IIF(not IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(5))) and ([Период__Период].[Период__Период].CurrentMember.Lag(5).Name <> "Декабрь"),([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), IIF(not IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(6))) and ([Период__Период].[Период__Период].CurrentMember.Lag(6).Name <> "Декабрь"),([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), null)))))))))))),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Отклонение от предыдущего периода_Поступило за период] AS
IIF(IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember)), null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Полугодие 1", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Квартал 1", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Январь", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Февраль", null, IIF([Период__Период].[Период__Период].CurrentMember.Name = "Март", null,
IIF(not IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(1))) and ([Период__Период].[Период__Период].CurrentMember.Lag(1).Name <> "Декабрь"),([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(1)), IIF(not IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(2))) and ([Период__Период].[Период__Период].CurrentMember.Lag(2).Name <> "Декабрь"),([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(2)), IIF(not IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(3))) and ([Период__Период].[Период__Период].CurrentMember.Lag(3).Name <> "Декабрь"),([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(3)), IIF(not IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(4))) and ([Период__Период].[Период__Период].CurrentMember.Lag(4).Name <> "Декабрь"),([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(4)), IIF(not IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(5))) and ([Период__Период].[Период__Период].CurrentMember.Lag(5).Name <> "Декабрь"),([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(5)), IIF(not IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(6))) and ([Период__Период].[Период__Период].CurrentMember.Lag(6).Name <> "Декабрь"),([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember.Lag(6)), null)))))))))))),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Отклонение от аналогичного периода предыдущего года_Начислено за период] AS
IIF(IsEmpty(([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember)), null, IIF(IsEmpty([Measures].[Предыдущий год_Начислено За период]), null, ([Measures].[Начислено За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Начислено За период], ParallelPeriod([Период__Период].[Период__Период].[Год], 1, [Период].[Месяц].CurrentMember)))),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Отклонение от аналогичного периода предыдущего года_Поступило за период] AS
IIF(IsEmpty(([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember)), null, IIF(IsEmpty([Measures].[Предыдущий год_Поступило За период]), null, ([Measures].[Поступило За период], [Период__Период].[Период__Период].CurrentMember) - ([Measures].[Поступило За период], ParallelPeriod([Период__Период].[Период__Период].[Год], 1, [Период].[Месяц].CurrentMember)))),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Удельный вес в общем объёме доходов_Начислено за период] AS
IIF(IsEmpty(([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)), null, IIF(IsEmpty(([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])), null, IIF(([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)>0 and ([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]) > 0, ([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)/([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]), IIF(([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]) < 0 and ([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)>0, (([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember) + ABS(([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]))) / ABS(([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])),
IIF(([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])>0 and ([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)<0, (([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember) - ([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])) / ([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]),
([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)/([Measures].[Начислено За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])))))),
FORMAT_STRING = "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[Удельный вес в общем объёме доходов_Поступило за период] AS
IIF(IsEmpty(([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)), null, IIF(IsEmpty(([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])), null, IIF(([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)>0 and ([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]) > 0, ([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)/([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]), IIF(([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]) < 0 and ([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)>0, (([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember) + ABS(([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]))) / ABS(([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])),
IIF(([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])>0 and ([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)<0, (([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember) - ([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])) / ([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели]),
([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].CurrentMember)/([Measures].[Поступило За период], [Доходы__Группы].[Доходы__Группы].[Все показатели])))))),
FORMAT_STRING = "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[Удельный вес в общем объёме видов экономической деятельности_Начислено за период] AS
IIF(IsEmpty(([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)), null, IIF(IsEmpty(([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])), null, IIF(([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)>0 and ([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]) > 0, ([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)/([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]), IIF(([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]) < 0 and ([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)>0, (([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember) + ABS(([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]))) / ABS(([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])),
IIF(([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])>0 and ([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)<0, (([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember) - ([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])) / ([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]),
([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)/([Measures].[Начислено За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])))))),
FORMAT_STRING = "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[Удельный вес в общем объёме видов экономической деятельности_Поступило за период] AS
IIF(IsEmpty(([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)), null, IIF(IsEmpty(([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])), null, IIF(([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)>0 and ([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]) > 0, ([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)/([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]), IIF(([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]) < 0 and ([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)>0, (([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember) + ABS(([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]))) / ABS(([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])),
IIF(([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])>0 and ([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)<0, (([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember) - ([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])) / ([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД]),
([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].CurrentMember)/([Measures].[Поступило За период], [ОКВЭД__Сопоставимый].[ОКВЭД__Сопоставимый].[Все коды ОКВЭД])))))),
FORMAT_STRING = "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[Отклонение поступлений от начислений_За период] AS
IIF(not IsEmpty(([Measures].[Поступило За период]) and ([Measures].[Начислено За период])), [Measures].[Поступило За период] - [Measures].[Начислено За период], null),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Отклонение поступлений от начислений_С начала года] AS
IIF(not IsEmpty(([Measures].[Начислено С начала года]) and ([Measures].[Поступило С начала года])), [Measures].[Поступило С начала года] - [Measures].[Начислено С начала года], null),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[% выполнения начислений_За период] AS
IIF((not IsEmpty([Measures].[Начислено За период] and [Measures].[Поступило За период]) and [Measures].[Начислено за период]<>0), ([Measures].[Поступило за период], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено за период], [Период__Период].[Период__Период].CurrentMember), null),
FORMAT_STRING = "Percent";

CREATE MEMBER CURRENTCUBE.Measures.[% выполнения начислений_С начала года] AS
IIF((not IsEmpty([Measures].[Начислено С начала года] and [Measures].[Поступило С начала года]) and [Measures].[Начислено С начала года]<>0), ([Measures].[Поступило С начала года], [Период__Период].[Период__Период].CurrentMember)/([Measures].[Начислено С начала года], [Период__Период].[Период__Период].CurrentMember), null),
FORMAT_STRING = "Percent";
