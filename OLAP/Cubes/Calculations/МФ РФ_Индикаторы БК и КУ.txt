CALCULATE;

SCOPE ([Measures].[Нормативное значение],  DESCENDANTS([Период__Период].[Период__Период].[Год].&[20000001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_до 2004 г")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20010001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_до 2004 г")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20020001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_до 2004 г")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20030001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_до 2004 г")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20040001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_до 2004 г")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20050001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_текущее")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20060001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_текущее")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20070001]));
   this = IIF(not IsEmpty([Measures].[Значение Факт]),
   IIF(IsLeaf([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_текущее")), null),
   null);
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20080001]));
   this = IIF([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember is [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Все индикаторы], Sum([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Children, [Measures].[Нормативное значение]),
IIF(([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember is [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Индикатор БК и КУ].&[122]  or [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember is [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Индикатор БК и КУ].&[123]) and 
([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Индикатор БК и КУ].&[241], [Measures].[Значение Факт]) = 1, Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_п4 ст130 БК")), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_текущее"))
));
END SCOPE;

SCOPE ([Measures].[Нормативное значение], DESCENDANTS([Период__Период].[Период__Период].[Год].&[20090001]));
   this = IIF([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember is [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Все индикаторы], Sum([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Children, [Measures].[Нормативное значение]),
IIF(([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember is [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Индикатор БК и КУ].&[122]  or [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember is [МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Индикатор БК и КУ].&[123]) and 
([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].[Индикатор БК и КУ].&[241], [Measures].[Значение Факт]) = 1, Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_п4 ст130 БК")), Abs([МФ РФ__Сопоставимый индикаторы БККУ].[МФ РФ__Сопоставимый индикаторы БККУ].CurrentMember.Properties("Норм значение_текущее"))
));
END SCOPE;

// Вычисляемые меры
CREATE MEMBER CURRENTCUBE.Measures.[Соответствие критерию Факт] AS IIF(not IsEmpty([Measures].[Значение Факт]) and ([Measures].[Наличие нарушения Факт] <> 0), "Не соответствует",
IIF(not IsEmpty([Measures].[Значение Факт]) and ([Measures].[Наличие нарушения Факт] = 0), "Соответствует", "")),
FORMAT_STRING = "Currency";

CREATE MEMBER CURRENTCUBE.Measures.[Соответствие критерию План] AS IIF(not IsEmpty([Measures].[Значение План]) and ([Measures].[Наличие нарушения План] <> 0), "Не соответствует",
IIF(not IsEmpty([Measures].[Значение План]) and ([Measures].[Наличие нарушения План] = 0), "Соответствует", "")),
FORMAT_STRING = "Currency";